function Base64Decrypt(data)
	local b='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
    data = string.gsub(data, '[^'..b..'=]', '')
    return (data:gsub('.', function(x)
        if (x == '=') then return '' end
        local r,f='',(b:find(x)-1)
        for i=6,1,-1 do r=r..(f%2^i-f%2^(i-1)>0 and '1' or '0') end
        return r;
    end):gsub('%d%d%d?%d?%d?%d?%d?%d?', function(x)
        if (#x ~= 8) then return '' end
        local c=0
        for i=1,8 do c=c+(x:sub(i,i)=='1' and 2^(8-i) or 0) end
        return string.char(c)
    end))
end

function _GetLocalVersion(LibName, StartPos, EndPos)
	if LibName == "SHADOWVAYNE" then
		LibNameFile = io.open(SCRIPT_PATH.."/"..MainScriptName, "r")
		LibNameString = LibNameFile:read("*a")
		LibNameFile:close()
		return tonumber(string.sub(LibNameString, 51, 54))
	else
		LibNameFile = io.open(LIB_PATH.."/"..LibName..".lua", "r")
		LibNameString = LibNameFile:read("*a")
		LibNamePos, Dummy = string.find(LibNameString, "local version =")
		if LibNamePos == nil then LibNamePos, Dummy = string.find(LibNameString, "@version") end
		LibNameFile:close()
		return tonumber(string.sub(LibNameString, LibNamePos+StartPos, LibNamePos+EndPos))
	end
end


StoredSOW = "bG9jYWwgdmVyc2lvbiA9ICIxLjEyOSIKbG9jYWwgQVVUT1VQREFURSA9IGZhbHNlCmxvY2FsIFVQREFURV9IT1NUID0gInJhdy5naXRodWIuY29tIgpsb2NhbCBVUERBVEVfUEFUSCA9ICIvaG9uZGE3L0JvTC9tYXN0ZXIvQ29tbW9uL1NPVy5sdWEiLi4iP3JhbmQ9Ii4ubWF0aC5yYW5kb20oMSwxMDAwMCkKbG9jYWwgVVBEQVRFX0ZJTEVfUEFUSCA9IExJQl9QQVRILi4iU09XLmx1YSIKbG9jYWwgVVBEQVRFX1VSTCA9ICJodHRwczovLyIuLlVQREFURV9IT1NULi5VUERBVEVfUEFUSAoKZnVuY3Rpb24gX0F1dG91cGRhdGVyTXNnKG1zZykgcHJpbnQoIjxmb250IGNvbG9yPVwiIzY2OTlmZlwiPjxiPlNPVzo8L2I+PC9mb250PiA8Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4iLi5tc2cuLiIuPC9mb250PiIpIGVuZAppZiBBVVRPVVBEQVRFIHRoZW4KCWxvY2FsIFNlcnZlckRhdGEgPSBHZXRXZWJSZXN1bHQoVVBEQVRFX0hPU1QsICIvaG9uZGE3L0JvTC9tYXN0ZXIvVmVyc2lvbkZpbGVzL1NPVy52ZXJzaW9uIikKCWlmIFNlcnZlckRhdGEgdGhlbgoJCVNlcnZlclZlcnNpb24gPSB0eXBlKHRvbnVtYmVyKFNlcnZlckRhdGEpKSA9PSAibnVtYmVyIiBhbmQgdG9udW1iZXIoU2VydmVyRGF0YSkgb3IgbmlsCgkJaWYgU2VydmVyVmVyc2lvbiB0aGVuCgkJCWlmIHRvbnVtYmVyKHZlcnNpb24pIDwgU2VydmVyVmVyc2lvbiB0aGVuCgkJCQlfQXV0b3VwZGF0ZXJNc2coIk5ldyB2ZXJzaW9uIGF2YWlsYWJsZSIuLlNlcnZlclZlcnNpb24pCgkJCQlfQXV0b3VwZGF0ZXJNc2coIlVwZGF0aW5nLCBwbGVhc2UgZG9uJ3QgcHJlc3MgRjkiKQoJCQkJRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBEb3dubG9hZEZpbGUoVVBEQVRFX1VSTCwgVVBEQVRFX0ZJTEVfUEFUSCwgZnVuY3Rpb24gKCkgX0F1dG91cGRhdGVyTXNnKCJTdWNjZXNzZnVsbHkgdXBkYXRlZC4gKCIuLnZlcnNpb24uLiIgPT4gIi4uU2VydmVyVmVyc2lvbi4uIiksIHByZXNzIEY5IHR3aWNlIHRvIGxvYWQgdGhlIHVwZGF0ZWQgdmVyc2lvbi4iKSBlbmQpIGVuZCwgMykKCQkJZWxzZQoJCQkJX0F1dG91cGRhdGVyTXNnKCJZb3UgaGF2ZSBnb3QgdGhlIGxhdGVzdCB2ZXJzaW9uICgiLi5TZXJ2ZXJWZXJzaW9uLi4iKSIpCgkJCWVuZAoJCWVuZAoJZWxzZQoJCV9BdXRvdXBkYXRlck1zZygiRXJyb3IgZG93bmxvYWRpbmcgdmVyc2lvbiBpbmZvIikKCWVuZAplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKY2xhc3MgIlNPVyIKZnVuY3Rpb24gU09XOl9faW5pdChWUCkKCV9HLlNPV0xvYWRlZCA9IHRydWUKCglzZWxmLlByb2plY3RpbGVTcGVlZCA9IG15SGVyby5yYW5nZSA+IDMwMCBhbmQgVlA6R2V0UHJvamVjdGlsZVNwZWVkKG15SGVybykgb3IgbWF0aC5odWdlCglzZWxmLkJhc2VXaW5kdXBUaW1lID0gMwoJc2VsZi5CYXNlQW5pbWF0aW9uVGltZSA9IDAuNjUKCXNlbGYuRGF0YVVwZGF0ZWQgPSBmYWxzZQoKCXNlbGYuVlAgPSBWUAoJCgktLUNhbGxiYWNrcwoJc2VsZi5BZnRlckF0dGFja0NhbGxiYWNrcyA9IHt9CglzZWxmLk9uQXR0YWNrQ2FsbGJhY2tzID0ge30KCXNlbGYuQmVmb3JlQXR0YWNrQ2FsbGJhY2tzID0ge30KCglzZWxmLkF0dGFja1RhYmxlID0KCQl7CgkJCVsiQXNoZXMgUSJdID0gImZyb3N0YXJyb3ciLAoJCX0KCglzZWxmLk5vQXR0YWNrVGFibGUgPQoJCXsKCQkJWyJTaHl2YW5hMSJdID0gInNoeXZhbmFkb3VibGVhdHRhY2tkcmFnb24iLAoJCQlbIlNoeXZhbmEyIl0gPSAiU2h5dmFuYURvdWJsZUF0dGFjayIsCgkJCVsiV3Vrb25nIl0gPSAiTW9ua2V5S2luZ0RvdWJsZUF0dGFjayIsCgkJfQoKCXNlbGYuQXR0YWNrUmVzZXRUYWJsZSA9IAoJCXsKCQkJWyJ2YXluZSJdID0gX1EsCgkJCVsiZGFyaXVzIl0gPSBfVywKCQkJWyJmaW9yYSJdID0gX0UsCgkJCVsiZ2FuZ3BsYW5rIl0gPSBfUSwKCQkJWyJqYXgiXSA9IF9XLAoJCQlbImxlb25hIl0gPSBfUSwKCQkJWyJtb3JkZWthaXNlciJdID0gX1EsCgkJCVsibmFzdXMiXSA9IF9RLAoJCQlbIm5hdXRpbHVzIl0gPSBfVywKCQkJWyJuaWRhbGVlIl0gPSBfUSwKCQkJWyJwb3BweSJdID0gX1EsCgkJCVsicmVuZWt0b24iXSA9IF9XLAoJCQlbInJlbmdhciJdID0gX1EsCgkJCVsic2h5dmFuYSJdID0gX1EsCgkJCVsic2l2aXIiXSA9IF9XLAoJCQlbInRhbG9uIl0gPSBfUSwKCQkJWyJ0cnVuZGxlIl0gPSBfUSwKCQkJWyJ2aSJdID0gX0UsCgkJCVsidm9saWJlYXIiXSA9IF9RLAoJCQlbInhpbnpoYW8iXSA9IF9RLAoJCQlbIm1vbmtleWtpbmciXSA9IF9RLAoJCQlbInlvcmljayJdID0gX1EsCgkJCVsiY2Fzc2lvcGVpYSJdID0gX0UsCgkJCVsiZ2FyZW4iXSA9IF9RLAoJCQlbImtoYXppeCJdID0gX1EsCgkJfQoKCXNlbGYuTGFzdEF0dGFjayA9IDAKCXNlbGYuRW5lbXlNaW5pb25zID0gbWluaW9uTWFuYWdlcihNSU5JT05fRU5FTVksIDIwMDAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0FTQykKCXNlbGYuSnVuZ2xlTWluaW9ucyA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0pVTkdMRSwgMjAwMCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQoJc2VsZi5PdGhlck1pbmlvbnMgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9PVEhFUiwgMjAwMCwgbXlIZXJvLCBNSU5JT05fU09SVF9IRUFMVEhfQVNDKQoJCglHZXRTYXZlKCJTT1ciKS5GYXJtRGVsYXkgPSBHZXRTYXZlKCJTT1ciKS5GYXJtRGVsYXkgYW5kIEdldFNhdmUoIlNPVyIpLkZhcm1EZWxheSBvciAwCglHZXRTYXZlKCJTT1ciKS5FeHRyYVdpbmRVcFRpbWUgPSBHZXRTYXZlKCJTT1ciKS5FeHRyYVdpbmRVcFRpbWUgYW5kIEdldFNhdmUoIlNPVyIpLkV4dHJhV2luZFVwVGltZSBvciA1MAoJR2V0U2F2ZSgiU09XIikuTW9kZTMgPSBHZXRTYXZlKCJTT1ciKS5Nb2RlMyBhbmQgR2V0U2F2ZSgiU09XIikuTW9kZTMgb3Igc3RyaW5nLmJ5dGUoIlgiKQoJR2V0U2F2ZSgiU09XIikuTW9kZTIgPSBHZXRTYXZlKCJTT1ciKS5Nb2RlMiBhbmQgR2V0U2F2ZSgiU09XIikuTW9kZTIgb3Igc3RyaW5nLmJ5dGUoIlYiKQoJR2V0U2F2ZSgiU09XIikuTW9kZTEgPSBHZXRTYXZlKCJTT1ciKS5Nb2RlMSBhbmQgR2V0U2F2ZSgiU09XIikuTW9kZTEgb3Igc3RyaW5nLmJ5dGUoIkMiKQoJR2V0U2F2ZSgiU09XIikuTW9kZTAgPSBHZXRTYXZlKCJTT1ciKS5Nb2RlMCBhbmQgR2V0U2F2ZSgiU09XIikuTW9kZTAgb3IgMzIKCglzZWxmLkF0dGFja3MgPSB0cnVlCglzZWxmLk1vdmUgPSB0cnVlCglzZWxmLm1vZGUgPSAtMQoJc2VsZi5jaGVja2NhbmNlbCA9IDAKCglBZGRQcm9jZXNzU3BlbGxDYWxsYmFjayhmdW5jdGlvbih1bml0LCBzcGVsbCkgc2VsZjpPblByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQplbmQKCmZ1bmN0aW9uIFNPVzpMb2FkVG9NZW51KG0sIFNUUykKCWlmIG5vdCBtIHRoZW4KCQlzZWxmLk1lbnUgPSBzY3JpcHRDb25maWcoIlNpbXBsZSBPcmJXYWxrZXIiLCAiU09XIikKCWVsc2UKCQlzZWxmLk1lbnUgPSBtCgllbmQKCglpZiBTVFMgdGhlbgoJCXNlbGYuU1RTID0gU1RTCgkJc2VsZi5TVFMuVlAgPSBzZWxmLlZQCgllbmQKCQoJc2VsZi5NZW51OmFkZFBhcmFtKCJFbmFibGVkIiwgIkVuYWJsZWQiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCglzZWxmLk1lbnU6YWRkUGFyYW0oIkZhcm1EZWxheSIsICJGYXJtIERlbGF5IiwgU0NSSVBUX1BBUkFNX1NMSUNFLCAtMTUwLCAwLCAxNTApCglzZWxmLk1lbnU6YWRkUGFyYW0oIkV4dHJhV2luZFVwVGltZSIsICJFeHRyYSBXaW5kVXAgVGltZSIsIFNDUklQVF9QQVJBTV9TTElDRSwgLTE1MCwgIDAsIDE1MCkKCQoJc2VsZi5NZW51LkZhcm1EZWxheSA9IEdldFNhdmUoIlNPVyIpLkZhcm1EZWxheQoJc2VsZi5NZW51LkV4dHJhV2luZFVwVGltZSA9IEdldFNhdmUoIlNPVyIpLkV4dHJhV2luZFVwVGltZQoKCXNlbGYuTWVudTphZGRQYXJhbSgiQXR0YWNrIiwgICJBdHRhY2siLCBTQ1JJUFRfUEFSQU1fTElTVCwgMiwgeyAiT25seSBGYXJtaW5nIiwgIkZhcm1pbmcgKyBDYXJyeSBtb2RlIn0pCglzZWxmLk1lbnU6YWRkUGFyYW0oIk1vZGUiLCAgIk9yYndhbGtpbmcgbW9kZSIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7ICJUbyBtb3VzZSIsICJUbyB0YXJnZXQifSkKCglzZWxmLk1lbnU6YWRkUGFyYW0oIkhvdGtleXMiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKQoKCXNlbGYuTWVudTphZGRQYXJhbSgiTW9kZTMiLCAiTGFzdCBoaXQhIiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJYIikpCglzZWxmLk1vZGUzUGFyYW1JRCA9ICNzZWxmLk1lbnUuX3BhcmFtCglzZWxmLk1lbnU6YWRkUGFyYW0oIk1vZGUxIiwgIk1peGVkIE1vZGUhIiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJDIikpCglzZWxmLk1vZGUxUGFyYW1JRCA9ICNzZWxmLk1lbnUuX3BhcmFtCglzZWxmLk1lbnU6YWRkUGFyYW0oIk1vZGUyIiwgIkxhbmVjbGVhciEiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlYiKSkKCXNlbGYuTW9kZTJQYXJhbUlEID0gI3NlbGYuTWVudS5fcGFyYW0KCXNlbGYuTWVudTphZGRQYXJhbSgiTW9kZTAiLCAiQ2FycnkgbWUhIiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIDMyKQoJc2VsZi5Nb2RlMFBhcmFtSUQgPSAjc2VsZi5NZW51Ll9wYXJhbQoKCXNlbGYuTWVudS5fcGFyYW1bc2VsZi5Nb2RlM1BhcmFtSURdLmtleSA9IEdldFNhdmUoIlNPVyIpLk1vZGUzCglzZWxmLk1lbnUuX3BhcmFtW3NlbGYuTW9kZTJQYXJhbUlEXS5rZXkgPSBHZXRTYXZlKCJTT1ciKS5Nb2RlMgoJc2VsZi5NZW51Ll9wYXJhbVtzZWxmLk1vZGUxUGFyYW1JRF0ua2V5ID0gR2V0U2F2ZSgiU09XIikuTW9kZTEKCXNlbGYuTWVudS5fcGFyYW1bc2VsZi5Nb2RlMFBhcmFtSURdLmtleSA9IEdldFNhdmUoIlNPVyIpLk1vZGUwCgkKCUFkZFRpY2tDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6T25UaWNrKCkgZW5kKQoJQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpDaGVja0NvbmZpZygpIGVuZCkKZW5kCgpmdW5jdGlvbiBTT1c6Q2hlY2tDb25maWcoKQoJR2V0U2F2ZSgiU09XIikuRmFybURlbGF5ID0gc2VsZi5NZW51LkZhcm1EZWxheQoJR2V0U2F2ZSgiU09XIikuRXh0cmFXaW5kVXBUaW1lID0gc2VsZi5NZW51LkV4dHJhV2luZFVwVGltZQoKCUdldFNhdmUoIlNPVyIpLk1vZGUzID0gc2VsZi5NZW51Ll9wYXJhbVtzZWxmLk1vZGUzUGFyYW1JRF0ua2V5CglHZXRTYXZlKCJTT1ciKS5Nb2RlMiA9IHNlbGYuTWVudS5fcGFyYW1bc2VsZi5Nb2RlMlBhcmFtSURdLmtleQoJR2V0U2F2ZSgiU09XIikuTW9kZTEgPSBzZWxmLk1lbnUuX3BhcmFtW3NlbGYuTW9kZTFQYXJhbUlEXS5rZXkKCUdldFNhdmUoIlNPVyIpLk1vZGUwID0gc2VsZi5NZW51Ll9wYXJhbVtzZWxmLk1vZGUwUGFyYW1JRF0ua2V5CmVuZAoKZnVuY3Rpb24gU09XOkRpc2FibGVBdHRhY2tzKCkKCXNlbGYuQXR0YWNrcyA9IGZhbHNlCmVuZAoKZnVuY3Rpb24gU09XOkVuYWJsZUF0dGFja3MoKQoJc2VsZi5BdHRhY2tzID0gdHJ1ZQplbmQKCmZ1bmN0aW9uIFNPVzpGb3JjZVRhcmdldCh0YXJnZXQpCglzZWxmLmZvcmNldGFyZ2V0ID0gdGFyZ2V0CmVuZAoKZnVuY3Rpb24gU09XOkdldFRpbWUoKQoJcmV0dXJuIG9zLmNsb2NrKCkKZW5kCgpmdW5jdGlvbiBTT1c6TXlSYW5nZSh0YXJnZXQpCglsb2NhbCBteVJhbmdlID0gbXlIZXJvLnJhbmdlICsgc2VsZi5WUDpHZXRIaXRCb3gobXlIZXJvKQoJaWYgdGFyZ2V0IGFuZCBWYWxpZFRhcmdldCh0YXJnZXQpIHRoZW4KCQlteVJhbmdlID0gbXlSYW5nZSArIHNlbGYuVlA6R2V0SGl0Qm94KHRhcmdldCkKCWVuZAoJcmV0dXJuIG15UmFuZ2UgLSAyMAplbmQKCmZ1bmN0aW9uIFNPVzpJblJhbmdlKHRhcmdldCkKCWxvY2FsIE15UmFuZ2UgPSBzZWxmOk15UmFuZ2UodGFyZ2V0KQoJaWYgdGFyZ2V0IGFuZCBHZXREaXN0YW5jZVNxcih0YXJnZXQudmlzaW9uUG9zLCBteUhlcm8udmlzaW9uUG9zKSA8PSBNeVJhbmdlICogTXlSYW5nZSB0aGVuCgkJcmV0dXJuIHRydWUKCWVuZAplbmQKCmZ1bmN0aW9uIFNPVzpWYWxpZFRhcmdldCh0YXJnZXQpCglpZiB0YXJnZXQgYW5kIHRhcmdldC50eXBlIGFuZCAodGFyZ2V0LnR5cGUgPT0gIm9ial9CYXJyYWNrc0RhbXBlbmVyIiBvciB0YXJnZXQudHlwZSA9PSAib2JqX0hRIikgIHRoZW4KCQlyZXR1cm4gZmFsc2UKCWVuZAoJcmV0dXJuIFZhbGlkVGFyZ2V0KHRhcmdldCkgYW5kIHNlbGY6SW5SYW5nZSh0YXJnZXQpCmVuZAoKZnVuY3Rpb24gU09XOkF0dGFjayh0YXJnZXQpCglzZWxmLkxhc3RBdHRhY2sgPSBzZWxmOkdldFRpbWUoKSArIHNlbGY6TGF0ZW5jeSgpCglteUhlcm86QXR0YWNrKHRhcmdldCkKZW5kCgpmdW5jdGlvbiBTT1c6V2luZFVwVGltZShleGFjdCkKCXJldHVybiAoMSAvIChteUhlcm8uYXR0YWNrU3BlZWQgKiBzZWxmLkJhc2VXaW5kdXBUaW1lKSkgKyAoZXhhY3QgYW5kIDAgb3IgR2V0U2F2ZSgiU09XIikuRXh0cmFXaW5kVXBUaW1lIC8gMTAwMCkKZW5kCgpmdW5jdGlvbiBTT1c6QW5pbWF0aW9uVGltZSgpCglyZXR1cm4gKDEgLyAobXlIZXJvLmF0dGFja1NwZWVkICogc2VsZi5CYXNlQW5pbWF0aW9uVGltZSkpCmVuZAoKZnVuY3Rpb24gU09XOkxhdGVuY3koKQoJcmV0dXJuIEdldExhdGVuY3koKSAvIDIwMDAKZW5kCgpmdW5jdGlvbiBTT1c6Q2FuQXR0YWNrKCkKCWlmIHNlbGYuTGFzdEF0dGFjayA8PSBzZWxmOkdldFRpbWUoKSB0aGVuCgkJcmV0dXJuIChzZWxmOkdldFRpbWUoKSArIHNlbGY6TGF0ZW5jeSgpICA+IHNlbGYuTGFzdEF0dGFjayArIHNlbGY6QW5pbWF0aW9uVGltZSgpKQoJZW5kCglyZXR1cm4gZmFsc2UKZW5kCgpmdW5jdGlvbiBTT1c6Q2FuTW92ZSgpCglpZiBzZWxmLkxhc3RBdHRhY2sgPD0gc2VsZjpHZXRUaW1lKCkgdGhlbgoJCXJldHVybiAoKHNlbGY6R2V0VGltZSgpICsgc2VsZjpMYXRlbmN5KCkgPiBzZWxmLkxhc3RBdHRhY2sgKyBzZWxmOldpbmRVcFRpbWUoKSkgb3Igc2VsZi5QYXJ0aWNsZUNyZWF0ZWQpIGFuZCBub3QgX0cuZXZhZGUKCWVuZAplbmQKCmZ1bmN0aW9uIFNPVzpCZWZvcmVBdHRhY2sodGFyZ2V0KQoJbG9jYWwgcmVzdWx0ID0gZmFsc2UKCWZvciBpLCBjYiBpbiBpcGFpcnMoc2VsZi5CZWZvcmVBdHRhY2tDYWxsYmFja3MpIGRvCgkJbG9jYWwgcmkgPSBjYih0YXJnZXQsIHNlbGYubW9kZSkKCQlpZiByaSB0aGVuCgkJCXJlc3VsdCA9IHRydWUKCQllbmQKCWVuZAoJcmV0dXJuIHJlc3VsdAplbmQKCmZ1bmN0aW9uIFNPVzpSZWdpc3RlckJlZm9yZUF0dGFja0NhbGxiYWNrKGYpCgl0YWJsZS5pbnNlcnQoc2VsZi5CZWZvcmVBdHRhY2tDYWxsYmFja3MsIGYpCmVuZAoKZnVuY3Rpb24gU09XOk9uQXR0YWNrKHRhcmdldCkKCWZvciBpLCBjYiBpbiBpcGFpcnMoc2VsZi5PbkF0dGFja0NhbGxiYWNrcykgZG8KCQljYih0YXJnZXQsIHNlbGYubW9kZSkKCWVuZAplbmQKCmZ1bmN0aW9uIFNPVzpSZWdpc3Rlck9uQXR0YWNrQ2FsbGJhY2soZikKCXRhYmxlLmluc2VydChzZWxmLk9uQXR0YWNrQ2FsbGJhY2tzLCBmKQplbmQKCmZ1bmN0aW9uIFNPVzpBZnRlckF0dGFjayh0YXJnZXQpCglmb3IgaSwgY2IgaW4gaXBhaXJzKHNlbGYuQWZ0ZXJBdHRhY2tDYWxsYmFja3MpIGRvCgkJY2IodGFyZ2V0LCBzZWxmLm1vZGUpCgllbmQKZW5kCgpmdW5jdGlvbiBTT1c6UmVnaXN0ZXJBZnRlckF0dGFja0NhbGxiYWNrKGYpCgl0YWJsZS5pbnNlcnQoc2VsZi5BZnRlckF0dGFja0NhbGxiYWNrcywgZikKZW5kCgpmdW5jdGlvbiBTT1c6TW92ZVRvKHgsIHkpCglteUhlcm86TW92ZVRvKHgsIHkpCmVuZApmdW5jdGlvbiBTT1c6T3JiV2Fsayh0YXJnZXQsIHBvaW50KQoJcG9pbnQgPSBwb2ludCBvciBzZWxmLmZvcmNlb3Jid2Fsa3BvcwoJaWYgc2VsZi5BdHRhY2tzIGFuZCBzZWxmOkNhbkF0dGFjaygpIGFuZCBzZWxmOlZhbGlkVGFyZ2V0KHRhcmdldCkgYW5kIG5vdCBzZWxmOkJlZm9yZUF0dGFjayh0YXJnZXQpIHRoZW4KCQlzZWxmOkF0dGFjayh0YXJnZXQpCgllbHNlaWYgc2VsZjpDYW5Nb3ZlKCkgYW5kIHNlbGYuTW92ZSB0aGVuCgkJaWYgbm90IHBvaW50IHRoZW4KCQkJbG9jYWwgT0JUYXJnZXQgPSBHZXRUYXJnZXQoKQoJCQlpZiBzZWxmLk1lbnUuTW9kZSA9PSAxIG9yIG5vdCBPQlRhcmdldCB0aGVuCgkJCQlsb2NhbCBNdiA9IFZlY3RvcihteUhlcm8pICsgNDAwICogKFZlY3Rvcihtb3VzZVBvcykgLSBWZWN0b3IobXlIZXJvKSk6bm9ybWFsaXplZCgpCgkJCQlzZWxmOk1vdmVUbyhNdi54LCBNdi56KQoJCQllbHNlaWYgR2V0RGlzdGFuY2VTcXIoT0JUYXJnZXQpID4gNTAqNTAgdGhlbgoJCQkJbG9jYWwgcG9pbnQgPSBzZWxmLlZQOkdldFByZWRpY3RlZFBvcyhPQlRhcmdldCwgMCwgMipteUhlcm8ubXMsIG15SGVybywgZmFsc2UpCgkJCQlzZWxmOk1vdmVUbyhwb2ludC54LCBwb2ludC56KQoJCQllbmQKCQllbHNlCgkJCXNlbGY6TW92ZVRvKHBvaW50LngsIHBvaW50LnopCgkJZW5kCgllbmQKZW5kCgpmdW5jdGlvbiBTT1c6SXNBdHRhY2soU3BlbGxOYW1lKQoJcmV0dXJuIChTcGVsbE5hbWU6bG93ZXIoKTpmaW5kKCJhdHRhY2siKSBvciB0YWJsZS5jb250YWlucyhzZWxmLkF0dGFja1RhYmxlLCBTcGVsbE5hbWU6bG93ZXIoKSkpIGFuZCBub3QgdGFibGUuY29udGFpbnMoc2VsZi5Ob0F0dGFja1RhYmxlLCBTcGVsbE5hbWU6bG93ZXIoKSkKZW5kCgpmdW5jdGlvbiBTT1c6SXNBQVJlc2V0KFNwZWxsTmFtZSkKCWxvY2FsIFNwZWxsSUQKCWlmIFNwZWxsTmFtZTpsb3dlcigpID09IG15SGVybzpHZXRTcGVsbERhdGEoX1EpLm5hbWU6bG93ZXIoKSB0aGVuCgkJU3BlbGxJRCA9IF9RCgllbHNlaWYgU3BlbGxOYW1lOmxvd2VyKCkgPT0gbXlIZXJvOkdldFNwZWxsRGF0YShfVykubmFtZTpsb3dlcigpIHRoZW4KCQlTcGVsbElEID0gX1cKCWVsc2VpZiBTcGVsbE5hbWU6bG93ZXIoKSA9PSBteUhlcm86R2V0U3BlbGxEYXRhKF9FKS5uYW1lOmxvd2VyKCkgdGhlbgoJCVNwZWxsSUQgPSBfRQoJZWxzZWlmIFNwZWxsTmFtZTpsb3dlcigpID09IG15SGVybzpHZXRTcGVsbERhdGEoX1IpLm5hbWU6bG93ZXIoKSB0aGVuCgkJU3BlbGxJRCA9IF9SCgllbmQKCglpZiBTcGVsbElEIHRoZW4KCQlyZXR1cm4gc2VsZi5BdHRhY2tSZXNldFRhYmxlW215SGVyby5jaGFyTmFtZTpsb3dlcigpXSA9PSBTcGVsbElEIAoJZW5kCglyZXR1cm4gZmFsc2UKZW5kCgpmdW5jdGlvbiBTT1c6T25Qcm9jZXNzU3BlbGwodW5pdCwgc3BlbGwpCglpZiB1bml0LmlzTWUgYW5kIHNlbGY6SXNBdHRhY2soc3BlbGwubmFtZSkgdGhlbgoJCWlmIHNlbGYuZGVidWdkcHMgdGhlbgoJCQlEUFMgPSBEUFMgYW5kIERQUyBvciAwCgkJCXByaW50KCJEUFM6ICIuLigxMDAwLyhzZWxmOkdldFRpbWUoKS0gRFBTKSkuLiIgIi4uKDEwMDAvKHNlbGY6QW5pbWF0aW9uVGltZSgpKSkpCgkJCURQUyA9IHNlbGY6R2V0VGltZSgpCgkJZW5kCgkJaWYgbm90IHNlbGYuRGF0YVVwZGF0ZWQgYW5kIG5vdCBzcGVsbC5uYW1lOmxvd2VyKCk6ZmluZCgiY2FyZCIpIHRoZW4KCQkJc2VsZi5CYXNlQW5pbWF0aW9uVGltZSA9IDEgLyAoc3BlbGwuYW5pbWF0aW9uVGltZSAqIG15SGVyby5hdHRhY2tTcGVlZCkKCQkJc2VsZi5CYXNlV2luZHVwVGltZSA9IDEgLyAoc3BlbGwud2luZFVwVGltZSAqIG15SGVyby5hdHRhY2tTcGVlZCkKCQkJaWYgc2VsZi5kZWJ1ZyB0aGVuCgkJCQlwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+QmFzaWMgQXR0YWNrcyBkYXRhIHVwZGF0ZWQ6IDwvZm9udD4iKQoJCQkJcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPkJhc2VXaW5kdXBUaW1lOiAiLi5zZWxmLkJhc2VXaW5kdXBUaW1lLi4iPC9mb250PiIpCgkJCQlwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+QmFzZUFuaW1hdGlvblRpbWU6ICIuLnNlbGYuQmFzZUFuaW1hdGlvblRpbWUuLiI8L2ZvbnQ+IikKCQkJCXByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj5Qcm9qZWN0aWxlU3BlZWQ6ICIuLnNlbGYuUHJvamVjdGlsZVNwZWVkLi4iPC9mb250PiIpCgkJCWVuZAoJCQlzZWxmLkRhdGFVcGRhdGVkID0gdHJ1ZQoJCWVuZAoJCXNlbGYuTGFzdEF0dGFjayA9IHNlbGY6R2V0VGltZSgpIC0gc2VsZjpMYXRlbmN5KCkKCQlzZWxmLmNoZWNraW5nID0gdHJ1ZQoJCXNlbGYuTGFzdEF0dGFja0NhbmNlbGxlZCA9IGZhbHNlCgkJc2VsZjpPbkF0dGFjayhzcGVsbC50YXJnZXQpCgkJc2VsZi5jaGVja2NhbmNlbCA9IHNlbGY6R2V0VGltZSgpCgkJRGVsYXlBY3Rpb24oZnVuY3Rpb24odCkgc2VsZjpBZnRlckF0dGFjayh0KSBlbmQsIHNlbGY6V2luZFVwVGltZSgpIC0gc2VsZjpMYXRlbmN5KCksIHtzcGVsbC50YXJnZXR9KQoKCWVsc2VpZiB1bml0LmlzTWUgYW5kIHNlbGY6SXNBQVJlc2V0KHNwZWxsLm5hbWUpIHRoZW4KCQlEZWxheUFjdGlvbihmdW5jdGlvbigpIHNlbGY6cmVzZXRBQSgpIGVuZCwgMC4yNSkKCWVuZAplbmQKCmZ1bmN0aW9uIFNPVzpyZXNldEFBKCkKCXNlbGYuTGFzdEF0dGFjayA9IDAKZW5kCi0tVE9ETzogQ2hhbmdlIHRoaXMuCmZ1bmN0aW9uIFNPVzpCb251c0RhbWFnZShtaW5pb24pCglsb2NhbCBBRCA9IG15SGVybzpDYWxjRGFtYWdlKG1pbmlvbiwgbXlIZXJvLnRvdGFsRGFtYWdlKQoJbG9jYWwgQk9OVVMgPSAwCglpZiBteUhlcm8uY2hhck5hbWUgPT0gJ1ZheW5lJyB0aGVuCgkJaWYgbXlIZXJvOkdldFNwZWxsRGF0YShfUSkubGV2ZWwgPiAwIGFuZCBteUhlcm86Q2FuVXNlU3BlbGwoX1EpID09IFNVUFJFU1NFRCB0aGVuCgkJCUJPTlVTID0gQk9OVVMgKyBteUhlcm86Q2FsY0RhbWFnZShtaW5pb24sICgoMC4wNSAqIG15SGVybzpHZXRTcGVsbERhdGEoX1EpLmxldmVsKSArIDAuMjUgKSAqIG15SGVyby50b3RhbERhbWFnZSkKCQllbmQKCQlpZiBub3QgVmF5bmVDQkFkZGVkIHRoZW4KCQkJVmF5bmVDQkFkZGVkID0gdHJ1ZQoJCQlmdW5jdGlvbiBWYXluZVBhcnRpY2xlKG9iaikKCQkJCWlmIEdldERpc3RhbmNlKG9iaikgPCAxMDAwIGFuZCBvYmoubmFtZTpsb3dlcigpOmZpbmQoInZheW5lX3dfcmluZzIudHJveSIpIHRoZW4KCQkJCQlWYXluZVdQYXJ0aWNsZSA9IG9iagoJCQkJZW5kCgkJCWVuZAoJCQlBZGRDcmVhdGVPYmpDYWxsYmFjayhWYXluZVBhcnRpY2xlKQoJCWVuZAoJCWlmIFZheW5lV1BhcnRpY2xlIGFuZCBWYXluZVdQYXJ0aWNsZS52YWxpZCBhbmQgR2V0RGlzdGFuY2UoVmF5bmVXUGFydGljbGUsIG1pbmlvbikgPCAxMCB0aGVuCgkJCUJPTlVTID0gQk9OVVMgKyAxMCArIDEwICogbXlIZXJvOkdldFNwZWxsRGF0YShfVykubGV2ZWwgKyAoMC4wMyArICgwLjAxICogbXlIZXJvOkdldFNwZWxsRGF0YShfVykubGV2ZWwpKSAqIG1pbmlvbi5tYXhIZWFsdGgKCQllbmQKCWVsc2VpZiBteUhlcm8uY2hhck5hbWUgPT0gJ1RlZW1vJyBhbmQgbXlIZXJvOkdldFNwZWxsRGF0YShfRSkubGV2ZWwgPiAwIHRoZW4KCQlCT05VUyA9IEJPTlVTICsgbXlIZXJvOkNhbGNNYWdpY0RhbWFnZShtaW5pb24sIChteUhlcm86R2V0U3BlbGxEYXRhKF9FKS5sZXZlbCAqIDEwKSArIChteUhlcm8uYXAgKiAwLjMpICkKCWVsc2VpZiBteUhlcm8uY2hhck5hbWUgPT0gJ0NvcmtpJyB0aGVuCgkJQk9OVVMgPSBCT05VUyArIG15SGVyby50b3RhbERhbWFnZS8xMAoJZWxzZWlmIG15SGVyby5jaGFyTmFtZSA9PSAnTWlzc0ZvcnR1bmUnIGFuZCBteUhlcm86R2V0U3BlbGxEYXRhKF9XKS5sZXZlbCA+IDAgdGhlbgoJCUJPTlVTID0gQk9OVVMgKyBteUhlcm86Q2FsY01hZ2ljRGFtYWdlKG1pbmlvbiwgKDQgKyAyICogbXlIZXJvOkdldFNwZWxsRGF0YShfVykubGV2ZWwpICsgKG15SGVyby5hcC8yMCkpCgllbHNlaWYgbXlIZXJvLmNoYXJOYW1lID09ICdWYXJ1cycgYW5kIG15SGVybzpHZXRTcGVsbERhdGEoX1cpLmxldmVsID4gMCB0aGVuCgkJQk9OVVMgPSBCT05VUyArICg2ICsgKG15SGVybzpHZXRTcGVsbERhdGEoX1cpLmxldmVsICogNCkgKyAobXlIZXJvLmFwICogMC4yNSkpCgllbHNlaWYgbXlIZXJvLmNoYXJOYW1lID09ICdDYWl0bHluJyB0aGVuCgkJCWlmIG5vdCBDYWxsYmFja0NhaXRseW5BZGRlZCB0aGVuCgkJCQlmdW5jdGlvbiBDYWl0bHluUGFydGljbGUob2JqKQoJCQkJCWlmIEdldERpc3RhbmNlKG9iaikgPCAxMDAgYW5kIG9iai5uYW1lOmxvd2VyKCk6ZmluZCgiY2FpdGx5bl9oZWFkc2hvdF9yZHkiKSB0aGVuCgkJCQkJCQlIZWFkU2hvdFBhcnRpY2xlID0gb2JqCgkJCQkJZW5kCgkJCQllbmQKCQkJCUFkZENyZWF0ZU9iakNhbGxiYWNrKENhaXRseW5QYXJ0aWNsZSkKCQkJCUNhbGxiYWNrQ2FpdGx5bkFkZGVkID0gdHJ1ZQoJCQllbmQKCQkJaWYgSGVhZFNob3RQYXJ0aWNsZSBhbmQgSGVhZFNob3RQYXJ0aWNsZS52YWxpZCB0aGVuCgkJCQlCT05VUyA9IEJPTlVTICsgQUQgKiAxLjUKCQkJZW5kCgllbHNlaWYgbXlIZXJvLmNoYXJOYW1lID09ICdPcmlhbm5hJyB0aGVuCgkJQk9OVVMgPSBCT05VUyArIG15SGVybzpDYWxjTWFnaWNEYW1hZ2UobWluaW9uLCAxMCArIDggKiAoKG15SGVyby5sZXZlbCAtIDEpICUgMykpCgllbHNlaWYgbXlIZXJvLmNoYXJOYW1lID09ICdUd2lzdGVkRmF0ZScgdGhlbgoJCQlpZiBub3QgVEZDYWxsYmFja0FkZGVkIHRoZW4KCQkJCWZ1bmN0aW9uIFRGUGFydGljbGUob2JqKQoJCQkJCWlmIEdldERpc3RhbmNlKG9iaikgPCAxMDAgYW5kIG9iai5uYW1lOmxvd2VyKCk6ZmluZCgiY2FyZG1hc3Rlcl9zdGFja3JlYWR5LnRyb3kiKSB0aGVuCgkJCQkJCVRGRVBhcnRpY2xlID0gb2JqCgkJCQkJZWxzZWlmIEdldERpc3RhbmNlKG9iaikgPCAxMDAgYW5kIG9iai5uYW1lOmxvd2VyKCk6ZmluZCgiY2FyZF9ibHVlLnRyb3kiKSB0aGVuCgkJCQkJCVRGV1BhcnRpY2xlID0gb2JqCgkJCQkJZW5kCgkJCQllbmQKCQkJCUFkZENyZWF0ZU9iakNhbGxiYWNrKFRGUGFydGljbGUpCgkJCQlURkNhbGxiYWNrQWRkZWQgPSB0cnVlCgkJCWVuZAoJCQlpZiBURkVQYXJ0aWNsZSBhbmQgVEZFUGFydGljbGUudmFsaWQgdGhlbgoJCQkJQk9OVVMgPSBCT05VUyArIG15SGVybzpDYWxjTWFnaWNEYW1hZ2UobWluaW9uLCBteUhlcm86R2V0U3BlbGxEYXRhKF9FKS5sZXZlbCAqIDE1ICsgNDAgKyAwLjUgKiBteUhlcm8uYXApICAKCQkJZW5kCgkJCWlmIFRGV1BhcnRpY2xlIGFuZCBURldQYXJ0aWNsZS52YWxpZCB0aGVuCgkJCQlCT05VUyA9IEJPTlVTICsgbWF0aC5tYXgobXlIZXJvOkNhbGNNYWdpY0RhbWFnZShtaW5pb24sIG15SGVybzpHZXRTcGVsbERhdGEoX1cpLmxldmVsICogMjAgKyAyMCArIDAuNSAqIG15SGVyby5hcCkgLSA0MCwgMCkgCgkJCWVuZAoJZWxzZWlmIG15SGVyby5jaGFyTmFtZSA9PSAnRHJhdmVuJyB0aGVuCgkJCWlmIG5vdCBDYWxsYmFja0RyYXZlbkFkZGVkIHRoZW4KCQkJCWZ1bmN0aW9uIERyYXZlblBhcnRpY2xlKG9iaikKCQkJCQlpZiBHZXREaXN0YW5jZShvYmopIDwgMTAwIGFuZCBvYmoubmFtZTpsb3dlcigpOmZpbmQoImRyYXZlbl9xX2J1ZiIpIHRoZW4KCQkJCQkJCURyYXZlblBhcnRpY2xlbyA9IG9iagoJCQkJCWVuZAoJCQkJZW5kCgkJCQlBZGRDcmVhdGVPYmpDYWxsYmFjayhEcmF2ZW5QYXJ0aWNsZSkKCQkJCUNhbGxiYWNrRHJhdmVuQWRkZWQgPSB0cnVlCgkJCWVuZAoJCQlpZiBEcmF2ZW5QYXJ0aWNsZW8gYW5kIERyYXZlblBhcnRpY2xlby52YWxpZCB0aGVuCgkJCQlCT05VUyA9IEJPTlVTICsgQUQgKiAoMC4zICsgKDAuMTAgKiBteUhlcm86R2V0U3BlbGxEYXRhKF9RKS5sZXZlbCkpCgkJCWVuZAoJZWxzZWlmIG15SGVyby5jaGFyTmFtZSA9PSAnTmFzdXMnIGFuZCBWSVBfVVNFUiB0aGVuCgkJaWYgbXlIZXJvOkdldFNwZWxsRGF0YShfUSkubGV2ZWwgPiAwIGFuZCBteUhlcm86Q2FuVXNlU3BlbGwoX1EpID09IFNVUFJFU1NFRCB0aGVuCgkJCWxvY2FsIFFkYW1hZ2UgPSB7MzAsIDUwLCA3MCwgOTAsIDExMH0KCQkJTmFzdXNRU3RhY2tzID0gTmFzdXNRU3RhY2tzIG9yIDAKCQkJQk9OVVMgPSBCT05VUyArIG15SGVybzpDYWxjRGFtYWdlKG1pbmlvbiwgMTAgKyAyMCAqIChteUhlcm86R2V0U3BlbGxEYXRhKF9RKS5sZXZlbCkgKyBOYXN1c1FTdGFja3MpCgkJCWlmIG5vdCBSZWN2UGFja2V0TmFzdXNBZGRlZCB0aGVuCgkJCQlmdW5jdGlvbiBOYXN1c09uUmVjdlBhY2tldChwKQoJCQkJCWlmIHAuaGVhZGVyID09IDB4RkUgYW5kIHAuc2l6ZSA9PSAweEMgdGhlbgoJCQkJCQlwLnBvcyA9IDEKCQkJCQkJcE5ldHdvcmtJRCA9IHA6RGVjb2RlRigpCgkJCQkJCXVuazAxID0gcDpEZWNvZGUyKCkKCQkJCSAJCXVuazAyID0gcDpEZWNvZGUxKCkKCQkJCQkJc3RhY2sgPSBwOkRlY29kZTQoKQoJCQkJCQlpZiBwTmV0d29ya0lEID09IG15SGVyby5uZXR3b3JrSUQgdGhlbgoJCQkJCQkJTmFzdXNRU3RhY2tzID0gc3RhY2sKCQkJCQkJZW5kCgkJCQkJZW5kCgkJCQllbmQKCQkJCVJlY3ZQYWNrZXROYXN1c0FkZGVkID0gdHJ1ZQoJCQkJQWRkUmVjdlBhY2tldENhbGxiYWNrKE5hc3VzT25SZWN2UGFja2V0KQoJCQllbmQKCQllbmQKCWVsc2VpZiBteUhlcm8uY2hhck5hbWUgPT0gIlppZ2dzIiB0aGVuCgkJaWYgbm90IENhbGxiYWNrWmlnZ3NBZGRlZCB0aGVuCgkJCWZ1bmN0aW9uIFppZ2dzUGFydGljbGUob2JqKQoJCQkJaWYgR2V0RGlzdGFuY2Uob2JqKSA8IDEwMCBhbmQgb2JqLm5hbWU6bG93ZXIoKTpmaW5kKCJ6aWdnc3Bhc3NpdmUiKSB0aGVuCgkJCQkJCVppZ2dzUGFydGljbGVPYmogPSBvYmoKCQkJCWVuZAoJCQllbmQKCQkJQWRkQ3JlYXRlT2JqQ2FsbGJhY2soWmlnZ3NQYXJ0aWNsZSkKCQkJQ2FsbGJhY2taaWdnc0FkZGVkID0gdHJ1ZQoJCWVuZAoJCWlmIFppZ2dzUGFydGljbGVPYmogYW5kIFppZ2dzUGFydGljbGVPYmoudmFsaWQgdGhlbgoJCQlsb2NhbCBiYXNlID0gezIwLCAyNCwgMjgsIDMyLCAzNiwgNDAsIDQ4LCA1NiwgNjQsIDcyLCA4MCwgODgsIDEwMCwgMTEyLCAxMjQsIDEzNiwgMTQ4LCAxNjB9CgkJCUJPTlVTID0gQk9OVVMgKyBteUhlcm86Q2FsY01hZ2ljRGFtYWdlKG1pbmlvbiwgYmFzZVtteUhlcm8ubGV2ZWxdICsgKDAuMjUgKyAwLjA1ICogKG15SGVyby5sZXZlbCAlIDcpKSAqIG15SGVyby5hcCkgIAoJCWVuZAoJZW5kCgoJcmV0dXJuIEJPTlVTCmVuZAoKZnVuY3Rpb24gU09XOktpbGxhYmxlTWluaW9uKCkKCWxvY2FsIHJlc3VsdAoJZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5FbmVteU1pbmlvbnMub2JqZWN0cykgZG8KCQlsb2NhbCB0aW1lID0gc2VsZjpXaW5kVXBUaW1lKHRydWUpICsgR2V0RGlzdGFuY2UobWluaW9uLnZpc2lvblBvcywgbXlIZXJvLnZpc2lvblBvcykgLyBzZWxmLlByb2plY3RpbGVTcGVlZCAtIDAuMDcKCQlsb2NhbCBQcmVkaWN0ZWRIZWFsdGggPSBzZWxmLlZQOkdldFByZWRpY3RlZEhlYWx0aChtaW5pb24sIHRpbWUsIEdldFNhdmUoIlNPVyIpLkZhcm1EZWxheSAvIDEwMDApCgkJaWYgc2VsZjpWYWxpZFRhcmdldChtaW5pb24pIGFuZCBQcmVkaWN0ZWRIZWFsdGggPCBzZWxmLlZQOkNhbGNEYW1hZ2VPZkF0dGFjayhteUhlcm8sIG1pbmlvbiwge25hbWUgPSAiQmFzaWMifSwgMCkgKyBzZWxmOkJvbnVzRGFtYWdlKG1pbmlvbikgYW5kIFByZWRpY3RlZEhlYWx0aCA+IC00MCB0aGVuCgkJCXJlc3VsdCA9IG1pbmlvbgoJCQlicmVhawoJCWVuZAoJZW5kCglyZXR1cm4gcmVzdWx0CmVuZAoKZnVuY3Rpb24gU09XOlNob3VsZFdhaXQoKQoJZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5FbmVteU1pbmlvbnMub2JqZWN0cykgZG8KCQlsb2NhbCB0aW1lID0gc2VsZjpBbmltYXRpb25UaW1lKCkgKyBHZXREaXN0YW5jZShtaW5pb24udmlzaW9uUG9zLCBteUhlcm8udmlzaW9uUG9zKSAvIHNlbGYuUHJvamVjdGlsZVNwZWVkIC0gMC4wNwoJCWlmIHNlbGY6VmFsaWRUYXJnZXQobWluaW9uKSBhbmQgc2VsZi5WUDpHZXRQcmVkaWN0ZWRIZWFsdGgyKG1pbmlvbiwgdGltZSAqIDIpIDwgKHNlbGYuVlA6Q2FsY0RhbWFnZU9mQXR0YWNrKG15SGVybywgbWluaW9uLCB7bmFtZSA9ICJCYXNpYyJ9LCAwKSArIHNlbGY6Qm9udXNEYW1hZ2UobWluaW9uKSkgdGhlbgoJCQlyZXR1cm4gdHJ1ZQoJCWVuZAoJZW5kCmVuZAoKZnVuY3Rpb24gU09XOlZhbGlkU3R1ZmYoKQoJbG9jYWwgcmVzdWx0ID0gc2VsZjpHZXRUYXJnZXQoKQoKCWlmIHJlc3VsdCB0aGVuIAoJCXJldHVybiByZXN1bHQKCWVuZAoKCWZvciBpLCBtaW5pb24gaW4gaXBhaXJzKHNlbGYuRW5lbXlNaW5pb25zLm9iamVjdHMpIGRvCgkJbG9jYWwgdGltZSA9IHNlbGY6QW5pbWF0aW9uVGltZSgpICsgR2V0RGlzdGFuY2UobWluaW9uLnZpc2lvblBvcywgbXlIZXJvLnZpc2lvblBvcykgLyBzZWxmLlByb2plY3RpbGVTcGVlZCAtIDAuMDcKCQlsb2NhbCBwZGFtYWdlMiA9IG1pbmlvbi5oZWFsdGggLSBzZWxmLlZQOkdldFByZWRpY3RlZEhlYWx0aChtaW5pb24sIHRpbWUsIEdldFNhdmUoIlNPVyIpLkZhcm1EZWxheSAvIDEwMDApCgkJbG9jYWwgcGRhbWFnZSA9IHNlbGYuVlA6R2V0UHJlZGljdGVkSGVhbHRoMihtaW5pb24sIHRpbWUgKiAyKQoJCWlmIHNlbGY6VmFsaWRUYXJnZXQobWluaW9uKSBhbmQgKChwZGFtYWdlKSA+IDIqc2VsZi5WUDpDYWxjRGFtYWdlT2ZBdHRhY2sobXlIZXJvLCBtaW5pb24sIHtuYW1lID0gIkJhc2ljIn0sIDApICsgc2VsZjpCb251c0RhbWFnZShtaW5pb24pIG9yIHBkYW1hZ2UyID09IDApIHRoZW4KCQkJcmV0dXJuIG1pbmlvbgoJCWVuZAoJZW5kCgoJZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5KdW5nbGVNaW5pb25zLm9iamVjdHMpIGRvCgkJaWYgc2VsZjpWYWxpZFRhcmdldChtaW5pb24pIHRoZW4KCQkJcmV0dXJuIG1pbmlvbgoJCWVuZAoJZW5kCgoJZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5PdGhlck1pbmlvbnMub2JqZWN0cykgZG8KCQlpZiBzZWxmOlZhbGlkVGFyZ2V0KG1pbmlvbikgdGhlbgoJCQlyZXR1cm4gbWluaW9uCgkJZW5kCgllbmQKZW5kCgpmdW5jdGlvbiBTT1c6R2V0VGFyZ2V0KE9ubHlDaGFtcGlvbnMpCglsb2NhbCByZXN1bHQKCWxvY2FsIGhlYWx0aFJhdGlvCgoJaWYgc2VsZjpWYWxpZFRhcmdldChzZWxmLmZvcmNldGFyZ2V0KSB0aGVuCgkJcmV0dXJuIHNlbGYuZm9yY2V0YXJnZXQKCWVsc2VpZiBzZWxmLmZvcmNldGFyZ2V0IH49IG5pbCB0aGVuCgkJcmV0dXJuIG5pbAoJZW5kCgoJaWYgKG5vdCBzZWxmLlNUUyBvciBub3QgT25seUNoYW1waW9ucykgYW5kIHNlbGY6VmFsaWRUYXJnZXQoR2V0VGFyZ2V0KCkpIGFuZCAoR2V0VGFyZ2V0KCkudHlwZSA9PSBteUhlcm8udHlwZSBvciAobm90IE9ubHlDaGFtcGlvbnMpKSB0aGVuCgkJcmV0dXJuIEdldFRhcmdldCgpCgllbmQKCglpZiBzZWxmLlNUUyB0aGVuCgkJbG9jYWwgb2xkaGl0Ym94bW9kZSA9IHNlbGYuU1RTLmhpdGJveG1vZGUKCQlzZWxmLlNUUy5oaXRib3htb2RlID0gdHJ1ZQoKCQlyZXN1bHQgPSBzZWxmLlNUUzpHZXRUYXJnZXQobXlIZXJvLnJhbmdlKQoKCQlzZWxmLlNUUy5oaXRib3htb2RlID0gb2xkaGl0Ym94bW9kZQoJCXJldHVybiByZXN1bHQKCWVuZAoKCWZvciBpLCBjaGFtcGlvbiBpbiBpcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8KCQlsb2NhbCBociA9IGNoYW1waW9uLmhlYWx0aCAvIG15SGVybzpDYWxjRGFtYWdlKGNoYW1waW9uLCAyMDApCgkJaWYgc2VsZjpWYWxpZFRhcmdldChjaGFtcGlvbikgYW5kICgoaGVhbHRoUmF0aW8gPT0gbmlsKSBvciBociA8IGhlYWx0aFJhdGlvKSB0aGVuCgkJCXJlc3VsdCA9IGNoYW1waW9uCgkJCWhlYWx0aFJhdGlvID0gaHIKCQllbmQKCWVuZAoKCXJldHVybiByZXN1bHQKZW5kCgpmdW5jdGlvbiBTT1c6RmFybShtb2RlLCBwb2ludCkKCWlmIG1vZGUgPT0gMSB0aGVuCgkJc2VsZi5FbmVteU1pbmlvbnM6dXBkYXRlKCkKCQlsb2NhbCB0YXJnZXQgPSBzZWxmOktpbGxhYmxlTWluaW9uKCkgb3Igc2VsZjpHZXRUYXJnZXQoKQoJCXNlbGY6T3JiV2Fsayh0YXJnZXQsIHBvaW50KQoJCXNlbGYubW9kZSA9IDEKCWVsc2VpZiBtb2RlID09IDIgdGhlbgoJCXNlbGYuRW5lbXlNaW5pb25zOnVwZGF0ZSgpCgkJc2VsZi5PdGhlck1pbmlvbnM6dXBkYXRlKCkKCQlzZWxmLkp1bmdsZU1pbmlvbnM6dXBkYXRlKCkKCgkJbG9jYWwgdGFyZ2V0ID0gc2VsZjpLaWxsYWJsZU1pbmlvbigpCgkJaWYgdGFyZ2V0IHRoZW4KCQkJc2VsZjpPcmJXYWxrKHRhcmdldCwgcG9pbnQpCgkJZWxzZWlmIG5vdCBzZWxmOlNob3VsZFdhaXQoKSB0aGVuCgoJCQlpZiBzZWxmOlZhbGlkVGFyZ2V0KHNlbGYubGFzdHRhcmdldCkgdGhlbgoJCQkJdGFyZ2V0ID0gc2VsZi5sYXN0dGFyZ2V0CgkJCWVsc2UKCQkJCXRhcmdldCA9IHNlbGY6VmFsaWRTdHVmZigpCgkJCWVuZAoJCQlzZWxmLmxhc3R0YXJnZXQgPSB0YXJnZXQKCQkJCgkJCXNlbGY6T3JiV2Fsayh0YXJnZXQsIHBvaW50KQoJCWVsc2UKCQkJc2VsZjpPcmJXYWxrKG5pbCwgcG9pbnQpCgkJZW5kCgkJc2VsZi5tb2RlID0gMgoJZWxzZWlmIG1vZGUgPT0gMyB0aGVuCgkJc2VsZi5FbmVteU1pbmlvbnM6dXBkYXRlKCkKCQlsb2NhbCB0YXJnZXQgPSBzZWxmOktpbGxhYmxlTWluaW9uKCkKCQlzZWxmOk9yYldhbGsodGFyZ2V0LCBwb2ludCkKCQlzZWxmLm1vZGUgPSAzCgllbmQKZW5kCgpmdW5jdGlvbiBTT1c6T25UaWNrKCkKCWlmIG5vdCBzZWxmLk1lbnUuRW5hYmxlZCB0aGVuIHJldHVybiBlbmQKCWlmIHNlbGYuTWVudS5Nb2RlMCB0aGVuCgkJbG9jYWwgdGFyZ2V0ID0gc2VsZjpHZXRUYXJnZXQodHJ1ZSkKCQlpZiBzZWxmLk1lbnUuQXR0YWNrID09IDIgdGhlbgoJCQlzZWxmOk9yYldhbGsodGFyZ2V0KQoJCWVsc2UKCQkJc2VsZjpPcmJXYWxrKCkKCQllbmQKCQlzZWxmLm1vZGUgPSAwCgllbHNlaWYgc2VsZi5NZW51Lk1vZGUxIHRoZW4KCQlzZWxmOkZhcm0oMSkKCWVsc2VpZiBzZWxmLk1lbnUuTW9kZTIgdGhlbgoJCXNlbGY6RmFybSgyKQoJZWxzZWlmIHNlbGYuTWVudS5Nb2RlMyB0aGVuCgkJc2VsZjpGYXJtKDMpCgllbHNlCgkJc2VsZi5tb2RlID0gLTEKCWVuZAplbmQKCmZ1bmN0aW9uIFNPVzpEcmF3QUFSYW5nZSh3aWR0aCwgY29sb3IpCglsb2NhbCBwID0gV29ybGRUb1NjcmVlbihEM0RYVkVDVE9SMyhteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56KSkKCWlmIE9uU2NyZWVuKHAueCwgcC55KSB0aGVuCgkJRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIHNlbGY6TXlSYW5nZSgpICsgMjUsIHdpZHRoIG9yIDEsIGNvbG9yIG9yIEFSR0IoMjU1LCAyNTUsIDAsIDApKQoJZW5kCmVuZAo="
StoredVPred = "bG9jYWwgdmVyc2lvbiA9ICIyLjUxIgpsb2NhbCBURVNUVkVSU0lPTiA9IGZhbHNlCmxvY2FsIEFVVE9VUERBVEUgPSBmYWxzZQpsb2NhbCBVUERBVEVfSE9TVCA9ICJyYXcuZ2l0aHViLmNvbSIKbG9jYWwgVVBEQVRFX1BBVEggPSAiL2hvbmRhNy9Cb0wvbWFzdGVyL0NvbW1vbi9WUHJlZGljdGlvbi5sdWEiLi4iP3JhbmQ9Ii4ubWF0aC5yYW5kb20oMSwxMDAwMCkKbG9jYWwgVVBEQVRFX0ZJTEVfUEFUSCA9IExJQl9QQVRILi4idlByZWRpY3Rpb24ubHVhIgpsb2NhbCBVUERBVEVfVVJMID0gImh0dHBzOi8vIi4uVVBEQVRFX0hPU1QuLlVQREFURV9QQVRICgpmdW5jdGlvbiBBdXRvdXBkYXRlck1zZyhtc2cpIHByaW50KCI8Zm9udCBjb2xvcj1cIiM2Njk5ZmZcIj48Yj5WUHJlZGljdGlvbjo8L2I+PC9mb250PiA8Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4iLi5tc2cuLiIuPC9mb250PiIpIGVuZAppZiBBVVRPVVBEQVRFIHRoZW4KCWxvY2FsIFNlcnZlckRhdGEgPSBHZXRXZWJSZXN1bHQoVVBEQVRFX0hPU1QsICIvaG9uZGE3L0JvTC9tYXN0ZXIvVmVyc2lvbkZpbGVzL3ZQcmVkaWN0aW9uLnZlcnNpb24iKQoJaWYgU2VydmVyRGF0YSB0aGVuCgkJU2VydmVyVmVyc2lvbiA9IHR5cGUodG9udW1iZXIoU2VydmVyRGF0YSkpID09ICJudW1iZXIiIGFuZCB0b251bWJlcihTZXJ2ZXJEYXRhKSBvciBuaWwKCQlpZiBTZXJ2ZXJWZXJzaW9uIHRoZW4KCQkJaWYgdG9udW1iZXIodmVyc2lvbikgPCBTZXJ2ZXJWZXJzaW9uIHRoZW4KCQkJCUF1dG91cGRhdGVyTXNnKCJOZXcgdmVyc2lvbiBhdmFpbGFibGUiLi5TZXJ2ZXJWZXJzaW9uKQoJCQkJQXV0b3VwZGF0ZXJNc2coIlVwZGF0aW5nLCBwbGVhc2UgZG9uJ3QgcHJlc3MgRjkiKQoJCQkJRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBEb3dubG9hZEZpbGUoVVBEQVRFX1VSTCwgVVBEQVRFX0ZJTEVfUEFUSCwgZnVuY3Rpb24gKCkgQXV0b3VwZGF0ZXJNc2coIlN1Y2Nlc3NmdWxseSB1cGRhdGVkLiAoIi4udmVyc2lvbi4uIiA9PiAiLi5TZXJ2ZXJWZXJzaW9uLi4iKSwgcHJlc3MgRjkgdHdpY2UgdG8gbG9hZCB0aGUgdXBkYXRlZCB2ZXJzaW9uLiIpIGVuZCkgZW5kLCAzKQoJCQllbHNlCgkJCQlBdXRvdXBkYXRlck1zZygiWW91IGhhdmUgZ290IHRoZSBsYXRlc3QgdmVyc2lvbiAoIi4uU2VydmVyVmVyc2lvbi4uIikiKQoJCQllbmQKCQllbmQKCWVsc2UKCQlBdXRvdXBkYXRlck1zZygiRXJyb3IgZG93bmxvYWRpbmcgdmVyc2lvbiBpbmZvIikKCWVuZAplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpsb2NhbCBfRkFTVCwgX01FRElVTSwgX1NMT1cgPSAxLCAyLCAzCmNsYXNzICdWUHJlZGljdGlvbicgLS17CmZ1bmN0aW9uIFZQcmVkaWN0aW9uOl9faW5pdCgpCglzZWxmLnZlcnNpb24gPSB0b251bWJlcih2ZXJzaW9uKQoJc2VsZi5zaG93ZGV2bW9kZSA9IGZhbHNlCglzZWxmLmhpdGJveGVzID0ge1snUmVjSXRlbXNDTEFTU0lDJ10gPSA2NSwgWydUZWVtb011c2hyb29tJ10gPSA1MC4wLCBbJ1Rlc3RDdWJlUmVuZGVyJ10gPSA2NSwgWydYZXJhdGgnXSA9IDY1LCBbJ0thc3NhZGluJ10gPSA2NSwgWydSZW5nYXInXSA9IDY1LCBbJ1RocmVzaCddID0gNTUuMCwgWydSZWNJdGVtc1RVVE9SSUFMJ10gPSA2NSwgWydaaWdncyddID0gNTUuMCwgWydaeXJhUGFzc2l2ZSddID0gMjAuMCwgWydaeXJhVGhvcm5QbGFudCddID0gMjAuMCwgWydLb2dNYXcnXSA9IDY1LCBbJ0hlaW1lclRCbHVlJ10gPSAzNS4wLCBbJ0VsaXNlU3BpZGVyJ10gPSA2NSwgWydTa2FybmVyJ10gPSA4MC4wLCBbJ0NoYW9zTmV4dXMnXSA9IDY1LCBbJ0thdGFyaW5hJ10gPSA2NSwgWydSaXZlbiddID0gNjUsIFsnU2lnaHRXYXJkJ10gPSAxLCBbJ0hlaW1lclRZZWxsb3cnXSA9IDM1LjAsIFsnQXNoZSddID0gNjUsIFsnVmlzaW9uV2FyZCddID0gMSwgWydUVF9OR29sZW0yJ10gPSA4MC4wLCBbJ1RocmVzaExhbnRlcm4nXSA9IDY1LCBbJ1JlY0l0ZW1zQ0xBU1NJQ01hcDEwJ10gPSA2NSwgWydSZWNJdGVtc09ESU4nXSA9IDY1LCBbJ1RUX1NwaWRlcmJvc3MnXSA9IDIwMC4wLCBbJ1JlY0l0ZW1zQVJBTSddID0gNjUsIFsnT3JkZXJOZXh1cyddID0gNjUsIFsnU29yYWthJ10gPSA2NSwgWydKaW54J10gPSA2NSwgWydUZXN0Q3ViZVJlbmRlcndDb2xsaXNpb24nXSA9IDY1LCBbJ1JlZF9NaW5pb25fV2l6YXJkJ10gPSA0OC4wLCBbJ0phcnZhbklWJ10gPSA2NSwgWydCbHVlX01pbmlvbl9XaXphcmQnXSA9IDQ4LjAsIFsnVFRfQ2hhb3NUdXJyZXQyJ10gPSA4OC40LCBbJ1RUX0NoYW9zVHVycmV0MyddID0gODguNCwgWydUVF9DaGFvc1R1cnJldDEnXSA9IDg4LjQsIFsnQ2hhb3NUdXJyZXRHaWFudCddID0gODguNCwgWydEcmFnb24nXSA9IDEwMC4wLCBbJ0x1bHVTbm93bWFuJ10gPSA1MC4wLCBbJ1dvcm0nXSA9IDEwMC4wLCBbJ0NoYW9zVHVycmV0V29ybSddID0gODguNCwgWydUVF9DaGFvc0luaGliaXRvciddID0gNjUsIFsnQ2hhb3NUdXJyZXROb3JtYWwnXSA9IDg4LjQsIFsnQW5jaWVudEdvbGVtJ10gPSAxMDAuMCwgWydaeXJhR3Jhc3BpbmdQbGFudCddID0gMjAuMCwgWydIQV9BUF9PcmRlclR1cnJldDMnXSA9IDg4LjQsIFsnSEFfQVBfT3JkZXJUdXJyZXQyJ10gPSA4OC40LCBbJ1RyeW5kYW1lcmUnXSA9IDY1LCBbJ09yZGVyVHVycmV0Tm9ybWFsMiddID0gODguNCwgWydTaW5nZWQnXSA9IDY1LCBbJ09yZGVySW5oaWJpdG9yJ10gPSA2NSwgWydEaWFuYSddID0gNjUsIFsnSEFfRkJfSGVhbHRoUmVsaWMnXSA9IDY1LCBbJ1RUX09yZGVySW5oaWJpdG9yJ10gPSA2NSwgWydHcmVhdFdyYWl0aCddID0gODAuMCwgWydZYXN1byddID0gNjUsIFsnT3JkZXJUdXJyZXREcmFnb24nXSA9IDg4LjQsIFsnT3JkZXJUdXJyZXROb3JtYWwnXSA9IDg4LjQsIFsnTGl6YXJkRWxkZXInXSA9IDY1LjAsIFsnSEFfQVBfQ2hhb3NUdXJyZXQnXSA9IDg4LjQsIFsnQWhyaSddID0gNjUsIFsnTHVsdSddID0gNjUsIFsnQ2hhb3NJbmhpYml0b3InXSA9IDY1LCBbJ0hBX0FQX0NoYW9zVHVycmV0MyddID0gODguNCwgWydIQV9BUF9DaGFvc1R1cnJldDInXSA9IDg4LjQsIFsnQ2hhb3NUdXJyZXRXb3JtMiddID0gODguNCwgWydUVF9PcmRlclR1cnJldDEnXSA9IDg4LjQsIFsnVFRfT3JkZXJUdXJyZXQyJ10gPSA4OC40LCBbJ1RUX09yZGVyVHVycmV0MyddID0gODguNCwgWydMdWx1RmFlcmllJ10gPSA2NSwgWydIQV9BUF9PcmRlclR1cnJldCddID0gODguNCwgWydPcmRlclR1cnJldEFuZ2VsJ10gPSA4OC40LCBbJ1llbGxvd1RyaW5rZXRVcGdyYWRlJ10gPSAxLCBbJ01hc3RlcllpJ10gPSA2NSwgWydMaXNzYW5kcmEnXSA9IDY1LCBbJ0FSQU1PcmRlclR1cnJldE5leHVzJ10gPSA4OC40LCBbJ0RyYXZlbiddID0gNjUsIFsnRmlkZGxlU3RpY2tzJ10gPSA2NSwgWydTbWFsbEdvbGVtJ10gPSA4MC4wLCBbJ0FSQU1PcmRlclR1cnJldEZyb250J10gPSA4OC40LCBbJ0NoYW9zVHVycmV0VHV0b3JpYWwnXSA9IDg4LjQsIFsnTmFzdXNVbHQnXSA9IDgwLjAsIFsnTWFva2FpJ10gPSA4MC4wLCBbJ1dyYWl0aCddID0gNTAuMCwgWydXb2xmJ10gPSA1MC4wLCBbJ1NpdmlyJ10gPSA2NSwgWydDb3JraSddID0gNjUsIFsnSmFubmEnXSA9IDY1LCBbJ05hc3VzJ10gPSA4MC4wLCBbJ0dvbGVtJ10gPSA4MC4wLCBbJ0FSQU1DaGFvc1R1cnJldEZyb250J10gPSA4OC40LCBbJ0FSQU1PcmRlclR1cnJldEluaGliJ10gPSA4OC40LCBbJ0xlZVNpbiddID0gNjUsIFsnSEFfQVBfQ2hhb3NUdXJyZXRUdXRvcmlhbCddID0gODguNCwgWydHaWFudFdvbGYnXSA9IDY1LjAsIFsnSEFfQVBfT3JkZXJUdXJyZXRUdXRvcmlhbCddID0gODguNCwgWydZb3VuZ0xpemFyZCddID0gNTAuMCwgWydKYXgnXSA9IDY1LCBbJ0xlc3NlcldyYWl0aCddID0gNTAuMCwgWydCbGl0emNyYW5rJ10gPSA4MC4wLCBbJ2JydXNoX0RfU1InXSA9IDY1LCBbJ2JydXNoX0VfU1InXSA9IDY1LCBbJ2JydXNoX0ZfU1InXSA9IDY1LCBbJ2JydXNoX0NfU1InXSA9IDY1LCBbJ2JydXNoX0FfU1InXSA9IDY1LCBbJ2JydXNoX0JfU1InXSA9IDY1LCBbJ0FSQU1DaGFvc1R1cnJldEluaGliJ10gPSA4OC40LCBbJ1NoZW4nXSA9IDY1LCBbJ05vY3R1cm5lJ10gPSA2NSwgWydTb25hJ10gPSA2NSwgWydBUkFNQ2hhb3NUdXJyZXROZXh1cyddID0gODguNCwgWydZZWxsb3dUcmlua2V0J10gPSAxLCBbJ09yZGVyVHVycmV0VHV0b3JpYWwnXSA9IDg4LjQsIFsnQ2FpdGx5biddID0gNjUsIFsnVHJ1bmRsZSddID0gNjUsIFsnTWFscGhpdGUnXSA9IDgwLjAsIFsnTW9yZGVrYWlzZXInXSA9IDgwLjAsIFsnWnlyYVNlZWQnXSA9IDY1LCBbJ1ZpJ10gPSA1MCwgWydUdXRvcmlhbF9SZWRfTWluaW9uX1dpemFyZCddID0gNDguMCwgWydSZW5la3RvbiddID0gODAuMCwgWydBbml2aWEnXSA9IDY1LCBbJ0ZpenonXSA9IDY1LCBbJ0hlaW1lcmRpbmdlciddID0gNTUuMCwgWydFdmVseW5uJ10gPSA2NSwgWydSdW1ibGUnXSA9IDgwLjAsIFsnTGVibGFuYyddID0gNjUsIFsnRGFyaXVzJ10gPSA4MC4wLCBbJ09sYWZBeGUnXSA9IDUwLjAsIFsnVmlrdG9yJ10gPSA2NSwgWydYaW5aaGFvJ10gPSA2NSwgWydPcmlhbm5hJ10gPSA2NSwgWydWbGFkaW1pciddID0gNjUsIFsnTmlkYWxlZSddID0gNjUsIFsnVHV0b3JpYWxfUmVkX01pbmlvbl9CYXNpYyddID0gNDguMCwgWydaZWRTaGFkb3cnXSA9IDY1LCBbJ1N5bmRyYSddID0gNjUsIFsnWmFjJ10gPSA4MC4wLCBbJ09sYWYnXSA9IDY1LCBbJ1ZlaWdhciddID0gNTUuMCwgWydUd2l0Y2gnXSA9IDY1LCBbJ0FsaXN0YXInXSA9IDgwLjAsIFsnQWthbGknXSA9IDY1LCBbJ1VyZ290J10gPSA4MC4wLCBbJ0xlb25hJ10gPSA2NSwgWydUYWxvbiddID0gNjUsIFsnS2FybWEnXSA9IDY1LCBbJ0pheWNlJ10gPSA2NSwgWydHYWxpbyddID0gODAuMCwgWydTaGFjbyddID0gNjUsIFsnVGFyaWMnXSA9IDY1LCBbJ1R3aXN0ZWRGYXRlJ10gPSA2NSwgWydWYXJ1cyddID0gNjUsIFsnR2FyZW4nXSA9IDY1LCBbJ1N3YWluJ10gPSA2NSwgWydWYXluZSddID0gNjUsIFsnRmlvcmEnXSA9IDY1LCBbJ1F1aW5uJ10gPSA2NSwgWydLYXlsZSddID0gNjUsIFsnQmx1ZV9NaW5pb25fQmFzaWMnXSA9IDQ4LjAsIFsnQnJhbmQnXSA9IDY1LCBbJ1RlZW1vJ10gPSA1NS4wLCBbJ0FtdW11J10gPSA1NS4wLCBbJ0FubmllJ10gPSA1NS4wLCBbJ09kaW5fQmx1ZV9NaW5pb25fY2FzdGVyJ10gPSA0OC4wLCBbJ0VsaXNlJ10gPSA2NSwgWydOYW1pJ10gPSA2NSwgWydQb3BweSddID0gNTUuMCwgWydBbml2aWFFZ2cnXSA9IDY1LCBbJ1RyaXN0YW5hJ10gPSA1NS4wLCBbJ0dyYXZlcyddID0gNjUsIFsnTW9yZ2FuYSddID0gNjUsIFsnR3JhZ2FzJ10gPSA4MC4wLCBbJ01pc3NGb3J0dW5lJ10gPSA2NSwgWydXYXJ3aWNrJ10gPSA2NSwgWydDYXNzaW9wZWlhJ10gPSA2NSwgWydUdXRvcmlhbF9CbHVlX01pbmlvbl9XaXphcmQnXSA9IDQ4LjAsIFsnRHJNdW5kbyddID0gODAuMCwgWydWb2xpYmVhciddID0gODAuMCwgWydJcmVsaWEnXSA9IDY1LCBbJ09kaW5fUmVkX01pbmlvbl9DYXN0ZXInXSA9IDQ4LjAsIFsnTHVjaWFuJ10gPSA2NSwgWydZb3JpY2snXSA9IDgwLjAsIFsnUmFtbXVzUEInXSA9IDY1LCBbJ1JlZF9NaW5pb25fQmFzaWMnXSA9IDQ4LjAsIFsnVWR5ciddID0gNjUsIFsnTW9ua2V5S2luZyddID0gNjUsIFsnVHV0b3JpYWxfQmx1ZV9NaW5pb25fQmFzaWMnXSA9IDQ4LjAsIFsnS2VubmVuJ10gPSA1NS4wLCBbJ051bnUnXSA9IDY1LCBbJ1J5emUnXSA9IDY1LCBbJ1plZCddID0gNjUsIFsnTmF1dGlsdXMnXSA9IDgwLjAsIFsnR2FuZ3BsYW5rJ10gPSA2NSwgWydzaG9wZXZvJ10gPSA2NSwgWydMdXgnXSA9IDY1LCBbJ1NlanVhbmknXSA9IDgwLjAsIFsnRXpyZWFsJ10gPSA2NSwgWydPZGluTmV1dHJhbEd1YXJkaWFuJ10gPSA2NSwgWydLaGF6aXgnXSA9IDY1LCBbJ1Npb24nXSA9IDgwLjAsIFsnQWF0cm94J10gPSA2NSwgWydIZWNhcmltJ10gPSA4MC4wLCBbJ1BhbnRoZW9uJ10gPSA2NSwgWydTaHl2YW5hJ10gPSA1MC4wLCBbJ1p5cmEnXSA9IDY1LCBbJ0thcnRodXMnXSA9IDY1LCBbJ1JhbW11cyddID0gNjUsIFsnWmlsZWFuJ10gPSA2NSwgWydDaG9nYXRoJ10gPSA4MC4wLCBbJ01hbHphaGFyJ10gPSA2NSwgWydZb3JpY2tSYXZlbm91c0dob3VsJ10gPSAxLjAsIFsnWW9yaWNrU3BlY3RyYWxHaG91bCddID0gMS4wLCBbJ0ppbnhNaW5lJ10gPSA2NSwgWydZb3JpY2tEZWNheWVkR2hvdWwnXSA9IDEuMCwgWydYZXJhdGhBcmNhbmVCYXJyYWdlTGF1bmNoZXInXSA9IDY1LCBbJ09kaW5fU09HX09yZGVyX0NyeXN0YWwnXSA9IDY1LCBbJ1Rlc3RDdWJlJ10gPSA2NSwgWydTaHl2YW5hRHJhZ29uJ10gPSA4MC4wLCBbJ0ZpenpCYWl0J10gPSA2NSwgWydTaG9wS2VlcGVyJ10gPSA2NSwgWydCbHVlX01pbmlvbl9NZWNoTWVsZWUnXSA9IDY1LjAsIFsnT2RpblF1ZXN0QnVmZiddID0gNjUsIFsnVFRfQnVmZnBsYXRfTCddID0gNjUsIFsnVFRfQnVmZnBsYXRfUiddID0gNjUsIFsnS29nTWF3RGVhZCddID0gNjUsIFsnVGVtcE1vdmFibGVDaGFyJ10gPSA0OC4wLCBbJ0xpemFyZCddID0gNTAuMCwgWydHb2xlbU9kaW4nXSA9IDgwLjAsIFsnT2Rpbk9wZW5pbmdCYXJyaWVyJ10gPSA2NSwgWydUVF9DaGFvc1R1cnJldDQnXSA9IDg4LjQsIFsnVFRfRmx5dHJhcF9BJ10gPSA2NSwgWydUVF9DaGFpbnNfT3JkZXJfUGVyaXBoJ10gPSA2NSwgWydUVF9OV29sZiddID0gNjUuMCwgWydTaG9wTWFsZSddID0gNjUsIFsnT2RpblNoaWVsZFJlbGljJ10gPSA2NSwgWydUVF9DaGFpbnNfWGFvc19CYXNlJ10gPSA2NSwgWydMdWx1U3F1aWxsJ10gPSA1MC4wLCBbJ1RUX1Nob3BrZWVwZXInXSA9IDY1LCBbJ3JlZERyYWdvbiddID0gMTAwLjAsIFsnTW9ua2V5S2luZ0Nsb25lJ10gPSA2NSwgWydPZGluX3NrZWxldG9uJ10gPSA2NSwgWydPZGluQ2hhb3NUdXJyZXRTaHJpbmUnXSA9IDg4LjQsIFsnQ2Fzc2lvcGVpYV9EZWF0aCddID0gNjUsIFsnT2RpbkNlbnRlclJlbGljJ10gPSA0OC4wLCBbJ0V6cmVhbF9jeWJlcl8xJ10gPSA2NSwgWydFenJlYWxfY3liZXJfMyddID0gNjUsIFsnRXpyZWFsX2N5YmVyXzInXSA9IDY1LCBbJ09kaW5SZWRTdXBlcm1pbmlvbiddID0gNTUuMCwgWydUVF9TcGVlZHNocmluZV9HZWFycyddID0gNjUsIFsnSmFydmFuSVZXYWxsJ10gPSA2NSwgWydEZXN0cm95ZWROZXh1cyddID0gNjUsIFsnQVJBTU9yZGVyTmV4dXMnXSA9IDY1LCBbJ1JlZF9NaW5pb25fTWVjaENhbm5vbiddID0gNjUuMCwgWydPZGluQmx1ZVN1cGVybWluaW9uJ10gPSA1NS4wLCBbJ1N5bmRyYU9yYnMnXSA9IDY1LCBbJ0x1bHVLaXR0eSddID0gNTAuMCwgWydTd2Fpbk5vQmlyZCddID0gNjUsIFsnTHVsdUxhZHlidWcnXSA9IDUwLjAsIFsnQ2FpdGx5blRyYXAnXSA9IDY1LCBbJ1RUX1Nocm9vbV9BJ10gPSA2NSwgWydBUkFNQ2hhb3NUdXJyZXRTaHJpbmUnXSA9IDg4LjQsIFsnT2Rpbl9XaW5kbWlsbF9Qcm9wZWxsZXJzJ10gPSA2NSwgWydEZXN0cm95ZWRJbmhpYml0b3InXSA9IDY1LCBbJ1RUX05Xb2xmMiddID0gNTAuMCwgWydPZGluTWluaW9uR3JhdmV5YXJkUG9ydGFsJ10gPSAxLjAsIFsnU3dhaW5CZWFtJ10gPSA2NSwgWydTdW1tb25lcl9SaWRlcl9PcmRlciddID0gNjUuMCwgWydUVF9SZWxpYyddID0gNjUsIFsnb2Rpbl9saWZ0c19jcnlzdGFsJ10gPSA2NSwgWydPZGluT3JkZXJUdXJyZXRTaHJpbmUnXSA9IDg4LjQsIFsnU3BlbGxCb29rMSddID0gNjUsIFsnQmx1ZV9NaW5pb25fTWVjaENhbm5vbiddID0gNjUuMCwgWydUVF9DaGFvc0luaGliaXRvcl9EJ10gPSA2NSwgWydPZGluX1NvR19DaGFvcyddID0gNjUsIFsnVHJ1bmRsZVdhbGwnXSA9IDY1LCBbJ0hBX0FQX0hlYWx0aFJlbGljJ10gPSA2NSwgWydPcmRlclR1cnJldFNocmluZSddID0gODguNCwgWydPcmlhbm5hQmFsbCddID0gNDguMCwgWydDaGFvc1R1cnJldFNocmluZSddID0gODguNCwgWydMdWx1Q3VwY2FrZSddID0gNTAuMCwgWydIQV9BUF9DaGFvc1R1cnJldFNocmluZSddID0gODguNCwgWydUVF9DaGFpbnNfQm90X0xhbmUnXSA9IDY1LCBbJ1RUX05XcmFpdGgyJ10gPSA1MC4wLCBbJ1RUX1RyZWVfQSddID0gNjUsIFsnU3VtbW9uZXJCZWFjb24nXSA9IDY1LCBbJ09kaW5fRHJpbGwnXSA9IDY1LCBbJ1RUX05Hb2xlbSddID0gODAuMCwgWydTaG9wJ10gPSA2NSwgWydBcmFtU3BlZWRTaHJpbmUnXSA9IDY1LCBbJ0Rlc3Ryb3llZFRvd2VyJ10gPSA2NSwgWydPcmlhbm5hTm9CYWxsJ10gPSA2NSwgWydPZGluX01pbmVjYXJ0J10gPSA2NSwgWydTdW1tb25lcl9SaWRlcl9DaGFvcyddID0gNjUuMCwgWydPZGluU3BlZWRTaHJpbmUnXSA9IDY1LCBbJ1RUX0JyYXppZXInXSA9IDY1LCBbJ1RUX1NwZWVkU2hyaW5lJ10gPSA2NSwgWydvZGluX2xpZnRzX2J1Y2tldHMnXSA9IDY1LCBbJ09kaW5Sb2NrU2F3J10gPSA2NSwgWydPZGluTWluaW9uU3Bhd25Qb3J0YWwnXSA9IDEuMCwgWydTeW5kcmFTcGhlcmUnXSA9IDQ4LjAsIFsnVFRfTmV4dXNfR2VhcnMnXSA9IDY1LCBbJ1JlZF9NaW5pb25fTWVjaE1lbGVlJ10gPSA2NS4wLCBbJ1N3YWluUmF2ZW4nXSA9IDY1LCBbJ2NyeXN0YWxfcGxhdGZvcm0nXSA9IDY1LCBbJ01hb2thaVNwcm91dGxpbmcnXSA9IDQ4LjAsIFsnVXJmJ10gPSA2NSwgWydUZXN0Q3ViZVJlbmRlcjEwVmlzaW9uJ10gPSA2NSwgWydNYWx6YWhhclZvaWRsaW5nJ10gPSAxMC4wLCBbJ0dob3N0V2FyZCddID0gMSwgWydNb25rZXlLaW5nRmx5aW5nJ10gPSA2NSwgWydMdWx1UGlnJ10gPSA1MC4wLCBbJ0FuaXZpYUljZUJsb2NrJ10gPSA2NSwgWydUVF9PcmRlckluaGliaXRvcl9EJ10gPSA2NSwgWyd5b25rZXknXSA9IDY1LCBbJ09kaW5fU29HX09yZGVyJ10gPSA2NSwgWydSYW1tdXNEQkMnXSA9IDY1LCBbJ0ZpenpTaGFyayddID0gNjUsIFsnTHVsdURyYWdvbiddID0gNTAuMCwgWydPZGluVGVzdEN1YmVSZW5kZXInXSA9IDY1LCBbJ09kaW5DcmFuZSddID0gNjUsIFsnVFRfVHJlZTEnXSA9IDY1LCBbJ0FSQU1PcmRlclR1cnJldFNocmluZSddID0gODguNCwgWydUVF9DaGFpbnNfT3JkZXJfQmFzZSddID0gNjUsIFsnT2Rpbl9XaW5kbWlsbF9HZWFycyddID0gNjUsIFsnQVJBTUNoYW9zTmV4dXMnXSA9IDY1LCBbJ1RUX05XcmFpdGgnXSA9IDUwLjAsIFsnVFRfT3JkZXJUdXJyZXQ0J10gPSA4OC40LCBbJ09kaW5fU09HX0NoYW9zX0NyeXN0YWwnXSA9IDY1LCBbJ1RUX1NwaWRlckxheWVyX1dlYiddID0gNjUsIFsnT2RpblF1ZXN0SW5kaWNhdG9yJ10gPSAxLjAsIFsnSmFydmFuSVZTdGFuZGFyZCddID0gNjUsIFsnVFRfRHVtbXlQdXNoZXInXSA9IDY1LCBbJ09kaW5DbGF3J10gPSA2NSwgWydFbGlzZVNwaWRlcmxpbmcnXSA9IDEuMCwgWydRdWlublZhbG9yJ10gPSA2NSwgWydVZHlyVGlnZXJVbHQnXSA9IDY1LCBbJ1VkeXJUdXJ0bGVVbHQnXSA9IDY1LCBbJ1VkeXJVbHQnXSA9IDY1LCBbJ1VkeXJQaG9lbml4VWx0J10gPSA2NSwgWydTaGFjb0JveCddID0gMTAsIFsnSEFfQVBfUG9ybyddID0gNjUsIFsnQW5uaWVUaWJiZXJzJ10gPSA4MC4wLCBbJ1VkeXJQaG9lbml4J10gPSA2NSwgWydVZHlyVHVydGxlJ10gPSA2NSwgWydVZHlyVGlnZXInXSA9IDY1LCBbJ0hBX0FQX09yZGVyU2hyaW5lVHVycmV0J10gPSA4OC40LCBbJ0hBX0FQX09yZGVyVHVycmV0UnViYmxlJ10gPSA2NSwgWydIQV9BUF9DaGFpbnNfTG9uZyddID0gNjUsIFsnSEFfQVBfT3JkZXJDbG90aCddID0gNjUsIFsnSEFfQVBfUGVyaXBoQnJpZGdlJ10gPSA2NSwgWydIQV9BUF9CcmlkZ2VMYW5lU3RhdHVlJ10gPSA2NSwgWydIQV9BUF9DaGFvc1R1cnJldFJ1YmJsZSddID0gODguNCwgWydIQV9BUF9CYW5uZXJNaWRCcmlkZ2UnXSA9IDY1LCBbJ0hBX0FQX1Bvcm9TcGF3bmVyJ10gPSA1MC4wLCBbJ0hBX0FQX0N1dGF3YXknXSA9IDY1LCBbJ0hBX0FQX0NoYWlucyddID0gNjUsIFsnSEFfQVBfU2hwU291dGgnXSA9IDY1LCBbJ0hBX0FQX0hlcm9Ub3dlciddID0gNjUsIFsnSEFfQVBfU2hwTm9ydGgnXSA9IDY1LCBbJ0NoYW9zSW5oaWJpdG9yX0QnXSA9IDY1LCBbJ1phY1JlYmlydGhCbG9ibGV0J10gPSA2NSwgWydPcmRlckluaGliaXRvcl9EJ10gPSA2NSwgWydOaWRhbGVlX1NwZWFyJ10gPSA2NSwgWydOaWRhbGVlX0NvdWdhciddID0gNjUsIFsnVFRfQnVmZnBsYXRfQ2hhaW4nXSA9IDY1LCBbJ1dyaWdnbGVMYW50ZXJuJ10gPSAxLCBbJ1R3aXN0ZWRMaXphcmRFbGRlciddID0gNjUuMCwgWydSYWJpZFdvbGYnXSA9IDY1LjAsIFsnSGVpbWVyVEdyZWVuJ10gPSA1MC4wLCBbJ0hlaW1lclRSZWQnXSA9IDUwLjAsIFsnVmlrdG9yRkYnXSA9IDY1LCBbJ1R3aXN0ZWRHb2xlbSddID0gODAuMCwgWydUd2lzdGVkU21hbGxXb2xmJ10gPSA1MC4wLCBbJ1R3aXN0ZWRHaWFudFdvbGYnXSA9IDY1LjAsIFsnVHdpc3RlZFRpbnlXcmFpdGgnXSA9IDUwLjAsIFsnVHdpc3RlZEJsdWVXcmFpdGgnXSA9IDUwLjAsIFsnVHdpc3RlZFlvdW5nTGl6YXJkJ10gPSA1MC4wLCBbJ1JlZF9NaW5pb25fTWVsZWUnXSA9IDQ4LjAsIFsnQmx1ZV9NaW5pb25fTWVsZWUnXSA9IDQ4LjAsIFsnQmx1ZV9NaW5pb25fSGVhbGVyJ10gPSA0OC4wLCBbJ0doYXN0J10gPSA2MC4wLCBbJ2JsdWVEcmFnb24nXSA9IDEwMC4wLCBbJ1JlZF9NaW5pb25fTWVjaFJhbmdlJ10gPSA2NS4wLCBbJ1Rlc3RfQ3ViZVNwaGVyZSddID0gNjUsfQoJc2VsZi5wcm9qZWN0aWxlc3BlZWRzID0ge1siVmVsa296Il09IDIwMDAsWyJUZWVtb011c2hyb29tIl0gPSBtYXRoLmh1Z2UsWyJUZXN0Q3ViZVJlbmRlciJdID0gbWF0aC5odWdlICxbIlhlcmF0aCJdID0gMjAwMC4wMDAwICxbIkthc3NhZGluIl0gPSBtYXRoLmh1Z2UgLFsiUmVuZ2FyIl0gPSBtYXRoLmh1Z2UgLFsiVGhyZXNoIl0gPSAxMDAwLjAwMDAgLFsiWmlnZ3MiXSA9IDE1MDAuMDAwMCAsWyJaeXJhUGFzc2l2ZSJdID0gMTUwMC4wMDAwICxbIlp5cmFUaG9yblBsYW50Il0gPSAxNTAwLjAwMDAgLFsiS29nTWF3Il0gPSAxODAwLjAwMDAgLFsiSGVpbWVyVEJsdWUiXSA9IDE1OTkuMzk5OSAsWyJFbGlzZVNwaWRlciJdID0gNTAwLjAwMDAgLFsiU2thcm5lciJdID0gNTAwLjAwMDAgLFsiQ2hhb3NOZXh1cyJdID0gNTAwLjAwMDAgLFsiS2F0YXJpbmEiXSA9IDQ2Ny4wMDAwICxbIlJpdmVuIl0gPSAzNDcuNzk5OTkgLFsiU2lnaHRXYXJkIl0gPSAzNDcuNzk5OTkgLFsiSGVpbWVyVFllbGxvdyJdID0gMTU5OS4zOTk5ICxbIkFzaGUiXSA9IDIwMDAuMDAwMCAsWyJWaXNpb25XYXJkIl0gPSAyMDAwLjAwMDAgLFsiVFRfTkdvbGVtMiJdID0gbWF0aC5odWdlICxbIlRocmVzaExhbnRlcm4iXSA9IG1hdGguaHVnZSAsWyJUVF9TcGlkZXJib3NzIl0gPSBtYXRoLmh1Z2UgLFsiT3JkZXJOZXh1cyJdID0gbWF0aC5odWdlICxbIlNvcmFrYSJdID0gMTAwMC4wMDAwICxbIkppbngiXSA9IDI3NTAuMDAwMCAsWyJUZXN0Q3ViZVJlbmRlcndDb2xsaXNpb24iXSA9IDI3NTAuMDAwMCAsWyJSZWRfTWluaW9uX1dpemFyZCJdID0gNjUwLjAwMDAgLFsiSmFydmFuSVYiXSA9IDIwLjAwMDAgLFsiQmx1ZV9NaW5pb25fV2l6YXJkIl0gPSA2NTAuMDAwMCAsWyJUVF9DaGFvc1R1cnJldDIiXSA9IDEyMDAuMDAwMCAsWyJUVF9DaGFvc1R1cnJldDMiXSA9IDEyMDAuMDAwMCAsWyJUVF9DaGFvc1R1cnJldDEiXSA9IDEyMDAuMDAwMCAsWyJDaGFvc1R1cnJldEdpYW50Il0gPSAxMjAwLjAwMDAgLFsiRHJhZ29uIl0gPSAxMjAwLjAwMDAgLFsiTHVsdVNub3dtYW4iXSA9IDEyMDAuMDAwMCAsWyJXb3JtIl0gPSAxMjAwLjAwMDAgLFsiQ2hhb3NUdXJyZXRXb3JtIl0gPSAxMjAwLjAwMDAgLFsiVFRfQ2hhb3NJbmhpYml0b3IiXSA9IDEyMDAuMDAwMCAsWyJDaGFvc1R1cnJldE5vcm1hbCJdID0gMTIwMC4wMDAwICxbIkFuY2llbnRHb2xlbSJdID0gNTAwLjAwMDAgLFsiWnlyYUdyYXNwaW5nUGxhbnQiXSA9IDUwMC4wMDAwICxbIkhBX0FQX09yZGVyVHVycmV0MyJdID0gMTIwMC4wMDAwICxbIkhBX0FQX09yZGVyVHVycmV0MiJdID0gMTIwMC4wMDAwICxbIlRyeW5kYW1lcmUiXSA9IDM0Ny43OTk5OSAsWyJPcmRlclR1cnJldE5vcm1hbDIiXSA9IDEyMDAuMDAwMCAsWyJTaW5nZWQiXSA9IDcwMC4wMDAwICxbIk9yZGVySW5oaWJpdG9yIl0gPSA3MDAuMDAwMCAsWyJEaWFuYSJdID0gMzQ3Ljc5OTk5ICxbIkhBX0ZCX0hlYWx0aFJlbGljIl0gPSAzNDcuNzk5OTkgLFsiVFRfT3JkZXJJbmhpYml0b3IiXSA9IDM0Ny43OTk5OSAsWyJHcmVhdFdyYWl0aCJdID0gNzUwLjAwMDAgLFsiWWFzdW8iXSA9IDM0Ny43OTk5OSAsWyJPcmRlclR1cnJldERyYWdvbiJdID0gMTIwMC4wMDAwICxbIk9yZGVyVHVycmV0Tm9ybWFsIl0gPSAxMjAwLjAwMDAgLFsiTGl6YXJkRWxkZXIiXSA9IDUwMC4wMDAwICxbIkhBX0FQX0NoYW9zVHVycmV0Il0gPSAxMjAwLjAwMDAgLFsiQWhyaSJdID0gMTc1MC4wMDAwICxbIkx1bHUiXSA9IDE0NTAuMDAwMCAsWyJDaGFvc0luaGliaXRvciJdID0gMTQ1MC4wMDAwICxbIkhBX0FQX0NoYW9zVHVycmV0MyJdID0gMTIwMC4wMDAwICxbIkhBX0FQX0NoYW9zVHVycmV0MiJdID0gMTIwMC4wMDAwICxbIkNoYW9zVHVycmV0V29ybTIiXSA9IDEyMDAuMDAwMCAsWyJUVF9PcmRlclR1cnJldDEiXSA9IDEyMDAuMDAwMCAsWyJUVF9PcmRlclR1cnJldDIiXSA9IDEyMDAuMDAwMCAsWyJUVF9PcmRlclR1cnJldDMiXSA9IDEyMDAuMDAwMCAsWyJMdWx1RmFlcmllIl0gPSAxMjAwLjAwMDAgLFsiSEFfQVBfT3JkZXJUdXJyZXQiXSA9IDEyMDAuMDAwMCAsWyJPcmRlclR1cnJldEFuZ2VsIl0gPSAxMjAwLjAwMDAgLFsiWWVsbG93VHJpbmtldFVwZ3JhZGUiXSA9IDEyMDAuMDAwMCAsWyJNYXN0ZXJZaSJdID0gbWF0aC5odWdlICxbIkxpc3NhbmRyYSJdID0gMjAwMC4wMDAwICxbIkFSQU1PcmRlclR1cnJldE5leHVzIl0gPSAxMjAwLjAwMDAgLFsiRHJhdmVuIl0gPSAxNzAwLjAwMDAgLFsiRmlkZGxlU3RpY2tzIl0gPSAxNzUwLjAwMDAgLFsiU21hbGxHb2xlbSJdID0gbWF0aC5odWdlICxbIkFSQU1PcmRlclR1cnJldEZyb250Il0gPSAxMjAwLjAwMDAgLFsiQ2hhb3NUdXJyZXRUdXRvcmlhbCJdID0gMTIwMC4wMDAwICxbIk5hc3VzVWx0Il0gPSAxMjAwLjAwMDAgLFsiTWFva2FpIl0gPSBtYXRoLmh1Z2UgLFsiV3JhaXRoIl0gPSA3NTAuMDAwMCAsWyJXb2xmIl0gPSBtYXRoLmh1Z2UgLFsiU2l2aXIiXSA9IDE3NTAuMDAwMCAsWyJDb3JraSJdID0gMjAwMC4wMDAwICxbIkphbm5hIl0gPSAxMjAwLjAwMDAgLFsiTmFzdXMiXSA9IG1hdGguaHVnZSAsWyJHb2xlbSJdID0gbWF0aC5odWdlICxbIkFSQU1DaGFvc1R1cnJldEZyb250Il0gPSAxMjAwLjAwMDAgLFsiQVJBTU9yZGVyVHVycmV0SW5oaWIiXSA9IDEyMDAuMDAwMCAsWyJMZWVTaW4iXSA9IG1hdGguaHVnZSAsWyJIQV9BUF9DaGFvc1R1cnJldFR1dG9yaWFsIl0gPSAxMjAwLjAwMDAgLFsiR2lhbnRXb2xmIl0gPSBtYXRoLmh1Z2UgLFsiSEFfQVBfT3JkZXJUdXJyZXRUdXRvcmlhbCJdID0gMTIwMC4wMDAwICxbIllvdW5nTGl6YXJkIl0gPSA3NTAuMDAwMCAsWyJKYXgiXSA9IDQwMC4wMDAwICxbIkxlc3NlcldyYWl0aCJdID0gbWF0aC5odWdlICxbIkJsaXR6Y3JhbmsiXSA9IG1hdGguaHVnZSAsWyJBUkFNQ2hhb3NUdXJyZXRJbmhpYiJdID0gMTIwMC4wMDAwICxbIlNoZW4iXSA9IDQwMC4wMDAwICxbIk5vY3R1cm5lIl0gPSBtYXRoLmh1Z2UgLFsiU29uYSJdID0gMTUwMC4wMDAwICxbIkFSQU1DaGFvc1R1cnJldE5leHVzIl0gPSAxMjAwLjAwMDAgLFsiWWVsbG93VHJpbmtldCJdID0gMTIwMC4wMDAwICxbIk9yZGVyVHVycmV0VHV0b3JpYWwiXSA9IDEyMDAuMDAwMCAsWyJDYWl0bHluIl0gPSAyNTAwLjAwMDAgLFsiVHJ1bmRsZSJdID0gMzQ3Ljc5OTk5ICxbIk1hbHBoaXRlIl0gPSAxMDAwLjAwMDAgLFsiTW9yZGVrYWlzZXIiXSA9IG1hdGguaHVnZSAsWyJaeXJhU2VlZCJdID0gbWF0aC5odWdlICxbIlZpIl0gPSAxMDAwLjAwMDAgLFsiVHV0b3JpYWxfUmVkX01pbmlvbl9XaXphcmQiXSA9IDY1MC4wMDAwICxbIlJlbmVrdG9uIl0gPSBtYXRoLmh1Z2UgLFsiQW5pdmlhIl0gPSAxNDAwLjAwMDAgLFsiRml6eiJdID0gbWF0aC5odWdlICxbIkhlaW1lcmRpbmdlciJdID0gMTUwMC4wMDAwICxbIkV2ZWx5bm4iXSA9IDQ2Ny4wMDAwICxbIlJ1bWJsZSJdID0gMzQ3Ljc5OTk5ICxbIkxlYmxhbmMiXSA9IDE3MDAuMDAwMCAsWyJEYXJpdXMiXSA9IG1hdGguaHVnZSAsWyJPbGFmQXhlIl0gPSBtYXRoLmh1Z2UgLFsiVmlrdG9yIl0gPSAyMzAwLjAwMDAgLFsiWGluWmhhbyJdID0gMjAuMDAwMCAsWyJPcmlhbm5hIl0gPSAxNDUwLjAwMDAgLFsiVmxhZGltaXIiXSA9IDE0MDAuMDAwMCAsWyJOaWRhbGVlIl0gPSAxNzUwLjAwMDAgLFsiVHV0b3JpYWxfUmVkX01pbmlvbl9CYXNpYyJdID0gbWF0aC5odWdlICxbIlplZFNoYWRvdyJdID0gNDY3LjAwMDAgLFsiU3luZHJhIl0gPSAxODAwLjAwMDAgLFsiWmFjIl0gPSAxMDAwLjAwMDAgLFsiT2xhZiJdID0gMzQ3Ljc5OTk5ICxbIlZlaWdhciJdID0gMTEwMC4wMDAwICxbIlR3aXRjaCJdID0gMjUwMC4wMDAwICxbIkFsaXN0YXIiXSA9IG1hdGguaHVnZSAsWyJBa2FsaSJdID0gNDY3LjAwMDAgLFsiVXJnb3QiXSA9IDEzMDAuMDAwMCAsWyJMZW9uYSJdID0gMzQ3Ljc5OTk5ICxbIlRhbG9uIl0gPSBtYXRoLmh1Z2UgLFsiS2FybWEiXSA9IDE1MDAuMDAwMCAsWyJKYXljZSJdID0gMzQ3Ljc5OTk5ICxbIkdhbGlvIl0gPSAxMDAwLjAwMDAgLFsiU2hhY28iXSA9IG1hdGguaHVnZSAsWyJUYXJpYyJdID0gbWF0aC5odWdlICxbIlR3aXN0ZWRGYXRlIl0gPSAxNTAwLjAwMDAgLFsiVmFydXMiXSA9IDIwMDAuMDAwMCAsWyJHYXJlbiJdID0gMzQ3Ljc5OTk5ICxbIlN3YWluIl0gPSAxNjAwLjAwMDAgLFsiVmF5bmUiXSA9IDIwMDAuMDAwMCAsWyJGaW9yYSJdID0gNDY3LjAwMDAgLFsiUXVpbm4iXSA9IDIwMDAuMDAwMCAsWyJLYXlsZSJdID0gbWF0aC5odWdlICxbIkJsdWVfTWluaW9uX0Jhc2ljIl0gPSBtYXRoLmh1Z2UgLFsiQnJhbmQiXSA9IDIwMDAuMDAwMCAsWyJUZWVtbyJdID0gMTMwMC4wMDAwICxbIkFtdW11Il0gPSA1MDAuMDAwMCAsWyJBbm5pZSJdID0gMTIwMC4wMDAwICxbIk9kaW5fQmx1ZV9NaW5pb25fY2FzdGVyIl0gPSAxMjAwLjAwMDAgLFsiRWxpc2UiXSA9IDE2MDAuMDAwMCAsWyJOYW1pIl0gPSAxNTAwLjAwMDAgLFsiUG9wcHkiXSA9IDUwMC4wMDAwICxbIkFuaXZpYUVnZyJdID0gNTAwLjAwMDAgLFsiVHJpc3RhbmEiXSA9IDIyNTAuMDAwMCAsWyJHcmF2ZXMiXSA9IDMwMDAuMDAwMCAsWyJNb3JnYW5hIl0gPSAxNjAwLjAwMDAgLFsiR3JhZ2FzIl0gPSBtYXRoLmh1Z2UgLFsiTWlzc0ZvcnR1bmUiXSA9IDIwMDAuMDAwMCAsWyJXYXJ3aWNrIl0gPSBtYXRoLmh1Z2UgLFsiQ2Fzc2lvcGVpYSJdID0gMTIwMC4wMDAwICxbIlR1dG9yaWFsX0JsdWVfTWluaW9uX1dpemFyZCJdID0gNjUwLjAwMDAgLFsiRHJNdW5kbyJdID0gbWF0aC5odWdlICxbIlZvbGliZWFyIl0gPSA0NjcuMDAwMCAsWyJJcmVsaWEiXSA9IDQ2Ny4wMDAwICxbIk9kaW5fUmVkX01pbmlvbl9DYXN0ZXIiXSA9IDY1MC4wMDAwICxbIkx1Y2lhbiJdID0gMjgwMC4wMDAwICxbIllvcmljayJdID0gbWF0aC5odWdlICxbIlJhbW11c1BCIl0gPSBtYXRoLmh1Z2UgLFsiUmVkX01pbmlvbl9CYXNpYyJdID0gbWF0aC5odWdlICxbIlVkeXIiXSA9IDQ2Ny4wMDAwICxbIk1vbmtleUtpbmciXSA9IDIwLjAwMDAgLFsiVHV0b3JpYWxfQmx1ZV9NaW5pb25fQmFzaWMiXSA9IG1hdGguaHVnZSAsWyJLZW5uZW4iXSA9IDE2MDAuMDAwMCAsWyJOdW51Il0gPSA1MDAuMDAwMCAsWyJSeXplIl0gPSAyNDAwLjAwMDAgLFsiWmVkIl0gPSA0NjcuMDAwMCAsWyJOYXV0aWx1cyJdID0gMTAwMC4wMDAwICxbIkdhbmdwbGFuayJdID0gMTAwMC4wMDAwICxbIkx1eCJdID0gMTYwMC4wMDAwICxbIlNlanVhbmkiXSA9IDUwMC4wMDAwICxbIkV6cmVhbCJdID0gMjAwMC4wMDAwICxbIk9kaW5OZXV0cmFsR3VhcmRpYW4iXSA9IDE4MDAuMDAwMCAsWyJLaGF6aXgiXSA9IDUwMC4wMDAwICxbIlNpb24iXSA9IG1hdGguaHVnZSAsWyJBYXRyb3giXSA9IDM0Ny43OTk5OSAsWyJIZWNhcmltIl0gPSA1MDAuMDAwMCAsWyJQYW50aGVvbiJdID0gMjAuMDAwMCAsWyJTaHl2YW5hIl0gPSA0NjcuMDAwMCAsWyJaeXJhIl0gPSAxNzAwLjAwMDAgLFsiS2FydGh1cyJdID0gMTIwMC4wMDAwICxbIlJhbW11cyJdID0gbWF0aC5odWdlICxbIlppbGVhbiJdID0gMTIwMC4wMDAwICxbIkNob2dhdGgiXSA9IDUwMC4wMDAwICxbIk1hbHphaGFyIl0gPSAyMDAwLjAwMDAgLFsiWW9yaWNrUmF2ZW5vdXNHaG91bCJdID0gMzQ3Ljc5OTk5ICxbIllvcmlja1NwZWN0cmFsR2hvdWwiXSA9IDM0Ny43OTk5OSAsWyJKaW54TWluZSJdID0gMzQ3Ljc5OTk5ICxbIllvcmlja0RlY2F5ZWRHaG91bCJdID0gMzQ3Ljc5OTk5ICxbIlhlcmF0aEFyY2FuZUJhcnJhZ2VMYXVuY2hlciJdID0gMzQ3Ljc5OTk5ICxbIk9kaW5fU09HX09yZGVyX0NyeXN0YWwiXSA9IDM0Ny43OTk5OSAsWyJUZXN0Q3ViZSJdID0gMzQ3Ljc5OTk5ICxbIlNoeXZhbmFEcmFnb24iXSA9IG1hdGguaHVnZSAsWyJGaXp6QmFpdCJdID0gbWF0aC5odWdlICxbIkJsdWVfTWluaW9uX01lY2hNZWxlZSJdID0gbWF0aC5odWdlICxbIk9kaW5RdWVzdEJ1ZmYiXSA9IG1hdGguaHVnZSAsWyJUVF9CdWZmcGxhdF9MIl0gPSBtYXRoLmh1Z2UgLFsiVFRfQnVmZnBsYXRfUiJdID0gbWF0aC5odWdlICxbIktvZ01hd0RlYWQiXSA9IG1hdGguaHVnZSAsWyJUZW1wTW92YWJsZUNoYXIiXSA9IG1hdGguaHVnZSAsWyJMaXphcmQiXSA9IDUwMC4wMDAwICxbIkdvbGVtT2RpbiJdID0gbWF0aC5odWdlICxbIk9kaW5PcGVuaW5nQmFycmllciJdID0gbWF0aC5odWdlICxbIlRUX0NoYW9zVHVycmV0NCJdID0gNTAwLjAwMDAgLFsiVFRfRmx5dHJhcF9BIl0gPSA1MDAuMDAwMCAsWyJUVF9OV29sZiJdID0gbWF0aC5odWdlICxbIk9kaW5TaGllbGRSZWxpYyJdID0gbWF0aC5odWdlICxbIkx1bHVTcXVpbGwiXSA9IG1hdGguaHVnZSAsWyJyZWREcmFnb24iXSA9IG1hdGguaHVnZSAsWyJNb25rZXlLaW5nQ2xvbmUiXSA9IG1hdGguaHVnZSAsWyJPZGluX3NrZWxldG9uIl0gPSBtYXRoLmh1Z2UgLFsiT2RpbkNoYW9zVHVycmV0U2hyaW5lIl0gPSA1MDAuMDAwMCAsWyJDYXNzaW9wZWlhX0RlYXRoIl0gPSA1MDAuMDAwMCAsWyJPZGluQ2VudGVyUmVsaWMiXSA9IDUwMC4wMDAwICxbIk9kaW5SZWRTdXBlcm1pbmlvbiJdID0gbWF0aC5odWdlICxbIkphcnZhbklWV2FsbCJdID0gbWF0aC5odWdlICxbIkFSQU1PcmRlck5leHVzIl0gPSBtYXRoLmh1Z2UgLFsiUmVkX01pbmlvbl9NZWNoQ2Fubm9uIl0gPSAxMjAwLjAwMDAgLFsiT2RpbkJsdWVTdXBlcm1pbmlvbiJdID0gbWF0aC5odWdlICxbIlN5bmRyYU9yYnMiXSA9IG1hdGguaHVnZSAsWyJMdWx1S2l0dHkiXSA9IG1hdGguaHVnZSAsWyJTd2Fpbk5vQmlyZCJdID0gbWF0aC5odWdlICxbIkx1bHVMYWR5YnVnIl0gPSBtYXRoLmh1Z2UgLFsiQ2FpdGx5blRyYXAiXSA9IG1hdGguaHVnZSAsWyJUVF9TaHJvb21fQSJdID0gbWF0aC5odWdlICxbIkFSQU1DaGFvc1R1cnJldFNocmluZSJdID0gNTAwLjAwMDAgLFsiT2Rpbl9XaW5kbWlsbF9Qcm9wZWxsZXJzIl0gPSA1MDAuMDAwMCAsWyJUVF9OV29sZjIiXSA9IG1hdGguaHVnZSAsWyJPZGluTWluaW9uR3JhdmV5YXJkUG9ydGFsIl0gPSBtYXRoLmh1Z2UgLFsiU3dhaW5CZWFtIl0gPSBtYXRoLmh1Z2UgLFsiU3VtbW9uZXJfUmlkZXJfT3JkZXIiXSA9IG1hdGguaHVnZSAsWyJUVF9SZWxpYyJdID0gbWF0aC5odWdlICxbIm9kaW5fbGlmdHNfY3J5c3RhbCJdID0gbWF0aC5odWdlICxbIk9kaW5PcmRlclR1cnJldFNocmluZSJdID0gNTAwLjAwMDAgLFsiU3BlbGxCb29rMSJdID0gNTAwLjAwMDAgLFsiQmx1ZV9NaW5pb25fTWVjaENhbm5vbiJdID0gMTIwMC4wMDAwICxbIlRUX0NoYW9zSW5oaWJpdG9yX0QiXSA9IDEyMDAuMDAwMCAsWyJPZGluX1NvR19DaGFvcyJdID0gMTIwMC4wMDAwICxbIlRydW5kbGVXYWxsIl0gPSAxMjAwLjAwMDAgLFsiSEFfQVBfSGVhbHRoUmVsaWMiXSA9IDEyMDAuMDAwMCAsWyJPcmRlclR1cnJldFNocmluZSJdID0gNTAwLjAwMDAgLFsiT3JpYW5uYUJhbGwiXSA9IDUwMC4wMDAwICxbIkNoYW9zVHVycmV0U2hyaW5lIl0gPSA1MDAuMDAwMCAsWyJMdWx1Q3VwY2FrZSJdID0gNTAwLjAwMDAgLFsiSEFfQVBfQ2hhb3NUdXJyZXRTaHJpbmUiXSA9IDUwMC4wMDAwICxbIlRUX05XcmFpdGgyIl0gPSA3NTAuMDAwMCAsWyJUVF9UcmVlX0EiXSA9IDc1MC4wMDAwICxbIlN1bW1vbmVyQmVhY29uIl0gPSA3NTAuMDAwMCAsWyJPZGluX0RyaWxsIl0gPSA3NTAuMDAwMCAsWyJUVF9OR29sZW0iXSA9IG1hdGguaHVnZSAsWyJBcmFtU3BlZWRTaHJpbmUiXSA9IG1hdGguaHVnZSAsWyJPcmlhbm5hTm9CYWxsIl0gPSBtYXRoLmh1Z2UgLFsiT2Rpbl9NaW5lY2FydCJdID0gbWF0aC5odWdlICxbIlN1bW1vbmVyX1JpZGVyX0NoYW9zIl0gPSBtYXRoLmh1Z2UgLFsiT2RpblNwZWVkU2hyaW5lIl0gPSBtYXRoLmh1Z2UgLFsiVFRfU3BlZWRTaHJpbmUiXSA9IG1hdGguaHVnZSAsWyJvZGluX2xpZnRzX2J1Y2tldHMiXSA9IG1hdGguaHVnZSAsWyJPZGluUm9ja1NhdyJdID0gbWF0aC5odWdlICxbIk9kaW5NaW5pb25TcGF3blBvcnRhbCJdID0gbWF0aC5odWdlICxbIlN5bmRyYVNwaGVyZSJdID0gbWF0aC5odWdlICxbIlJlZF9NaW5pb25fTWVjaE1lbGVlIl0gPSBtYXRoLmh1Z2UgLFsiU3dhaW5SYXZlbiJdID0gbWF0aC5odWdlICxbImNyeXN0YWxfcGxhdGZvcm0iXSA9IG1hdGguaHVnZSAsWyJNYW9rYWlTcHJvdXRsaW5nIl0gPSBtYXRoLmh1Z2UgLFsiVXJmIl0gPSBtYXRoLmh1Z2UgLFsiVGVzdEN1YmVSZW5kZXIxMFZpc2lvbiJdID0gbWF0aC5odWdlICxbIk1hbHphaGFyVm9pZGxpbmciXSA9IDUwMC4wMDAwICxbIkdob3N0V2FyZCJdID0gNTAwLjAwMDAgLFsiTW9ua2V5S2luZ0ZseWluZyJdID0gNTAwLjAwMDAgLFsiTHVsdVBpZyJdID0gNTAwLjAwMDAgLFsiQW5pdmlhSWNlQmxvY2siXSA9IDUwMC4wMDAwICxbIlRUX09yZGVySW5oaWJpdG9yX0QiXSA9IDUwMC4wMDAwICxbIk9kaW5fU29HX09yZGVyIl0gPSA1MDAuMDAwMCAsWyJSYW1tdXNEQkMiXSA9IDUwMC4wMDAwICxbIkZpenpTaGFyayJdID0gNTAwLjAwMDAgLFsiTHVsdURyYWdvbiJdID0gNTAwLjAwMDAgLFsiT2RpblRlc3RDdWJlUmVuZGVyIl0gPSA1MDAuMDAwMCAsWyJUVF9UcmVlMSJdID0gNTAwLjAwMDAgLFsiQVJBTU9yZGVyVHVycmV0U2hyaW5lIl0gPSA1MDAuMDAwMCAsWyJPZGluX1dpbmRtaWxsX0dlYXJzIl0gPSA1MDAuMDAwMCAsWyJBUkFNQ2hhb3NOZXh1cyJdID0gNTAwLjAwMDAgLFsiVFRfTldyYWl0aCJdID0gNzUwLjAwMDAgLFsiVFRfT3JkZXJUdXJyZXQ0Il0gPSA1MDAuMDAwMCAsWyJPZGluX1NPR19DaGFvc19DcnlzdGFsIl0gPSA1MDAuMDAwMCAsWyJPZGluUXVlc3RJbmRpY2F0b3IiXSA9IDUwMC4wMDAwICxbIkphcnZhbklWU3RhbmRhcmQiXSA9IDUwMC4wMDAwICxbIlRUX0R1bW15UHVzaGVyIl0gPSA1MDAuMDAwMCAsWyJPZGluQ2xhdyJdID0gNTAwLjAwMDAgLFsiRWxpc2VTcGlkZXJsaW5nIl0gPSAyMDAwLjAwMDAgLFsiUXVpbm5WYWxvciJdID0gbWF0aC5odWdlICxbIlVkeXJUaWdlclVsdCJdID0gbWF0aC5odWdlICxbIlVkeXJUdXJ0bGVVbHQiXSA9IG1hdGguaHVnZSAsWyJVZHlyVWx0Il0gPSBtYXRoLmh1Z2UgLFsiVWR5clBob2VuaXhVbHQiXSA9IG1hdGguaHVnZSAsWyJTaGFjb0JveCJdID0gMTUwMC4wMDAwICxbIkhBX0FQX1Bvcm8iXSA9IDE1MDAuMDAwMCAsWyJBbm5pZVRpYmJlcnMiXSA9IG1hdGguaHVnZSAsWyJVZHlyUGhvZW5peCJdID0gbWF0aC5odWdlICxbIlVkeXJUdXJ0bGUiXSA9IG1hdGguaHVnZSAsWyJVZHlyVGlnZXIiXSA9IG1hdGguaHVnZSAsWyJIQV9BUF9PcmRlclNocmluZVR1cnJldCJdID0gNTAwLjAwMDAgLFsiSEFfQVBfQ2hhaW5zX0xvbmciXSA9IDUwMC4wMDAwICxbIkhBX0FQX0JyaWRnZUxhbmVTdGF0dWUiXSA9IDUwMC4wMDAwICxbIkhBX0FQX0NoYW9zVHVycmV0UnViYmxlIl0gPSA1MDAuMDAwMCAsWyJIQV9BUF9Qb3JvU3Bhd25lciJdID0gNTAwLjAwMDAgLFsiSEFfQVBfQ3V0YXdheSJdID0gNTAwLjAwMDAgLFsiSEFfQVBfQ2hhaW5zIl0gPSA1MDAuMDAwMCAsWyJDaGFvc0luaGliaXRvcl9EIl0gPSA1MDAuMDAwMCAsWyJaYWNSZWJpcnRoQmxvYmxldCJdID0gNTAwLjAwMDAgLFsiT3JkZXJJbmhpYml0b3JfRCJdID0gNTAwLjAwMDAgLFsiTmlkYWxlZV9TcGVhciJdID0gNTAwLjAwMDAgLFsiTmlkYWxlZV9Db3VnYXIiXSA9IDUwMC4wMDAwICxbIlRUX0J1ZmZwbGF0X0NoYWluIl0gPSA1MDAuMDAwMCAsWyJXcmlnZ2xlTGFudGVybiJdID0gNTAwLjAwMDAgLFsiVHdpc3RlZExpemFyZEVsZGVyIl0gPSA1MDAuMDAwMCAsWyJSYWJpZFdvbGYiXSA9IG1hdGguaHVnZSAsWyJIZWltZXJUR3JlZW4iXSA9IDE1OTkuMzk5OSAsWyJIZWltZXJUUmVkIl0gPSAxNTk5LjM5OTkgLFsiVmlrdG9yRkYiXSA9IDE1OTkuMzk5OSAsWyJUd2lzdGVkR29sZW0iXSA9IG1hdGguaHVnZSAsWyJUd2lzdGVkU21hbGxXb2xmIl0gPSBtYXRoLmh1Z2UgLFsiVHdpc3RlZEdpYW50V29sZiJdID0gbWF0aC5odWdlICxbIlR3aXN0ZWRUaW55V3JhaXRoIl0gPSA3NTAuMDAwMCAsWyJUd2lzdGVkQmx1ZVdyYWl0aCJdID0gNzUwLjAwMDAgLFsiVHdpc3RlZFlvdW5nTGl6YXJkIl0gPSA3NTAuMDAwMCAsWyJSZWRfTWluaW9uX01lbGVlIl0gPSBtYXRoLmh1Z2UgLFsiQmx1ZV9NaW5pb25fTWVsZWUiXSA9IG1hdGguaHVnZSAsWyJCbHVlX01pbmlvbl9IZWFsZXIiXSA9IDEwMDAuMDAwMCAsWyJHaGFzdCJdID0gNzUwLjAwMDAgLFsiYmx1ZURyYWdvbiJdID0gODAwLjAwMDAgLFsiUmVkX01pbmlvbl9NZWNoUmFuZ2UiXSA9IDMwMDAuMDAwMCx9CglzZWxmLkFjdGl2ZUF0dGFja3MgPSB7fQoJc2VsZi5NaW5pb25zQXR0YWNrcyA9IHt9CgkKCglpZiBub3QgX0cuVlByZWRpY3Rpb25NZW51IHRoZW4KCQlfRy5WUHJlZGljdGlvbk1lbnUgPSBzY3JpcHRDb25maWcoIlZQcmVkaWN0aW9uIiwgIlZQcmVkaWN0aW9uIikKCQkJCgkJCV9HLlZQcmVkaWN0aW9uTWVudTphZGRQYXJhbSgiTW9kZSIsICJDYXN0IE1vZGUiLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgeyJGYXN0IiwgIk1lZGl1bSIsICJTbG93IiB9KQoJCQkKCQkJLS1bW0NvbGxpc2lvbl1dCgkJCV9HLlZQcmVkaWN0aW9uTWVudTphZGRTdWJNZW51KCJDb2xsaXNpb24iLCAiQ29sbGlzaW9uIikKCQkJCV9HLlZQcmVkaWN0aW9uTWVudS5Db2xsaXNpb246YWRkUGFyYW0oIkJ1ZmZlciIsICJDb2xsaXNpb24gYnVmZmVyIiwgU0NSSVBUX1BBUkFNX1NMSUNFLCAyMCwgMCwgMTAwKQoJCQkJX0cuVlByZWRpY3Rpb25NZW51LkNvbGxpc2lvbjphZGRQYXJhbSgiTWluaW9ucyIsICJOb3JtYWwgbWluaW9ucyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKCQkJCV9HLlZQcmVkaWN0aW9uTWVudS5Db2xsaXNpb246YWRkUGFyYW0oIk1vYnMiLCAiSnVuZ2xlIG1pbmlvbnMiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCgkJCQlfRy5WUHJlZGljdGlvbk1lbnUuQ29sbGlzaW9uOmFkZFBhcmFtKCJPdGhlcnMiLCAiT3RoZXJzIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQoJCQkJX0cuVlByZWRpY3Rpb25NZW51LkNvbGxpc2lvbjphZGRQYXJhbSgiQ0hlYWx0aCIsICJDaGVjayBpZiBtaW5pb25zIGFyZSBhYm91dCB0byBkaWUgKEJFVEEpIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkKCQkJCV9HLlZQcmVkaWN0aW9uTWVudS5Db2xsaXNpb246YWRkUGFyYW0oImluZm8iLCAiLSIsIFNDUklQVF9QQVJBTV9JTkZPLCAiXiBDYW4gY2F1c2UgZnBzIGRyb3BzIikKCgkJCQlfRy5WUHJlZGljdGlvbk1lbnUuQ29sbGlzaW9uOmFkZFBhcmFtKCJVbml0UG9zIiwgIkNoZWNrIGNvbGxpc2lvbiBhdCB0aGUgdW5pdCBwb3MiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCgkJCQlfRy5WUHJlZGljdGlvbk1lbnUuQ29sbGlzaW9uOmFkZFBhcmFtKCJDYXN0UG9zIiwgIkNoZWNrIGNvbGxpc2lvbiBhdCB0aGUgY2FzdCBwb3MiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCgkJCQlfRy5WUHJlZGljdGlvbk1lbnUuQ29sbGlzaW9uOmFkZFBhcmFtKCJQcmVkaWN0UG9zIiwgIkNoZWNrIGNvbGxpc2lvbiBhdCB0aGUgcHJlZGljdGVkIHBvcyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpCgoJCQlpZiBzZWxmLnNob3dkZXZtb2RlIHRoZW4KCQkJX0cuVlByZWRpY3Rpb25NZW51OmFkZFN1Yk1lbnUoIkRldmVsb3BlcnMiLCAiRGV2ZWxvcGVycyIpCgkJCQlfRy5WUHJlZGljdGlvbk1lbnUuRGV2ZWxvcGVyczphZGRQYXJhbSgiRGVidWciLCAiRW5hYmxlIGRlYnVnIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkKCQkJCV9HLlZQcmVkaWN0aW9uTWVudS5EZXZlbG9wZXJzOmFkZFBhcmFtKCJTQyIsICJTaG93IGNvbGxpc2lvbiIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpCgkJCWVuZAoJCQlfRy5WUHJlZGljdGlvbk1lbnU6YWRkUGFyYW0oIlZlcnNpb24iLCAiVmVyc2lvbiIsIFNDUklQVF9QQVJBTV9JTkZPLCB0b3N0cmluZyhzZWxmLnZlcnNpb24pKQoJZW5kCgoJLS1bW1VzZSB3YXlwb2ludHMgZnJvbSB0aGUgbGFzdCAxMCBzZWNvbmRzXV0KCXNlbGYuV2F5cG9pbnRzVGltZSA9IDEwCgkKCXNlbGYuRW5lbXlNaW5pb25zID0gbWluaW9uTWFuYWdlcihNSU5JT05fRU5FTVksIDIwMDAsIG15SGVyby52aXNpb25Qb3MsIE1JTklPTl9TT1JUX0hFQUxUSF9BU0MpCglzZWxmLkp1bmdsZU1pbmlvbnMgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9KVU5HTEUsIDIwMDAsIG15SGVyby52aXNpb25Qb3MsIE1JTklPTl9TT1JUX0hFQUxUSF9BU0MpCglzZWxmLk90aGVyTWluaW9ucyA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX09USEVSLCAyMDAwLCBteUhlcm8udmlzaW9uUG9zLCBNSU5JT05fU09SVF9IRUFMVEhfQVNDKQoKCXNlbGYuVGFyZ2V0c1Zpc2libGUgPSB7fQoJc2VsZi5UYXJnZXRzV2F5cG9pbnRzID0ge30KCXNlbGYuVGFyZ2V0c0ltbW9iaWxlID0ge30KCXNlbGYuVGFyZ2V0c0Rhc2hpbmcgPSB7fQoJc2VsZi5UYXJnZXRzU2xvd2VkID0ge30KCXNlbGYuRG9udFNob290ID0ge30KCXNlbGYuRG9udFNob290MiA9IHt9CglzZWxmLkRvbnRTaG9vdFVudGlsTmV3V2F5cG9pbnRzID0ge30KCglpZiBWSVBfVVNFUiB0aGVuCgkJV2F5UG9pbnRNYW5hZ2VyLkFkZENhbGxiYWNrKGZ1bmN0aW9uKE5ldHdvcmtJRCkgc2VsZjpPbk5ld1dheVBvaW50cyhOZXR3b3JrSUQpIGVuZCkKCQlBZHZhbmNlZENhbGxiYWNrOmJpbmQoIk9uR2FpblZpc2lvbiIsIGZ1bmN0aW9uKHVuaXQpIHNlbGY6T25HYWluVmlzaW9uKHVuaXQpIGVuZCkKCQlBZHZhbmNlZENhbGxiYWNrOmJpbmQoIk9uR2FpbkJ1ZmYiLCBmdW5jdGlvbih1bml0LCBidWZmKSBzZWxmOk9uR2FpbkJ1ZmYodW5pdCwgYnVmZikgZW5kKQoJCUFkdmFuY2VkQ2FsbGJhY2s6YmluZCgiT25EYXNoIiwgZnVuY3Rpb24odW5pdCwgZGFzaCkgc2VsZjpPbkRhc2godW5pdCwgZGFzaCkgZW5kKQoJZW5kCgkKCUFkZFByb2Nlc3NTcGVsbENhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIHNwZWxsKSBzZWxmOk9uUHJvY2Vzc1NwZWxsKHVuaXQsIHNwZWxsKSBlbmQpCglBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOk9uVGljaygpIGVuZCkKCUFkZERyYXdDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6T25EcmF3KCkgZW5kKQoJQWRkUHJvY2Vzc1NwZWxsQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgc3BlbGwpIHNlbGY6Q29sbGlzaW9uUHJvY2Vzc1NwZWxsKHVuaXQsIHNwZWxsKSBlbmQpCglzZWxmLkJsYWNrTGlzdCA9IAoJewoJCXtuYW1lID0gImFhdHJveHEiLCBkdXJhdGlvbiA9IDAuNzV9LCAtLVtbNCBEYXNoZXMsIE9uRGFzaCBmYWlsc11dCgl9CgkKCS0tW1tTcGVsbHMgdGhhdCB3aWxsIGNhdXNlIE9uRGFzaCB0byBmaXJlLCBkb250IHNob290IGFuZCB3YWl0IHRvIE9uRGFzaF1dCglzZWxmLmRhc2hBYm91dFRvSGFwcGVuZCA9Cgl7CgkJe25hbWUgPSAiYWhyaXR1bWJsZSIsIGR1cmF0aW9uID0gMC4yNX0sLS1haHJpJ3MgcgoJCXtuYW1lID0gImFrYWxpc2hhZG93ZGFuY2UiLCBkdXJhdGlvbiA9IDAuMjV9LC0tYWthbGkgcgoJCXtuYW1lID0gImhlYWRidXR0IiwgZHVyYXRpb24gPSAwLjI1fSwtLWFsaXN0YXIgdwoJCXtuYW1lID0gImNhaXRseW5lbnRyYXBtZW50IiwgZHVyYXRpb24gPSAwLjI1fSwtLWNhaXRseW4gZQoJCXtuYW1lID0gImNhcnBldGJvbWIiLCBkdXJhdGlvbiA9IDAuMjV9LC0tY29ya2kgdwoJCXtuYW1lID0gImRpYW5hdGVsZXBvcnQiLCBkdXJhdGlvbiA9IDAuMjV9LC0tZGlhbmEgcgoJCXtuYW1lID0gImZpenpwaWVyY2luZ3N0cmlrZSIsIGR1cmF0aW9uID0gMC4yNX0sLS1maXp6IHEKCQl7bmFtZSA9ICJmaXp6anVtcCIsIGR1cmF0aW9uID0gMC4yNX0sLS1maXp6IGUKCQl7bmFtZSA9ICJncmFnYXNib2R5c2xhbSIsIGR1cmF0aW9uID0gMC4yNX0sLS1ncmFnYXMgZQoJCXtuYW1lID0gImdyYXZlc21vdmUiLCBkdXJhdGlvbiA9IDAuMjV9LC0tZ3JhdmVzIGUKCQl7bmFtZSA9ICJpcmVsaWFnYXRvdHN1IiwgZHVyYXRpb24gPSAwLjI1fSwtLWlyZWxpYSBxCgkJe25hbWUgPSAiamFydmFuaXZkcmFnb25zdHJpa2UiLCBkdXJhdGlvbiA9IDAuMjV9LC0tamFydmFuIHEKCQl7bmFtZSA9ICJqYXhsZWFwc3RyaWtlIiwgZHVyYXRpb24gPSAwLjI1fSwtLWpheCBxCgkJe25hbWUgPSAia2hheml4ZSIsIGR1cmF0aW9uID0gMC4yNX0sLS1raGF6aXggZSBhbmQgZSBldm9sdmVkCgkJe25hbWUgPSAibGVibGFuY3NsaWRlIiwgZHVyYXRpb24gPSAwLjI1fSwtLWxlYmxhbmMgdwoJCXtuYW1lID0gImxlYmxhbmNzbGlkZW0iLCBkdXJhdGlvbiA9IDAuMjV9LC0tbGVibGFuYyB3IChyKQoJCXtuYW1lID0gImJsaW5kbW9ua3F0d28iLCBkdXJhdGlvbiA9IDAuMjV9LC0tbGVlIHNpbiBxIAoJCXtuYW1lID0gImJsaW5kbW9ua3dvbmUiLCBkdXJhdGlvbiA9IDAuMjV9LC0tbGVlIHNpbiB3CgkJe25hbWUgPSAibHVjaWFuZSIsIGR1cmF0aW9uID0gMC4yNX0sLS1sdWNpYW4gZQoJCXtuYW1lID0gIm1hb2thaXVuc3RhYmxlZ3Jvd3RoIiwgZHVyYXRpb24gPSAwLjI1fSwtLW1hb2thaSB3CgkJe25hbWUgPSAibm9jdHVybmVwYXJhbm9pYTIiLCBkdXJhdGlvbiA9IDAuMjV9LC0tbm9jdHVybmUgcgoJCXtuYW1lID0gInBhbnRoZW9uX2xlYXBiYXNoIiwgZHVyYXRpb24gPSAwLjI1fSwtLXBhbnRoZW9uIGU/CgkJe25hbWUgPSAicmVuZWt0b25zbGljZWFuZGRpY2UiLCBkdXJhdGlvbiA9IDAuMjV9LC0tcmVuZWt0b24gZQoJCXtuYW1lID0gInJpdmVudHJpY2xlYXZlIiwgZHVyYXRpb24gPSAwLjI1fSwtLXJpdmVuIHEKCQl7bmFtZSA9ICJyaXZlbmZlaW50IiwgZHVyYXRpb24gPSAwLjI1fSwtLXJpdmVuIGUKCQl7bmFtZSA9ICJzZWp1YW5pYXJjdGljYXNzYXVsdCIsIGR1cmF0aW9uID0gMC4yNX0sLS1zZWp1YW5pIHEKCQl7bmFtZSA9ICJzaGVuc2hhZG93ZGFzaCIsIGR1cmF0aW9uID0gMC4yNX0sLS1zaGVuIGUKCQl7bmFtZSA9ICJzaHl2YW5hdHJhbnNmb3JtY2FzdCIsIGR1cmF0aW9uID0gMC4yNX0sLS1zaHl2YW5hIHIKCQl7bmFtZSA9ICJyb2NrZXRqdW1wIiwgZHVyYXRpb24gPSAwLjI1fSwtLXRyaXN0YW5hIHcKCQl7bmFtZSA9ICJzbGFzaGNhc3QiLCBkdXJhdGlvbiA9IDAuMjV9LC0tdHJ5bmRhbWVyZSBlCgkJe25hbWUgPSAidmF5bmV0dW1ibGUiLCBkdXJhdGlvbiA9IDAuMjV9LC0tdmF5bmUgcQoJCXtuYW1lID0gInZpcSIsIGR1cmF0aW9uID0gMC4yNX0sLS12aSBxCgkJe25hbWUgPSAibW9ua2V5a2luZ25pbWJ1cyIsIGR1cmF0aW9uID0gMC4yNX0sLS13dWtvbmcgcQoJCXtuYW1lID0gInhlbnpoYW9zd2VlcCIsIGR1cmF0aW9uID0gMC4yNX0sLS14aW4geGhhbyBxCgkJe25hbWUgPSAieWFzdW9kYXNod3JhcHBlciIsIGR1cmF0aW9uID0gMC4yNX0sLS15YXN1byBlCgoJfQoJLS1bW1NwZWxscyB0aGF0IGRvbid0IGFsbG93IG1vdmVtZW50IChkdXJhdGlvbnMgYXBwcm94KV1dCglzZWxmLnNwZWxscyA9IHsKCQl7bmFtZSA9ICJrYXRhcmluYXIiLCBkdXJhdGlvbiA9IDF9LCAtLUthdGFyaW5hcyBSCgkJe25hbWUgPSAiZHJhaW4iLCBkdXJhdGlvbiA9IDF9LCAtLUZpZGRsZSBXCgkJe25hbWUgPSAiY3Jvd3N0b3JtIiwgZHVyYXRpb24gPSAxfSwgLS1GaWRkbGUgUgoJCXtuYW1lID0gImNvbnN1bWUiLCBkdXJhdGlvbiA9IDAuNX0sIC0tTnVudSBRCgkJe25hbWUgPSAiYWJzb2x1dGV6ZXJvIiwgZHVyYXRpb24gPSAxfSwgLS1OdW51IFIKCQl7bmFtZSA9ICJyb2NrZXRncmFiIiwgZHVyYXRpb24gPSAwLjV9LCAtLUJsaXR6Y3JhbmsgUQoJCXtuYW1lID0gInN0YXRpY2ZpZWxkIiwgZHVyYXRpb24gPSAwLjV9LCAtLUJsaXR6Y3JhbmsgUgoJCXtuYW1lID0gImNhc3Npb3BlaWFwZXRyaWZ5aW5nZ2F6ZSIsIGR1cmF0aW9uID0gMC41fSwgLS1DYXNzaW8ncyBSCgkJe25hbWUgPSAiZXpyZWFsdHJ1ZXNob3RiYXJyYWdlIiwgZHVyYXRpb24gPSAxfSwgLS1FenJlYWwncyBSCgkJe25hbWUgPSAiZ2FsaW9pZG9sb2ZkdXJhbmQiLCBkdXJhdGlvbiA9IDF9LCAtLUV6cmVhbCdzIFIKCQl7bmFtZSA9ICJncmFnYXNkcnVua2VucmFnZSIsIGR1cmF0aW9uID0gMX0sIC0tIiJHcmFnYXMgVwoJCXtuYW1lID0gImx1eG1hbGljZWNhbm5vbiIsIGR1cmF0aW9uID0gMX0sIC0tTHV4IFIKCQl7bmFtZSA9ICJyZWFwdGhld2hpcmx3aW5kIiwgZHVyYXRpb24gPSAxfSwgLS1KYW5uYXMgUgoJCXtuYW1lID0gImppbnh3IiwgZHVyYXRpb24gPSAwLjZ9LCAtLWppbnhXCgkJe25hbWUgPSAiamlueHIiLCBkdXJhdGlvbiA9IDAuNn0sIC0tamlueFIKCQl7bmFtZSA9ICJtaXNzZm9ydHVuZWJ1bGxldHRpbWUiLCBkdXJhdGlvbiA9IDF9LCAtLU1pc3NGb3J0dW5lUgoJCXtuYW1lID0gInNoZW5zdGFuZHVuaXRlZCIsIGR1cmF0aW9uID0gMX0sIC0tU2hlblIKCQl7bmFtZSA9ICJ0aHJlc2hlIiwgZHVyYXRpb24gPSAwLjR9LCAtLVRocmVzaEUKCQl7bmFtZSA9ICJ0aHJlc2hycGVudGEiLCBkdXJhdGlvbiA9IDAuNzV9LCAtLVRocmVzaFIKCQl7bmFtZSA9ICJpbmZpbml0ZWR1cmVzcyIsIGR1cmF0aW9uID0gMX0sIC0tV2Fyd2ljayBSCgkJe25hbWUgPSAibWVkaXRhdGUiLCBkdXJhdGlvbiA9IDF9IC0teWkgVwoJfQoKCXNlbGYuYmxpbmtzID0gewoJCXtuYW1lID0gImV6cmVhbGFyY2FuZXNoaWZ0IiwgcmFuZ2UgPSA0NzUsIGRlbGF5ID0gMC4yNSwgZGVsYXkyPTAuOH0sLS1FenJlYWxzIEUKCQl7bmFtZSA9ICJkZWNlaXZlIiwgcmFuZ2UgPSA0MDAsIGRlbGF5ID0gMC4yNSwgZGVsYXkyPTAuOH0sIC0tU2hhY29zIFEKCQl7bmFtZSA9ICJyaWZ0d2FsayIsIHJhbmdlID0gNzAwLCBkZWxheSA9IDAuMjUsIGRlbGF5Mj0wLjh9LC0tS2Fzc2FkaW5SCgkJe25hbWUgPSAiZ2F0ZSIsIHJhbmdlID0gNTUwMCwgZGVsYXkgPSAxLjUsIGRlbGF5Mj0xLjV9LC0tVHdpc3RlZCBmYXRlIFIKCQl7bmFtZSA9ICJrYXRhcmluYWUiLCByYW5nZSA9IG1hdGguaHVnZSwgZGVsYXkgPSAwLjI1LCBkZWxheTI9MC44fSwtLUthdGFyaW5hcyBFCgkJe25hbWUgPSAiZWxpc2VzcGlkZXJlZGVzY2VudCIsIHJhbmdlID0gbWF0aC5odWdlLCBkZWxheSA9IDAuMjUsIGRlbGF5Mj0wLjh9LC0tRWxpc2UgRQoJCXtuYW1lID0gImVsaXNlc3BpZGVyZSIsIHJhbmdlID0gbWF0aC5odWdlLCBkZWxheSA9IDAuMjUsIGRlbGF5Mj0wLjh9LC0tRWxpc2UgaW5zdGEgRQoJfQoKCXJldHVybiBzZWxmCmVuZAoKLS1SX1dBWVBPSU5UIG5ldyBkZWZpbml0aW9uCmlmIFZJUF9VU0VSIHRoZW4KCWxvYWQoQmFzZTY0RGVjb2RlKCJHMHgxWVZJQUFRUUVCQWdBR1pNTkNob0tBQUFBQUFBQUFBQUFBUU1NQUFBQUJnQkFBQWRBUUFBSGdFQUFTOEFBQUtVQUFBQktnQUNDcFVBQUFFcUFnSUtsZ0FBQVNvQUFnd3BBZ0lFZkFJQUFCd0FBQUFRREFBQUFYMGNBQkFjQUFBQlFZV05yWlhRQUJBc0FBQUJrWldacGJtbDBhVzl1QUFRTEFBQUFVbDlYUVZsUVQwbE9WQUFFQlFBQUFHbHVhWFFBQkFjQUFBQmtaV052WkdVQUJBY0FBQUJsYm1OdlpHVUFBd0FBQUFJQUFBQUpBQUFBQUFBSUVBQUFBQXNBQVFCTEFBQURnVUFBQU1GQUFBQUJRUUFBUVVFQUFJRkJBQURCUVFBQVpFQUFBd3BBQUlBS1FFQ0JDa0RBZ1VzQUFBQUtRQUNDSHdBQUFSOEFnQUFGQUFBQUJBOEFBQUJoWkdScGRHbHZibUZzU1c1bWJ3QURBQUFBQUFBQUFBQUVEd0FBQUhObGNYVmxibU5sVG5WdFltVnlBQVFLQUFBQWJtVjBkMjl5YTBsa0FBUUtBQUFBZDJGNVVHOXBiblJ6QUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQXNBQUFBbEFBQUFBUUFLUGdBQUFBcEFRSUJMd0FBQWl3QUFBRXFBQUlHTUFFRUFuWUFBQVVxQWdJR0xBQUFBU29DQWdvY0FRQUNOZ0VFQnpNQkJBTjJBQUFHTndBQUJDb0FBZ0l3QVFRQ2RnQUFCU29BQWhJeEFRZ0NkZ0FBQkdJQkNBUmZBQUlDSEFFQUFqY0JDQVp0QUFBQVhRQUNBaHdCQUFJMEFRd0VLZ0FDQWgwQkRBTWNBUUFBQmdRTUFvVUFHZ0FwQUFZQ01BVUVBbllFQUFjZkJ3QUFZd0FFREY4QUVnSWNCUUFET3dVTURDc0FCZ014QlJBRGRnUUFCU3NBQmlNeEJRZ0RkZ1FBQjBNSEVBMHJBQVluSEFVQUF6UUhGQXdyQUFZREdRVVVBeDRIRkF3QUNBQUJIZ3NRQTNZR0FBVXJBZ1lJWEFBQ0FvQUQ1ZjE4QUFBRWZBSUFBRndBQUFBUUVBQUFBY0c5ekFBTUFBQUFBQUFEd1B3UVBBQUFBWVdSa2FYUnBiMjVoYkVsdVptOEFCQW9BQUFCdVpYUjNiM0pyU1dRQUJBZ0FBQUJFWldOdlpHVkdBQVFLQUFBQWQyRjVVRzlwYm5SekFBTUFBQUFBQUFBWVFBUUlBQUFBUkdWamIyUmxNZ0FFRkFBQUFHRmtaR2wwYVc5dVlXeE9aWFIzYjNKclNXUUFCQWdBQUFCRVpXTnZaR1V4QUFNQUFBQUFBQUFBQUFNQUFBQUFBQUFzUUFNQUFBQUFBQUFvUUFRRkFBQUFjMmw2WlFBREFBQUFBQUFBOEw4REFBQUFBQUFBSWtBRUR3QUFBSE5sY1hWbGJtTmxUblZ0WW1WeUFBUUlBQUFBUkdWamIyUmxOQUFFRGdBQUFIZGhlWEJ2YVc1MFEyOTFiblFBQXdBQUFBQUFBQUJBQXdBQUFBQUFBQkJBQkFjQUFBQlFZV05yWlhRQUJCQUFBQUJrWldOdlpHVlhZWGxRYjJsdWRITUFBQUFBQUFFQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQW5BQUFBT1FBQUFBRUFDVVVBQUFCR1FFQUFob0JBQUlmQVFBR0hBRUVCWFlBQUFRaEFBSUJHQUVBQVRFREJBTWVBUVFESHdNRUJYVUNBQVVZQVFBQk1BTUlBeDRCQkFNZEF3Z0hWQUlBQnpvRENBVjFBZ0FGR3dFSUFoNEJCQUlkQVFnRmRBQUVCRjhBQWdJWUJRQUNNQVVNREFBS0FBcDFCZ0FGaWdBQUE0MEQrZjBZQVFBQk1BTU1Bd1VBREFGMUFnQUZHQUVBQVRJRERBTWVBUVFESHdNTUJYVUNBQVVZQVFBQk1RTUVBeDRCQkFNY0F4QUhIUU1RQng0REVBVjFBZ0FGR0FFQUFURURCQU1lQVFRREhBTVFCeDBERUFjZkF4QUZkUUlBQlJnQkFBRXhBd1FESGdFRUF4d0RFQWNjQXhRSEhnTVFCWFVDQUFVWUFRQUJNUU1FQXg0QkJBTWNBeEFISEFNVUJ4OERFQVYxQWdBRkdBRUFBWHdBQUFSOEFnQUFWQUFBQUJBSUFBQUJ3QUFRTEFBQUFRMHh2VEZCaFkydGxkQUFFQndBQUFGQmhZMnRsZEFBRUNBQUFBR2hsWVdSbGNuTUFCQXNBQUFCU1gxZEJXVkJQU1U1VUFBUUlBQUFBUlc1amIyUmxSZ0FFQndBQUFIWmhiSFZsY3dBRUNnQUFBRzVsZEhkdmNtdEpaQUFFQ0FBQUFFVnVZMjlrWlRJQUJBOEFBQUJoWkdScGRHbHZibUZzU1c1bWJ3QURBQUFBQUFBQUdFQUVCd0FBQUdsd1lXbHljd0FFQ0FBQUFFVnVZMjlrWlRFQUF3QUFBQUFBQUFoQUJBZ0FBQUJGYm1OdlpHVTBBQVFQQUFBQWMyVnhkV1Z1WTJWT2RXMWlaWElBQkFvQUFBQjNZWGxRYjJsdWRITUFBd0FBQUFBQUFQQS9CQUlBQUFCNEFBUUNBQUFBZVFBREFBQUFBQUFBQUVBQUFBQUFBUUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFFQUFBQUJBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQT0iKSkoKQplbmQKLS0KCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkdldFRpbWUoKQoJcmV0dXJuIG9zLmNsb2NrKCkKZW5kCgotLVtbVHJhY2sgd2hlbiB3ZSBsb3NlIG9yIGdhaW4gdmlzaW9uIG92ZXIgYW4gZW5lbXldXQpmdW5jdGlvbiBWUHJlZGljdGlvbjpPbkdhaW5WaXNpb24odW5pdCkKCWlmIHVuaXQudHlwZSA9PSBteUhlcm8udHlwZSB0aGVuCgkJc2VsZi5UYXJnZXRzVmlzaWJsZVt1bml0Lm5ldHdvcmtJRF0gPSBzZWxmOkdldFRpbWUoKQoJZW5kCmVuZAoKLS1bW1RyYWNrIHdoZW4gd2UgbG9zZSBvciBnYWluIHZpc2lvbiBvdmVyIGFuIGVuZW15XV0KZnVuY3Rpb24gVlByZWRpY3Rpb246T25Mb3NlVmlzaW9uKHVuaXQpCglpZiB1bml0LnR5cGUgPT0gbXlIZXJvLnR5cGUgdGhlbgoJCXNlbGYuVGFyZ2V0c1Zpc2libGVbdW5pdC5uZXR3b3JrSURdID0gbWF0aC5odWdlCgllbmQKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpPbkdhaW5CdWZmKHVuaXQsIGJ1ZmYpCglpZiB1bml0LnR5cGUgPT0gbXlIZXJvLnR5cGUgYW5kIChidWZmLnR5cGUgPT0gQlVGRl9TVFVOIG9yIGJ1ZmYudHlwZSA9PSBCVUZGX1JPT1Qgb3IgYnVmZi50eXBlID09IEJVRkZfS05PQ0tVUCBvciBidWZmLnR5cGUgPT0gQlVGRl9TVVBQUkVTUykgdGhlbgoJCXNlbGYuVGFyZ2V0c0ltbW9iaWxlW3VuaXQubmV0d29ya0lEXSA9IHNlbGY6R2V0VGltZSgpICsgYnVmZi5kdXJhdGlvbgoJZWxzZWlmIHVuaXQudHlwZSA9PSBteUhlcm8udHlwZSBhbmQgKGJ1ZmYudHlwZSA9PSBCVUZGX1NMT1cgb3IgYnVmZi50eXBlID09IEJVRkZfQ0hBUk0gb3IgYnVmZi50eXBlID09IEJVRkZfRkVBUiBvciBidWZmLnR5cGUgPT0gQlVGRl9UQVVOVCkgdGhlbgoJCXNlbGYuVGFyZ2V0c1Nsb3dlZFt1bml0Lm5ldHdvcmtJRF0gPSBzZWxmOkdldFRpbWUoKSArIGJ1ZmYuZHVyYXRpb24KCWVuZAoKCWlmIHVuaXQudHlwZSA9PSBteUhlcm8udHlwZSBhbmQgKGJ1ZmYudHlwZSA9PSBCVUZGX0tOT0NLQkFDSykgdGhlbgoJCXNlbGYuRG9udFNob290W3VuaXQubmV0d29ya0lEXSA9IHNlbGY6R2V0VGltZSgpICsgMQoJZW5kCmVuZAoKZnVuY3Rpb24gVlByZWRpY3Rpb246T25EYXNoKHVuaXQsIGRhc2gpCglpZiB1bml0LnR5cGUgPT0gbXlIZXJvLnR5cGUgdGhlbgoJCWRhc2guZW5kUG9zID0gZGFzaC50YXJnZXQgYW5kIGRhc2gudGFyZ2V0IG9yIGRhc2guZW5kUG9zCgkJZGFzaC5zdGFydFQgPSBzZWxmOkdldFRpbWUoKSAtIEdldExhdGVuY3koKS8yMDAwCgkJZGFzaC5lbmRUID0gZGFzaC5zdGFydFQgKyBkYXNoLmR1cmF0aW9uCgkJc2VsZi5UYXJnZXRzRGFzaGluZ1t1bml0Lm5ldHdvcmtJRF0gPSBkYXNoCgkJc2VsZi5Eb250U2hvb3RVbnRpbE5ld1dheXBvaW50c1t1bml0Lm5ldHdvcmtJRF0gPSB0cnVlCgllbmQKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpPblByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkKCWlmIHVuaXQgYW5kIHVuaXQudHlwZSA9PSBteUhlcm8udHlwZSB0aGVuCgkJZm9yIGksIHMgaW4gaXBhaXJzKHNlbGYuc3BlbGxzKSBkbwoJCQlpZiBzcGVsbC5uYW1lOmxvd2VyKCkgPT0gcy5uYW1lIHRoZW4KCQkJCXNlbGYuVGFyZ2V0c0ltbW9iaWxlW3VuaXQubmV0d29ya0lEXSA9IHNlbGY6R2V0VGltZSgpICsgcy5kdXJhdGlvbgoJCQkJcmV0dXJuCgkJCWVuZAoJCWVuZAoKCQlmb3IgaSwgcyBpbiBpcGFpcnMoc2VsZi5ibGlua3MpIGRvCgkJCWxvY2FsIExhbmRpbmdQb3MgPSBHZXREaXN0YW5jZSh1bml0LnZpc2lvblBvcywgVmVjdG9yKHNwZWxsLmVuZFBvcykpIDwgcy5yYW5nZSBhbmQgVmVjdG9yKHNwZWxsLmVuZFBvcykgb3IgVmVjdG9yKHVuaXQudmlzaW9uUG9zKSArIHMucmFuZ2UgKiAoVmVjdG9yKHNwZWxsLmVuZFBvcykgLSBWZWN0b3IodW5pdC52aXNpb25Qb3MpKTpub3JtYWxpemVkKCkKCQkJaWYgc3BlbGwubmFtZTpsb3dlcigpID09IHMubmFtZSBhbmQgbm90IElzV2FsbChEM0RYVkVDVE9SMyhzcGVsbC5lbmRQb3MueCwgc3BlbGwuZW5kUG9zLnksIHNwZWxsLmVuZFBvcy56KSkgdGhlbgoJCQkJc2VsZi5UYXJnZXRzRGFzaGluZ1t1bml0Lm5ldHdvcmtJRF0gPSB7aXNibGluayA9IHRydWUsIGR1cmF0aW9uID0gcy5kZWxheSwgZW5kVCA9IHNlbGY6R2V0VGltZSgpICsgcy5kZWxheSwgZW5kVDIgPSBzZWxmOkdldFRpbWUoKSArIHMuZGVsYXkyLCBzdGFydFBvcyA9IFZlY3Rvcih1bml0LnZpc2lvblBvcyksIGVuZFBvcyA9IExhbmRpbmdQb3N9CgkJCQlyZXR1cm4gCgkJCWVuZAoJCWVuZAoKCQlmb3IgaSwgcyBpbiBpcGFpcnMoc2VsZi5CbGFja0xpc3QpIGRvCgkJCWlmIHNwZWxsLm5hbWU6bG93ZXIoKSA9PSBzLm5hbWUgdGhlbgoJCQkJc2VsZi5Eb250U2hvb3RbdW5pdC5uZXR3b3JrSURdID0gc2VsZjpHZXRUaW1lKCkgKyBzLmR1cmF0aW9uCgkJCQlyZXR1cm4KCQkJZW5kCgkJZW5kCgoJCWZvciBpLCBzIGluIGlwYWlycyhzZWxmLmRhc2hBYm91dFRvSGFwcGVuZCkgZG8KCQkJaWYgc3BlbGwubmFtZTpsb3dlcigpID09IHMubmFtZSB0aGVuCgkJCQlzZWxmLkRvbnRTaG9vdDJbdW5pdC5uZXR3b3JrSURdID0gc2VsZjpHZXRUaW1lKCkgKyBzLmR1cmF0aW9uCgkJCQlyZXR1cm4KCQkJZW5kCgkJZW5kCgllbmQKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpPbk5ld1dheVBvaW50cyhOZXR3b3JrSUQpCglsb2NhbCBvYmplY3QgPSBvYmpNYW5hZ2VyOkdldE9iamVjdEJ5TmV0d29ya0lkKE5ldHdvcmtJRCkKCWlmIG9iamVjdCBhbmQgb2JqZWN0LnZhbGlkIGFuZCBvYmplY3QubmV0d29ya0lEIGFuZCBvYmplY3QudHlwZSA9PSBteUhlcm8udHlwZSB0aGVuCgkJc2VsZi5Eb250U2hvb3RVbnRpbE5ld1dheXBvaW50c1tOZXR3b3JrSURdID0gZmFsc2UKCQlpZiBzZWxmLlRhcmdldHNXYXlwb2ludHNbTmV0d29ya0lEXSA9PSBuaWwgdGhlbgoJCQlzZWxmLlRhcmdldHNXYXlwb2ludHNbTmV0d29ya0lEXSA9IHt9CgkJZW5kCgkJbG9jYWwgV2F5cG9pbnRzVG9BZGQgPSBXYXlQb2ludE1hbmFnZXI6R2V0V2F5UG9pbnRzKG9iamVjdCkKCQlpZiBXYXlwb2ludHNUb0FkZCBhbmQgI1dheXBvaW50c1RvQWRkID49IDEgdGhlbgoJCQktLVtbU2F2ZSBvbmx5IHRoZSBsYXN0IHdheXBvaW50ICh3aGVyZSB0aGUgcGxheWVyIGNsaWNrZWQpXV0KCQkJdGFibGUuaW5zZXJ0KHNlbGYuVGFyZ2V0c1dheXBvaW50c1tOZXR3b3JrSURdLCB7dW5pdHBvcyA9IFZlY3RvcihvYmplY3QudmlzaW9uUG9zKSAsIHdheXBvaW50ID0gV2F5cG9pbnRzVG9BZGRbI1dheXBvaW50c1RvQWRkXSwgdGltZSA9IHNlbGY6R2V0VGltZSgpLCBuID0gI1dheXBvaW50c1RvQWRkfSkKCQllbmQKCWVsc2VpZiBvYmplY3QgYW5kIG9iamVjdC52YWxpZCBhbmQgb2JqZWN0LnR5cGUgfj0gbXlIZXJvLnR5cGUgdGhlbgoJCWxvY2FsIGkgPSAxCgkJd2hpbGUgaSA8PSAjc2VsZi5BY3RpdmVBdHRhY2tzIGRvCgkJCWlmIChzZWxmLkFjdGl2ZUF0dGFja3NbaV0uQXR0YWNrZXIgYW5kIHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5BdHRhY2tlci52YWxpZCBhbmQgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLkF0dGFja2VyLm5ldHdvcmtJRCA9PSBOZXR3b3JrSUQgYW5kIChzZWxmLkFjdGl2ZUF0dGFja3NbaV0uc3RhcnR0aW1lICsgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLndpbmRVcFRpbWUgLSBHZXRMYXRlbmN5KCkvMjAwMCkgPiBzZWxmOkdldFRpbWUoKSkgdGhlbgoJCQkJbG9jYWwgd3B0cyA9IFdheVBvaW50TWFuYWdlcjpHZXRXYXlQb2ludHMob2JqZWN0KQoJCQkJaWYgI3dwdHMgPiAxIHRoZW4KCQkJCQl0YWJsZS5yZW1vdmUoc2VsZi5BY3RpdmVBdHRhY2tzLCBpKQoJCQkJZWxzZQoJCQkJCWkgPSBpICsgMQoJCQkJZW5kCgkJCWVsc2UKCQkJCWkgPSBpICsgMQoJCQllbmQKCQllbmQKCWVuZAplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOklzSW1tb2JpbGUodW5pdCwgZGVsYXksIHJhZGl1cywgc3BlZWQsIGZyb20sIHNwZWxsdHlwZSkKCWlmIHNlbGYuVGFyZ2V0c0ltbW9iaWxlW3VuaXQubmV0d29ya0lEXSB0aGVuCgkJbG9jYWwgRXh0cmFEZWxheSA9IHNwZWVkID09IG1hdGguaHVnZSBhbmQgIDAgb3IgKEdldERpc3RhbmNlKGZyb20sIHVuaXQpIC8gc3BlZWQpCgkJaWYgKHNlbGYuVGFyZ2V0c0ltbW9iaWxlW3VuaXQubmV0d29ya0lEXSA+IChzZWxmOkdldFRpbWUoKSArIGRlbGF5ICsgRXh0cmFEZWxheSkgYW5kIHNwZWxsdHlwZSA9PSAiY2lyY3VsYXIiKSB0aGVuCgkJCXJldHVybiB0cnVlLCBWZWN0b3IodW5pdC52aXNpb25Qb3MpLCBWZWN0b3IodW5pdC52aXNpb25Qb3MpICsgKHJhZGl1cy8zKSAqIChWZWN0b3IoZnJvbSkgLSBWZWN0b3IodW5pdC52aXNpb25Qb3MpKTpub3JtYWxpemVkKCkKCQllbHNlaWYgKHNlbGYuVGFyZ2V0c0ltbW9iaWxlW3VuaXQubmV0d29ya0lEXSArIChyYWRpdXMgLyB1bml0Lm1zKSkgPiAoc2VsZjpHZXRUaW1lKCkgKyBkZWxheSArIEV4dHJhRGVsYXkpIHRoZW4KCQkJcmV0dXJuIHRydWUsIFZlY3Rvcih1bml0LnZpc2lvblBvcyksIFZlY3Rvcih1bml0LnZpc2lvblBvcykKCQllbmQKCWVuZAoJcmV0dXJuIGZhbHNlLCBWZWN0b3IodW5pdC52aXNpb25Qb3MpLCBWZWN0b3IodW5pdC52aXNpb25Qb3MpCmVuZAoKZnVuY3Rpb24gVlByZWRpY3Rpb246aXNTbG93ZWQodW5pdCwgZGVsYXksIHNwZWVkLCBmcm9tKQoJaWYgc2VsZi5UYXJnZXRzU2xvd2VkW3VuaXQubmV0d29ya0lEXSB0aGVuCgkJaWYgc2VsZi5UYXJnZXRzU2xvd2VkW3VuaXQubmV0d29ya0lEXSA+IChzZWxmOkdldFRpbWUoKSArIGRlbGF5ICsgR2V0RGlzdGFuY2UodW5pdCwgZnJvbSkgLyBzcGVlZCkgdGhlbgoJCQlyZXR1cm4gdHJ1ZQoJCWVuZAoJZW5kCglyZXR1cm4gZmFsc2UKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpJc0Rhc2hpbmcodW5pdCwgZGVsYXksIHJhZGl1cywgc3BlZWQsIGZyb20pCglsb2NhbCBUYXJnZXREYXNoaW5nID0gZmFsc2UKCWxvY2FsIENhbkhpdCA9IGZhbHNlCglsb2NhbCBQb3NpdGlvbgoKCWlmIHNlbGYuVGFyZ2V0c0Rhc2hpbmdbdW5pdC5uZXR3b3JrSURdIHRoZW4KCQlsb2NhbCBkYXNoID0gc2VsZi5UYXJnZXRzRGFzaGluZ1t1bml0Lm5ldHdvcmtJRF0KCQlpZiBkYXNoLmVuZFQgPj0gc2VsZjpHZXRUaW1lKCkgdGhlbgoJCQlUYXJnZXREYXNoaW5nID0gdHJ1ZQoJCQlpZiBkYXNoLmlzYmxpbmsgdGhlbgoJCQkJaWYgKGRhc2guZW5kVCAtIHNlbGY6R2V0VGltZSgpKSA8PSAoZGVsYXkgKyBHZXREaXN0YW5jZShmcm9tLCBkYXNoLmVuZFBvcykvc3BlZWQpIHRoZW4KCQkJCQlQb3NpdGlvbiA9IFZlY3RvcihkYXNoLmVuZFBvcy54LCAwLCBkYXNoLmVuZFBvcy56KQoJCQkJCUNhbkhpdCA9ICh1bml0Lm1zICogKGRlbGF5ICsgR2V0RGlzdGFuY2UoZnJvbSwgZGFzaC5lbmRQb3MpL3NwZWVkIC0gKGRhc2guZW5kVDIgLSBzZWxmOkdldFRpbWUoKSkpKSA8IHJhZGl1cwoJCQkJZW5kCgoJCQkJaWYgKChkYXNoLmVuZFQgLSBzZWxmOkdldFRpbWUoKSkgPj0gKGRlbGF5ICsgR2V0RGlzdGFuY2UoZnJvbSwgZGFzaC5zdGFydFBvcykvc3BlZWQpKSBhbmQgbm90IENhbkhpdCB0aGVuCgkJCQkJUG9zaXRpb24gPSBWZWN0b3IoZGFzaC5zdGFydFBvcy54LCAwLCBkYXNoLnN0YXJ0UG9zLnopCgkJCQkJQ2FuSGl0ID0gdHJ1ZQoJCQkJZW5kCgkJCQkKCQkJZWxzZQoJCQkJbG9jYWwgdDEsIHAxLCB0MiwgcDIsIGRpc3QgPSBWZWN0b3JNb3ZlbWVudENvbGxpc2lvbihkYXNoLnN0YXJ0UG9zLCBkYXNoLmVuZFBvcywgZGFzaC5zcGVlZCwgZnJvbSwgc3BlZWQsIChzZWxmOkdldFRpbWUoKSAtIGRhc2guc3RhcnRUKSArIGRlbGF5KQoJCQkJdDEsIHQyID0gKHQxIGFuZCAwIDw9IHQxIGFuZCB0MSA8PSAoZGFzaC5lbmRUIC0gc2VsZjpHZXRUaW1lKCkgLSBkZWxheSkpIGFuZCB0MSBvciBuaWwsICh0MiBhbmQgMCA8PSB0MiBhbmQgdDIgPD0gIChkYXNoLmVuZFQgLSBzZWxmOkdldFRpbWUoKSAtIGRlbGF5KSkgYW5kIHQyIG9yIG5pbCAKCQkJCWxvY2FsIHQgPSB0MSBhbmQgdDIgYW5kIG1hdGgubWluKHQxLHQyKSBvciB0MSBvciB0MgoJCQkJaWYgdCB0aGVuCgkJCQkJUG9zaXRpb24gPSB0PT10MSBhbmQgVmVjdG9yKHAxLngsIDAsIHAxLnkpIG9yIFZlY3RvcihwMi54LCAwLCBwMi55KQoJCQkJCUNhbkhpdCA9IHRydWUKCQkJCWVsc2UKCQkJCQlQb3NpdGlvbiA9IFZlY3RvcihkYXNoLmVuZFBvcy54LCAwLCBkYXNoLmVuZFBvcy56KQoJCQkJCUNhbkhpdCA9ICh1bml0Lm1zICogKGRlbGF5ICsgR2V0RGlzdGFuY2UoZnJvbSwgUG9zaXRpb24pL3NwZWVkIC0gKGRhc2guZW5kVCAtIHNlbGY6R2V0VGltZSgpKSkpIDwgcmFkaXVzCgkJCQllbmQKCQkJZW5kCgkJZW5kCgllbmQKCXJldHVybiBUYXJnZXREYXNoaW5nLCBDYW5IaXQsIFBvc2l0aW9uCmVuZAoKZnVuY3Rpb24gVlByZWRpY3Rpb246R2V0V2F5cG9pbnRzKE5ldHdvcmtJRCwgZnJvbSwgdG8pCglsb2NhbCBSZXN1bHQgPSB7fQoJdG8gPSB0byBhbmQgdG8gb3Igc2VsZjpHZXRUaW1lKCkKCWlmIHNlbGYuVGFyZ2V0c1dheXBvaW50c1tOZXR3b3JrSURdIHRoZW4KCQlmb3IgaSwgd2F5cG9pbnQgaW4gaXBhaXJzKHNlbGYuVGFyZ2V0c1dheXBvaW50c1tOZXR3b3JrSURdKSBkbwoJCQlpZiBmcm9tIDw9IHdheXBvaW50LnRpbWUgIGFuZCB0byA+PSB3YXlwb2ludC50aW1lIHRoZW4KCQkJCXRhYmxlLmluc2VydChSZXN1bHQsIHdheXBvaW50KQoJCQllbmQKCQllbmQKCWVuZAoJcmV0dXJuIFJlc3VsdCwgI1Jlc3VsdAplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkNvdW50V2F5cG9pbnRzKE5ldHdvcmtJRCwgZnJvbSwgdG8pCglsb2NhbCBSLCBOID0gc2VsZjpHZXRXYXlwb2ludHMoTmV0d29ya0lELCBmcm9tLCB0bykKCXJldHVybiBOCmVuZAoKZnVuY3Rpb24gVlByZWRpY3Rpb246R2V0V2F5cG9pbnRzTGVuZ3RoKFdheXBvaW50cykKCWxvY2FsIHJlc3VsdCA9IDAKCWZvciBpID0gMSwgI1dheXBvaW50cyAtMSBkbwoJCXJlc3VsdCA9IHJlc3VsdCArIEdldERpc3RhbmNlKFdheXBvaW50c1tpXSwgV2F5cG9pbnRzW2kgKyAxXSkKCWVuZAoJcmV0dXJuIHJlc3VsdAplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkN1dFdheXBvaW50cyhXYXlwb2ludHMsIGRpc3RhbmNlKQoJbG9jYWwgcmVzdWx0ID0ge30KCWxvY2FsIHJlbWFpbmluZyA9IGRpc3RhbmNlCglpZiBkaXN0YW5jZSA+IDAgdGhlbgoJCWZvciBpID0gMSwgI1dheXBvaW50cyAtMSBkbwoJCQlsb2NhbCBBLCBCID0gV2F5cG9pbnRzW2ldLCBXYXlwb2ludHNbaSArIDFdCgkJCWxvY2FsIGRpc3QgPSBHZXREaXN0YW5jZShBLCBCKQoJCQlpZiBkaXN0ID49IHJlbWFpbmluZyB0aGVuCgkJCQlyZXN1bHRbMV0gPSBWZWN0b3IoQSkgKyByZW1haW5pbmcgKiAoVmVjdG9yKEIpIC0gVmVjdG9yKEEpKTpub3JtYWxpemVkKCkKCgkJCQlmb3IgaiA9IGkgKyAxLCAjV2F5cG9pbnRzIGRvCgkJCQkJcmVzdWx0W2ogLSBpICsgMV0gPSBXYXlwb2ludHNbal0KCQkJCWVuZAoJCQkJcmVtYWluaW5nID0gMAoJCQkJYnJlYWsKCQkJZWxzZQoJCQkJcmVtYWluaW5nID0gcmVtYWluaW5nIC0gZGlzdAoJCQllbmQKCQllbmQKCWVsc2UKCQlsb2NhbCBBLCBCID0gV2F5cG9pbnRzWzFdLCBXYXlwb2ludHNbMl0KCQlyZXN1bHQgPSBXYXlwb2ludHMKCQlyZXN1bHRbMV0gPSBWZWN0b3IoQSkgLSBkaXN0YW5jZSAqIChWZWN0b3IoQikgLSBWZWN0b3IoQSkpOm5vcm1hbGl6ZWQoKQoJZW5kCgoJcmV0dXJuIHJlc3VsdAplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkdldEN1cnJlbnRXYXlQb2ludHMob2JqZWN0KQoJbG9jYWwgcmVzdWx0ID0ge30KCglpZiBub3QgVklQX1VTRVIgdGhlbgoJCWlmIG9iamVjdC5oYXNNb3ZlUGF0aCB0aGVuCgkJCXRhYmxlLmluc2VydChyZXN1bHQsIFZlY3RvcihvYmplY3QudmlzaW9uUG9zLngsIG9iamVjdC52aXNpb25Qb3MueikpCgkJCWZvciBpID0gb2JqZWN0LnBhdGhJbmRleCwgb2JqZWN0LnBhdGhDb3VudCBkbwoJCQkJcGF0aCA9IG9iamVjdDpHZXRQYXRoKGkpCgkJCQl0YWJsZS5pbnNlcnQocmVzdWx0LCBWZWN0b3IocGF0aC54LCBwYXRoLnopKQoJCQllbmQKCQllbHNlCgkJCXRhYmxlLmluc2VydChyZXN1bHQsIG9iamVjdC52aXNpb25Qb3MgYW5kIFZlY3RvcihvYmplY3QudmlzaW9uUG9zLngsIG9iamVjdC52aXNpb25Qb3Mueikgb3IgVmVjdG9yKG9iamVjdC54LCBvYmplY3QueikpCgkJZW5kCgkJcmV0dXJuIHJlc3VsdAoJZWxzZQoJCWxvY2FsIHdheVBvaW50cywgbGluZVNlZ21lbnQsIGRpc3RhbmNlU3FyLCBmUG9pbnQgPSBXYXlQb2ludE1hbmFnZXI6R2V0UmF3V2F5UG9pbnRzKG9iamVjdCksIDAsIG1hdGguaHVnZSwgbmlsCgkJaWYgbm90IHdheVBvaW50cyBhbmQgbm90IG9iamVjdC52aXNpb25Qb3MgdGhlbgoJCQlyZXR1cm4geyB7IHggPSBvYmplY3QueCwgeSA9IG9iamVjdC56IH0gfQoJCWVsc2VpZiBub3Qgd2F5UG9pbnRzIGFuZCBvYmplY3QudmlzaW9uUG9zIHRoZW4KCQkJcmV0dXJuIHsgeyB4ID0gb2JqZWN0LnZpc2lvblBvcy54LCB5ID0gb2JqZWN0LnZpc2lvblBvcy56IH0gfQoJCWVuZAoJCWZvciBpID0gMSwgI3dheVBvaW50cyAtIDEgZG8KCQkJbG9jYWwgcDEsIHRtcDEsIHRtcDIgPSBWZWN0b3JQb2ludFByb2plY3Rpb25PbkxpbmVTZWdtZW50KHdheVBvaW50c1tpXSwgd2F5UG9pbnRzW2kgKyAxXSwgVmVjdG9yKG9iamVjdC52aXNpb25Qb3MpKQoJCQlsb2NhbCBkaXN0YW5jZVNlZ21lbnRTcXIgPSBHZXREaXN0YW5jZVNxcihwMSwgb2JqZWN0LnZpc2lvblBvcykKCQkJaWYgZGlzdGFuY2VTZWdtZW50U3FyIDw9IGRpc3RhbmNlU3FyIHRoZW4KCQkJCWZQb2ludCA9IHAxCgkJCQlsaW5lU2VnbWVudCA9IGkKCQkJCWRpc3RhbmNlU3FyID0gZGlzdGFuY2VTZWdtZW50U3FyCgkJCWVsc2UKCQkJCWJyZWFrIC0tbm90IG5lY2Vzc2FyeSwgYnV0IG1ha2VzIGl0IGZhc3RlcgoJCQllbmQKCQllbmQKCQlsb2NhbCByZXN1bHQgPSB7IGZQb2ludCBvciB7IHggPSBvYmplY3QudmlzaW9uUG9zLngsIHkgPSBvYmplY3QudmlzaW9uUG9zLnogfSB9CgkJZm9yIGkgPSBsaW5lU2VnbWVudCArIDEsICN3YXlQb2ludHMgZG8KCQkJcmVzdWx0WyNyZXN1bHQgKyAxXSA9IHdheVBvaW50c1tpXQoJCWVuZAoJCWlmICNyZXN1bHQgPT0gMiBhbmQgR2V0RGlzdGFuY2VTcXIocmVzdWx0WzFdLCByZXN1bHRbMl0pIDwgNDAwIHRoZW4gcmVzdWx0WzJdID0gbmlsIGVuZAoJCXJldHVybiByZXN1bHQKCWVuZAoJCmVuZAoKCgotLVtbQ2FsY3VsYXRlIHRoZSBoZXJvIHBvc2l0aW9uIGJhc2VkIG9uIHRoZSBsYXN0IHdheXBvaW50c11dCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkNhbGN1bGF0ZVRhcmdldFBvc2l0aW9uKHVuaXQsIGRlbGF5LCByYWRpdXMsIHNwZWVkLCBmcm9tLCBzcGVsbHR5cGUpCglsb2NhbCBXYXlwb2ludHMgPSB7fQoJbG9jYWwgUG9zaXRpb24sIENhc3RQb3NpdGlvbiA9IFZlY3Rvcih1bml0LnZpc2lvblBvcyksIFZlY3Rvcih1bml0LnZpc2lvblBvcykKCWxvY2FsIHQKCglXYXlwb2ludHMgPSBzZWxmOkdldEN1cnJlbnRXYXlQb2ludHModW5pdCkKCWxvY2FsIFdheXBvaW50c2xlbmd0aCA9IHNlbGY6R2V0V2F5cG9pbnRzTGVuZ3RoKFdheXBvaW50cykKCglpZiAjV2F5cG9pbnRzID09IDEgdGhlbgoJCVBvc2l0aW9uLCBDYXN0UG9zaXRpb24gPSBWZWN0b3IoV2F5cG9pbnRzWzFdLngsIDAsIFdheXBvaW50c1sxXS55KSwgVmVjdG9yKFdheXBvaW50c1sxXS54LCAwLCBXYXlwb2ludHNbMV0ueSkKCQlyZXR1cm4gUG9zaXRpb24sIENhc3RQb3NpdGlvbgoJZWxzZWlmIChXYXlwb2ludHNsZW5ndGggLSBkZWxheSAqIHVuaXQubXMgKyByYWRpdXMpID49IDAgdGhlbgoJCWxvY2FsIHRBID0gMAoJCVdheXBvaW50cyA9IHNlbGY6Q3V0V2F5cG9pbnRzKFdheXBvaW50cywgZGVsYXkgKiB1bml0Lm1zIC0gcmFkaXVzKQoKCQlpZiBzcGVlZCB+PSBtYXRoLmh1Z2UgdGhlbgoJCQlmb3IgaSA9IDEsICNXYXlwb2ludHMgLSAxIGRvCgkJCQlsb2NhbCBBLCBCID0gV2F5cG9pbnRzW2ldLCBXYXlwb2ludHNbaSsxXQoJCQkJaWYgaSA9PSAjV2F5cG9pbnRzIC0gMSB0aGVuCgkJCQkJQiA9IFZlY3RvcihCKSArIHJhZGl1cyAqIFZlY3RvcihCIC0gQSk6bm9ybWFsaXplZCgpCgkJCQllbmQKCQkJCWxvY2FsIHQxLCBwMSwgdDIsIHAyLCBEID0gVmVjdG9yTW92ZW1lbnRDb2xsaXNpb24oQSwgQiwgdW5pdC5tcywgVmVjdG9yKGZyb20ueCwgZnJvbS56KSwgc3BlZWQpCgkJCQlsb2NhbCB0QiA9IHRBICsgRCAvIHVuaXQubXMKCQkJCXQxLCB0MiA9ICh0MSBhbmQgdEEgPD0gdDEgYW5kIHQxIDw9ICh0QiAtIHRBKSkgYW5kIHQxIG9yIG5pbCwgKHQyIGFuZCB0QSA8PSB0MiBhbmQgdDIgPD0gKHRCIC0gdEEpKSBhbmQgdDIgb3IgbmlsCgkJCQl0ID0gdDEgYW5kIHQyIGFuZCBtYXRoLm1pbih0MSwgdDIpIG9yIHQxIG9yIHQyCgkJCQlpZiB0IHRoZW4KCQkJCQlDYXN0UG9zaXRpb24gPSB0PT10MSBhbmQgVmVjdG9yKHAxLngsIDAsIHAxLnkpIG9yIFZlY3RvcihwMi54LCAwLCBwMi55KQoJCQkJCWJyZWFrCgkJCQllbmQKCQkJCXRBID0gdEIKCQkJZW5kCgkJZWxzZQoJCQl0ID0gMAoJCQlDYXN0UG9zaXRpb24gPSBWZWN0b3IoV2F5cG9pbnRzWzFdLngsIDAsIFdheXBvaW50c1sxXS55KQoJCWVuZAoKCQlpZiB0IHRoZW4KCQkJaWYgKHNlbGY6R2V0V2F5cG9pbnRzTGVuZ3RoKFdheXBvaW50cykgLSB0ICogdW5pdC5tcyAtIHJhZGl1cykgPj0gMCB0aGVuCgkJCQlXYXlwb2ludHMgPSBzZWxmOkN1dFdheXBvaW50cyhXYXlwb2ludHMsIHJhZGl1cyArIHQgKiB1bml0Lm1zKQoJCQkJUG9zaXRpb24gPSBWZWN0b3IoV2F5cG9pbnRzWzFdLngsIDAsIFdheXBvaW50c1sxXS55KQoJCQllbHNlCgkJCQlQb3NpdGlvbiA9IENhc3RQb3NpdGlvbgoJCQllbmQKCQllbHNlaWYgdW5pdC50eXBlIH49IG15SGVyby50eXBlIHRoZW4KCQkJQ2FzdFBvc2l0aW9uID0gVmVjdG9yKFdheXBvaW50c1sjV2F5cG9pbnRzXS54LCAwLCBXYXlwb2ludHNbI1dheXBvaW50c10ueSkKCQkJUG9zaXRpb24gPSBDYXN0UG9zaXRpb24KCQllbmQKCgllbHNlaWYgdW5pdC50eXBlIH49IG15SGVyby50eXBlIHRoZW4KCQlDYXN0UG9zaXRpb24gPSBWZWN0b3IoV2F5cG9pbnRzWyNXYXlwb2ludHNdLngsIDAsIFdheXBvaW50c1sjV2F5cG9pbnRzXS55KQoJCVBvc2l0aW9uID0gQ2FzdFBvc2l0aW9uCgllbmQKCglpZiB0IGFuZCBzZWxmOmlzU2xvd2VkKHVuaXQsIDAsIG1hdGguaHVnZSwgZnJvbSkgYW5kIG5vdCBzZWxmOmlzU2xvd2VkKHVuaXQsIHQsIG1hdGguaHVnZSwgZnJvbSkgYW5kIFBvc2l0aW9uIHRoZW4KCQlDYXN0UG9zaXRpb24gPSBQb3NpdGlvbgoJZW5kCgoJcmV0dXJuIFBvc2l0aW9uLCBDYXN0UG9zaXRpb24KZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpNYXhBbmdsZSh1bml0LCBjdXJyZW50d2F5cG9pbnQsIGZyb20pCglsb2NhbCBXUHRhYmxlLCBuID0gc2VsZjpHZXRXYXlwb2ludHModW5pdC5uZXR3b3JrSUQsIGZyb20pCglsb2NhbCBNYXggPSAwCglsb2NhbCBDViA9IChWZWN0b3IoY3VycmVudHdheXBvaW50LngsIDAsIGN1cnJlbnR3YXlwb2ludC55KSAtIFZlY3Rvcih1bml0KSkKCQlmb3IgaSwgd2F5cG9pbnQgaW4gaXBhaXJzKFdQdGFibGUpIGRvCgkJCQlsb2NhbCBhbmdsZSA9IFZlY3RvcigwLCAwLCAwKTphbmdsZUJldHdlZW4oQ1YsIFZlY3Rvcih3YXlwb2ludC53YXlwb2ludC54LCAwLCB3YXlwb2ludC53YXlwb2ludC55KSAtIFZlY3Rvcih3YXlwb2ludC51bml0cG9zLngsIDAsIHdheXBvaW50LnVuaXRwb3MueSkpCgkJCQlpZiBhbmdsZSA+IE1heCB0aGVuCgkJCQkJTWF4ID0gYW5nbGUKCQkJCWVuZAoJCWVuZAoJcmV0dXJuIE1heAplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOldheVBvaW50QW5hbHlzaXModW5pdCwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tLCBzcGVsbHR5cGUpCglsb2NhbCBQb3NpdGlvbiwgQ2FzdFBvc2l0aW9uLCBIaXRDaGFuY2UKCWxvY2FsIFNhdmVkV2F5UG9pbnRzID0gc2VsZi5UYXJnZXRzV2F5cG9pbnRzW3VuaXQubmV0d29ya0lEXSBhbmQgc2VsZi5UYXJnZXRzV2F5cG9pbnRzW3VuaXQubmV0d29ya0lEXSBvciB7fQoJbG9jYWwgQ3VycmVudFdheVBvaW50cyA9IHNlbGY6R2V0Q3VycmVudFdheVBvaW50cyh1bml0KQoJbG9jYWwgVmlzaWJsZVNpbmNlID0gc2VsZi5UYXJnZXRzVmlzaWJsZVt1bml0Lm5ldHdvcmtJRF0gYW5kIHNlbGYuVGFyZ2V0c1Zpc2libGVbdW5pdC5uZXR3b3JrSURdIG9yIHNlbGY6R2V0VGltZSgpCgkKCUhpdENoYW5jZSA9IDEKCVBvc2l0aW9uLCBDYXN0UG9zaXRpb24gPSBzZWxmOkNhbGN1bGF0ZVRhcmdldFBvc2l0aW9uKHVuaXQsIGRlbGF5LCByYWRpdXMsIHNwZWVkLCBmcm9tLCBzcGVsbHR5cGUpCgoJaWYgc2VsZjpDb3VudFdheXBvaW50cyh1bml0Lm5ldHdvcmtJRCwgc2VsZjpHZXRUaW1lKCkgLSAwLjEpID49IDEgb3Igc2VsZjpDb3VudFdheXBvaW50cyh1bml0Lm5ldHdvcmtJRCwgc2VsZjpHZXRUaW1lKCkgLSAxKSA9PSAxIHRoZW4KCQlIaXRDaGFuY2UgPSAyCgllbmQKCQoJbG9jYWwgTiA9IChfRy5WUHJlZGljdGlvbk1lbnUuTW9kZSA9PSBfU0xPVykgYW5kIDMgb3IgMgoJbG9jYWwgdDEgPSAoX0cuVlByZWRpY3Rpb25NZW51Lk1vZGUgPT0gX1NMT1cpIGFuZCAxIG9yIDAuNQoJaWYgc2VsZjpDb3VudFdheXBvaW50cyh1bml0Lm5ldHdvcmtJRCwgc2VsZjpHZXRUaW1lKCkgLSAwLjc1KSA+PSBOIHRoZW4KCQlsb2NhbCBhbmdsZSA9IHNlbGY6TWF4QW5nbGUodW5pdCwgQ3VycmVudFdheVBvaW50c1sjQ3VycmVudFdheVBvaW50c10sIHNlbGY6R2V0VGltZSgpIC0gdDEpCgkJaWYgYW5nbGUgPiA5MCB0aGVuCgkJCUhpdENoYW5jZSA9IDEKCQllbHNlaWYgYW5nbGUgPCAzMCBhbmQgc2VsZjpDb3VudFdheXBvaW50cyh1bml0Lm5ldHdvcmtJRCwgc2VsZjpHZXRUaW1lKCkgLSAwLjEpID49IDEgdGhlbgoJCQlIaXRDaGFuY2UgPSAyCgkJZW5kCgllbmQKCQoJTiA9IChfRy5WUHJlZGljdGlvbk1lbnUuTW9kZSA9PSBfU0xPVykgYW5kIDIgb3IgMQoJaWYgc2VsZjpDb3VudFdheXBvaW50cyh1bml0Lm5ldHdvcmtJRCwgc2VsZjpHZXRUaW1lKCkgLSBOKSA9PSAwIHRoZW4KCQlIaXRDaGFuY2UgPSAyCgllbmQKCQoJaWYgX0cuVlByZWRpY3Rpb25NZW51Lk1vZGUgPT0gX0ZBU1QgdGhlbgoJCUhpdENoYW5jZSA9IDIKCWVuZAoJCglpZiAjQ3VycmVudFdheVBvaW50cyA8PSAxIGFuZCBzZWxmOkdldFRpbWUoKSAtIFZpc2libGVTaW5jZSA+IDEgdGhlbgoJCUhpdENoYW5jZSA9IDIKCWVuZAoJCglpZiBzZWxmOmlzU2xvd2VkKHVuaXQsIGRlbGF5LCBzcGVlZCwgZnJvbSkgdGhlbgoJCUhpdENoYW5jZSA9IDIKCWVuZAoKCWlmIFBvc2l0aW9uIGFuZCBDYXN0UG9zaXRpb24gYW5kICgocmFkaXVzIC8gdW5pdC5tcyA+PSBkZWxheSArIEdldERpc3RhbmNlKGZyb20sIENhc3RQb3NpdGlvbikvc3BlZWQpIG9yIChyYWRpdXMgLyB1bml0Lm1zID49IGRlbGF5ICsgR2V0RGlzdGFuY2UoZnJvbSwgUG9zaXRpb24pL3NwZWVkKSkgdGhlbgoJCUhpdENoYW5jZSA9IDMKCWVuZAoJCS0tW1tBbmdsZSB0b28gd2lkZV1dCglpZiBWZWN0b3IoZnJvbSk6YW5nbGVCZXR3ZWVuKFZlY3Rvcih1bml0LnZpc2lvblBvcyksIFZlY3RvcihDYXN0UG9zaXRpb24pKSA+IDYwIHRoZW4KCQlIaXRDaGFuY2UgPSAxCgllbmQKCQoJaWYgbm90IFBvc2l0aW9uIG9yIG5vdCBDYXN0UG9zaXRpb24gdGhlbgoJCUhpdENoYW5jZSA9IDAKCQlDYXN0UG9zaXRpb24gPSBWZWN0b3IoQ3VycmVudFdheVBvaW50c1sjQ3VycmVudFdheVBvaW50c10ueCwgMCwgQ3VycmVudFdheVBvaW50c1sjQ3VycmVudFdheVBvaW50c10ueSkKCQlQb3NpdGlvbiA9IENhc3RQb3NpdGlvbgoJZW5kCgoJaWYgR2V0RGlzdGFuY2UobXlIZXJvLnZpc2lvblBvcywgdW5pdC52aXNpb25Qb3MpIDwgMjUwIHRoZW4KCQlIaXRDaGFuY2UgPSAyCgkJUG9zaXRpb24sIENhc3RQb3NpdGlvbiA9IHNlbGY6Q2FsY3VsYXRlVGFyZ2V0UG9zaXRpb24odW5pdCwgZGVsYXkqMC41LCByYWRpdXMsIHNwZWVkKjIsIGZyb20sIHNwZWxsdHlwZSkKCQlQb3NpdGlvbiA9IENhc3RQb3NpdGlvbgoJZW5kCgoJaWYgI1NhdmVkV2F5UG9pbnRzID09IDAgYW5kIChzZWxmOkdldFRpbWUoKSAtIFZpc2libGVTaW5jZSkgPiAzIHRoZW4KCQlIaXRDaGFuY2UgPSAyCgllbmQKCglpZiBzZWxmLkRvbnRTaG9vdFVudGlsTmV3V2F5cG9pbnRzW3VuaXQubmV0d29ya0lEXSB0aGVuCgkJSGl0Q2hhbmNlID0gMAoJCUNhc3RQb3NpdGlvbiA9IFZlY3Rvcih1bml0LnZpc2lvblBvcy54LCAwLCB1bml0LnZpc2lvblBvcy56KQoJCVBvc2l0aW9uID0gQ2FzdFBvc2l0aW9uCgllbmQKCglyZXR1cm4gQ2FzdFBvc2l0aW9uLCBIaXRDaGFuY2UsIFBvc2l0aW9uCmVuZAoKZnVuY3Rpb24gVlByZWRpY3Rpb246R2V0QmVzdENhc3RQb3NpdGlvbih1bml0LCBkZWxheSwgcmFkaXVzLCByYW5nZSwgc3BlZWQsIGZyb20sIGNvbGxpc2lvbiwgc3BlbGx0eXBlKQoJYXNzZXJ0KHVuaXQsICJWUHJlZGljdGlvbjogVGFyZ2V0IGNhbid0IGJlIG5pbCIpCgkKCXJhbmdlID0gcmFuZ2UgYW5kIHJhbmdlIC0gNCBvciBtYXRoLmh1Z2UKCXJhZGl1cyA9IHJhZGl1cyA9PSAwIGFuZCAxIG9yIChyYWRpdXMgKyBzZWxmOkdldEhpdEJveCh1bml0KSkgLSA0CglzcGVlZCA9IHNwZWVkIGFuZCBzcGVlZCBvciBtYXRoLmh1Z2UKCWZyb20gPSBmcm9tIGFuZCBmcm9tIG9yIFZlY3RvcihteUhlcm8udmlzaW9uUG9zKQoJaWYgZnJvbS5uZXR3b3JrSUQgYW5kIGZyb20ubmV0d29ya0lEID09IG15SGVyby5uZXR3b3JrSUQgdGhlbgoJCWZyb20gPSBWZWN0b3IobXlIZXJvLnZpc2lvblBvcykKCWVuZAoJbG9jYWwgSXNGcm9tTXlIZXJvID0gR2V0RGlzdGFuY2VTcXIoZnJvbSwgbXlIZXJvLnZpc2lvblBvcykgPCA1MCo1MCBhbmQgdHJ1ZSBvciBmYWxzZQoKCWRlbGF5ID0gZGVsYXkgKyAoMC4wNyArIEdldExhdGVuY3koKSAvIDIwMDApCgkKCWxvY2FsIFBvc2l0aW9uLCBDYXN0UG9zaXRpb24sIEhpdENoYW5jZSA9IFZlY3Rvcih1bml0LnZpc2lvblBvcyksIFZlY3Rvcih1bml0LnZpc2lvblBvcyksIDAKCWxvY2FsIFRhcmdldERhc2hpbmcsIENhbkhpdERhc2hpbmcsIERhc2hQb3NpdGlvbiA9IHNlbGY6SXNEYXNoaW5nKHVuaXQsIGRlbGF5LCByYWRpdXMsIHNwZWVkLCBmcm9tKQoJbG9jYWwgVGFyZ2V0SW1tb2JpbGUsIEltbW9iaWxlUG9zLCBJbW1vYmlsZUNhc3RQb3NpdGlvbiA9IHNlbGY6SXNJbW1vYmlsZSh1bml0LCBkZWxheSwgcmFkaXVzLCBzcGVlZCwgZnJvbSwgc3BlbGx0eXBlKQoJbG9jYWwgVmlzaWJsZVNpbmNlID0gc2VsZi5UYXJnZXRzVmlzaWJsZVt1bml0Lm5ldHdvcmtJRF0gYW5kIHNlbGYuVGFyZ2V0c1Zpc2libGVbdW5pdC5uZXR3b3JrSURdIG9yIHNlbGY6R2V0VGltZSgpCgoJaWYgdW5pdC50eXBlIH49IG15SGVyby50eXBlIHRoZW4KCQlQb3NpdGlvbiwgQ2FzdFBvc2l0aW9uID0gc2VsZjpDYWxjdWxhdGVUYXJnZXRQb3NpdGlvbih1bml0LCBkZWxheSwgcmFkaXVzLCBzcGVlZCwgZnJvbSwgc3BlbGx0eXBlKQoJCUhpdENoYW5jZSA9IDIKCWVsc2UKCQlpZiBzZWxmLkRvbnRTaG9vdFt1bml0Lm5ldHdvcmtJRF0gYW5kIHNlbGYuRG9udFNob290W3VuaXQubmV0d29ya0lEXSA+IHNlbGY6R2V0VGltZSgpIHRoZW4KCQkJUG9zaXRpb24sIENhc3RQb3NpdGlvbiA9IFZlY3Rvcih1bml0LnZpc2lvblBvcy54LCB1bml0LnZpc2lvblBvcy55LCB1bml0LnZpc2lvblBvcy56KSwgIFZlY3Rvcih1bml0LnZpc2lvblBvcy54LCB1bml0LnZpc2lvblBvcy55LCB1bml0LnZpc2lvblBvcy56KQoJCQlIaXRDaGFuY2UgPSAwCgkJZWxzZWlmIFRhcmdldERhc2hpbmcgdGhlbgoJCQlpZiBDYW5IaXREYXNoaW5nIHRoZW4KCQkJCUhpdENoYW5jZSA9IDUKCQkJZWxzZQoJCQkJSGl0Q2hhbmNlID0gMAoJCQllbmQgCgkJCVBvc2l0aW9uLCBDYXN0UG9zaXRpb24gPSBEYXNoUG9zaXRpb24sIERhc2hQb3NpdGlvbgoJCWVsc2VpZiBzZWxmLkRvbnRTaG9vdDJbdW5pdC5uZXR3b3JrSURdIGFuZCBzZWxmLkRvbnRTaG9vdDJbdW5pdC5uZXR3b3JrSURdID4gc2VsZjpHZXRUaW1lKCkgdGhlbgoJCQlQb3NpdGlvbiwgQ2FzdFBvc2l0aW9uID0gVmVjdG9yKHVuaXQudmlzaW9uUG9zLngsIHVuaXQudmlzaW9uUG9zLnksIHVuaXQudmlzaW9uUG9zLnopLCAgVmVjdG9yKHVuaXQudmlzaW9uUG9zLngsIHVuaXQudmlzaW9uUG9zLnksIHVuaXQudmlzaW9uUG9zLnopCgkJCUhpdENoYW5jZSA9IDcKCQllbHNlaWYgVGFyZ2V0SW1tb2JpbGUgdGhlbgoJCQlQb3NpdGlvbiwgQ2FzdFBvc2l0aW9uID0gSW1tb2JpbGVQb3MsIEltbW9iaWxlQ2FzdFBvc2l0aW9uCgkJCUhpdENoYW5jZSA9IDQKCQllbHNlaWYgbm90IHNlbGYuRG9udFVzZVdheVBvaW50cyB0aGVuCgkJCUNhc3RQb3NpdGlvbiwgSGl0Q2hhbmNlLCBQb3NpdGlvbiA9IHNlbGY6V2F5UG9pbnRBbmFseXNpcyh1bml0LCBkZWxheSwgcmFkaXVzLCByYW5nZSwgc3BlZWQsIGZyb20sIHNwZWxsdHlwZSkKCQllbmQKCWVuZAoKCS0tW1tPdXQgb2YgcmFuZ2VdXQoJaWYgSXNGcm9tTXlIZXJvIHRoZW4KCQlpZiAoc3BlbGx0eXBlID09ICJsaW5lIiBhbmQgR2V0RGlzdGFuY2VTcXIoZnJvbSwgUG9zaXRpb24pID49IHJhbmdlICogcmFuZ2UpIHRoZW4KCQkJSGl0Q2hhbmNlID0gMAoJCWVuZAoJCWlmIChzcGVsbHR5cGUgPT0gImNpcmN1bGFyIiBhbmQgKEdldERpc3RhbmNlU3FyKGZyb20sIFBvc2l0aW9uKSA+PSAocmFuZ2UgKyByYWRpdXMpXjIpKSB0aGVuCgkJCUhpdENoYW5jZSA9IDAKCQllbmQKCgkJaWYgc2VsZi5TaG90QXRNYXhSYW5nZSBhbmQgSGl0Q2hhbmNlIH49IDAgYW5kIHNwZWxsdHlwZSA9PSAiY2lyY3VsYXIiIGFuZCAoR2V0RGlzdGFuY2VTcXIoZnJvbSwgQ2FzdFBvc2l0aW9uKSA+IHJhbmdlIF4gMikgdGhlbgoJCQlpZiBHZXREaXN0YW5jZVNxcihmcm9tLCBQb3NpdGlvbikgPD0gKHJhbmdlICsgcmFkaXVzIC8gMS40KSBeIDIgdGhlbgoJCQkJaWYgR2V0RGlzdGFuY2VTcXIoZnJvbSwgUG9zaXRpb24pIDw9IHJhbmdlICogcmFuZ2UgdGhlbgoJCQkJCUNhc3RQb3NpdGlvbiA9IFBvc2l0aW9uCgkJCQllbHNlCgkJCQkJQ2FzdFBvc2l0aW9uID0gVmVjdG9yKGZyb20pICsgcmFuZ2UgKiAoVmVjdG9yKFBvc2l0aW9uKSAtIFZlY3Rvcihmcm9tKSk6bm9ybWFsaXplZCgpCgkJCQllbmQKCQkJZW5kCgkJZWxzZWlmIChHZXREaXN0YW5jZVNxcihmcm9tLCBDYXN0UG9zaXRpb24pID4gcmFuZ2UgXiAyKSB0aGVuCgkJCUhpdENoYW5jZSA9IDAKCQllbmQKCWVuZAoKCXJhZGl1cyA9IHJhZGl1cyAtIHNlbGY6R2V0SGl0Qm94KHVuaXQpICsgNAoKCWlmIGNvbGxpc2lvbiBhbmQgSGl0Q2hhbmNlID4gMCB0aGVuCgkJc2VsZi5FbmVteU1pbmlvbnMucmFuZ2UgPSByYW5nZSArIDUwMCAqIChkZWxheSArIHJhbmdlL3NwZWVkKQoJCXNlbGYuSnVuZ2xlTWluaW9ucy5yYW5nZSA9IHNlbGYuRW5lbXlNaW5pb25zLnJhbmdlCgkJc2VsZi5PdGhlck1pbmlvbnMucmFuZ2UgPSBzZWxmLkVuZW15TWluaW9ucy5yYW5nZQoJCXNlbGYuRW5lbXlNaW5pb25zOnVwZGF0ZSgpCgkJc2VsZi5KdW5nbGVNaW5pb25zOnVwZGF0ZSgpCgkJc2VsZi5PdGhlck1pbmlvbnM6dXBkYXRlKCkKCgkJaWYgY29sbGlzaW9uIGFuZCBfRy5WUHJlZGljdGlvbk1lbnUuQ29sbGlzaW9uLlVuaXRQb3MgYW5kIHNlbGY6Q2hlY2tNaW5pb25Db2xsaXNpb24odW5pdCwgdW5pdCwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tKSB0aGVuCgkJCUhpdENoYW5jZSA9IC0xCgkJZWxzZWlmIF9HLlZQcmVkaWN0aW9uTWVudS5Db2xsaXNpb24uUHJlZGljdFBvcyBhbmQgc2VsZjpDaGVja01pbmlvbkNvbGxpc2lvbih1bml0LCBQb3NpdGlvbiwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tKSB0aGVuCgkJCUhpdENoYW5jZSA9IC0xCgkJZWxzZWlmIF9HLlZQcmVkaWN0aW9uTWVudS5Db2xsaXNpb24uQ2FzdFBvcyBhbmQgc2VsZjpDaGVja01pbmlvbkNvbGxpc2lvbih1bml0LCBDYXN0UG9zaXRpb24sIGRlbGF5LCByYWRpdXMsIHJhbmdlLCBzcGVlZCwgZnJvbSkgdGhlbgoJCQlIaXRDaGFuY2UgPSAtMQoJCWVuZAoJZW5kCglyZXR1cm4gQ2FzdFBvc2l0aW9uLCBIaXRDaGFuY2UsIFBvc2l0aW9uCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS1Db2xsaXNpb24KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkdldFByZWRpY3RlZEhlYWx0aCh1bml0LCB0aW1lLCBkZWxheSkKCWxvY2FsIEluY0RhbWFnZSA9IDAKCWxvY2FsIGkgPSAxCglsb2NhbCBNYXhEYW1hZ2UgPSAwCglsb2NhbCBjb3VudCA9IDAKCWRlbGF5ID0gZGVsYXkgYW5kIGRlbGF5IG9yIDAuMDcKCXdoaWxlIGkgPD0gI3NlbGYuQWN0aXZlQXR0YWNrcyBkbwoJCWlmIHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5BdHRhY2tlciBhbmQgbm90IHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5BdHRhY2tlci5kZWFkIGFuZCBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uVGFyZ2V0IGFuZCBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uVGFyZ2V0Lm5ldHdvcmtJRCA9PSB1bml0Lm5ldHdvcmtJRCB0aGVuCgkJCWxvY2FsIGhpdHRpbWUgPSBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uc3RhcnR0aW1lICsgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLndpbmRVcFRpbWUgKyAoR2V0RGlzdGFuY2Uoc2VsZi5BY3RpdmVBdHRhY2tzW2ldLnBvcywgdW5pdC52aXNpb25Qb3MpKSAvIHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5wcm9qZWN0aWxlc3BlZWQgKyBkZWxheQoJCQlpZiBzZWxmOkdldFRpbWUoKSA8IGhpdHRpbWUgLSBkZWxheSBhbmQgaGl0dGltZSA8IHNlbGY6R2V0VGltZSgpICsgdGltZSAgdGhlbgoJCQkJSW5jRGFtYWdlID0gSW5jRGFtYWdlICsgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLmRhbWFnZQoJCQkJY291bnQgPSBjb3VudCArIDEKCQkJCWlmIHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5kYW1hZ2UgPiBNYXhEYW1hZ2UgdGhlbgoJCQkJCU1heERhbWFnZSA9IHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5kYW1hZ2UKCQkJCWVuZAoJCQllbmQKCQllbmQKCQlpID0gaSArIDEKCWVuZAoKCXJldHVybiB1bml0LmhlYWx0aCAtIEluY0RhbWFnZSwgTWF4RGFtYWdlLCBjb3VudAplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkdldFByZWRpY3RlZEhlYWx0aDIodW5pdCwgdCkKCWxvY2FsIGRhbWFnZSA9IDAKCWxvY2FsIGkgPSAxCgoJd2hpbGUgaSA8PSAjc2VsZi5BY3RpdmVBdHRhY2tzIGRvCgkJbG9jYWwgbiA9IDAKCQlpZiAoc2VsZjpHZXRUaW1lKCkgLSAwLjEpIDw9IHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5zdGFydHRpbWUgKyBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uYW5pbWF0aW9uVGltZSBhbmQgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLlRhcmdldCBhbmQgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLlRhcmdldC52YWxpZCBhbmQgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLlRhcmdldC5uZXR3b3JrSUQgPT0gdW5pdC5uZXR3b3JrSUQgYW5kIHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5BdHRhY2tlciBhbmQgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLkF0dGFja2VyLnZhbGlkIGFuZCBub3Qgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLkF0dGFja2VyLmRlYWQgdGhlbgoJCQlsb2NhbCBGcm9tVCA9IHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5zdGFydHRpbWUKCQkJbG9jYWwgVG9UID0gdCArIHNlbGY6R2V0VGltZSgpCgoJCQl3aGlsZSBGcm9tVCA8IFRvVCBkbwoJCQkJaWYgRnJvbVQgPj0gc2VsZjpHZXRUaW1lKCkgYW5kIChGcm9tVCArIChzZWxmLkFjdGl2ZUF0dGFja3NbaV0ud2luZFVwVGltZSArIEdldERpc3RhbmNlKHVuaXQudmlzaW9uUG9zLCBzZWxmLkFjdGl2ZUF0dGFja3NbaV0ucG9zKSAvIHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5wcm9qZWN0aWxlc3BlZWQpKSA8IFRvVCB0aGVuCgkJCQkJbiA9IG4gKyAxCgkJCQllbmQKCQkJCUZyb21UID0gRnJvbVQgKyBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uYW5pbWF0aW9uVGltZQoJCQllbmQKCQllbmQKCQlkYW1hZ2UgPSBkYW1hZ2UgKyBuICogc2VsZi5BY3RpdmVBdHRhY2tzW2ldLmRhbWFnZQoJCWkgPSBpICsgMQoJZW5kCgoJcmV0dXJuIHVuaXQuaGVhbHRoIC0gZGFtYWdlCmVuZAoKZnVuY3Rpb24gVlByZWRpY3Rpb246Q29sbGlzaW9uUHJvY2Vzc1NwZWxsKHVuaXQsIHNwZWxsKQoJaWYgdW5pdCBhbmQgdW5pdC52YWxpZCBhbmQgc3BlbGwudGFyZ2V0IGFuZCB1bml0LnR5cGUgfj0gbXlIZXJvLnR5cGUgYW5kIHNwZWxsLnRhcmdldC50eXBlID09ICdvYmpfQUlfTWluaW9uJyBhbmQgdW5pdC50ZWFtID09IG15SGVyby50ZWFtIGFuZCBzcGVsbCBhbmQgc3BlbGwubmFtZSBhbmQgKHNwZWxsLm5hbWU6bG93ZXIoKTpmaW5kKCJhdHRhY2siKSBvciAoc3BlbGwubmFtZSA9PSAiZnJvc3RhcnJvdyIpKSBhbmQgc3BlbGwud2luZFVwVGltZSBhbmQgc3BlbGwudGFyZ2V0IHRoZW4KCQlpZiBHZXREaXN0YW5jZVNxcih1bml0KSA8IDQwMDAwMDAgdGhlbgoKCQkJbG9jYWwgdGltZSA9IHNlbGY6R2V0VGltZSgpICsgc3BlbGwud2luZFVwVGltZSArIEdldERpc3RhbmNlKHNwZWxsLnRhcmdldCwgdW5pdCkgLyBzZWxmOkdldFByb2plY3RpbGVTcGVlZCh1bml0KSAtIEdldExhdGVuY3koKS8yMDAwCgkJCWxvY2FsIGkgPSAxCgkJCXdoaWxlIGkgPD0gI3NlbGYuQWN0aXZlQXR0YWNrcyBkbwoJCQkJaWYgKHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5BdHRhY2tlciBhbmQgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLkF0dGFja2VyLnZhbGlkIGFuZCBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uQXR0YWNrZXIubmV0d29ya0lEID09IHVuaXQubmV0d29ya0lEKSBvciAoKHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5oaXR0aW1lICsgMykgPCBzZWxmOkdldFRpbWUoKSkgdGhlbgoJCQkJCXRhYmxlLnJlbW92ZShzZWxmLkFjdGl2ZUF0dGFja3MsIGkpCgkJCQllbHNlCgkJCQkJaSA9IGkgKyAxCgkJCQllbmQKCQkJZW5kCgoJCQl0YWJsZS5pbnNlcnQoc2VsZi5BY3RpdmVBdHRhY2tzLCB7QXR0YWNrZXIgPSB1bml0LCBwb3MgPSBWZWN0b3IodW5pdC52aXNpb25Qb3MpLCBUYXJnZXQgPSBzcGVsbC50YXJnZXQsIGFuaW1hdGlvblRpbWUgPSBzcGVsbC5hbmltYXRpb25UaW1lLCBkYW1hZ2UgPSBzZWxmOkNhbGNEYW1hZ2VPZkF0dGFjayh1bml0LCBzcGVsbC50YXJnZXQsIHNwZWxsLCAwKSwgaGl0dGltZT10aW1lLCBzdGFydHRpbWUgPSBzZWxmOkdldFRpbWUoKSAtIEdldExhdGVuY3koKS8yMDAwLCB3aW5kVXBUaW1lID0gc3BlbGwud2luZFVwVGltZSwgcHJvamVjdGlsZXNwZWVkID0gc2VsZjpHZXRQcm9qZWN0aWxlU3BlZWQodW5pdCl9KQoJCWVuZAoJZW5kCmVuZAoKZnVuY3Rpb24gVlByZWRpY3Rpb246Q2hlY2tDb2wodW5pdCwgbWluaW9uLCBQb3NpdGlvbiwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tLCBkcmF3KQoJaWYgdW5pdC5uZXR3b3JrSUQgPT0gbWluaW9uLm5ldHdvcmtJRCB0aGVuIAoJCXJldHVybiBmYWxzZQoJZW5kCgktLVtbQ2hlY2sgZmlyc3QgaWYgdGhlIG1pbmlvbiBpcyBnb2luZyB0byBiZSBkZWFkIHdoZW4gc2tpbGxzaG90cyByZWFjaGVzIGhpcyBwb3NpdGlvbl1dCglpZiBtaW5pb24udHlwZSB+PSBteUhlcm8udHlwZSBhbmQgX0cuVlByZWRpY3Rpb25NZW51LkNvbGxpc2lvbi5DSGVhbHRoIGFuZCBzZWxmOkdldFByZWRpY3RlZEhlYWx0aChtaW5pb24sICBkZWxheSAgKyBHZXREaXN0YW5jZShmcm9tLCBtaW5pb24udmlzaW9uUG9zKSAvIHNwZWVkIC0gR2V0TGF0ZW5jeSgpLzEwMDApIDwgMCB0aGVuCgkJcmV0dXJuIGZhbHNlCgllbmQKCglsb2NhbCB3YXlwb2ludHMgPSBzZWxmOkdldEN1cnJlbnRXYXlQb2ludHMobWluaW9uKQoJbG9jYWwgTVBvcywgQ2FzdFBvc2l0aW9uID0gI3dheXBvaW50cyA9PSAxIGFuZCBWZWN0b3IobWluaW9uLnZpc2lvblBvcykgb3Igc2VsZjpDYWxjdWxhdGVUYXJnZXRQb3NpdGlvbihtaW5pb24sIGRlbGF5LCByYWRpdXMsIHNwZWVkLCBmcm9tLCAibGluZSIpCglpZiBHZXREaXN0YW5jZVNxcihmcm9tLCBNUG9zKSA8PSAocmFuZ2UpXjIgYW5kIEdldERpc3RhbmNlU3FyKGZyb20sIG1pbmlvbikgPD0gKHJhbmdlICsgMTAwKV4yIHRoZW4KCQlsb2NhbCBidWZmZXIgPSAoI3dheXBvaW50cyA+IDEpIGFuZCBfRy5WUHJlZGljdGlvbk1lbnUuQ29sbGlzaW9uLkJ1ZmZlciBvciA4CgoJCWlmIG1pbmlvbi50eXBlID09IG15SGVyby50eXBlIHRoZW4KCQkJYnVmZmVyID0gYnVmZmVyICsgc2VsZjpHZXRIaXRCb3gobWluaW9uKQoJCWVuZAoKCQlpZiBkcmF3IHRoZW4KCQkJRHJhd0NpcmNsZTNEKG1pbmlvbi52aXNpb25Qb3MueCwgbXlIZXJvLnksIG1pbmlvbi52aXNpb25Qb3Mueiwgc2VsZjpHZXRIaXRCb3gobWluaW9uKSArIGJ1ZmZlciwgMSwgQVJHQigyNTUsIDI1NSwgMjU1LCAyNTUpKQoJCQlEcmF3Q2lyY2xlM0QoTVBvcy54LCBteUhlcm8ueSwgTVBvcy56LCBzZWxmOkdldEhpdEJveChtaW5pb24pICsgYnVmZmVyLCAxLCBBUkdCKDI1NSwgMjU1LCAyNTUsIDI1NSkpCgkJCXNlbGY6RExpbmUoTVBvcywgbWluaW9uLnZpc2lvblBvcywgQ29sb3IpCgkJZW5kCgkJCgkJaWYgI3dheXBvaW50cyA+IDEgdGhlbgoJCQlsb2NhbCBwcm9qMSwgcG9pbnRMaW5lLCBpc09uU2VnbWVudCA9IFZlY3RvclBvaW50UHJvamVjdGlvbk9uTGluZVNlZ21lbnQoZnJvbSwgUG9zaXRpb24sIFZlY3RvcihNUG9zKSkKCQkJaWYgaXNPblNlZ21lbnQgYW5kIChHZXREaXN0YW5jZVNxcihNUG9zLCBwcm9qMSkgPD0gKHNlbGY6R2V0SGl0Qm94KG1pbmlvbikgKyByYWRpdXMgKyBidWZmZXIpIF4gMikgdGhlbgoJCQkJcmV0dXJuIHRydWUKCQkJZW5kCgkJZW5kCgkJCgkJbG9jYWwgcHJvajIsIHBvaW50TGluZSwgaXNPblNlZ21lbnQgPSBWZWN0b3JQb2ludFByb2plY3Rpb25PbkxpbmVTZWdtZW50KGZyb20sIFBvc2l0aW9uLCBWZWN0b3IobWluaW9uLnZpc2lvblBvcykpCgkJaWYgaXNPblNlZ21lbnQgYW5kIChHZXREaXN0YW5jZVNxcihtaW5pb24udmlzaW9uUG9zLCBwcm9qMikgPD0gKHNlbGY6R2V0SGl0Qm94KG1pbmlvbikgKyByYWRpdXMgKyBidWZmZXIpIF4gMikgdGhlbgoJCQlyZXR1cm4gdHJ1ZQoJCWVuZAoJZW5kCglyZXR1cm4gZmFsc2UKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpDaGVja01pbmlvbkNvbGxpc2lvbih1bml0LCBQb3NpdGlvbiwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tLCBkcmF3LCB1cGRhdGVtYW5hZ2VycykKCVBvc2l0aW9uID0gVmVjdG9yKFBvc2l0aW9uKQoJZnJvbSA9IGZyb20gYW5kIFZlY3Rvcihmcm9tKSBvciBteUhlcm8udmlzaW9uUG9zCgkKCWlmIHVwZGF0ZW1hbmFnZXJzIHRoZW4KCQlzZWxmLkVuZW15TWluaW9ucy5yYW5nZSA9IHJhbmdlICsgNTAwICogKGRlbGF5ICsgcmFuZ2UgLyBzcGVlZCkKCQlzZWxmLkp1bmdsZU1pbmlvbnMucmFuZ2UgPSBzZWxmLkVuZW15TWluaW9ucy5yYW5nZQoJCXNlbGYuT3RoZXJNaW5pb25zLnJhbmdlID0gc2VsZi5FbmVteU1pbmlvbnMucmFuZ2UKCQlzZWxmLkVuZW15TWluaW9uczp1cGRhdGUoKQoJCXNlbGYuSnVuZ2xlTWluaW9uczp1cGRhdGUoKQoJCXNlbGYuT3RoZXJNaW5pb25zOnVwZGF0ZSgpCgllbmQKCglsb2NhbCByZXN1bHQgPSBmYWxzZQoJaWYgX0cuVlByZWRpY3Rpb25NZW51LkNvbGxpc2lvbi5NaW5pb25zIHRoZW4KCQlmb3IgaSwgbWluaW9uIGluIGlwYWlycyhzZWxmLkVuZW15TWluaW9ucy5vYmplY3RzKSBkbwoJCQlpZiBzZWxmOkNoZWNrQ29sKHVuaXQsIG1pbmlvbiwgUG9zaXRpb24sIGRlbGF5LCByYWRpdXMsIHJhbmdlLCBzcGVlZCwgZnJvbSwgZHJhdykgdGhlbgoJCQkJaWYgbm90IGRyYXcgdGhlbgoJCQkJCXJldHVybiB0cnVlCgkJCQllbHNlCgkJCQkJcmVzdWx0ID0gdHJ1ZQoJCQkJZW5kCgkJCWVuZAoJCWVuZAoJZW5kCgkKCWlmIF9HLlZQcmVkaWN0aW9uTWVudS5Db2xsaXNpb24uTW9icyB0aGVuCgkJZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5KdW5nbGVNaW5pb25zLm9iamVjdHMpIGRvCgkJCWlmIHNlbGY6Q2hlY2tDb2wodW5pdCwgbWluaW9uLCBQb3NpdGlvbiwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tLCBkcmF3KSB0aGVuCgkJCQlpZiBub3QgZHJhdyB0aGVuCgkJCQkJcmV0dXJuIHRydWUKCQkJCWVsc2UKCQkJCQlyZXN1bHQgPSB0cnVlCgkJCQllbmQKCQkJZW5kCgkJZW5kCgllbmQKCglpZiBfRy5WUHJlZGljdGlvbk1lbnUuQ29sbGlzaW9uLk90aGVycyB0aGVuCgkJZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5PdGhlck1pbmlvbnMub2JqZWN0cykgZG8KCQkJaWYgbWluaW9uLnRlYW0gfj0gbXlIZXJvLnRlYW0gYW5kIHNlbGY6Q2hlY2tDb2wodW5pdCwgbWluaW9uLCBQb3NpdGlvbiwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tLCBkcmF3KSB0aGVuCgkJCQlpZiBub3QgZHJhdyB0aGVuCgkJCQkJcmV0dXJuIHRydWUKCQkJCWVsc2UKCQkJCQlyZXN1bHQgPSB0cnVlCgkJCQllbmQKCQkJZW5kCgkJZW5kCgllbmQKCglpZiBzZWxmLkNoYW1waW9uQ29sbGlzaW9uIHRoZW4KCQlmb3IgaSwgZW5lbXkgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvCgkJCWlmIHNlbGY6Q2hlY2tDb2wodW5pdCwgZW5lbXksIFBvc2l0aW9uLCBkZWxheSwgcmFkaXVzLCByYW5nZSwgc3BlZWQsIGZyb20sIGRyYXcpIHRoZW4KCQkJCWlmIG5vdCBkcmF3IHRoZW4KCQkJCQlyZXR1cm4gdHJ1ZQoJCQkJZWxzZQoJCQkJCXJlc3VsdCA9IHRydWUKCQkJCWVuZAoJCQllbmQKCQllbmQKCWVuZAoKCWlmIGRyYXcgdGhlbgoJCWxvY2FsIERpcmVjdGlvbiA9IFZlY3RvcihQb3NpdGlvbiAtIGZyb20pOnBlcnBlbmRpY3VsYXIoKTpub3JtYWxpemVkKCkKCQlsb2NhbCBDb2xvciA9IHJlc3VsdCBhbmQgQVJHQigyNTUsIDI1NSwgMCwgMCkgb3IgQVJHQigyNTUsIDAsIDI1NSwgMCkKCQlsb2NhbCBQMXIgPSBWZWN0b3IoZnJvbSkgKyByYWRpdXMgKiBWZWN0b3IoRGlyZWN0aW9uKQoJCWxvY2FsIFAxbCA9IFZlY3Rvcihmcm9tKSAtIHJhZGl1cyAqIFZlY3RvcihEaXJlY3Rpb24pCgkJbG9jYWwgUDJyID0gVmVjdG9yKGZyb20pICsgcmFkaXVzICogRGlyZWN0aW9uIC0gVmVjdG9yKERpcmVjdGlvbik6cGVycGVuZGljdWxhcigpICogR2V0RGlzdGFuY2UoZnJvbSwgUG9zaXRpb24pCgkJbG9jYWwgUDJsID0gVmVjdG9yKGZyb20pIC0gcmFkaXVzICogRGlyZWN0aW9uIC0gVmVjdG9yKERpcmVjdGlvbik6cGVycGVuZGljdWxhcigpICogR2V0RGlzdGFuY2UoZnJvbSwgUG9zaXRpb24pCgoJCXNlbGY6RExpbmUoUDFyLCBQMWwsIENvbG9yKQoJCXNlbGY6RExpbmUoUDFyLCBQMnIsIENvbG9yKQoJCXNlbGY6RExpbmUoUDFsLCBQMmwsIENvbG9yKQoJCXNlbGY6RExpbmUoUDJyLCBQMmwsIENvbG9yKQoJCWlmIG5vdCByZXN1bHQgYW5kIElzS2V5RG93bihzdHJpbmcuYnl0ZSgiVCIpKSB0aGVuCgkJCUNhc3RTcGVsbChfUSwgUG9zaXRpb24ueCwgUG9zaXRpb24ueikKCQllbmQKCWVuZAoKCXJldHVybiBmYWxzZQplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkdldENpcmN1bGFyQ2FzdFBvc2l0aW9uKHVuaXQsIGRlbGF5LCByYWRpdXMsIHJhbmdlLCBzcGVlZCwgZnJvbSwgY29sbGlzaW9uKQoJcmV0dXJuIHNlbGY6R2V0QmVzdENhc3RQb3NpdGlvbih1bml0LCBkZWxheSwgcmFkaXVzLCByYW5nZSwgc3BlZWQsIGZyb20sIGNvbGxpc2lvbiwgImNpcmN1bGFyIikKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpHZXRMaW5lQ2FzdFBvc2l0aW9uKHVuaXQsIGRlbGF5LCByYWRpdXMsIHJhbmdlLCBzcGVlZCwgZnJvbSwgY29sbGlzaW9uKQoJcmV0dXJuIHNlbGY6R2V0QmVzdENhc3RQb3NpdGlvbih1bml0LCBkZWxheSwgcmFkaXVzLCByYW5nZSwgc3BlZWQsIGZyb20sIGNvbGxpc2lvbiwgImxpbmUiKQplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkdldFByZWRpY3RlZFBvcyh1bml0LCBkZWxheSwgc3BlZWQsIGZyb20sIGNvbGxpc2lvbikKCXJldHVybiBzZWxmOkdldEJlc3RDYXN0UG9zaXRpb24odW5pdCwgZGVsYXksIDEsIG1hdGguaHVnZSwgc3BlZWQsIGZyb20sIGNvbGxpc2lvbiwgImNpcmN1bGFyIikKZW5kCgotLVRPRE86IFJlY29kZSB0aGlzIHN0dWZmIGFuZCBtYWtlIGl0IG1vcmUgcmVhZGFibGUgOkQKZnVuY3Rpb24gVlByZWRpY3Rpb246R2V0Q2lyY3VsYXJBT0VDYXN0UG9zaXRpb24odW5pdCwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tLCBjb2xsaXNpb24pCglsb2NhbCBDYXN0UG9zaXRpb24sIEhpdENoYW5jZSwgUG9zaXRpb24gPSBzZWxmOkdldEJlc3RDYXN0UG9zaXRpb24odW5pdCwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tLCBjb2xsaXNpb24sICJjaXJjdWxhciIpCglsb2NhbCBwb2ludHMgPSB7fQoJbG9jYWwgbWFpbkNhc3RQb3NpdGlvbiwgbWFpbkhpdENoYW5jZSwgbWFpblBvc2l0aW9uID0gQ2FzdFBvc2l0aW9uLCBIaXRDaGFuY2UsIFBvc2l0aW9uCgoJdGFibGUuaW5zZXJ0KHBvaW50cywgUG9zaXRpb24pCgoJZm9yIGksIHRhcmdldCBpbiBpcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8KCQlpZiB0YXJnZXQubmV0d29ya0lEIH49IHVuaXQubmV0d29ya0lEIGFuZCBWYWxpZFRhcmdldCh0YXJnZXQsIHJhbmdlICogMS41KSB0aGVuCgkJCUNhc3RQb3NpdGlvbiwgSGl0Q2hhbmNlLCBQb3NpdGlvbiA9IHNlbGY6R2V0QmVzdENhc3RQb3NpdGlvbih0YXJnZXQsIGRlbGF5LCByYWRpdXMsIHJhbmdlLCBzcGVlZCwgZnJvbSwgY29sbGlzaW9uLCAiY2lyY3VsYXIiKQoJCQlpZiBHZXREaXN0YW5jZShmcm9tLCBQb3NpdGlvbikgPCAocmFuZ2UgKyByYWRpdXMpIGFuZCAoSGl0Y2hhbmNlIH49IC0xIG9yIG5vdCBjb2xsaXNpb24pIHRoZW4KCQkJCXRhYmxlLmluc2VydChwb2ludHMsIFBvc2l0aW9uKQoJCQllbmQKCQllbmQKCWVuZAoKCXdoaWxlICNwb2ludHMgPiAxIGRvCgkJbG9jYWwgTWVjID0gTUVDKHBvaW50cykKCQlsb2NhbCBDaXJjbGUgPSBNZWM6Q29tcHV0ZSgpCgkJCgkJaWYgQ2lyY2xlLnJhZGl1cyA8PSByYWRpdXMgKyBzZWxmOkdldEhpdEJveCh1bml0KSAtIDggdGhlbgoJCQlyZXR1cm4gQ2lyY2xlLmNlbnRlciwgbWFpbkhpdENoYW5jZSwgI3BvaW50cwoJCWVuZAoKCQlsb2NhbCBtYXhkaXN0ID0gLTEKCQlsb2NhbCBtYXhkaXN0aW5kZXggPSAwCgoJCWZvciBpPTIsICNwb2ludHMgZG8KCQkJbG9jYWwgZCA9IEdldERpc3RhbmNlU3FyKHBvaW50c1tpXSwgcG9pbnRzWzFdKQoJCQlpZiBkID4gbWF4ZGlzdCBvciBtYXhkaXN0ID09IC0xIHRoZW4KCQkJCW1heGRpc3RpbmRleCA9IGkKCQkJCW1heGRpc3QgPSBkCgkJCWVuZAoJCWVuZAoKCQl0YWJsZS5yZW1vdmUocG9pbnRzLCBtYXhkaXN0aW5kZXgpCgllbmQKCglyZXR1cm4gbWFpbkNhc3RQb3NpdGlvbiwgbWFpbkhpdENoYW5jZSwgI3BvaW50cywgbWFpblBvc2l0aW9uCmVuZAoKZnVuY3Rpb24gVlByZWRpY3Rpb246R2V0TGluZUFPRUNhc3RQb3NpdGlvbih1bml0LCBkZWxheSwgcmFkaXVzLCByYW5nZSwgc3BlZWQsIGZyb20pCglsb2NhbCBDYXN0UG9zaXRpb24sIEhpdENoYW5jZSwgUG9zaXRpb24gPSBzZWxmOkdldEJlc3RDYXN0UG9zaXRpb24odW5pdCwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tLCBmYWxzZSwgImxpbmUiKQoJbG9jYWwgcG9pbnRzID0ge30KCWxvY2FsIFBvc2l0aW9ucyA9IHt9Cglsb2NhbCBtYWluQ2FzdFBvc2l0aW9uLCBtYWluSGl0Q2hhbmNlID0gQ2FzdFBvc2l0aW9uLCBIaXRDaGFuY2UKCgl0YWJsZS5pbnNlcnQoUG9zaXRpb25zLCB7dW5pdCA9IHVuaXQsIEhpdENoYW5jZSA9IEhpdENoYW5jZSwgUG9zaXRpb24gPSBQb3NpdGlvbiwgQ2FzdFBvc2l0aW9uID0gQ2FzdFBvc2l0aW9ufSkKCXRhYmxlLmluc2VydChwb2ludHMsIFBvc2l0aW9uKQoKCXJhbmdlID0gcmFuZ2UgYW5kIHJhbmdlIC0gNCBvciAyMDAwMAoJcmFkaXVzID0gcmFkaXVzID09IDAgYW5kIDEgb3IgKHJhZGl1cyArIHNlbGY6R2V0SGl0Qm94KHVuaXQpKSAtIDQKCWZyb20gPSBmcm9tIGFuZCBWZWN0b3IoZnJvbSkgb3IgVmVjdG9yKG15SGVyby52aXNpb25Qb3MpCgoJbG9jYWwgZnVuY3Rpb24gQ2lyY2xlQ2lyY2xlSW50ZXJzZWN0aW9uKEMxLCBDMiwgUjEsIFIyKQoJCWxvY2FsIEQgPSBHZXREaXN0YW5jZShDMSwgQzIpCgkJbG9jYWwgQSA9IChSMSAqIFIxIC0gUjIgKiBSMiArIEQgKiBEICkgLyAoMiAqIEQpCgkJbG9jYWwgSCA9IG1hdGguc3FydChSMSAqIFIxIC0gQSAqIEEpOwoJCWxvY2FsIERpcmVjdGlvbiA9IChWZWN0b3IoQzIpIC0gVmVjdG9yKEMxKSk6bm9ybWFsaXplZCgpCgkJbG9jYWwgUEEgPSBWZWN0b3IoQzEpICsgQSAqIERpcmVjdGlvbgoKCQlsb2NhbCBTMSA9IFBBICsgSCAqIERpcmVjdGlvbjpwZXJwZW5kaWN1bGFyKCkKCQlsb2NhbCBTMiA9IFBBIC0gSCAqIERpcmVjdGlvbjpwZXJwZW5kaWN1bGFyKCkKCgkJcmV0dXJuIFMxLCBTMgoJZW5kCgoJbG9jYWwgZnVuY3Rpb24gR2V0UG9zaWJsZVBvaW50cyhmcm9tLCBwb3MsIHdpZHRoLCByYW5nZSkKCQlsb2NhbCBtaWRkbGVwb2ludCA9IChmcm9tICsgcG9zKS8yCgkJbG9jYWwgUDEsIFAyID0gQ2lyY2xlQ2lyY2xlSW50ZXJzZWN0aW9uKGZyb20sIG1pZGRsZXBvaW50LCB3aWR0aCwgR2V0RGlzdGFuY2UobWlkZGxlcG9pbnQsIGZyb20pKQoKCQlsb2NhbCBWMSA9IChQMSAtIGZyb20pCgkJbG9jYWwgVjIgPSAoUDIgLSBmcm9tKQoKCQlyZXR1cm4gZnJvbSArIHJhbmdlICogKHBvcyAtIFYxIC0gZnJvbSk6bm9ybWFsaXplZCgpLCBmcm9tICsgcmFuZ2UgKiAocG9zIC0gVjIgLSBmcm9tKTpub3JtYWxpemVkKCkKCWVuZAoKCWxvY2FsIGZ1bmN0aW9uIENvdW50SGl0cyhQMSwgUDIsIHdpZHRoLCBwb2ludHMpCgkJbG9jYWwgaGl0cyA9IDAKCQlsb2NhbCBoaXR0ID0ge30KCQl3aWR0aCA9IHdpZHRoICsgMgoJCWZvciBpLCBwb2ludCBpbiBpcGFpcnMocG9pbnRzKSBkbwoJCQlsb2NhbCBwb2ludFNlZ21lbnQsIHBvaW50TGluZSwgaXNPblNlZ21lbnQgPSBWZWN0b3JQb2ludFByb2plY3Rpb25PbkxpbmVTZWdtZW50KFAxLCBQMiwgcG9pbnQpCgkJCWlmIGlzT25TZWdtZW50IGFuZCBHZXREaXN0YW5jZVNxcihwb2ludFNlZ21lbnQsIHBvaW50KSA8PSB3aWR0aCAqIHdpZHRoIHRoZW4KCQkJCWhpdHMgPSBoaXRzICsgMQoJCQkJdGFibGUuaW5zZXJ0KGhpdHQsIHBvaW50KQoJCQllbHNlaWYgaSA9PSAxIHRoZW4KCQkJCXJldHVybiAtMQoJCQllbmQKCQllbmQKCQlyZXR1cm4gaGl0cywgaGl0dAoJZW5kCgoJZm9yIGksIHRhcmdldCBpbiBpcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8KCQlpZiB0YXJnZXQubmV0d29ya0lEIH49IHVuaXQubmV0d29ya0lEIGFuZCBWYWxpZFRhcmdldCh0YXJnZXQsIHJhbmdlICogMS41KSB0aGVuCgkJCUNhc3RQb3NpdGlvbiwgSGl0Q2hhbmNlLCBQb3NpdGlvbiA9IHNlbGY6R2V0QmVzdENhc3RQb3NpdGlvbih0YXJnZXQsIGRlbGF5LCByYWRpdXMsIHJhbmdlLCBzcGVlZCwgZnJvbSwgZmFsc2UsICJsaW5lIikKCQkJaWYgR2V0RGlzdGFuY2UoZnJvbSwgUG9zaXRpb24pIDwgKHJhbmdlICsgcmFkaXVzKSB0aGVuCgkJCQl0YWJsZS5pbnNlcnQocG9pbnRzLCBQb3NpdGlvbikKCQkJCXRhYmxlLmluc2VydChQb3NpdGlvbnMsIHt1bml0ID0gdGFyZ2V0LCBIaXRDaGFuY2UgPSBIaXRDaGFuY2UsIFBvc2l0aW9uID0gUG9zaXRpb24sIENhc3RQb3NpdGlvbiA9IENhc3RQb3NpdGlvbn0pCgkJCWVuZAoJCWVuZAoJZW5kCgoJbG9jYWwgTWF4SGl0ID0gMQoJbG9jYWwgTWF4SGl0UG9zCgoJaWYgI3BvaW50cyA+IDEgdGhlbgoJCWZvciBpLCBjYW5kaWRhdGUgaW4gaXBhaXJzKHBvaW50cykgZG8KCQkJbG9jYWwgQzEsIEMyID0gR2V0UG9zaWJsZVBvaW50cyhmcm9tLCBwb2ludHNbaV0sIHJhZGl1cyAtIDIwLCByYW5nZSkKCQkJbG9jYWwgaGl0cywgTVBvaW50czEgPSBDb3VudEhpdHMoZnJvbSwgQzEsIHJhZGl1cywgcG9pbnRzKQoJCQlsb2NhbCBoaXRzMiwgTVBvaW50czIgPSBDb3VudEhpdHMoZnJvbSwgQzIsIHJhZGl1cywgcG9pbnRzKQoJCQlpZiBoaXRzID49IE1heEhpdCB0aGVuCgkJCQlNYXhIaXRQb3MgPSBDMQoJCQkJTWF4SGl0ID0gaGl0cwoJCQkJTWF4SGl0UG9pbnRzID0gTVBvaW50czEKCQkJZW5kCgkJCWlmIGhpdHMyID49IE1heEhpdCB0aGVuCgkJCQlNYXhIaXRQb3MgPSBDMgoJCQkJTWF4SGl0ID0gaGl0czIKCQkJCU1heEhpdFBvaW50cyA9IE1Qb2ludHMyCgkJCWVuZAoJCWVuZAoJZW5kCgoJaWYgTWF4SGl0ID4gMSB0aGVuCgkJLS1jZW50ZXIgdGhlIGxpbmUKCQlsb2NhbCBtYXhkaXN0ID0gLTEKCQlsb2NhbCBwMQoJCWxvY2FsIHAyCgkJZm9yIGksIGhpdHAgaW4gaXBhaXJzKE1heEhpdFBvaW50cykgZG8KCQkJZm9yIG8sIGhpdHAyIGluIGlwYWlycyhNYXhIaXRQb2ludHMpIGRvCgkJCQlsb2NhbCBTdGFydFAsIEVuZFAgPSBWZWN0b3IoZnJvbSksIChWZWN0b3IoaGl0cCkgKyBWZWN0b3IoaGl0cDIpKSAvIDIKCQkJCWxvY2FsIHBvaW50U2VnbWVudCwgcG9pbnRMaW5lLCBpc09uU2VnbWVudCA9IFZlY3RvclBvaW50UHJvamVjdGlvbk9uTGluZVNlZ21lbnQoU3RhcnRQLCBFbmRQLCBoaXRwKQoJCQkJbG9jYWwgcG9pbnRTZWdtZW50MiwgcG9pbnRMaW5lMiwgaXNPblNlZ21lbnQyID0gVmVjdG9yUG9pbnRQcm9qZWN0aW9uT25MaW5lU2VnbWVudChTdGFydFAsIEVuZFAsIGhpdHAyKQoKCQkJCWxvY2FsIGRpc3QgPSBHZXREaXN0YW5jZVNxcihoaXRwLCBwb2ludExpbmUpICsgR2V0RGlzdGFuY2VTcXIoaGl0cDIsIHBvaW50TGluZTIpCgkJCQlpZiBkaXN0ID49IG1heGRpc3QgdGhlbgoJCQkJCW1heGRpc3QgPSBkaXN0CgkJCQkJcDEgPSBoaXRwCgkJCQkJcDIgPSBoaXRwMgoJCQkJZW5kCgkJCWVuZAoJCWVuZAoKCQlpZiBzZWxmLlJldHVybkhpdFRhYmxlIHRoZW4KCQkJZm9yIGkgPSAjUG9zaXRpb25zLCAxLCAtMSBkbwoJCQkJbG9jYWwgcG9pbnRTZWdtZW50LCBwb2ludExpbmUsIGlzT25TZWdtZW50ID0gVmVjdG9yUG9pbnRQcm9qZWN0aW9uT25MaW5lU2VnbWVudChWZWN0b3IoZnJvbSksIChwMSArIHAyKSAvIDIsIFBvc2l0aW9uc1tpXS5Qb3NpdGlvbikKCQkJCWlmIChub3QgaXNPblNlZ21lbnQpIG9yIChHZXREaXN0YW5jZVNxcihwb2ludExpbmUsIFBvc2l0aW9uc1tpXS5Qb3NpdGlvbikgPiAocmFkaXVzICsgNSleMikgdGhlbgoJCQkJCXRhYmxlLnJlbW92ZShQb3NpdGlvbnMsIGkpCgkJCQllbmQKCQkJZW5kCgkJZW5kCgoJCXJldHVybiAocDEgKyBwMikgLyAyLCBtYWluSGl0Q2hhbmNlLCBNYXhIaXQsIFBvc2l0aW9ucwoJZWxzZQoJCXJldHVybiBtYWluQ2FzdFBvc2l0aW9uLCBtYWluSGl0Q2hhbmNlLCAxLCBQb3NpdGlvbnMKCWVuZAplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkdldENvbmVBT0VDYXN0UG9zaXRpb24odW5pdCwgZGVsYXksIGFuZ2xlLCByYW5nZSwgc3BlZWQsIGZyb20pCglyYW5nZSA9IHJhbmdlIGFuZCByYW5nZSAtIDQgb3IgMjAwMDAKCXJhZGl1cyA9IDEKCWZyb20gPSBmcm9tIGFuZCBWZWN0b3IoZnJvbSkgb3IgVmVjdG9yKG15SGVyby52aXNpb25Qb3MpCglhbmdsZSA9IChhbmdsZSA8IG1hdGgucGkgKiAyKSBhbmQgYW5nbGUgb3IgKGFuZ2xlICogbWF0aC5waSAvIDE4MCkKCglsb2NhbCBDYXN0UG9zaXRpb24sIEhpdENoYW5jZSwgUG9zaXRpb24gPSBzZWxmOkdldEJlc3RDYXN0UG9zaXRpb24odW5pdCwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tLCBmYWxzZSwgImxpbmUiKQoJbG9jYWwgcG9pbnRzID0ge30KCWxvY2FsIG1haW5DYXN0UG9zaXRpb24sIG1haW5IaXRDaGFuY2UgPSBDYXN0UG9zaXRpb24sIEhpdENoYW5jZQoKCXRhYmxlLmluc2VydChwb2ludHMsIFZlY3RvcihQb3NpdGlvbikgLSBWZWN0b3IoZnJvbSkpCgoJbG9jYWwgZnVuY3Rpb24gQ291bnRWZWN0b3JzQmV0d2VlbihWMSwgVjIsIHBvaW50cykKCQlsb2NhbCByZXN1bHQgPSAwCQoJCWxvY2FsIGhpdHBvaW50cyA9IHt9IAoJCWZvciBpLCB0ZXN0IGluIGlwYWlycyhwb2ludHMpIGRvCgkJCWxvY2FsIE5WZWN0b3IgPSBWZWN0b3IoVjEpOmNyb3NzUCh0ZXN0KQoJCQlsb2NhbCBOVmVjdG9yMiA9IFZlY3Rvcih0ZXN0KTpjcm9zc1AoVjIpCgkJCWlmIE5WZWN0b3IueSA+PSAwIGFuZCBOVmVjdG9yMi55ID49IDAgdGhlbgoJCQkJcmVzdWx0ID0gcmVzdWx0ICsgMQoJCQkJdGFibGUuaW5zZXJ0KGhpdHBvaW50cywgdGVzdCkKCQkJZWxzZWlmIGkgPT0gMSB0aGVuCgkJCQlyZXR1cm4gLTEgLS1kb2VzbnQgaGl0IHRoZSBtYWluIHRhcmdldAoJCQllbmQKCQllbmQKCQlyZXR1cm4gcmVzdWx0LCBoaXRwb2ludHMKCWVuZAoKCWxvY2FsIGZ1bmN0aW9uIENoZWNrSGl0KHBvc2l0aW9uLCBhbmdsZSwgcG9pbnRzKQoJCWxvY2FsIGRpcmVjdGlvbiA9IFZlY3Rvcihwb3NpdGlvbik6bm9ybWFsaXplZCgpCgkJbG9jYWwgdjEgPSBWZWN0b3IocG9zaXRpb24pOnJvdGF0ZWQoMCwgLWFuZ2xlIC8gMiwgMCkKCQlsb2NhbCB2MiA9IFZlY3Rvcihwb3NpdGlvbik6cm90YXRlZCgwLCBhbmdsZSAvIDIsIDApCgkJcmV0dXJuIENvdW50VmVjdG9yc0JldHdlZW4odjEsIHYyLCBwb2ludHMpCgllbmQKCglmb3IgaSwgdGFyZ2V0IGluIGlwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbwoJCWlmIHRhcmdldC5uZXR3b3JrSUQgfj0gdW5pdC5uZXR3b3JrSUQgYW5kIFZhbGlkVGFyZ2V0KHRhcmdldCwgcmFuZ2UgKiAxLjUpIHRoZW4KCQkJQ2FzdFBvc2l0aW9uLCBIaXRDaGFuY2UsIFBvc2l0aW9uID0gc2VsZjpHZXRCZXN0Q2FzdFBvc2l0aW9uKHRhcmdldCwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tLCBmYWxzZSwgImxpbmUiKQoJCQlpZiBHZXREaXN0YW5jZVNxcihmcm9tLCBQb3NpdGlvbikgPCByYW5nZSAqIHJhbmdlIHRoZW4KCQkJCXRhYmxlLmluc2VydChwb2ludHMsIFZlY3RvcihQb3NpdGlvbikgLSBWZWN0b3IoZnJvbSkpCgkJCWVuZAoJCWVuZAoJZW5kCgoJbG9jYWwgTWF4SGl0UG9zCglsb2NhbCBNYXhIaXQgPSAxCglsb2NhbCBNYXhIaXRQb2ludHMgPSB7fQoKCWlmICNwb2ludHMgPiAxIHRoZW4KCQlmb3IgaSwgcG9pbnQgaW4gaXBhaXJzKHBvaW50cykgZG8KCQkJbG9jYWwgcG9zMSA9IFZlY3Rvcihwb2ludCk6cm90YXRlZCgwLCBhbmdsZSAvIDIsIDApCgkJCWxvY2FsIHBvczIgPSBWZWN0b3IocG9pbnQpOnJvdGF0ZWQoMCwgLSBhbmdsZSAvIDIsIDApCgoJCQlsb2NhbCBoaXRzLCBwb2ludHMxID0gQ2hlY2tIaXQocG9zMSwgYW5nbGUsIHBvaW50cykKCQkJbG9jYWwgaGl0czIsIHBvaW50czIgPSBDaGVja0hpdChwb3MyLCBhbmdsZSwgcG9pbnRzKQoKCQkJaWYgaGl0cyA+PSBNYXhIaXQgdGhlbgoJCQkJTWF4SGl0UG9zID0gQzEKCQkJCU1heEhpdCA9IGhpdHMKCQkJCU1heEhpdFBvaW50cyA9IHBvaW50czEKCQkJZW5kCgkJCWlmIGhpdHMyID49IE1heEhpdCB0aGVuCgkJCQlNYXhIaXRQb3MgPSBDMgoJCQkJTWF4SGl0ID0gaGl0czIKCQkJCU1heEhpdFBvaW50cyA9IHBvaW50czIKCQkJZW5kCgkJZW5kCgllbmQKCglpZiBNYXhIaXQgPiAxIHRoZW4KCQktLUNlbnRlciB0aGUgY29uZQoJCWxvY2FsIG1heGFuZ2xlID0gLTEKCQlsb2NhbCBwMQoJCWxvY2FsIHAyCgkJZm9yIGksIGhpdHAgaW4gaXBhaXJzKE1heEhpdFBvaW50cykgZG8KCQkJZm9yIG8sIGhpdHAyIGluIGlwYWlycyhNYXhIaXRQb2ludHMpIGRvCgkJCQlsb2NhbCBjYW5nbGUgPSBWZWN0b3IoKTphbmdsZUJldHdlZW4oaGl0cDIsIGhpdHApIAoJCQkJaWYgY2FuZ2xlID4gbWF4YW5nbGUgdGhlbgoJCQkJCW1heGFuZ2xlID0gY2FuZ2xlCgkJCQkJcDEgPSBoaXRwCgkJCQkJcDIgPSBoaXRwMgoJCQkJZW5kCgkJCWVuZAoJCWVuZAoKCgkJcmV0dXJuIFZlY3Rvcihmcm9tKSArIHJhbmdlICogKCgocDEgKyBwMikgLyAyKSk6bm9ybWFsaXplZCgpLCBtYWluSGl0Q2hhbmNlLCBNYXhIaXQKCWVsc2UKCQlyZXR1cm4gbWFpbkNhc3RQb3NpdGlvbiwgbWFpbkhpdENoYW5jZSwgMQoJZW5kCmVuZAoKZnVuY3Rpb24gVlByZWRpY3Rpb246T25UaWNrKCkKCS0tW1tEZWxldGUgdGhlIG9sZCBzYXZlZCBXYXlwb2ludHNdXQoJaWYgc2VsZi5sYXN0aWNrID09IG5pbCBvciBzZWxmOkdldFRpbWUoKSAtIHNlbGYubGFzdGljayA+IDAuMiB0aGVuCgkJc2VsZi5sYXN0aWNrID0gc2VsZjpHZXRUaW1lKCkKCQlmb3IgTklELCBUYXJnZXRXYXlwb2ludHMgaW4gcGFpcnMoc2VsZi5UYXJnZXRzV2F5cG9pbnRzKSBkbwoJCQlsb2NhbCBpID0gMSAKCQkJd2hpbGUgaSA8PSAjc2VsZi5UYXJnZXRzV2F5cG9pbnRzW05JRF0gZG8KCQkJCWlmIHNlbGYuVGFyZ2V0c1dheXBvaW50c1tOSURdW2ldWyJ0aW1lIl0gKyBzZWxmLldheXBvaW50c1RpbWUgPCBzZWxmOkdldFRpbWUoKSB0aGVuCgkJCQkJdGFibGUucmVtb3ZlKHNlbGYuVGFyZ2V0c1dheXBvaW50c1tOSURdLCBpKQoJCQkJZWxzZQoJCQkJCWkgPSBpICsgMQoJCQkJZW5kCgkJCWVuZAoJCWVuZAoKCQlmb3IgaSwgdW5pdCBpbiBpcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8KCQkJZm9yIGogPSAxLCB1bml0LmJ1ZmZDb3VudCBkbwoJCQkJbG9jYWwgYnVmZiA9IHVuaXQ6Z2V0QnVmZihqKQoJCQkJaWYgYnVmZi52YWxpZCBhbmQgYnVmZi5uYW1lID09ICJTdHVuIiB0aGVuCgkJCQkJaWYgc2VsZi5UYXJnZXRzSW1tb2JpbGVbdW5pdC5uZXR3b3JrSURdIGFuZCBzZWxmLlRhcmdldHNJbW1vYmlsZVt1bml0Lm5ldHdvcmtJRF0gPCBzZWxmOkdldFRpbWUoKSB0aGVuCgkJCQkJCXNlbGYuVGFyZ2V0c0ltbW9iaWxlW3VuaXQubmV0d29ya0lEXSA9IHNlbGY6R2V0VGltZSgpICsgKGJ1ZmYuZW5kVC1idWZmLnN0YXJ0VCkKCQkJCQllbmQKCQkJCWVuZAoJCQllbmQKCQllbmQKCWVuZAplbmQKCi0tW1tEcmF3aW5nIGZ1bmN0aW9ucyBmb3IgZGVidWc6IF1dCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkRyYXdTYXZlZFdheXBvaW50cyhvYmplY3QsIHRpbWUpCglsb2NhbCBXYXlwb2ludHMgPSBzZWxmOkdldFdheXBvaW50cyhvYmplY3QubmV0d29ya0lELCBzZWxmOkdldFRpbWUoKSAtIHRpbWUpCglmb3IgaSwgd2F5cG9pbnQgaW4gaXBhaXJzKFdheXBvaW50cykgZG8KCQlEcmF3Q2lyY2xlM0Qod2F5cG9pbnQud2F5cG9pbnQueCwgbXlIZXJvLnksIHdheXBvaW50LndheXBvaW50LnksIDEwMCwgMiwgQVJHQigyNTUsIDI1NSwgMjU1LCAyNTUpKQoJCURyYXdUZXh0M0QodG9zdHJpbmcoaSksIHdheXBvaW50LndheXBvaW50LngsIG15SGVyby55LCB3YXlwb2ludC53YXlwb2ludC55LCAxMywgQVJHQigyNTUsIDI1NSwgMjU1LCAyNTUpLCB0cnVlKQoJCURyYXdDaXJjbGUzRCh3YXlwb2ludC51bml0cG9zLngsIG15SGVyby55LCB3YXlwb2ludC51bml0cG9zLnksIDEwMCwgMiwgQVJHQigyNTUsIDI1NSwgMCwgMCkpCgllbmQKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpEcmF3SGl0Qm94KG9iamVjdCkKCURyYXdDaXJjbGUzRChvYmplY3QueCwgb2JqZWN0LnksIG9iamVjdC56LCBzZWxmOkdldEhpdEJveChvYmplY3QpLCAxLCBBUkdCKDI1NSwgMjU1LCAyNTUsIDI1NSkpCglpZiBvYmplY3QudmlzaW9uUG9zIHRoZW4KCQlEcmF3Q2lyY2xlM0Qob2JqZWN0LnZpc2lvblBvcy54LCBvYmplY3QudmlzaW9uUG9zLnksIG9iamVjdC52aXNpb25Qb3Mueiwgc2VsZjpHZXRIaXRCb3gob2JqZWN0KSwgMSwgQVJHQigyNTUsIDAsIDI1NSwgMCkpCgllbmQKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpETGluZShGcm9tLCBUbywgQ29sb3IpCglEcmF3TGluZTNEKEZyb20ueCwgRnJvbS55LCBGcm9tLnosIFRvLngsIFRvLnksIFRvLnosIDEsIENvbG9yKQplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOk9uRHJhdygpCglpZiBzZWxmLnNob3dkZXZtb2RlIGFuZCBfRy5WUHJlZGljdGlvbk1lbnUuRGV2ZWxvcGVycy5EZWJ1ZyB0aGVuCgkJTGFzdEdldFRhcmdldCA9IExhc3RHZXRUYXJnZXQgb3IgbXlIZXJvCgkJbG9jYWwgdGFyZ2V0ID0gR2V0VGFyZ2V0KCkgb3IgTGFzdEdldFRhcmdldAoJCUxhc3RHZXRUYXJnZXQgPSB0YXJnZXQKCQlmb3IgaSwgZW5lbXkgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvCgkJCXNlbGY6RHJhd0hpdEJveChlbmVteSkKCQllbmQKCQlpZiBfRy5WUHJlZGljdGlvbk1lbnUuRGV2ZWxvcGVycy5TQyB0aGVuCgkJCXNlbGYuRW5lbXlNaW5pb25zOnVwZGF0ZSgpCgkJCXNlbGYuSnVuZ2xlTWluaW9uczp1cGRhdGUoKQoJCQlzZWxmLk90aGVyTWluaW9uczp1cGRhdGUoKQoJCQlzZWxmOkNoZWNrTWluaW9uQ29sbGlzaW9uKFZlY3RvcihteUhlcm8udmlzaW9uUG9zKSArIDEwNTAgKiAoVmVjdG9yKG1vdXNlUG9zKSAtIFZlY3RvcihteUhlcm8udmlzaW9uUG9zKSk6bm9ybWFsaXplZCgpLCAwLjI1LCA3MCwgMTA1MCwgMTgwMCwgbXlIZXJvLnZpc2lvblBvcywgdHJ1ZSkKCQllbmQKCQlpZiB0YXJnZXQgdGhlbgoJCQlzZWxmOkRyYXdIaXRCb3godGFyZ2V0KSAKCQkJbG9jYWwgQ2FzdFBvc2l0aW9uLCAgSGl0Q2hhbmNlLCAgUG9zaXRpb24gPSBzZWxmOkdldENpcmN1bGFyQ2FzdFBvc2l0aW9uKHRhcmdldCwgMC42LCA3MCwgOTAwLCBtYXRoLmh1Z2UpCgkJCWlmIEhpdENoYW5jZSA+PSAtMSB0aGVuCgkJCQlEcmF3VGV4dDNEKHRvc3RyaW5nKEhpdENoYW5jZSksIENhc3RQb3NpdGlvbi54LCBteUhlcm8ueSwgQ2FzdFBvc2l0aW9uLnosIDQwLCBBUkdCKDI1NSwgMjU1LCAyNTUsIDI1NSksIHRydWUpCgkJCQlEcmF3Q2lyY2xlM0QoUG9zaXRpb24ueCwgbXlIZXJvLnksIFBvc2l0aW9uLnosIDcwICsgc2VsZjpHZXRIaXRCb3godGFyZ2V0KSwgMSwgQVJHQigyNTUsIDAsIDI1NSwgMCkpCgkJCQlEcmF3Q2lyY2xlM0QoQ2FzdFBvc2l0aW9uLngsIG15SGVyby55LCBDYXN0UG9zaXRpb24ueiwgNzAgKyBzZWxmOkdldEhpdEJveCh0YXJnZXQpLCAxLCBBUkdCKDI1NSwgMjU1LCAwLCAwKSkKCQkJZW5kCgkJCWxvY2FsIHdheXBvaW50ID0gc2VsZjpHZXRDdXJyZW50V2F5UG9pbnRzKHRhcmdldCkKCQkJZm9yIGkgID0gMSwgI3dheXBvaW50LTEgZG8KCQkJCXNlbGY6RExpbmUoVmVjdG9yKHdheXBvaW50W2ldLngsIG15SGVyby55LCB3YXlwb2ludFtpXS55KSwgVmVjdG9yKHdheXBvaW50W2krMV0ueCwgbXlIZXJvLnksIHdheXBvaW50W2krMV0ueSksIEFSR0IoMjU1LDI1NSwyNTUsMjU1KSkKCQkJZW5kCgkJZW5kCgllbmQKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpHZXRIaXRCb3gob2JqZWN0KQoJaWYgc2VsZi5ub2hpdGJveG1vZGUgYW5kIG9iamVjdC50eXBlIGFuZCBvYmplY3QudHlwZSA9PSBteUhlcm8udHlwZSB0aGVuCgkJcmV0dXJuIDAKCWVuZAoJcmV0dXJuIChzZWxmLmhpdGJveGVzW29iamVjdC5jaGFyTmFtZV0gfj0gbmlsIGFuZCBzZWxmLmhpdGJveGVzW29iamVjdC5jaGFyTmFtZV0gfj0gMCkgYW5kIHNlbGYuaGl0Ym94ZXNbb2JqZWN0LmNoYXJOYW1lXSAgb3IgNjUKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpHZXRQcm9qZWN0aWxlU3BlZWQodW5pdCkKCXJldHVybiBzZWxmLnByb2plY3RpbGVzcGVlZHNbdW5pdC5jaGFyTmFtZV0gYW5kIHNlbGYucHJvamVjdGlsZXNwZWVkc1t1bml0LmNoYXJOYW1lXSBvciBtYXRoLmh1Z2UKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpDYWxjRGFtYWdlT2ZBdHRhY2soc291cmNlLCB0YXJnZXQsIHNwZWxsLCBhZGRpdGlvbmFsRGFtYWdlKQoJLS0gcmVhZCBpbml0aWFsIGFybW9yIGFuZCBkYW1hZ2UgdmFsdWVzCglsb2NhbCBhcm1vclBlblBlcmNlbnQgPSBzb3VyY2UuYXJtb3JQZW5QZXJjZW50Cglsb2NhbCBhcm1vclBlbiA9IHNvdXJjZS5hcm1vclBlbgoJbG9jYWwgdG90YWxEYW1hZ2UgPSBzb3VyY2UudG90YWxEYW1hZ2UgKyAoYWRkaXRpb25hbERhbWFnZSBvciAwKQoJbG9jYWwgZGFtYWdlTXVsdGlwbGllciA9IHNwZWxsLm5hbWU6ZmluZCgiQ3JpdEF0dGFjayIpIGFuZCAyIG9yIDEKCgktLSBtaW5pb25zIGdpdmUgd3JvbmcgdmFsdWVzIGZvciBhcm1vclBlbiBhbmQgYXJtb3JQZW5QZXJjZW50CglpZiBzb3VyY2UudHlwZSA9PSAib2JqX0FJX01pbmlvbiIgdGhlbgoJCWFybW9yUGVuUGVyY2VudCA9IDEKCWVsc2VpZiBzb3VyY2UudHlwZSA9PSAib2JqX0FJX1R1cnJldCIgdGhlbgoJCWFybW9yUGVuUGVyY2VudCA9IDAuNwoJZW5kCgoJLS0gdHVycmV0cyBpZ25vcmUgYXJtb3IgcGVuZXRyYXRpb24gYW5kIGNyaXRpY2FsIGF0dGFja3MKCWlmIHRhcmdldC50eXBlID09ICJvYmpfQUlfVHVycmV0IiB0aGVuCgkJYXJtb3JQZW5QZXJjZW50ID0gMQoJCWFybW9yUGVuID0gMAoJCWRhbWFnZU11bHRpcGxpZXIgPSAxCgllbmQKCgktLSBjYWxjdWxhdGUgaW5pdGlhbCBkYW1hZ2UgbXVsdGlwbGllciBmb3IgbmVnYXRpdmUgYW5kIHBvc2l0aXZlIGFybW9yCgoJbG9jYWwgdGFyZ2V0QXJtb3IgPSAodGFyZ2V0LmFybW9yICogYXJtb3JQZW5QZXJjZW50KSAtIGFybW9yUGVuCglpZiB0YXJnZXRBcm1vciA8IDAgdGhlbiAtLSBtaW5pb25zIGNhbid0IGdvIGJlbG93IDAgYXJtb3IuCgkJLS1kYW1hZ2VNdWx0aXBsaWVyID0gKDIgLSAxMDAgLyAoMTAwIC0gdGFyZ2V0QXJtb3IpKSAqIGRhbWFnZU11bHRpcGxpZXIKCQlkYW1hZ2VNdWx0aXBsaWVyID0gMSAqIGRhbWFnZU11bHRpcGxpZXIKCWVsc2UKCQlkYW1hZ2VNdWx0aXBsaWVyID0gMTAwIC8gKDEwMCArIHRhcmdldEFybW9yKSAqIGRhbWFnZU11bHRpcGxpZXIKCWVuZAoKCS0tIHVzZSBhYmlsaXR5IHBvd2VyIG9yIGFkIGJhc2VkIGRhbWFnZSBvbiB0dXJyZXRzCglpZiBzb3VyY2UudHlwZSA9PSAib2JqX0FJX0hlcm8iIGFuZCB0YXJnZXQudHlwZSA9PSAib2JqX0FJX1R1cnJldCIgdGhlbgoJCXRvdGFsRGFtYWdlID0gbWF0aC5tYXgoc291cmNlLnRvdGFsRGFtYWdlLCBzb3VyY2UuZGFtYWdlICsgMC40ICogc291cmNlLmFwKQoJZW5kCgoJLS0gbWluaW9ucyBkZWFsIGxlc3MgZGFtYWdlIHRvIGVuZW15IGhlcm9zCglpZiBzb3VyY2UudHlwZSA9PSAib2JqX0FJX01pbmlvbiIgYW5kIHRhcmdldC50eXBlID09ICJvYmpfQUlfSGVybyIgYW5kIHNvdXJjZS50ZWFtIH49IFRFQU1fTkVVVFJBTCB0aGVuCgkJZGFtYWdlTXVsdGlwbGllciA9IDAuNjAgKiBkYW1hZ2VNdWx0aXBsaWVyCgllbmQKCgktLSBoZXJvcyBkZWFsIGxlc3MgZGFtYWdlIHRvIHR1cnJldHMKCWlmIHNvdXJjZS50eXBlID09ICJvYmpfQUlfSGVybyIgYW5kIHRhcmdldC50eXBlID09ICJvYmpfQUlfVHVycmV0IiB0aGVuCgkJZGFtYWdlTXVsdGlwbGllciA9IDAuOTUgKiBkYW1hZ2VNdWx0aXBsaWVyCgllbmQKCgktLSBtaW5pb25zIGRlYWwgbGVzcyBkYW1hZ2UgdG8gdHVycmV0cwoJaWYgc291cmNlLnR5cGUgPT0gIm9ial9BSV9NaW5pb24iIGFuZCB0YXJnZXQudHlwZSA9PSAib2JqX0FJX1R1cnJldCIgdGhlbgoJCWRhbWFnZU11bHRpcGxpZXIgPSAwLjQ3NSAqIGRhbWFnZU11bHRpcGxpZXIKCWVuZAoKCS0tIHNpZWdlIG1pbmlvbnMgYW5kIHN1cGVybWluaW9ucyB0YWtlIGxlc3MgZGFtYWdlIGZyb20gdHVycmV0cwoJaWYgc291cmNlLnR5cGUgPT0gIm9ial9BSV9UdXJyZXQiIGFuZCAodGFyZ2V0LmNoYXJOYW1lID09ICJSZWRfTWluaW9uX01lY2hDYW5ub24iIG9yIHRhcmdldC5jaGFyTmFtZSA9PSAiQmx1ZV9NaW5pb25fTWVjaENhbm5vbiIpIHRoZW4KCQlkYW1hZ2VNdWx0aXBsaWVyID0gMC44ICogZGFtYWdlTXVsdGlwbGllcgoJZW5kCgoJLS0gY2FzdGVyIG1pbmlvbnMgYW5kIGJhc2ljIG1pbmlvbnMgdGFrZSBtb3JlIGRhbWFnZSBmcm9tIHR1cnJldHMKCWlmIHNvdXJjZS50eXBlID09ICJvYmpfQUlfVHVycmV0IiBhbmQgKHRhcmdldC5jaGFyTmFtZSA9PSAiUmVkX01pbmlvbl9XaXphcmQiIG9yIHRhcmdldC5jaGFyTmFtZSA9PSAiQmx1ZV9NaW5pb25fV2l6YXJkIiBvciB0YXJnZXQuY2hhck5hbWUgPT0gIlJlZF9NaW5pb25fQmFzaWMiIG9yIHRhcmdldC5jaGFyTmFtZSA9PSAiQmx1ZV9NaW5pb25fQmFzaWMiKSB0aGVuCgkJZGFtYWdlTXVsdGlwbGllciA9ICgxIC8gMC44NzUpICogZGFtYWdlTXVsdGlwbGllcgoJZW5kCgoJLS0gdHVycmV0cyBkZWFsIG1vcmUgZGFtYWdlIHRvIGFsbCB1bml0cyBieSBkZWZhdWx0CglpZiBzb3VyY2UudHlwZSA9PSAib2JqX0FJX1R1cnJldCIgdGhlbgoJCWRhbWFnZU11bHRpcGxpZXIgPSAxLjA1ICogZGFtYWdlTXVsdGlwbGllcgoJZW5kCgoJLS0gY2FsY3VsYXRlIGRhbWFnZSBkZWFsdAoJcmV0dXJuIGRhbWFnZU11bHRpcGxpZXIgKiB0b3RhbERhbWFnZQplbmQKLS19Cg=="
StoredSourceLib = "LS0gQ2hhbmdlIGF1dG9VcGRhdGUgdG8gZmFsc2UgaWYgeW91IHdpc2ggdG8gbm90IHJlY2VpdmUgYXV0byB1cGRhdGVzLgotLSBDaGFuZ2Ugc2lsZW50VXBkYXRlIHRvIHRydWUgaWYgeW91IHdpc2ggbm90IHRvIHJlY2VpdmUgYW55IG1lc3NhZ2UgcmVnYXJkaW5nIHVwZGF0ZXMKbG9jYWwgYXV0b1VwZGF0ZSAgID0gZmFsc2UKbG9jYWwgc2lsZW50VXBkYXRlID0gZmFsc2UKCmxvY2FsIHZlcnNpb24gPSAxLjA1OAoKLS1bWwoKICAgICAgX19fX19fX19fICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLl9fX18gICAgLl9fX19fLiAgICAKICAgICAvICAgX19fX18vIF9fX18gIF9fIF9fX19fX19fXyAgIF9fX18gIF9fX18gfCAgICB8ICAgfF9fXF8gfF9fICAKICAgICBcX19fX18gIFwgLyAgXyBcfCAgfCAgXF8gIF9fIFxfLyBfX19cLyBfXyBcfCAgICB8ICAgfCAgfHwgX18gXCAKICAgICAvICAgICAgICAoICA8Xz4gKSAgfCAgL3wgIHwgXC9cICBcX19cICBfX18vfCAgICB8X19ffCAgfHwgXF9cIFwKICAgIC9fX19fX19fICAvXF9fX18vfF9fX18vIHxfX3wgICAgXF9fXyAgPl9fXyAgPl9fX19fX18gXF9ffHxfX18gIC8KICAgICAgICAgICAgXC8gICAgICAgICAgICAgICAgICAgICAgICAgIFwvICAgIFwvICAgICAgICBcLyAgICAgICBcLyAKCiAgICBTb3VyY2VMaWIgLSBhIGNvbW1vbiBsaWJyYXJ5IGJ5IFRlYW0gVGhlU291cmNlCiAgICBDb3B5cmlnaHQgKEMpIDIwMTQgIFRlYW0gVGhlU291cmNlCgogICAgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKICAgIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CiAgICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcgogICAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KCiAgICBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKICAgIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCiAgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCiAgICBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgoKICAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCiAgICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8uCgoKICAgIEludHJvZHVjdGlvbjoKICAgICAgICBXZSB3ZXJlIHRpcmVkIG9mIHVwZGF0aW5nIGV2ZXJ5IHNpbmdsZSBzY3JpcHQgd2UgZGV2ZWxvcGVkIHNvIGZhciBzbyB3ZSBkZWNpZGVkIHRvIGhhdmUgaXQgYSBsaXR0bGUgYml0CiAgICAgICAgbW9yZSBkeW5hbWljIHdpdGggYSBjdXN0b20gbGlicmFyeSB3aGljaCB3ZSBjYW4gdXBkYXRlIGluc3RlYWQgYW5kIGV2ZXJ5IHNjcmlwdCB1c2luZyBpdCB3aWxsIGF1dG9tYXRpY2FsbHkKICAgICAgICBiZSB1cGRhdGVkIChvZiBjb3Vyc2Ugb25seSB0aGUgcGFydHMgd2hpY2ggYXJlIGluIHRoaXMgbGliKS4gU28gbGV0J3Mgc2F5IHBhY2tldCBjYXN0aW5nIGdldCdzIGZ1Y2tlZCB1cAogICAgICAgIG9yIHdlIHdhbnQgdG8gY2hhbmdlIHRoZSB3YXkgc29tZSBkcmF3aW5nIGlzIGRvbmUsIHdlIGp1c3QgbmVlZCB0byB1cGRhdGUgaXQgaGVyZSBhbmQgYWxsIHNjcmlwdHMgd2lsbCBoYXZlCiAgICAgICAgdGhlIHNhbWUgdHdlYWtzIHRoZW4uCgogICAgQ29udGVudHM6CiAgICAgICAgUmVxdWlyZSAgICAgICAgIC0tIEEgYmFzaWMgYnV0IHBvd2VyZnVsIGxpYnJhcnkgZG93bmxvYWRlcgogICAgICAgIFNvdXJjZVVwZGF0ZXIgICAtLSBPbmUgb2YgdGhlIG1vc3QgYmFzaWMgZnVuY3Rpb25zIGZvciBldmVyeSBzY3JpcHQgd2UgdXNlCiAgICAgICAgU3BlbGwgICAgICAgICAgIC0tIFNwZWxscyBoYW5kbGVkIHRoZSB3YXkgdGhleSBzaG91bGQgYmUgaGFuZGxlZAogICAgICAgIERyYXdNYW5hZ2VyICAgICAtLSBFYXN5IGRyYXdpbmcgb2YgYWxsIGtpbmQgb2YgdGhpbmdzLCBjb21lcyBhbG9uZyB3aXRoIHNvbWUgb3RoZXIgY2xhc3NlcyBzdWNoIGFzIENpcmNsZQogICAgICAgIERhbWFnZUxpYiAgICAgICAtLSBDYWxjdWxhdGUgdGhlIGRhbWFnZSBkb25lIGRvIG90aGVycyBhbmQgZXZlbiBwcmludCBpdCBvbiB0aGVpciBoZWFsdGhiYXIKICAgICAgICBTVFMgICAgICAgICAgICAgLS0gU2ltcGxlVGFyZ2V0U2VsZWN0b3IgaXMgYSBzaW1wbGUgYW5kIHlldCBwb3dlcmZ1bCB0YXJnZXQgc2VsZWN0b3IgdG8gcHJvdmlkZSB2ZXJ5IGJhc2ljIHRhcmdldCBzZWxlY3RpbmcKICAgICAgICBNZW51V3JhcHBlciAgICAgLS0gRWFzeSBtZW51IGNyZWF0aW9uIHdpdGggb25seSBhIGZldyBsaW5lcwogICAgICAgIEludGVycnVwdGVyICAgICAtLSBFYXN5IHdheSB0byBoYW5kbGUgaW50ZXJydXB0YWJsZSBzcGVsbHMKICAgICAgICBBbnRpR2V0Y2xvc2VyICAgLS0gTmV2ZXIgbGV0IHRoZW0gZ2V0IGNsb3NlIHRvIHlvdQoKXV0KCi0tIFRlbXBvcmFyeSBoZXJlIHVudGlsIGl0J3MgaW5jbHVkZWQgaW4gQm9MIGl0c2VsZgppZiBWSVBfVVNFUiB0aGVuCiAgICBBZGRCdWdzcGxhdENhbGxiYWNrKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwID0gQ0xvTFBhY2tldCgweDlCKQogICAgICAgIHAuZHdBcmcxID0gMQogICAgICAgIHAuZHdBcmcyID0gMAogICAgICAgIHA6RW5jb2RlNCgwKQogICAgICAgIFNlbmRQYWNrZXQocCkKICAgIGVuZCkKZW5kCgotLVtbCgonfHwnJ3wuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgICAgICAgICAgICAgICAgICAKIHx8ICAgfHwgICAgLi4uLiAgICAuLi4gLiAgLi4uIC4uLiAgLi4uICAuLi4gLi4gICAgLi4uLiAgCiB8fCcnfCcgICAufC4uLnx8IC4nICAgfHwgICB8fCAgfHwgICB8fCAgIHx8JyAnJyAufC4uLnx8IAogfHwgICB8LiAgfHwgICAgICB8LiAgIHx8ICAgfHwgIHx8ICAgfHwgICB8fCAgICAgfHwgICAgICAKLnx8LiAgJ3wnICAnfC4uLicgJ3wuLid8fCAgICd8Li4nfC4gLnx8LiAufHwuICAgICAnfC4uLicgCiAgICAgICAgICAgICAgICAgICAgICAgfHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgJycnJyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCiAgICBSZXF1aXJlIC0gQSBzaW1wbGUgbGlicmFyeSBkb3dubG9hZGVyCgogICAgSW50cm9kdWN0aW9uOgogICAgICAgIElmIHlvdSB3YW50IHRvIHVzZSB0aGlzIGNsYXNzIHlvdSBuZWVkIHRvIHB1dCB0aGlzIGF0IHRoZSBiZWdpbm5pbmcgb2YgeW91IHNjcmlwdC4KICAgICAgICBFeGFtcGxlOgogICAgICAgICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgIGlmIHBsYXllci5jaGFyTmFtZSB+PSAiQnJhbmQiIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICByZXF1aXJlICJTb3VyY2VMaWIiCgogICAgICAgICAgICBsb2NhbCBsaWJEb3dubG9hZGVyID0gUmVxdWlyZSgiQnJhbmQgc2NyaXB0IikKICAgICAgICAgICAgbGliRG93bmxvYWRlcjpBZGQoIlZQcmVkaWN0aW9uIiwgImh0dHBzOi8vYml0YnVja2V0Lm9yZy9ob25kYTcvYm9sL3Jhdy9tYXN0ZXIvQ29tbW9uL1ZQcmVkaWN0aW9uLmx1YSIpCiAgICAgICAgICAgIGxpYkRvd25sb2FkZXI6QWRkKCJTT1ciLCAgICAgICAgICJodHRwczovL2JpdGJ1Y2tldC5vcmcvaG9uZGE3L2JvbC9yYXcvbWFzdGVyL0NvbW1vbi9TT1cubHVhIikKICAgICAgICAgICAgbGliRG93bmxvYWRlcjpDaGVjaygpCgogICAgICAgICAgICBpZiBsaWJEb3dubG9hZGVyLmRvd25sb2FkTmVlZGVkIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgRnVuY3Rpb25zOgogICAgICAgIFJlcXVpcmUobXlOYW1lKQoKICAgIE1lbWJlcnM6CiAgICAgICAgUmVxdWlyZS5kb3dubG9hZE5lZWRlZAoKICAgIE1ldGhvZHM6CiAgICAgICAgUmVxdWlyZTpBZGQobmFtZSwgdXJsKQogICAgICAgIFJlcXVpcmU6Q2hlY2soKQpdXQpjbGFzcyAnUmVxdWlyZScKCmZ1bmN0aW9uIF9fcmVxdWlyZV9hZnRlckRvd25sb2FkKHJlcXVpcmVJbnN0YW5jZSkKCiAgICByZXF1aXJlSW5zdGFuY2UuZG93bmxvYWRDb3VudCA9IHJlcXVpcmVJbnN0YW5jZS5kb3dubG9hZENvdW50IC0gMQogICAgaWYgcmVxdWlyZUluc3RhbmNlLmRvd25sb2FkQ291bnQgPT0gMCB0aGVuCiAgICAgICAgcHJpbnQoIjxmb250IGNvbG9yPVwiIzY2OTlmZlwiPjxiPiIgLi4gcmVxdWlyZUluc3RhbmNlLm15TmFtZSAuLiAiOjwvYj48L2ZvbnQ+IDxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPlJlcXVpcmVkIGxpYnJhcmllcyBkb3dubG9hZGVkISBQbGVhc2UgcmVsb2FkITwvZm9udD4iKQogICAgZW5kCgplbmQKCmZ1bmN0aW9uIFJlcXVpcmU6X19pbml0KG15TmFtZSkKCiAgICBzZWxmLm15TmFtZSA9IG15TmFtZSBvciBHZXRDdXJyZW50RW52KCkuRklMRV9OQU1FCiAgICBzZWxmLmRvd25sb2FkTmVlZGVkID0gZmFsc2UKCiAgICBzZWxmLnJlcXVpcmVtZW50cyA9IHt9CgplbmQKCmZ1bmN0aW9uIFJlcXVpcmU6QWRkKG5hbWUsIHVybCkKCiAgICBhc3NlcnQobmFtZSBhbmQgdHlwZShuYW1lKSA9PSAic3RyaW5nIiBhbmQgdXJsIGFuZCB0eXBlKHVybCkgPT0gInN0cmluZyIsICJSZXF1aXJlOkFkZCgpOiBTb21lIG9yIGFsbCBhcmd1bWVudHMgYXJlIGludmFsaWQuIikKICAgIAogICAgc2VsZi5yZXF1aXJlbWVudHNbbmFtZV0gPSB1cmwKCiAgICByZXR1cm4gc2VsZgoKZW5kCgpmdW5jdGlvbiBSZXF1aXJlOkNoZWNrKCkKCiAgICBmb3Igc2NyaXB0TmFtZSwgc2NyaXB0VXJsIGluIHBhaXJzKHNlbGYucmVxdWlyZW1lbnRzKSBkbwogICAgICAgIGxvY2FsIHNjcmlwdEZpbGUgPSBMSUJfUEFUSCAuLiBzY3JpcHROYW1lIC4uICIubHVhIgogICAgICAgIGlmIEZpbGVFeGlzdChzY3JpcHRGaWxlKSB0aGVuCiAgICAgICAgICAgIHJlcXVpcmUoc2NyaXB0TmFtZSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIHNlbGYuZG93bmxvYWROZWVkZWQgPSB0cnVlCiAgICAgICAgICAgIHNlbGYuZG93bmxvYWRDb3VudCA9IHNlbGYuZG93bmxvYWRDb3VudCBhbmQgc2VsZi5kb3dubG9hZENvdW50ICsgMSBvciAxCiAgICAgICAgICAgIERvd25sb2FkRmlsZShzY3JpcHRVcmwsIHNjcmlwdEZpbGUsIGZ1bmN0aW9uKCkgX19yZXF1aXJlX2FmdGVyRG93bmxvYWQoc2VsZikgZW5kKQogICAgICAgIGVuZAogICAgZW5kCgogICAgcmV0dXJuIHNlbGYKCmVuZAoKCi0tW1sKCiAufCcnJy58ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd8fCcgICd8JyAgICAgICAgICAgICAgICd8fCAgICAgICAgICAgIC4gICAgICAgICAgICAgICAgICAgCiB8fC4uICAnICAgIC4uLiAgIC4uLiAuLi4gIC4uLiAuLiAgICAuLi4uICAgIC4uLi4gICB8fCAgICB8ICAuLi4gLi4uICAgICAuLiB8fCAgIC4uLi4gICAufHwuICAgIC4uLi4gIC4uLiAuLiAgCiAgJyd8fHwuICAufCAgJ3wuICB8fCAgfHwgICB8fCcgJycgLnwgICAnJyAufC4uLnx8ICB8fCAgICB8ICAgfHwnICB8fCAgLicgICd8fCAgJycgLnx8ICAgfHwgICAufC4uLnx8ICB8fCcgJycgCi4gICAgICd8fCB8fCAgIHx8ICB8fCAgfHwgICB8fCAgICAgfHwgICAgICB8fCAgICAgICB8fCAgICB8ICAgfHwgICAgfCAgfC4gICB8fCAgLnwnIHx8ICAgfHwgICB8fCAgICAgICB8fCAgICAgCnwnLi4uLnwnICAgJ3wuLnwnICAnfC4uJ3wuIC58fC4gICAgICd8Li4uJyAgJ3wuLi4nICAgJ3wuLicgICAgfHwuLi4nICAgJ3wuLid8fC4gJ3wuLid8JyAgJ3wuJyAgJ3wuLi4nIC58fC4gICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJycnICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCgoKICAgIFNvdXJjZVVwZGF0ZXIgLSBhIHNpbXBsZSB1cGRhdGVyIGNsYXNzCgogICAgSW50cm9kdWN0aW9uOgogICAgICAgIFNjcmlwdHMgdGhhdCB3YW50IHRvIHVzZSB0aGlzIGNsYXNzIG5lZWQgdG8gaGF2ZSBhIHZlcnNpb24gZmllbGQgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgc2NyaXB0LCBsaWtlIHRoaXM6CiAgICAgICAgICAgIGxvY2FsIHZlcnNpb24gPSBZT1VSX1ZFUlNJT04gKFlPVVJfVkVSU0lPTiBjYW4gZWl0aGVyIGJlIGEgc3RyaW5nIGEgYSBudW1lcmljIHZhbHVlISkKICAgICAgICBJdCBkb2VzIG5vdCBuZWVkIHRvIGJlIGV4YWN0bHkgYXQgdGhlIGJlZ2lubmluZywgbGlrZSBpbiB0aGlzIHNjcmlwdCwgYnV0IGl0IGhhcyB0byBiZSB3aXRoaW4gdGhlIGZpcnN0IDEwMAogICAgICAgIGNoYXJzIG9mIHRoZSBmaWxlLCBvdGhlcndpc2UgdGhlIHdlYnJlc3VsdCB3b24ndCBzZWUgdGhlIGZpZWxkLCBhcyBpdCBnYXRoZXJzIG9ubHkgYWJvdXQgMTAwIGNoYXJzCgogICAgRnVuY3Rpb25zOgogICAgICAgIFNvdXJjZVVwZGF0ZXIoc2NyaXB0TmFtZSwgdmVyc2lvbiwgaG9zdCwgdXBkYXRlUGF0aCwgZmlsZVBhdGgsIHZlcnNpb25QYXRoKQoKICAgIE1lbWJlcnM6CiAgICAgICAgU291cmNlVXBkYXRlci5zaWxlbnQgfCBib29sIHwgRGVmaW5lcyB3aGVhdGhlciB0byBwcmludCBub3RpZmljYXRpb25zIG9yIG5vdAoKICAgIE1ldGhvZHM6CiAgICAgICAgU291cmNlVXBkYXRlcjpTZXRTaWxlbnQoc2lsZW50KQogICAgICAgIFNvdXJjZVVwZGF0ZXI6Q2hlY2tVcGRhdGUoKQoKXV0KY2xhc3MgJ1NvdXJjZVVwZGF0ZXInCgotLVtbCiAgICBDcmVhdGUgYSBuZXcgaW5zdGFuY2Ugb2YgU291cmNlVXBkYXRlcgoKICAgIEBwYXJhbSBzY3JpcHROYW1lICB8IHN0cmluZyAgICAgICAgfCBOYW1lIG9mIHRoZSBzY3JpcHQgd2hpY2ggc2hvdWxkIGJlIHVzZWQgd2hlbiBwcmludGVkIGluIGNoYXQKICAgIEBwYXJhbSB2ZXJzaW9uICAgICB8IGZsb2F0L3N0cmluZyAgfCBDdXJyZW50IHZlcnNpb24gb2YgdGhlIHNjcmlwdAogICAgQHBhcmFtIGhvc3QgICAgICAgIHwgc3RyaW5nICAgICAgICB8IEhvc3QsIGZvciBleGFtcGxlICJiaXRidWNrZXQub3JnIiBvciAicmF3LmdpdGh1Yi5jb20iCiAgICBAcGFyYW0gdXBkYXRlUGF0aCAgfCBzdHJpbmcgICAgICAgIHwgUmF3IHBhdGggdG8gdGhlIHNjcmlwdCB3aGljaCBzaG91bGQgYmUgdXBkYXRlZAogICAgQHBhcmFtIGZpbGVQYXRoICAgIHwgc3RyaW5nICAgICAgICB8IFBhdGggdG8gdGhlIGZpbGUgd2hpY2ggc2hvdWxkIGJlIHJlcGxhY2VkIHdoZW4gdXBkYXRpbmcgdGhlIHNjcmlwdAogICAgQHBhcmFtIHZlcnNpb25QYXRoIHwgc3RyaW5nICAgICAgICB8IChvcHRpb25hbCkgUGF0aCB0byBhIHZlcnNpb24gZmlsZSB0byBjaGVjayBhZ2FpbnN0LiBUaGUgdmVyc2lvbiBmaWxlIG1heSBvbmx5IGNvbnRhaW4gdGhlIHZlcnNpb24uCl1dCmZ1bmN0aW9uIFNvdXJjZVVwZGF0ZXI6X19pbml0KHNjcmlwdE5hbWUsIHZlcnNpb24sIGhvc3QsIHVwZGF0ZVBhdGgsIGZpbGVQYXRoLCB2ZXJzaW9uUGF0aCkKCiAgICBzZWxmLnByaW50TWVzc2FnZSA9IGZ1bmN0aW9uKG1lc3NhZ2UpIGlmIG5vdCBzZWxmLnNpbGVudCB0aGVuIHByaW50KCI8Zm9udCBjb2xvcj1cIiM2Njk5ZmZcIj48Yj4iIC4uIHNlbGYuVVBEQVRFX1NDUklQVF9OQU1FIC4uICI6PC9iPjwvZm9udD4gPGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IiAuLiBtZXNzYWdlIC4uICI8L2ZvbnQ+IikgZW5kIGVuZAogICAgc2VsZi5nZXRWZXJzaW9uID0gZnVuY3Rpb24odmVyc2lvbikgcmV0dXJuIHRvbnVtYmVyKHN0cmluZy5tYXRjaCh2ZXJzaW9uLCAiJWQrJS4/JWQqIikpIGVuZAoKICAgIHNlbGYuVVBEQVRFX1NDUklQVF9OQU1FID0gc2NyaXB0TmFtZQogICAgc2VsZi5VUERBVEVfSE9TVCA9IGhvc3QKICAgIHNlbGYuVVBEQVRFX1BBVEggPSB1cGRhdGVQYXRoIC4uICI/cmFuZD0iLi5tYXRoLnJhbmRvbSgxLDEwMDAwKQogICAgc2VsZi5VUERBVEVfVVJMID0gImh0dHBzOi8vIi4uc2VsZi5VUERBVEVfSE9TVC4uc2VsZi5VUERBVEVfUEFUSAoKICAgIC0tIFVzZWQgZm9yIHZlcnNpb24gZmlsZXMKICAgIHNlbGYuVkVSU0lPTl9QQVRIID0gdmVyc2lvblBhdGggYW5kIHZlcnNpb25QYXRoIC4uICI/cmFuZD0iLi5tYXRoLnJhbmRvbSgxLDEwMDAwKQogICAgc2VsZi5WRVJTSU9OX1VSTCA9IHZlcnNpb25QYXRoIGFuZCAiaHR0cHM6Ly8iLi5zZWxmLlVQREFURV9IT1NULi5zZWxmLlZFUlNJT05fUEFUSAoKICAgIHNlbGYuVVBEQVRFX0ZJTEVfUEFUSCA9IGZpbGVQYXRoCgogICAgc2VsZi5GSUxFX1ZFUlNJT04gPSBzZWxmLmdldFZlcnNpb24odmVyc2lvbikKICAgIHNlbGYuU0VSVkVSX1ZFUlNJT04gPSBuaWwKCiAgICBzZWxmLnNpbGVudCA9IGZhbHNlCgplbmQKCi0tW1sKICAgIEFsbG93cyBvciBkaXNhbGxvd3MgdGhlIHVwZGF0ZXIgdG8gcHJpbnQgaW5mbyBhYm91dCB1cGRhdGluZwoKICAgIEBwYXJhbSAgfCBib29sICAgfCBNZXNzYWdlIG91dHB1dCBvciBub3QKICAgIEByZXR1cm4gfCBjbGFzcyAgfCBUaGUgY3VycmVudCBpbnN0YW5jZQpdXQpmdW5jdGlvbiBTb3VyY2VVcGRhdGVyOlNldFNpbGVudChzaWxlbnQpCgogICAgc2VsZi5zaWxlbnQgPSBzaWxlbnQKICAgIHJldHVybiBzZWxmCgplbmQKCi0tW1sKICAgIENoZWNrIGZvciBhbiB1cGRhdGUgYW5kIGRvd25sb2FkcyBpdCB3aGVuIGF2YWlsYWJsZQpdXQpmdW5jdGlvbiBTb3VyY2VVcGRhdGVyOkNoZWNrVXBkYXRlKCkKCiAgICBsb2NhbCB3ZWJSZXN1bHQgPSBHZXRXZWJSZXN1bHQoc2VsZi5VUERBVEVfSE9TVCwgc2VsZi5WRVJTSU9OX1BBVEggb3Igc2VsZi5VUERBVEVfUEFUSCkKICAgIGlmIHdlYlJlc3VsdCB0aGVuCiAgICAgICAgaWYgc2VsZi5WRVJTSU9OX1BBVEggdGhlbgogICAgICAgICAgICBzZWxmLlNFUlZFUl9WRVJTSU9OID0gd2ViUmVzdWx0CiAgICAgICAgZWxzZQogICAgICAgICAgICBzZWxmLlNFUlZFUl9WRVJTSU9OID0gc3RyaW5nLm1hdGNoKHdlYlJlc3VsdCwgIiVzKmxvY2FsJXMrdmVyc2lvbiVzKz0lcysuKiVkKyUuJWQrIikKICAgICAgICBlbmQKICAgICAgICBpZiBzZWxmLlNFUlZFUl9WRVJTSU9OIHRoZW4KICAgICAgICAgICAgc2VsZi5TRVJWRVJfVkVSU0lPTiA9IHNlbGYuZ2V0VmVyc2lvbihzZWxmLlNFUlZFUl9WRVJTSU9OKQogICAgICAgICAgICBpZiBzZWxmLkZJTEVfVkVSU0lPTiA8IHNlbGYuU0VSVkVSX1ZFUlNJT04gdGhlbgogICAgICAgICAgICAgICAgc2VsZi5wcmludE1lc3NhZ2UoIk5ldyB2ZXJzaW9uIGF2YWlsYWJsZTogdiIgLi4gc2VsZi5TRVJWRVJfVkVSU0lPTikKICAgICAgICAgICAgICAgIHNlbGYucHJpbnRNZXNzYWdlKCJVcGRhdGluZywgcGxlYXNlIGRvbid0IHByZXNzIEY5IikKICAgICAgICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uICgpIERvd25sb2FkRmlsZShzZWxmLlVQREFURV9VUkwsIHNlbGYuVVBEQVRFX0ZJTEVfUEFUSCwgZnVuY3Rpb24gKCkgc2VsZi5wcmludE1lc3NhZ2UoIlN1Y2Nlc3NmdWxseSB1cGRhdGVkLCBwbGVhc2UgcmVsb2FkISIpIGVuZCkgZW5kLCAyKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBzZWxmLnByaW50TWVzc2FnZSgiWW91J3ZlIGdvdCB0aGUgbGF0ZXN0IHZlcnNpb246IHYiIC4uIHNlbGYuU0VSVkVSX1ZFUlNJT04pCiAgICAgICAgICAgIGVuZAogICAgICAgIGVsc2UKICAgICAgICAgICAgc2VsZi5wcmludE1lc3NhZ2UoIlNvbWV0aGluZyB3ZW50IHdyb25nISBQbGVhc2UgbWFudWFsbHkgdXBkYXRlIHRoZSBzY3JpcHQhIikKICAgICAgICBlbmQKICAgIGVsc2UKICAgICAgICBzZWxmLnByaW50TWVzc2FnZSgiRXJyb3IgZG93bmxvYWRpbmcgdmVyc2lvbiBpbmZvISIpCiAgICBlbmQKCmVuZAoKCi0tW1sKCiAufCcnJy58ICAgICAgICAgICAgICAgICAgICd8fCAgJ3x8ICAKIHx8Li4gICcgIC4uLiAuLi4gICAgLi4uLiAgIHx8ICAgfHwgIAogICcnfHx8LiAgIHx8JyAgfHwgLnwuLi58fCAgfHwgICB8fCAgCi4gICAgICd8fCAgfHwgICAgfCB8fCAgICAgICB8fCAgIHx8ICAKfCcuLi4ufCcgICB8fC4uLicgICAnfC4uLicgLnx8LiAufHwuIAogICAgICAgICAgIHx8ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAnJycnICAgICAgICAgICAgICAgICAgICAgICAKCiAgICBTcGVsbCAtIEhhbmRsZWQgd2l0aCBlYXNlIQoKICAgIEZ1bmN0aW9uczoKICAgICAgICBTcGVsbChzcGVsbElkLCByYW5nZSwgcGFja2V0Q2FzdCkKCiAgICBNZW1iZXJzOgogICAgICAgIFNwZWxsLnJhbmdlICAgICAgICAgIHwgZmxvYXQgIHwgUmFuZ2Ugb2YgdGhlIHNwZWxsLCBwbGVhc2UgZG8gTk9UIGNoYW5nZSB0aGlzIHZhbHVlLCB1c2UgU3BlbGw6U2V0UmFuZ2UoKSBpbnN0ZWFkCiAgICAgICAgU3BlbGwucmFuZ2VTcXIgICAgICAgfCBmbG9hdCAgfCBTcXVhcmVkIHJhbmdlIG9mIHRoZSBzcGVsbCwgcGxlYXNlIGRvIE5PVCBjaGFuZ2UgdGhpcyB2YWx1ZSwgdXNlIFNwZWxsOlNldFJhbmdlKCkgaW5zdGVhZAogICAgICAgIFNwZWxsLnBhY2tldENhc3QgICAgIHwgYm9vbCAgIHwgU2V0IHBhY2tldCBjYXN0IHN0YXRlCiAgICAgICAgLS0gVGhpcyBvbmx5IGFwcGxpZXMgZm9yIHNraWxsc2hvdHMKICAgICAgICBTcGVsbC5zb3VyY2VQb3NpdGlvbiB8IHZlY3RvciB8IEZyb20gd2hlcmUgdGhlIHNwZWxsIGlzIGNhc3RlZCwgZGVmYXVsdDogcGxheWVyCiAgICAgICAgU3BlbGwuc291cmNlUmFuZ2UgICAgfCB2ZWN0b3IgfCBGcm9tIHdoZXJlIHRoZSByYW5nZSBzaG91bGQgYmUgY2FsY3VsYXRlZCwgZGVmYXVsdDogcGxheWVyCiAgICAgICAgLS0gVGhpcyBvbmx5IGFwcGxpZXMgZm9yIEFPRSBza2lsbHNob3RzCiAgICAgICAgU3BlbGwubWluVGFyZ2V0c0FvZSAgfCBpbnQgICAgfCBTZXQgbWluaW11bSB0YXJnZXRzIGZvciBBT0UgZGFtYWdlCgogICAgTWV0aG9kczoKICAgICAgICBTcGVsbDpTZXRSYW5nZShyYW5nZSkKICAgICAgICBTcGVsbDpTZXRTb3VyY2Uoc291cmNlKQogICAgICAgIFNwZWxsOlNldFNvdXJjZVBvc2l0aW9uKHNvdXJjZSkKICAgICAgICBTcGVsbDpTZXRTb3VyY2VSYW5nZShzb3VyY2UpCgogICAgICAgIFNwZWxsOlNldFNraWxsc2hvdChWUCwgc2tpbGxzaG90VHlwZSwgd2lkdGgsIGRlbGF5LCBzcGVlZCwgY29sbGlzaW9uKQogICAgICAgIFNwZWxsOlNldEFPRSh1c2VBb2UsIHJhZGl1cywgbWluVGFyZ2V0c0FvZSkKCiAgICAgICAgU3BlbGw6U2V0Q2hhcmdlZChzcGVsbE5hbWUsIGNoYXJnZUR1cmF0aW9uLCBtYXhSYW5nZSwgdGltZVRvTWF4UmFuZ2UsIGFib3J0Q29uZGl0aW9uKQogICAgICAgIFNwZWxsOklzQ2hhcmdpbmcoKQogICAgICAgIFNwZWxsOkNoYXJnZSgpCgogICAgICAgIFNwZWxsOlNldEhpdENoYW5jZShoaXRDaGFuY2UpCiAgICAgICAgU3BlbGw6VmFsaWRUYXJnZXQodGFyZ2V0KQoKICAgICAgICBTcGVsbDpHZXRQcmVkaWN0aW9uKHRhcmdldCkKICAgICAgICBTcGVsbDpDYXN0SWZEYXNoaW5nKHRhcmdldCkKICAgICAgICBTcGVsbDpDYXN0SWZJbW1vYmlsZSh0YXJnZXQpCiAgICAgICAgU3BlbGw6Q2FzdChwYXJhbTEsIHBhcmFtMikKCiAgICAgICAgU3BlbGw6QWRkQXV0b21hdGlvbihhdXRvbWF0aW9uSWQsIGZ1bmMpCiAgICAgICAgU3BlbGw6UmVtb3ZlQXV0b21hdGlvbihhdXRvbWF0aW9uSWQpCiAgICAgICAgU3BlbGw6Q2xlYXJBdXRvbWF0aW9ucygpCgogICAgICAgIFNwZWxsOlRyYWNrQ2FzdGluZyhzcGVsbE5hbWUpCiAgICAgICAgU3BlbGw6V2lsbEhpdFRhcmdldCgpCiAgICAgICAgU3BlbGw6UmVnaXN0ZXJDYXN0Q2FsbGJhY2soZnVuYykKCiAgICAgICAgU3BlbGw6R2V0TGFzdENhc3RUaW1lKCkKCiAgICAgICAgU3BlbGw6SXNJblJhbmdlKHRhcmdldCwgZnJvbSkKICAgICAgICBTcGVsbDpJc1JlYWR5KCkKICAgICAgICBTcGVsbDpHZXRNYW5hVXNhZ2UoKQogICAgICAgIFNwZWxsOkdldENvb2xkb3duKCkKICAgICAgICBTcGVsbDpHZXRMZXZlbCgpCiAgICAgICAgU3BlbGw6R2V0TmFtZSgpCgpdXQpjbGFzcyAnU3BlbGwnCgotLSBDbGFzcyByZWxhdGVkIGNvbnN0YW50cwpTS0lMTFNIT1RfTElORUFSICAgPSAwClNLSUxMU0hPVF9DSVJDVUxBUiA9IDEKU0tJTExTSE9UX0NPTkUgICAgID0gMgoKLS0gRGlmZmVyZW50IFNwZWxsU3RhdGVzIHJldHVybmVkIHdoZW4gU3BlbGw6Q2FzdCgpIGlzIGNhbGxlZApTUEVMTFNUQVRFX1RSSUdHRVJFRCAgICAgICAgICA9IDAKU1BFTExTVEFURV9PVVRfT0ZfUkFOR0UgICAgICAgPSAxClNQRUxMU1RBVEVfTE9XRVJfSElUQ0hBTkNFICAgID0gMgpTUEVMTFNUQVRFX0NPTExJU0lPTiAgICAgICAgICA9IDMKU1BFTExTVEFURV9OT1RfRU5PVUdIX1RBUkdFVFMgPSA0ClNQRUxMU1RBVEVfTk9UX0RBU0hJTkcgICAgICAgID0gNQpTUEVMTFNUQVRFX0RBU0hJTkdfQ0FOVF9ISVQgICA9IDYKU1BFTExTVEFURV9OT1RfSU1NT0JJTEUgICAgICAgPSA3ClNQRUxMU1RBVEVfSU5WQUxJRF9UQVJHRVQgICAgID0gOApTUEVMTFNUQVRFX05PVF9UUklHR0VSRUQgICAgICA9IDkKCi0tIFNwZWxsIGlkZW50aWZpZXIgbnVtYmVyIHVzZWQgZm9yIGNvbXBhcmluZyBzcGVsbHMKbG9jYWwgc3BlbGxOdW0gPSAxCgotLVtbCiAgICBOZXcgaW5zdGFuY2Ugb2YgU3BlbGwKCiAgICBAcGFyYW0gc3BlbGxJZCAgICB8IGludCAgIHwgU3BlbGwgSUQgKF9RLCBfVywgX0UsIF9SKQogICAgQHBhcmFtIHJhbmdlICAgICAgfCBmbG9hdCB8IFJhbmdlIG9mIHRoZSBzcGVsbAogICAgQHBhcmFtIHBhY2tldENhc3QgfCBib29sICB8IChvcHRpb25hbCkgRW5hYmxlIHBhY2tldCBjYXN0aW5nCl1dCmZ1bmN0aW9uIFNwZWxsOl9faW5pdChzcGVsbElkLCByYW5nZSwgcGFja2V0Q2FzdCkKCiAgICBhc3NlcnQoc3BlbGxJZCB+PSBuaWwgYW5kIHJhbmdlIH49IG5pbCBhbmQgdHlwZShzcGVsbElkKSA9PSAibnVtYmVyIiBhbmQgdHlwZShyYW5nZSkgPT0gIm51bWJlciIsICJTcGVsbDogQ2FuJ3QgaW5pdGlhbGl6ZSBTcGVsbCB3aXRob3V0IHZhbGlkIGFyZ3VtZW50cy4iKQoKICAgIHNlbGYuc3BlbGxJZCA9IHNwZWxsSWQKICAgIHNlbGY6U2V0UmFuZ2UocmFuZ2UpCiAgICBzZWxmLnBhY2tldENhc3QgPSBwYWNrZXRDYXN0IG9yIGZhbHNlCgogICAgc2VsZjpTZXRTb3VyY2UocGxheWVyKQoKICAgIHNlbGYuX2F1dG9tYXRpb25zID0ge30KCiAgICBzZWxmLl9zcGVsbE51bSA9IHNwZWxsTnVtCiAgICBzcGVsbE51bSA9IHNwZWxsTnVtICsgMQoKZW5kCgotLVtbCiAgICBVcGRhdGUgdGhlIHNwZWxsIHJhbmdlIHdpdGggdGhlIG5ldyBnaXZlbiB2YWx1ZQoKICAgIEBwYXJhbSByYW5nZSB8IGZsb2F0IHwgUmFuZ2Ugb2YgdGhlIHNwZWxsCiAgICBAcmV0dXJuICAgICAgfCBjbGFzcyB8IFRoZSBjdXJyZW50IGluc3RhbmNlCl1dCmZ1bmN0aW9uIFNwZWxsOlNldFJhbmdlKHJhbmdlKQoKICAgIGFzc2VydChyYW5nZSBhbmQgdHlwZShyYW5nZSkgPT0gIm51bWJlciIsICJTcGVsbDogcmFuZ2UgaXMgaW52YWxpZCIpCgogICAgc2VsZi5yYW5nZSA9IHJhbmdlCiAgICBzZWxmLnJhbmdlU3FyID0gbWF0aC5wb3cocmFuZ2UsIDIpCgogICAgcmV0dXJuIHNlbGYKCmVuZAoKLS1bWwogICAgVXBkYXRlIGJvdGggdGhlIHNvdXJjZVBvc2l0aW9uIGFuZCBzb3VyY2VSYW5nZSBmcm9tIHdoZXJlIGV2ZXJ5dGhpbmcgd2lsbCBiZSBjYWxjdWxhdGVkCgogICAgQHBhcmFtIHNvdXJjZSB8IEN1bml0IHwgU291cmNlIHBvc2l0aW9uLCBmb3IgZXhhbXBsZSBwbGF5ZXIKICAgIEByZXR1cm4gICAgICAgfCBjbGFzcyB8IFRoZSBjdXJyZW50IGluc3RhbmNlCl1dCmZ1bmN0aW9uIFNwZWxsOlNldFNvdXJjZShzb3VyY2UpCgogICAgYXNzZXJ0KHNvdXJjZSwgIlNwZWxsOiBzb3VyY2UgY2FuJ3QgYmUgbmlsISIpCgogICAgc2VsZi5zb3VyY2VQb3NpdGlvbiA9IHNvdXJjZQogICAgc2VsZi5zb3VyY2VSYW5nZSAgICA9IHNvdXJjZQoKICAgIHJldHVybiBzZWxmCgplbmQKCi0tW1sKICAgIFVwZGF0ZSB0aGUgc291cmNlIHBvc290aW9uIGZyb20gd2hlcmUgdGhlIHNwZWxsIHdpbGwgYmUgc2hvdAoKICAgIEBwYXJhbSBzb3VyY2UgfCBDdW5pdCB8IFNvdXJjZSBwb3NpdGlvbiBmcm9tIHdoZXJlIHRoZSBzcGVsbCB3aWxsIGJlIHNob3QsIHBsYXllciBieSBkZWZhdWx0CiAgICBAIHJldHVybiAgICAgIHwgY2xhc3MgfCBUaGUgY3VycmVudCBpbnN0YW5jZQpdXQpmdW5jdGlvbiBTcGVsbDpTZXRTb3VyY2VQb3NpdGlvbihzb3VyY2UpCgogICAgYXNzZXJ0KHNvdXJjZSwgIlNwZWxsOiBzb3VyY2UgY2FuJ3QgYmUgbmlsISIpCgogICAgc2VsZi5zb3VyY2VQb3NpdGlvbiA9IHNvdXJjZQoKICAgIHJldHVybiBzZWxmCgplbmQKCi0tW1sKICAgIFVwZGF0ZSB0aGUgc291cmNlIHVuaXQgZnJvbSB3aGVyZSB0aGUgcmFuZ2Ugd2lsbCBiZSBjYWxjdWxhdGVkCgogICAgQHBhcmFtIHNvdXJjZSB8IEN1bml0IHwgU291cmNlIG9iamVjdCB1bml0IGZyb20gd2hlcmUgdGhlIHJhbmdlIHNob3VsZCBiZSBjYWxjdWxlZAogICAgQHJldHVybiAgICAgICB8IGNsYXNzIHwgVGhlIGN1cnJlbnQgaW5zdGFuY2UKXV0KZnVuY3Rpb24gU3BlbGw6U2V0U291cmNlUmFuZ2Uoc291cmNlKQoKICAgIGFzc2VydChzb3VyY2UsICJTcGVsbDogc291cmNlIGNhbid0IGJlIG5pbCEiKQoKICAgIHNlbGYuc291cmNlUmFuZ2UgPSBzb3VyY2UKCiAgICByZXR1cm4gc2VsZgoKZW5kCgotLVtbCiAgICBEZWZpbmUgdGhpcyBzcGVsbCBhcyBza2lsbHNob3QgKGNhbid0IGJlIHJldmVyc2VkKQoKICAgIEBwYXJhbSBWUCAgICAgICAgICAgIHwgY2xhc3MgfCBJbnN0YW5jZSBvZiBWUHJlZGljdGlvbgogICAgQHBhcmFtIHNraWxsc2hvdFR5cGUgfCBpbnQgICB8IFR5cGUgb2YgdGhpcyBza2lsbHNob3QKICAgIEBwYXJhbSB3aWR0aCAgICAgICAgIHwgZmxvYXQgfCBXaWR0aCBvZiB0aGUgc2tpbGxzaG90CiAgICBAcGFyYW0gZGVsYXkgICAgICAgICB8IGZsb2F0IHwgKG9wdGlvbmFsKSBEZWxheSBpbiBzZWNvbmRzCiAgICBAcGFyYW0gc3BlZWQgICAgICAgICB8IGZsb2F0IHwgKG9wdGlvbmFsKSBTcGVlZCBpbiB1bml0cyBwZXIgc2Vjb25kCiAgICBAcGFyYW0gY29sbGlzaW9uICAgICB8IGJvb2wgIHwgKG9wdGlvbmFsKSBSZXNwZWN0IHVuaXQgY29sbGlzaW9uIHdoZW4gY2FzdGluZwogICAgQHJlcnVybiAgICAgICAgICAgICAgfCBjbGFzcyB8IFRoZSBjdXJyZW50IGluc3RhbmNlCl1dCmZ1bmN0aW9uIFNwZWxsOlNldFNraWxsc2hvdChWUCwgc2tpbGxzaG90VHlwZSwgd2lkdGgsIGRlbGF5LCBzcGVlZCwgY29sbGlzaW9uKQoKICAgIGFzc2VydChza2lsbHNob3RUeXBlIH49IG5pbCwgIlNwZWxsOiBOZWVkIGF0IGxlYXN0IHRoZSBza2lsbHNob3QgdHlwZSEiKQoKICAgIHNlbGYuVlAgPSBWUAogICAgc2VsZi5za2lsbHNob3RUeXBlID0gc2tpbGxzaG90VHlwZQogICAgc2VsZi53aWR0aCA9IHdpZHRoIG9yIDAKICAgIHNlbGYuZGVsYXkgPSBkZWxheSBvciAwCiAgICBzZWxmLnNwZWVkID0gc3BlZWQKICAgIHNlbGYuY29sbGlzaW9uID0gY29sbGlzaW9uCgogICAgaWYgbm90IHNlbGYuaGl0Q2hhbmNlIHRoZW4gc2VsZi5oaXRDaGFuY2UgPSAyIGVuZAoKICAgIHJldHVybiBzZWxmCgplbmQKCi0tW1sKICAgIFNldCB0aGUgQU9FIHN0YXR1cyBvZiB0aGlzIHNwZWxsLCB0aGlzIGNhbiBiZSBjaGFuZ2VkIGxhdGVyCgogICAgQHBhcmFtIHVzZUFvZSAgICAgICAgfCBib29sICB8IE5ldyBBT0Ugc3RhdGUKICAgIEBwYXJhbSByYWRpdXMgICAgICAgIHwgZmxvYXQgfCBSYWRpdXMgb2YgdGhlIEFPRSBkYW1hZ2UKICAgIEBwYXJhbSBtaW5UYXJnZXRzQW9lIHwgaW50ICAgfCBNaW5pbXVtIHRhcmdldHMgdG8gYmUgaGl0dGVkIGJ5IHRoZSBBT0UgZGFtYWdlCiAgICBAcmVydXJuICAgICAgICAgICAgICB8IGNsYXNzIHwgVGhlIGN1cnJlbnQgaW5zdGFuY2UKXV0KZnVuY3Rpb24gU3BlbGw6U2V0QU9FKHVzZUFvZSwgcmFkaXVzLCBtaW5UYXJnZXRzQW9lKQoKICAgIHNlbGYudXNlQW9lID0gdXNlQW9lIG9yIGZhbHNlCiAgICBzZWxmLnJhZGl1cyA9IHJhZGl1cyBvciBzZWxmLndpZHRoCiAgICBzZWxmLm1pblRhcmdldHNBb2UgPSBtaW5UYXJnZXRzQW9lIG9yIDAKCiAgICByZXR1cm4gc2VsZgoKZW5kCgotLVtbCiAgICBEZWZpbmUgdGhpcyBzcGVsbCBhcyBjaGFyZ2VkIHNwZWxsCgogICAgQHBhcmFtIHNwZWxsTmFtZSAgICAgIHwgc3RyaW5nICAgfCBOYW1lIG9mIHRoZSBzcGVsbCwgZXhhbXBsZTogVmFydXNRCiAgICBAcGFyYW0gY2hhcmdlRHVyYXRpb24gfCBmbG9hdCAgICB8IFNlY29uZHMgb2YgdGhlIHNwZWxsIHRvIGNoYXJnZSwgYWZ0ZXIgdGhlIHRpbWUgdGhlIGNoYXJnZSBleHBpcmVzCiAgICBAcGFyYW0gbWF4UmFnZSAgICAgICAgfCBmbG9hdCAgICB8IE1heCByYW5nZSB0aGUgc3BlbGwgd2lsbCBoYXZlIGFmdGVyIGZ1bGx5IGNoYXJnaW5nCiAgICBAcGFyYW0gdGltZVRvTWF4UmFuZ2UgfCBmbG9hdCAgICB8IFRpbWUgaW4gc2Vjb25kcyB0byByZWFjaCBtYXggcmFuZ2UgYWZ0ZXIgY2FzdGluZyB0aGUgc3BlbGwKICAgIEBwYXJhbSBhYm9ydENvbmRpdGlvbiB8IGZ1bmN0aW9uIHwgKG9wdGlvbmFsKSBBIGZ1bmN0aW9uIHdoaWNoIHJldHVybnMgdHJ1ZSB3aGVuIHRoZSBjaGFyZ2UgcHJvY2VzcyBzaG91bGQgYmUgc3RvcHBlZC4KXV0KZnVuY3Rpb24gU3BlbGw6U2V0Q2hhcmdlZChzcGVsbE5hbWUsIGNoYXJnZUR1cmF0aW9uLCBtYXhSYW5nZSwgdGltZVRvTWF4UmFuZ2UsIGFib3J0Q29uZGl0aW9uKQoKICAgIGFzc2VydChzZWxmLnNraWxsc2hvdFR5cGUsICJTcGVsbDpTZXRDaGFyZ2VkKCk6IE9ubHkgc2tpbGxzaG90cyBjYW4gYmUgZGVmaW5lZCBhcyBjaGFyZ2VkIHNwZWxscyEiKQogICAgYXNzZXJ0KHNwZWxsTmFtZSBhbmQgdHlwZShzcGVsbE5hbWUpID09ICJzdHJpbmciIGFuZCBjaGFyZ2VEdXJhdGlvbiBhbmQgdHlwZShjaGFyZ2VEdXJhdGlvbikgPT0gIm51bWJlciIsICJTcGVsbDpTZXRDaGFyZ2VkKCk6IFNvbWUgb3IgYWxsIGFyZ3VtZW50cyBhcmUgaW52YWxpZCEiKQogICAgYXNzZXJ0KHNlbGYuX19jaGFyZ2VkID09IG5pbCwgIlNwZWxsOlNldENoYXJnZWQoKTogQWxyZWFkeSBtYXJrZWQgYXMgY2hhcmdlZCBzcGVsbCEiKQoKICAgIHNlbGYuX19jaGFyZ2VkICAgICAgICAgICA9IHRydWUKICAgIHNlbGYuX19jaGFyZ2VkX2Fib3J0ZWQgICA9IHRydWUKICAgIHNlbGYuX19jaGFyZ2VkX3NwZWxsTmFtZSA9IHNwZWxsTmFtZQogICAgc2VsZi5fX2NoYXJnZWRfZHVyYXRpb24gID0gY2hhcmdlRHVyYXRpb24KCiAgICBzZWxmLl9fY2hhcmdlZF9tYXhSYW5nZSAgICAgICA9IG1heFJhbmdlCiAgICBzZWxmLl9fY2hhcmdlZF9jaGFyZ2VUaW1lICAgICA9IHRpbWVUb01heFJhbmdlCiAgICBzZWxmLl9fY2hhcmdlZF9hYm9ydENvbmRpdGlvbiA9IGFib3J0Q29uZGl0aW9uIG9yIGZ1bmN0aW9uICgpIHJldHVybiBmYWxzZSBlbmQKCiAgICBzZWxmLl9fY2hhcmdlZF9hY3RpdmUgICA9IGZhbHNlCiAgICBzZWxmLl9fY2hhcmdlZF9jYXN0VGltZSA9IDAKCiAgICAtLSBSZWdpc3RlciBjYWxsYmFja3MKICAgIGlmIG5vdCBzZWxmLl9fdGlja0NhbGxiYWNrIHRoZW4KICAgICAgICBBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOk9uVGljaygpIGVuZCkKICAgICAgICBzZWxmLl9fdGlja0NhbGxiYWNrID0gdHJ1ZQogICAgZW5kCgogICAgaWYgbm90IHNlbGYuX19zZW5kUGFja2V0Q2FsbGJhY2sgdGhlbgogICAgICAgIEFkZFNlbmRQYWNrZXRDYWxsYmFjayhmdW5jdGlvbihwKSBzZWxmOk9uU2VuZFBhY2tldChwKSBlbmQpCiAgICAgICAgc2VsZi5fX3NlbmRQYWNrZXRDYWxsYmFjayA9IHRydWUKICAgIGVuZAoKICAgIGlmIG5vdCBzZWxmLl9fcHJvY2Vzc1NwZWxsQ2FsbGJhY2sgdGhlbgogICAgICAgIEFkZFByb2Nlc3NTcGVsbENhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIHNwZWxsKSBzZWxmOk9uUHJvY2Vzc1NwZWxsKHVuaXQsIHNwZWxsKSBlbmQpCiAgICAgICAgc2VsZi5fX3Byb2Nlc3NTcGVsbENhbGxiYWNrID0gdHJ1ZQogICAgZW5kCgogICAgcmV0dXJuIHNlbGYKCmVuZAoKLS1bWwogICAgUmV0dXJucyB3aGV0aGVyIHRoZSBzcGVsbCBpcyBjdXJyZW50bHkgY2hhcmdpbmcgb3Igbm90CgogICAgQHJldHVybiB8IGJvb2wgfCBTcGVsbCBjaGFyZ2luZyBvciBub3QKXV0KZnVuY3Rpb24gU3BlbGw6SXNDaGFyZ2luZygpCiAgICByZXR1cm4gc2VsZi5fX2NoYXJnZWRfYWJvcnRDb25kaXRpb24oKSA9PSBmYWxzZSBhbmQgc2VsZi5fX2NoYXJnZWRfYWN0aXZlCmVuZAoKLS1bWwogICAgQ2hhcmdlcyB0aGUgc3BlbGwKXV0KZnVuY3Rpb24gU3BlbGw6Q2hhcmdlKCkKCiAgICBhc3NlcnQoc2VsZi5fX2NoYXJnZWQsICJTcGVsbDpDaGFyZ2UoKTogU3BlbGwgaXMgbm90IGRlZmluZWQgYXMgY2hhcmdlYWJsZSBzcGVsbCEiKQoKICAgIGlmIG5vdCBzZWxmOklzQ2hhcmdpbmcoKSB0aGVuCiAgICAgICAgUGFja2V0KCJTX0NBU1QiLCB7c3BlbGxJZCA9IHNlbGYuc3BlbGxJZH0pOnNlbmQoKQogICAgZW5kCgplbmQKCi0tIEludGVybmFsIGZ1bmN0aW9uLCBkbyBub3QgdXNlIQpmdW5jdGlvbiBTcGVsbDpfQWJvcnRDaGFyZ2UoKQogICAgaWYgc2VsZi5fX2NoYXJnZWQgYW5kIHNlbGYuX19jaGFyZ2VkX2FjdGl2ZSB0aGVuCiAgICAgICAgc2VsZi5fX2NoYXJnZWRfYWJvcnRlZCA9IHRydWUKICAgICAgICBzZWxmLl9fY2hhcmdlZF9hY3RpdmUgID0gZmFsc2UKICAgICAgICBzZWxmOlNldFJhbmdlKHNlbGYuX19jaGFyZ2VkX2luaXRpYWxSYW5nZSkKICAgIGVuZAplbmQKCi0tW1sKICAgIFNldCB0aGUgaGl0Q2hhbmNlIG9mIHRoZSBwcmVkaWN0ZWQgdGFyZ2V0IHBvc2l0aW9uIHdoZW4gdG8gY2FzdAoKICAgIEBwYXJhbSBoaXRDaGFuY2UgfCBpbnQgICB8IE5ldyBoaXRDaGFuY2UgZm9yIHByZWRpY3RlZCBwb3NpdGlvbnMKICAgIEByZXJ1cm4gICAgICAgICAgfCBjbGFzcyB8IFRoZSBjdXJyZW50IGluc3RhbmNlCl1dCmZ1bmN0aW9uIFNwZWxsOlNldEhpdENoYW5jZShoaXRDaGFuY2UpCgogICAgc2VsZi5oaXRDaGFuY2UgPSBoaXRDaGFuY2Ugb3IgMgoKICAgIHJldHVybiBzZWxmCgplbmQKCi0tW1sKICAgIENoZWNrcyBpZiB0aGUgZ2l2ZW4gdGFyZ2V0IGlzIHZhbGlkIGZvciB0aGUgc3BlbGwKCiAgICBAcGFyYW0gdGFyZ2V0IHwgdXNlcmRhdGEgfCBUYXJnZXQgdG8gYmUgY2hlY2tlZCBpZiB2YWxpZAogICAgQHJldHVybiAgICAgICB8IGJvb2wgICAgIHwgVmFsaWQgdGFyZ2V0IG9yIG5vdApdXQpmdW5jdGlvbiBTcGVsbDpWYWxpZFRhcmdldCh0YXJnZXQsIHJhbmdlKQoKICAgIHJldHVybiBWYWxpZFRhcmdldCh0YXJnZXQsIHJhbmdlIG9yIHNlbGYucmFuZ2UpCgplbmQKCi0tW1sKICAgIFJldHVybnMgdGhlIHByZWRpY3Rpb24gcmVzdWx0cyBmcm9tIFZQcmVkaWN0aW9uIHRvIHVzZSBmb3IgY3VzdG9tIHJlYXNvbnMKCiAgICBAcmV0dXJuIHwgdmFyaW91cyBkYXRhIHwgVGhlIG9yaWdpbmFsIHJlc3VsdCBmcm9tIFZQcmVkaWN0aW9uCl1dCmZ1bmN0aW9uIFNwZWxsOkdldFByZWRpY3Rpb24odGFyZ2V0KQoKICAgIGlmIHNlbGYuc2tpbGxzaG90VHlwZSB+PSBuaWwgdGhlbgogICAgICAgIGlmIHNlbGYuc2tpbGxzaG90VHlwZSA9PSBTS0lMTFNIT1RfTElORUFSIHRoZW4KICAgICAgICAgICAgaWYgc2VsZi51c2VBb2UgdGhlbgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuVlA6R2V0TGluZUFPRUNhc3RQb3NpdGlvbih0YXJnZXQsIHNlbGYuZGVsYXksIHNlbGYucmFkaXVzLCBzZWxmLnJhbmdlLCBzZWxmLnNwZWVkLCBzZWxmLnNvdXJjZVBvc2l0aW9uKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5WUDpHZXRMaW5lQ2FzdFBvc2l0aW9uKHRhcmdldCwgc2VsZi5kZWxheSwgc2VsZi53aWR0aCwgc2VsZi5yYW5nZSwgc2VsZi5zcGVlZCwgc2VsZi5zb3VyY2VQb3NpdGlvbiwgc2VsZi5jb2xsaXNpb24pCiAgICAgICAgICAgIGVuZAogICAgICAgIGVsc2VpZiBzZWxmLnNraWxsc2hvdFR5cGUgPT0gU0tJTExTSE9UX0NJUkNVTEFSIHRoZW4KICAgICAgICAgICAgaWYgc2VsZi51c2VBb2UgdGhlbgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuVlA6R2V0Q2lyY3VsYXJBT0VDYXN0UG9zaXRpb24odGFyZ2V0LCBzZWxmLmRlbGF5LCBzZWxmLnJhZGl1cywgc2VsZi5yYW5nZSwgc2VsZi5zcGVlZCwgc2VsZi5zb3VyY2VQb3NpdGlvbikKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuVlA6R2V0Q2lyY3VsYXJDYXN0UG9zaXRpb24odGFyZ2V0LCBzZWxmLmRlbGF5LCBzZWxmLndpZHRoLCBzZWxmLnJhbmdlLCBzZWxmLnNwZWVkLCBzZWxmLnNvdXJjZVBvc2l0aW9uLCBzZWxmLmNvbGxpc2lvbikKICAgICAgICAgICAgZW5kCiAgICAgICAgIGVsc2VpZiBzZWxmLnNraWxsc2hvdFR5cGUgPT0gU0tJTExTSE9UX0NPTkUgdGhlbgogICAgICAgICAgICBpZiBzZWxmLnVzZUFvZSB0aGVuCiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5WUDpHZXRDb25lQU9FQ2FzdFBvc2l0aW9uKHRhcmdldCwgc2VsZi5kZWxheSwgc2VsZi5yYWRpdXMsIHNlbGYucmFuZ2UsIHNlbGYuc3BlZWQsIHNlbGYuc291cmNlUG9zaXRpb24pCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLlZQOkdldExpbmVDYXN0UG9zaXRpb24odGFyZ2V0LCBzZWxmLmRlbGF5LCBzZWxmLndpZHRoLCBzZWxmLnJhbmdlLCBzZWxmLnNwZWVkLCBzZWxmLnNvdXJjZVBvc2l0aW9uLCBzZWxmLmNvbGxpc2lvbikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKCmVuZAoKLS1bWwogICAgVHJpZXMgdG8gY2FzdCB0aGUgc3BlbGwgd2hlbiB0aGUgdGFyZ2V0IGlzIGRhc2hpbmcKCiAgICBAcGFyYW0gdGFyZ2V0IHwgQ3VuaXQgfCBEYXNoaW5nIHRhcmdldCB0byBhdHRhY2sKICAgIEBwYXJhbSByZXR1cm4gfCBpbnQgICB8IFNwZWxsU3RhdGUgb2YgdGhlIGN1cnJlbnQgc3BlbGwKXV0KZnVuY3Rpb24gU3BlbGw6Q2FzdElmRGFzaGluZyh0YXJnZXQpCgogICAgLS0gRG9uJ3QgY2FsY3VsYXRlIHN0dWZmIHdoZW4gdGFyZ2V0IGlzIGludmFsaWQKICAgIGlmIG5vdCBWYWxpZFRhcmdldCh0YXJnZXQpIHRoZW4gcmV0dXJuIFNQRUxMU1RBVEVfSU5WQUxJRF9UQVJHRVQgZW5kCgogICAgaWYgc2VsZi5za2lsbHNob3RUeXBlIH49IG5pbCB0aGVuCiAgICAgICAgbG9jYWwgaXNEYXNoaW5nLCBjYW5IaXQsIHBvc2l0aW9uID0gc2VsZi5WUDpJc0Rhc2hpbmcodGFyZ2V0LCBzZWxmLmRlbGF5ICsgMC4wNyArIEdldExhdGVuY3koKSAvIDIwMDAsIHNlbGYud2lkdGgsIHNlbGYuc3BlZWQsIHNlbGYuc291cmNlUG9zaXRpb24pCgogICAgICAgIC0tIE91dCBvZiByYW5nZQogICAgICAgIGlmIHNlbGYucmFuZ2VTcXIgPCBfR2V0RGlzdGFuY2VTcXIoc2VsZi5zb3VyY2VSYW5nZSwgcG9zaXRpb24pIHRoZW4gcmV0dXJuIFNQRUxMU1RBVEVfT1VUX09GX1JBTkdFIGVuZAoKICAgICAgICBpZiBpc0Rhc2hpbmcgYW5kIGNhbkhpdCB0aGVuCgogICAgICAgICAgICAtLSBDb2xsaXNpb24KICAgICAgICAgICAgaWYgbm90IHNlbGYuY29sbGlzaW9uIG9yIHNlbGYuY29sbGlzaW9uIGFuZCBub3Qgc2VsZi5WUDpDaGVja01pbmlvbkNvbGxpc2lvbih0YXJnZXQsIHBvc2l0aW9uLCBzZWxmLmRlbGF5ICsgMC4wNyArIEdldExhdGVuY3koKSAvIDIwMDAsIHNlbGYud2lkdGgsIHNlbGYucmFuZ2UsIHNlbGYuc3BlZWQsIHNlbGYuc291cmNlUG9zaXRpb24sIGZhbHNlLCB0cnVlKSB0aGVuCiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZjpfX0Nhc3Qoc2VsZi5zcGVsbElkLCBwb3NpdGlvbi54LCBwb3NpdGlvbi56KQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICByZXR1cm4gU1BFTExTVEFURV9DT0xMSVNJT04KICAgICAgICAgICAgZW5kCgogICAgICAgIGVsc2VpZiBub3QgaXNEYXNoaW5nIHRoZW4gcmV0dXJuIFNQRUxMU1RBVEVfTk9UX0RBU0hJTkcKICAgICAgICBlbHNlIHJldHVybiBTUEVMTFNUQVRFX0RBU0hJTkdfQ0FOVF9ISVQgZW5kCiAgICBlbHNlCiAgICAgICAgbG9jYWwgaXNEYXNoaW5nLCBjYW5IaXQsIHBvc2l0aW9uID0gc2VsZi5WUDpJc0Rhc2hpbmcodGFyZ2V0LCAwLjI1ICsgMC4wNyArIEdldExhdGVuY3koKSAvIDIwMDAsIDEsIG1hdGguaHVnZSwgc2VsZi5zb3VyY2VQb3NpdGlvbikKCiAgICAgICAgLS0gT3V0IG9mIHJhbmdlCiAgICAgICAgaWYgc2VsZi5yYW5nZVNxciA8IF9HZXREaXN0YW5jZVNxcihzZWxmLnNvdXJjZVJhbmdlLCBwb3NpdGlvbikgdGhlbiByZXR1cm4gU1BFTExTVEFURV9PVVRfT0ZfUkFOR0UgZW5kCgogICAgICAgIGlmIGlzRGFzaGluZyBhbmQgY2FuSGl0IHRoZW4KICAgICAgICAgICAgcmV0dXJuIHNlbGY6X19DYXN0KHBvc2l0aW9uLngsIHBvc2l0aW9uLnopCiAgICAgICAgZWxzZWlmIG5vdCBpc0Rhc2hpbmcgdGhlbiByZXR1cm4gU1BFTExTVEFURV9OT1RfREFTSElORwogICAgICAgIGVsc2UgcmV0dXJuIFNQRUxMU1RBVEVfREFTSElOR19DQU5UX0hJVCBlbmQKICAgIGVuZAoKICAgIHJldHVybiBTUEVMTFNUQVRFX05PVF9UUklHR0VSRUQKCmVuZAoKLS1bWwogICAgVHJpZXMgdG8gY2FzdCB0aGUgc3BlbGwgd2hlbiB0aGUgdGFyZ2V0IGlzIGltbW9iaWxlCgogICAgQHBhcmFtIHRhcmdldCB8IEN1bml0IHwgSW1tb2JpbGUgdGFyZ2V0IHRvIGF0dGFjawogICAgQHBhcmFtIHJldHVybiB8IGludCAgIHwgU3BlbGxTdGF0ZSBvZiB0aGUgY3VycmVudCBzcGVsbApdXQpmdW5jdGlvbiBTcGVsbDpDYXN0SWZJbW1vYmlsZSh0YXJnZXQpCgogICAgLS0gRG9uJ3QgY2FsY3VsYXRlIHN0dWZmIHdoZW4gdGFyZ2V0IGlzIGludmFsaWQKICAgIGlmIG5vdCBWYWxpZFRhcmdldCh0YXJnZXQpIHRoZW4gcmV0dXJuIFNQRUxMU1RBVEVfSU5WQUxJRF9UQVJHRVQgZW5kCgogICAgaWYgc2VsZi5za2lsbHNob3RUeXBlIH49IG5pbCB0aGVuCiAgICAgICAgbG9jYWwgaXNJbW1vYmlsZSwgcG9zaXRpb24gPSBzZWxmLlZQOklzSW1tb2JpbGUodGFyZ2V0LCBzZWxmLmRlbGF5ICsgMC4wNyArIEdldExhdGVuY3koKSAvIDIwMDAsIHNlbGYud2lkdGgsIHNlbGYuc3BlZWQsIHNlbGYuc291cmNlUG9zaXRpb24pCgogICAgICAgIC0tIE91dCBvZiByYW5nZQogICAgICAgIGlmIHNlbGYucmFuZ2VTcXIgPCBfR2V0RGlzdGFuY2VTcXIoc2VsZi5zb3VyY2VSYW5nZSwgcG9zaXRpb24pIHRoZW4gcmV0dXJuIFNQRUxMU1RBVEVfT1VUX09GX1JBTkdFIGVuZAoKICAgICAgICBpZiBpc0ltbW9iaWxlIHRoZW4KCiAgICAgICAgICAgIC0tIENvbGxpc2lvbgogICAgICAgICAgICBpZiBub3Qgc2VsZi5jb2xsaXNpb24gb3IgKHNlbGYuY29sbGlzaW9uIGFuZCBub3Qgc2VsZi5WUDpDaGVja01pbmlvbkNvbGxpc2lvbih0YXJnZXQsIHBvc2l0aW9uLCBzZWxmLmRlbGF5ICsgMC4wNyArIEdldExhdGVuY3koKSAvIDIwMDAsIHNlbGYud2lkdGgsIHNlbGYucmFuZ2UsIHNlbGYuc3BlZWQsIHNlbGYuc291cmNlUG9zaXRpb24sIGZhbHNlLCB0cnVlKSkgdGhlbgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGY6X19DYXN0KHBvc2l0aW9uLngsIHBvc2l0aW9uLnopCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHJldHVybiBTUEVMTFNUQVRFX0NPTExJU0lPTgogICAgICAgICAgICBlbmQKCiAgICAgICAgZWxzZSByZXR1cm4gU1BFTExTVEFURV9OT1RfSU1NT0JJTEUgZW5kCiAgICBlbHNlCiAgICAgICAgbG9jYWwgaXNJbW1vYmlsZSwgcG9zaXRpb24gPSBzZWxmLlZQOklzSW1tb2JpbGUodGFyZ2V0LCAwLjI1ICsgMC4wNyArIEdldExhdGVuY3koKSAvIDIwMDAsIDEsIG1hdGguaHVnZSwgc2VsZi5zb3VyY2VQb3NpdGlvbikKCiAgICAgICAgLS0gT3V0IG9mIHJhbmdlCiAgICAgICAgaWYgc2VsZi5yYW5nZVNxciA8IF9HZXREaXN0YW5jZVNxcihzZWxmLnNvdXJjZVJhbmdlLCB0YXJnZXQpIHRoZW4gcmV0dXJuIFNQRUxMU1RBVEVfT1VUX09GX1JBTkdFIGVuZAoKICAgICAgICBpZiBpc0ltbW9iaWxlIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHNlbGY6X19DYXN0KHRhcmdldCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJldHVybiBTUEVMTFNUQVRFX05PVF9JTU1PQklMRQogICAgICAgIGVuZAogICAgZW5kCgogICAgcmV0dXJuIFNQRUxMU1RBVEVfTk9UX1RSSUdHRVJFRAoKZW5kCgotLVtbCiAgICBDYXN0IHRoZSBzcGVsbCwgcmVzcGVjdGluZyBwcmV2aW91c2x5IG1hZGUgZGVjaXNpb25zIGFib3V0IHNraWxsc2hvdHMgYW5kIEFPRSBzdHVmZgoKICAgIEBwYXJhbSBwYXJhbTEgfCB1c2VyZGF0YS9mbG9hdCB8IFdoZW4gcGFyYW0yIGlzIG5pbCB0aGVuIHRoaXMgY2FuIGJlIHRoZSB0YXJnZXQgb2JqZWN0LCBvdGhlcndpc2UgdGhpcyBpcyB0aGUgWCBjb29yZGluYXRlIG9mIHRoZSBza2lsbHNob3QgcG9zaXRpb24KICAgIEBwYXJhbSBwYXJhbTIgfCBmbG9hdCAgICAgICAgICB8IFogY29vcmRpbmF0ZSBvZiB0aGUgc2tpbGxzaG90IHBvc2l0aW9uCiAgICBAcGFyYW0gcmV0dXJuIHwgaW50ICAgICAgICAgICAgfCBTcGVsbFN0YXRlIG9mIHRoZSBjdXJyZW50IHNwZWxsCl1dCmZ1bmN0aW9uIFNwZWxsOkNhc3QocGFyYW0xLCBwYXJhbTIpCgogICAgaWYgc2VsZi5za2lsbHNob3RUeXBlIH49IG5pbCBhbmQgcGFyYW0xIH49IG5pbCBhbmQgcGFyYW0yID09IG5pbCB0aGVuCgogICAgICAgIC0tIERvbid0IGNhbGN1bGF0ZSBzdHVmZiB3aGVuIHRhcmdldCBpcyBpbnZhbGlkCiAgICAgICAgaWYgbm90IFZhbGlkVGFyZ2V0KHBhcmFtMSkgdGhlbiByZXR1cm4gU1BFTExTVEFURV9JTlZBTElEX1RBUkdFVCBlbmQKCiAgICAgICAgbG9jYWwgY2FzdFBvc2l0aW9uLCBoaXRDaGFuY2UsIHBvc2l0aW9uLCBuVGFyZ2V0cwogICAgICAgIGlmIHNlbGYuc2tpbGxzaG90VHlwZSA9PSBTS0lMTFNIT1RfTElORUFSIG9yIHNlbGYuc2tpbGxzaG90VHlwZSA9PSBTS0lMTFNIT1RfQ09ORSB0aGVuCiAgICAgICAgICAgIGlmIHNlbGYudXNlQW9lIHRoZW4KICAgICAgICAgICAgICAgIGNhc3RQb3NpdGlvbiwgaGl0Q2hhbmNlLCBuVGFyZ2V0cyA9IHNlbGY6R2V0UHJlZGljdGlvbihwYXJhbTEpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGNhc3RQb3NpdGlvbiwgaGl0Q2hhbmNlLCBwb3NpdGlvbiA9IHNlbGY6R2V0UHJlZGljdGlvbihwYXJhbTEpCiAgICAgICAgICAgICAgICAtLSBPdXQgb2YgcmFuZ2UKICAgICAgICAgICAgICAgIGlmIHNlbGYucmFuZ2VTcXIgPCBfR2V0RGlzdGFuY2VTcXIoc2VsZi5zb3VyY2VSYW5nZSwgcG9zaXRpb24pIHRoZW4gcmV0dXJuIFNQRUxMU1RBVEVfT1VUX09GX1JBTkdFIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbHNlaWYgc2VsZi5za2lsbHNob3RUeXBlID09IFNLSUxMU0hPVF9DSVJDVUxBUiB0aGVuCiAgICAgICAgICAgIGlmIHNlbGYudXNlQW9lIHRoZW4KICAgICAgICAgICAgICAgIGNhc3RQb3NpdGlvbiwgaGl0Q2hhbmNlLCBuVGFyZ2V0cyA9IHNlbGY6R2V0UHJlZGljdGlvbihwYXJhbTEpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGNhc3RQb3NpdGlvbiwgaGl0Q2hhbmNlLCBwb3NpdGlvbiA9IHNlbGY6R2V0UHJlZGljdGlvbihwYXJhbTEpCiAgICAgICAgICAgICAgICAtLSBPdXQgb2YgcmFuZ2UKICAgICAgICAgICAgICAgIGlmIG1hdGgucG93KHNlbGYucmFuZ2UgKyBzZWxmLndpZHRoICsgc2VsZi5WUDpHZXRIaXRCb3gocGFyYW0xKSwgMikgPCBfR2V0RGlzdGFuY2VTcXIoc2VsZi5zb3VyY2VSYW5nZSwgcG9zaXRpb24pIHRoZW4gcmV0dXJuIFNQRUxMU1RBVEVfT1VUX09GX1JBTkdFIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgLS0gQU9FIG5vdCBlbm91Z2ggdGFyZ2V0cwogICAgICAgIGlmIG5UYXJnZXRzIGFuZCBuVGFyZ2V0cyA8IHNlbGYubWluVGFyZ2V0c0FvZSB0aGVuIHJldHVybiBTUEVMTFNUQVRFX05PVF9FTk9VR0hfVEFSR0VUUyBlbmQKCiAgICAgICAgLS0gQ29sbGlzaW9uIGRldGVjdGVkCiAgICAgICAgaWYgaGl0Q2hhbmNlID09IC0xIHRoZW4gcmV0dXJuIFNQRUxMU1RBVEVfQ09MTElTSU9OIGVuZAoKICAgICAgICAtLSBIaXRjaGFuY2UgdG9vIGxvdwogICAgICAgIGlmIGhpdENoYW5jZSBhbmQgaGl0Q2hhbmNlIDwgc2VsZi5oaXRDaGFuY2UgdGhlbiByZXR1cm4gU1BFTExTVEFURV9MT1dFUl9ISVRDSEFOQ0UgZW5kCgogICAgICAgIC0tIE91dCBvZiByYW5nZQogICAgICAgIGlmIHNlbGYucmFuZ2VTcXIgPCBfR2V0RGlzdGFuY2VTcXIoc2VsZi5zb3VyY2VSYW5nZSwgY2FzdFBvc2l0aW9uKSB0aGVuIHJldHVybiBTUEVMTFNUQVRFX09VVF9PRl9SQU5HRSBlbmQKCiAgICAgICAgcGFyYW0xID0gY2FzdFBvc2l0aW9uLngKICAgICAgICBwYXJhbTIgPSBjYXN0UG9zaXRpb24uegogICAgZW5kCgogICAgLS0gQ2FzdCB0aGUgc3BlbGwKICAgIHJldHVybiBzZWxmOl9fQ2FzdChwYXJhbTEsIHBhcmFtMikKCmVuZAoKLS1bWwogICAgSW50ZXJuYWwgZnVuY3Rpb24sIGRvIG5vdCB1c2UgdGhpcyEKXV0KZnVuY3Rpb24gU3BlbGw6X19DYXN0KHBhcmFtMSwgcGFyYW0yKQoKICAgIGlmIHNlbGYucGFja2V0Q2FzdCB0aGVuCiAgICAgICAgaWYgcGFyYW0xIH49IG5pbCBhbmQgcGFyYW0yIH49IG5pbCB0aGVuCiAgICAgICAgICAgIFBhY2tldCgiU19DQVNUIiwge3NwZWxsSWQgPSBzZWxmLnNwZWxsSWQsIHRvWCA9IHBhcmFtMSwgdG9ZID0gcGFyYW0yLCBmcm9tWCA9IHBhcmFtMSwgZnJvbVkgPSBwYXJhbTJ9KTpzZW5kKCkKICAgICAgICBlbHNlaWYgcGFyYW0xIH49IG5pbCB0aGVuCiAgICAgICAgICAgIFBhY2tldCgiU19DQVNUIiwge3NwZWxsSWQgPSBzZWxmLnNwZWxsSWQsIHRvWCA9IHBhcmFtMS54LCB0b1kgPSBwYXJhbTEueiwgZnJvbVggPSBwYXJhbTEueCwgZnJvbVkgPSBwYXJhbTEueiwgdGFyZ2V0TmV0d29ya0lkID0gcGFyYW0xLm5ldHdvcmtJRH0pOnNlbmQoKQogICAgICAgIGVsc2UKICAgICAgICAgICAgUGFja2V0KCJTX0NBU1QiLCB7c3BlbGxJZCA9IHNlbGYuc3BlbGxJZCwgdG9YID0gcGxheWVyLngsIHRvWSA9IHBsYXllci56LCBmcm9tWCA9IHBsYXllci54LCBmcm9tWSA9IHBsYXllci56LCB0YXJnZXROZXR3b3JrSWQgPSBwbGF5ZXIubmV0d29ya0lEfSk6c2VuZCgpCiAgICAgICAgZW5kCiAgICBlbHNlCiAgICAgICAgaWYgcGFyYW0xIH49IG5pbCBhbmQgcGFyYW0yIH49IG5pbCB0aGVuCiAgICAgICAgICAgIENhc3RTcGVsbChzZWxmLnNwZWxsSWQsIHBhcmFtMSwgcGFyYW0yKQogICAgICAgIGVsc2VpZiBwYXJhbTEgfj0gbmlsIHRoZW4KICAgICAgICAgICAgQ2FzdFNwZWxsKHNlbGYuc3BlbGxJZCwgcGFyYW0xKQogICAgICAgIGVsc2UKICAgICAgICAgICAgQ2FzdFNwZWxsKHNlbGYuc3BlbGxJZCkKICAgICAgICBlbmQKICAgIGVuZAoKICAgIHJldHVybiBTUEVMTFNUQVRFX1RSSUdHRVJFRAoKZW5kCgotLVtbCiAgICBBZGQgYW4gYXV0b21hdGlvbiB0byB0aGUgc3BlbGwgdG8gbGV0IGl0IGNhc3QgaXRzZWxmIHdoZW4gYSBjZXJ0YWluIGNvbmRpdGlvbiBpcyBtZXQKCiAgICBAcGFyYW0gYXV0b21hdGlvbklkIHwgc3RyaW5nL2ludCB8IFRoZSBJRCBvZiB0aGUgYXV0b21hdGlvbiwgZXhhbXBsZSAiQW50aUdhcENsb3NlciIKICAgIEBwYXJhbSBmdW5jICAgICAgICAgfCBmdW5jdGlvbiAgIHwgRnVuY3Rpb24gdG8gYmUgY2FsbGVkIHdoZW4gY2hlY2tpbmcsIHNob3VsZCByZXR1cm4gYSBib29sIHZhbHVlIGluZGljYXRpbmcgaWYgaXQgc2hvdWxkIGJlIGNhc3RlZCBhbmQgb3B0aW9uYWxseSB0aGUgY2FzdCBwYXJhbXMgKGV4OiB0YXJnZXQgb3IgeCBhbmQgeikKXV0KZnVuY3Rpb24gU3BlbGw6QWRkQXV0b21hdGlvbihhdXRvbWF0aW9uSWQsIGZ1bmMpCgogICAgYXNzZXJ0KGF1dG9tYXRpb25JZCwgIlNwZWxsOiBhdXRvbWF0aW9uSWQgaXMgaW52YWxpZCEiKQogICAgYXNzZXJ0KGZ1bmMgYW5kIHR5cGUoZnVuYykgPT0gImZ1bmN0aW9uIiwgIlNwZWxsOiBmdW5jIGlzIGludmFsaWQhIikKCiAgICBmb3IgaW5kZXgsIGF1dG9tYXRpb24gaW4gaXBhaXJzKHNlbGYuX2F1dG9tYXRpb25zKSBkbwogICAgICAgIGlmIGF1dG9tYXRpb24uaWQgPT0gYXV0b21hdGlvbklkIHRoZW4gcmV0dXJuIGVuZAogICAgZW5kCgogICAgdGFibGUuaW5zZXJ0KHNlbGYuX2F1dG9tYXRpb25zLCB7IGlkID09IGF1dG9tYXRpb25JZCwgZnVuYyA9IGZ1bmMgfSkKCiAgICAtLSBSZWdpc3RlciBjYWxsYmFja3MKICAgIGlmIG5vdCBzZWxmLl9fdGlja0NhbGxiYWNrIHRoZW4KICAgICAgICBBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOk9uVGljaygpIGVuZCkKICAgICAgICBzZWxmLl9fdGlja0NhbGxiYWNrID0gdHJ1ZQogICAgZW5kCgplbmQKCi0tW1sKICAgIFJlbW92ZSBhbmQgYXV0b21hdGlvbiBieSBpdCdzIGlkCgogICAgQHBhcmFtIGF1dG9tYXRpb25JZCB8IHN0cmluZy9pbnQgfCBUaGUgSUQgb2YgdGhlIGF1dG9tYXRpb24sIGV4YW1wbGUgIkFudGlHYXBDbG9zZXIiCl1dCmZ1bmN0aW9uIFNwZWxsOlJlbW92ZUF1dG9tYXRpb24oYXV0b21hdGlvbklkKQoKICAgIGFzc2VydChhdXRvbWF0aW9uSWQsICJTcGVsbDogYXV0b21hdGlvbklkIGlzIGludmFsaWQhIikKCiAgICBmb3IgaW5kZXgsIGF1dG9tYXRpb24gaW4gaXBhaXJzKHNlbGYuX2F1dG9tYXRpb25zKSBkbwogICAgICAgIGlmIGF1dG9tYXRpb24uaWQgPT0gYXV0b21hdGlvbklkIHRoZW4KICAgICAgICAgICAgdGFibGUucmVtb3ZlKHNlbGYuX2F1dG9tYXRpb25zLCBpbmRleCkKICAgICAgICAgICAgYnJlYWsKICAgICAgICBlbmQKICAgIGVuZAoKZW5kCgotLVtbCiAgICBDbGVhciBhbGwgYXV0b21hdGlvbnMgYXNzaW5nZWQgdG8gdGhpcyBzcGVsbApdXQpmdW5jdGlvbiBTcGVsbDpDbGVhckF1dG9tYXRpb25zKCkKICAgIHNlbGYuX2F1dG9tYXRpb25zID0ge30KZW5kCgotLVtbCiAgICBUcmFjayB0aGUgc3BlbGwgbGlrZSBpbiBPblByb2Nlc3NTcGVsbCB0byBhZGQgbW9yZSBmZWF0dXJlcyB0byB0aGlzIFNwZWxsIGluc3RhbmNlCgogICAgQHBhcmFtIHNwZWxsTmFtZSB8IHN0cmluZy90YWJsZSB8IENhc2UgaW5zZW5zaXRpdmUgbmFtZShzKSBvZiB0aGUgc3BlbGwKICAgIEByZXR1cm4gICAgICAgICAgfCBjbGFzcyAgICAgICAgfCBUaGUgY3VycmVudCBpbnN0YW5jZQpdXQpmdW5jdGlvbiBTcGVsbDpUcmFja0Nhc3Rpbmcoc3BlbGxOYW1lKQoKICAgIGFzc2VydChzcGVsbE5hbWUsICJTcGVsbDpUcmFja0Nhc3RpbmcoKTogc3BlbGxOYW1lIGlzIGludmFsaWQhIikKICAgIGFzc2VydChzZWxmLl9fdHJhY2tlZF9zcGVsbE5hbWVzID09IG5pbCwgIlNwZWxsOlRyYWNrQ2FzdGluZygpOiBUaGlzIHNwZWxsIGlzIGFscmVhZHkgdHJhY2tlZCEiKQogICAgYXNzZXJ0KHR5cGUoc3BlbGxOYW1lKSA9PSAic3RyaW5nIiBvciB0eXBlKHNwZWxsTmFtZSkgPT0gInRhYmxlIiwgIlNwZWxsOlRyYWNrQ2FzdGluZygpOiBUeXBlIG9mIHNwZWxsTmFtZSBpcyBpbnZhbGlkOiAiIC4uIHR5cGUoc3BlbGxOYW1lKSkKCiAgICBzZWxmLl9fdHJhY2tlZF9zcGVsbE5hbWVzID0gdHlwZShzcGVsbE5hbWUpID09ICJ0YWJsZSIgYW5kIHNwZWxsTmFtZSBvciB7IHNwZWxsTmFtZSB9CgogICAgLS0gUmVnaXN0ZXIgY2FsbGJhY2tzCiAgICBpZiBub3Qgc2VsZi5fX3Byb2Nlc3NTcGVsbENhbGxiYWNrIHRoZW4KICAgICAgICBBZGRQcm9jZXNzU3BlbGxDYWxsYmFjayhmdW5jdGlvbih1bml0LCBzcGVsbCkgc2VsZjpPblByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQogICAgICAgIHNlbGYuX19wcm9jZXNzU3BlbGxDYWxsYmFjayA9IHRydWUKICAgIGVuZAoKICAgIHJldHVybiBzZWxmCgplbmQKCi0tW1sKICAgIFdoZW4gdGhlIHNwZWxsIGlzIGNhc3RlZCBhbmQgYWJvdXQgdG8gaGl0IGEgdGFyZ2V0LCB0aGlzIHdpbGwgcmV0dXJuIHRoZSBmb2xsb3dpbmcKCiAgICBAcmV0dXJuIHwgQ1VuaXQsZmxvYXQgfCBUaGUgdGFyZ2V0IHVuaXQsIHRoZSByZW1haW5pbmcgdGltZSBpbiBzZWNvbmRzIGl0IHdpbGwgdGFrZSB0byBoaXQgdGhlIHRhcmdldCwgb3RoZXJ3aXNlIG5pbApdXQpmdW5jdGlvbiBTcGVsbDpXaWxsSGl0VGFyZ2V0KCkKCiAgICAtLSBUT0RPOiBWUHJlZGljdGlvbiBleHBlcnQncyB3b3JrIDtECgplbmQKCi0tW1sKICAgIFJlZ2lzdGVyIGEgZnVuY3Rpb24gd2hpY2ggd2lsbCBiZSB0cmlnZ2VyZWQgd2hlbiB0aGUgc3BlbGwgaXMgYmVpbmcgY2FzdGVkIHRoZSBmdW5jdGlvbiB3aWxsIGJlIGdpdmVuIHRoZSBzcGVsbCBvYmplY3QgYXMgcGFyYW1ldGVyCgogICAgQHBhcmFtIGZ1bmMgfCBmdW5jdGlvbiB8IEZ1bmN0aW9uIHRvIGJlIGNhbGxlZCB3aGVuIHRoZSBzcGVsbCBpcyBiZWluZyBwcm9jZXNzZWQgKGNhc3RlZCkKXV0KZnVuY3Rpb24gU3BlbGw6UmVnaXN0ZXJDYXN0Q2FsbGJhY2soZnVuYykKCiAgICBhc3NlcnQoZnVuYyBhbmQgdHlwZShmdW5jKSA9PSAiZnVuY3Rpb24iIGFuZCBzZWxmLl9fdHJhY2tlZF9jYXN0Q2FsbGJhY2sgPT0gbmlsLCAiU3BlbGw6UmVnaXN0ZXJDYXN0Q2FsbGJhY2soKTogZnVuYyBpcyBlaXRoZXIgaW52YWxpZCBvciBhIGNhbGxiYWNrIGlzIGFscmVhZHkgcmVnaXN0ZXJlZCEiKQoKICAgIHNlbGYuX190cmFja2VkX2Nhc3RDYWxsYmFjayA9IGZ1bmMKCmVuZAoKLS1bWwogICAgUmV0dXJucyB0aGUgb3MuY2xvY2soKSB0aW1lIHdoZW4gdGhlIHNwZWxsIHdhcyBsYXN0IGNhc3RlZAoKICAgIEByZXR1cm4gfCBmbG9hdCB8IFRpbWUgaW4gc2Vjb25kcyB3aGVuIHRoZSBzcGVsbCB3YXMgbGFzdCBjYXN0ZWQgb3IgbmlsIGlmIHRoZSBzcGVsbCB3YXMgbmV2ZXIgY2FzdGVkIG9yIHNwZWxsIGlzIG5vdCB0cmFja2VkCl1dCmZ1bmN0aW9uIFNwZWxsOkdldExhc3RDYXN0VGltZSgpCiAgICByZXR1cm4gc2VsZi5fX3RyYWNrZWRfbGFzdENhc3RUaW1lIG9yIDAKZW5kCgotLVtbCiAgICBHZXQgaWYgdGhlIHRhcmdldCBpcyBpbiByYW5nZQoKICAgIEByZXR1cm4gfCBib29sIHwgSW4gcmFuZ2Ugb3Igbm90Cl1dCmZ1bmN0aW9uIFNwZWxsOklzSW5SYW5nZSh0YXJnZXQsIGZyb20pCiAgICByZXR1cm4gc2VsZi5yYW5nZVNxciA+PSBfR2V0RGlzdGFuY2VTcXIodGFyZ2V0LCBmcm9tIG9yIHNlbGYuc291cmNlUG9zaXRpb24pCmVuZAoKLS1bWwogICAgR2V0IGlmIHRoZSBzcGVsbCBpcyByZWFkeSBvciBub3QKCiAgICBAcmV0dXJuIHwgYm9vbCB8IFNwZWxsIHN0YXRlIHJlYWR5IG9yIG5vdApdXQpmdW5jdGlvbiBTcGVsbDpJc1JlYWR5KCkKICAgIHJldHVybiBwbGF5ZXI6Q2FuVXNlU3BlbGwoc2VsZi5zcGVsbElkKSA9PSBSRUFEWQplbmQKCi0tW1sKICAgIEdldCB0aGUgbWFuYSB1c2FnZSBvZiB0aGUgc3BlbGwKCiAgICBAcmV0dXJuIHwgZmxvYXQgfCBNYW5hIHVzYWdlIG9mIHRoZSBzcGVsbApdXQpmdW5jdGlvbiBTcGVsbDpHZXRNYW5hVXNhZ2UoKQogICAgcmV0dXJuIHBsYXllcjpHZXRTcGVsbERhdGEoc2VsZi5zcGVsbElkKS5tYW5hCmVuZAoKLS1bWwogICAgR2V0IHRoZSBDVVJSRU5UIGNvb2xkb3duIG9mIHRoZSBzcGVsbAoKICAgIEByZXR1cm4gfCBmbG9hdCB8IEN1cnJlbnQgY29vbGRvd24gb2YgdGhlIHNwZWxsCl1dCmZ1bmN0aW9uIFNwZWxsOkdldENvb2xkb3duKGN1cnJlbnQpCiAgICByZXR1cm4gY3VycmVudCBhbmQgcGxheWVyOkdldFNwZWxsRGF0YShzZWxmLnNwZWxsSWQpLmN1cnJlbnRDZCBvciBwbGF5ZXI6R2V0U3BlbGxEYXRhKHNlbGYuc3BlbGxJZCkudG90YWxDb29sZG93bgplbmQKCi0tW1sKICAgIEdldCB0aGUgc3RhdCBwb2ludHMgYXNzaW5nZWQgdG8gdGhpcyBzcGVsbCAobGV2ZWwpCgogICAgQHJldHVybiB8IGludCB8IFN0YXQgcG9pbnRzIGFzc2luZ2VkIHRvIHRoaXMgc3BlbGwgKGxldmVsKQpdXQpmdW5jdGlvbiBTcGVsbDpHZXRMZXZlbCgpCiAgICByZXR1cm4gcGxheWVyOkdldFNwZWxsRGF0YShzZWxmLnNwZWxsSWQpLmxldmVsCmVuZAoKLS1bWwogICAgR2V0IHRoZSBuYW1lIG9mIHRoZSBzcGVsbAoKICAgIEByZXR1cm4gfCBzdHJpbmcgfCBOYW1lIG9mIHRoZSB0aGUgc3BlbGwKXV0KZnVuY3Rpb24gU3BlbGw6R2V0TmFtZSgpCiAgICByZXR1cm4gcGxheWVyOkdldFNwZWxsRGF0YShzZWxmLnNwZWxsSWQpLm5hbWUKZW5kCgotLVtbCiAgICBJbnRlcm5hbCBjYWxsYmFjaywgZG9uJ3QgdXNlIHRoaXMhCl1dCmZ1bmN0aW9uIFNwZWxsOk9uVGljaygpCgogICAgLS0gQXV0b21hdGlvbnMKICAgIGlmIHNlbGYuX2F1dG9tYXRpb25zIGFuZCAjc2VsZi5fYXV0b21hdGlvbnMgPiAwIHRoZW4KICAgICAgICBmb3IgXywgYXV0b21hdGlvbiBpbiBpcGFpcnMoc2VsZi5fYXV0b21hdGlvbnMpIGRvCiAgICAgICAgICAgIGxvY2FsIGRvQ2FzdCwgcGFyYW0xLCBwYXJhbTIgPSBhdXRvbWF0aW9uLmZ1bmMoKQogICAgICAgICAgICBpZiBkb0Nhc3QgPT0gdHJ1ZSB0aGVuCiAgICAgICAgICAgICAgICBzZWxmOkNhc3QocGFyYW0xLCBwYXJhbTIpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0gQ2hhcmdlZCBzcGVsbHMKICAgIGlmIHNlbGYuX19jaGFyZ2VkIHRoZW4KICAgICAgICBpZiBzZWxmOklzQ2hhcmdpbmcoKSB0aGVuCiAgICAgICAgICAgIHNlbGY6U2V0UmFuZ2UobWF0aC5taW4oc2VsZi5fX2NoYXJnZWRfaW5pdGlhbFJhbmdlICsgKHNlbGYuX19jaGFyZ2VkX21heFJhbmdlIC0gc2VsZi5fX2NoYXJnZWRfaW5pdGlhbFJhbmdlKSAqICgob3MuY2xvY2soKSAtIHNlbGYuX19jaGFyZ2VkX2Nhc3RUaW1lKSAvIHNlbGYuX19jaGFyZ2VkX2NoYXJnZVRpbWUpLCBzZWxmLl9fY2hhcmdlZF9tYXhSYW5nZSkpCiAgICAgICAgZWxzZWlmIG5vdCBzZWxmLl9fY2hhcmdlZF9hYm9ydGVkIGFuZCBvcy5jbG9jaygpIC0gc2VsZi5fX2NoYXJnZWRfY2FzdFRpbWUgPiAwLjEgdGhlbgogICAgICAgICAgICBzZWxmOl9BYm9ydENoYXJnZSgpCiAgICAgICAgZW5kCiAgICBlbmQKCmVuZAoKLS1bWwogICAgSW50ZXJuYWwgY2FsbGJhY2ssIGRvbid0IHVzZSB0aGlzIQpdXQpmdW5jdGlvbiBTcGVsbDpPblByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkKCiAgICBpZiB1bml0IGFuZCB1bml0LnZhbGlkIGFuZCB1bml0LmlzTWUgYW5kIHNwZWxsIGFuZCBzcGVsbC5uYW1lIHRoZW4KCiAgICAgICAgLS0gVHJhY2tlZCBzcGVsbHMKICAgICAgICBpZiBzZWxmLl9fdHJhY2tlZF9zcGVsbE5hbWVzIHRoZW4KICAgICAgICAgICAgZm9yIF8sIHRyYWNrZWRTcGVsbCBpbiBpcGFpcnMoc2VsZi5fX3RyYWNrZWRfc3BlbGxOYW1lcykgZG8KICAgICAgICAgICAgICAgIGlmIHRyYWNrZWRTcGVsbDpsb3dlcigpID09IHNwZWxsLm5hbWU6bG93ZXIoKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fX3RyYWNrZWRfbGFzdENhc3RUaW1lID0gb3MuY2xvY2soKQogICAgICAgICAgICAgICAgICAgIHNlbGYuX190cmFja2VkX2Nhc3RDYWxsYmFjayhzcGVsbCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgLS0gQ2hhcmdlZCBzcGVsbHMKICAgICAgICBpZiBzZWxmLl9fY2hhcmdlZCBhbmQgc2VsZi5fX2NoYXJnZWRfc3BlbGxOYW1lOmxvd2VyKCkgPT0gc3BlbGwubmFtZTpsb3dlcigpIHRoZW4KICAgICAgICAgICAgc2VsZi5fX2NoYXJnZWRfYWN0aXZlICAgICAgID0gdHJ1ZQogICAgICAgICAgICBzZWxmLl9fY2hhcmdlZF9hYm9ydGVkICAgICAgPSBmYWxzZQogICAgICAgICAgICBzZWxmLl9fY2hhcmdlZF9pbml0aWFsUmFuZ2UgPSBzZWxmLnJhbmdlCiAgICAgICAgICAgIHNlbGYuX19jaGFyZ2VkX2Nhc3RUaW1lICAgICA9IG9zLmNsb2NrKCkKICAgICAgICAgICAgc2VsZi5fX2NoYXJnZWRfY291bnQgICAgICAgID0gc2VsZi5fX2NoYXJnZWRfY291bnQgYW5kIHNlbGYuX19jaGFyZ2VkX2NvdW50ICsgMSBvciAxCiAgICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKGNoYXJnZUNvdW50KQogICAgICAgICAgICAgICAgaWYgc2VsZi5fX2NoYXJnZWRfY291bnQgPT0gY2hhcmdlQ291bnQgdGhlbgogICAgICAgICAgICAgICAgICAgIHNlbGY6X0Fib3J0Q2hhcmdlKCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQsIHNlbGYuX19jaGFyZ2VkX2R1cmF0aW9uLCB7IHNlbGYuX19jaGFyZ2VkX2NvdW50IH0pCiAgICAgICAgZW5kCgogICAgZW5kCgplbmQKCi0tW1sKICAgIEludGVybmFsIGNhbGxiYWNrLCBkb24ndCB1c2UgdGhpcyEKXV0KZnVuY3Rpb24gU3BlbGw6T25TZW5kUGFja2V0KHApCgogICAgLS0gQ2hhcmdlZCBzcGVsbHMKICAgIGlmIHNlbGYuX19jaGFyZ2VkIHRoZW4KICAgICAgICBpZiBwLmhlYWRlciA9PSAyMjkgdGhlbgogICAgICAgICAgICBpZiBvcy5jbG9jaygpIC0gc2VsZi5fX2NoYXJnZWRfY2FzdFRpbWUgPD0gMC4xIHRoZW4KICAgICAgICAgICAgICAgIHA6QmxvY2soKQogICAgICAgICAgICBlbmQKICAgICAgICBlbHNlaWYgcC5oZWFkZXIgPT0gUGFja2V0LmhlYWRlcnMuU19DQVNUIHRoZW4KICAgICAgICAgICAgbG9jYWwgcGFja2V0ID0gUGFja2V0KHApCiAgICAgICAgICAgIGlmIHBhY2tldDpnZXQoInNwZWxsSWQiKSA9PSBzZWxmLnNwZWxsSWQgdGhlbgogICAgICAgICAgICAgICAgaWYgb3MuY2xvY2soKSAtIHNlbGYuX19jaGFyZ2VkX2Nhc3RUaW1lIDw9IHNlbGYuX19jaGFyZ2VkX2R1cmF0aW9uIHRoZW4KICAgICAgICAgICAgICAgICAgICBzZWxmOl9BYm9ydENoYXJnZSgpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbmV3UGFja2V0ID0gQ0xvTFBhY2tldCgyMjkpCiAgICAgICAgICAgICAgICAgICAgbmV3UGFja2V0OkVuY29kZUYocGxheWVyLm5ldHdvcmtJRCkKICAgICAgICAgICAgICAgICAgICBuZXdQYWNrZXQ6RW5jb2RlMSgweDgwKQogICAgICAgICAgICAgICAgICAgIG5ld1BhY2tldDpFbmNvZGVGKG1vdXNlUG9zLngpCiAgICAgICAgICAgICAgICAgICAgbmV3UGFja2V0OkVuY29kZUYobW91c2VQb3MueSkKICAgICAgICAgICAgICAgICAgICBuZXdQYWNrZXQ6RW5jb2RlRihtb3VzZVBvcy56KQogICAgICAgICAgICAgICAgICAgIFNlbmRQYWNrZXQobmV3UGFja2V0KQogICAgICAgICAgICAgICAgICAgIHA6QmxvY2soKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgplbmQKCmZ1bmN0aW9uIFNwZWxsOl9fZXEob3RoZXIpCgogICAgcmV0dXJuIG90aGVyIGFuZCBvdGhlci5fc3BlbGxOdW0gYW5kIG90aGVyLl9zcGVsbE51bSA9PSBzZWxmLl9zcGVsbE51bSBvciBmYWxzZQoKZW5kCgoKLS1bWwoKJ3x8Jyd8LiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnfHwgICAgfHwnICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKIHx8ICAgfHwgIC4uLiAuLiAgIC4uLi4gICAuLi4gLi4uIC4uLiAgfHx8ICB8fHwgICAuLi4uICAgLi4gLi4uICAgIC4uLi4gICAgIC4uLiAuICAgLi4uLiAgLi4uIC4uICAKIHx8ICAgIHx8ICB8fCcgJycgJycgLnx8ICAgfHwgIHx8ICB8ICAgfCd8Li4nfHwgICcnIC58fCAgIHx8ICB8fCAgJycgLnx8ICAgfHwgfHwgIC58Li4ufHwgIHx8JyAnJyAKIHx8ICAgIHx8ICB8fCAgICAgLnwnIHx8ICAgIHx8fCB8fHwgICAgfCAnfCcgfHwgIC58JyB8fCAgIHx8ICB8fCAgLnwnIHx8ICAgIHwnJyAgIHx8ICAgICAgIHx8ICAgICAKLnx8Li4ufCcgIC58fC4gICAgJ3wuLid8JyAgICB8ICAgfCAgICAufC4gfCAufHwuICd8Li4nfCcgLnx8LiB8fC4gJ3wuLid8JyAgJ3x8fHwuICAnfC4uLicgLnx8LiAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAufC4uLi4nICAgICAgICAgICAgICAgICAKCiAgICBEcmF3TWFuYWdlciAtIFRpcmVkIG9mIGhhdmluZyB0byBkcmF3IGV2ZXJ5dGhpbmcgb3ZlciBhbmQgb3ZlciBhZ2Fpbj8gVGhlbiB1c2UgdGhpcyEKCiAgICBGdW5jdGlvbnM6CiAgICAgICAgRHJhd01hbmFnZXIoKQoKICAgIE1ldGhvZHM6CiAgICAgICAgRHJhd01hbmFnZXI6QWRkQ2lyY2xlKGNpcmNsZSkKICAgICAgICBEcmF3TWFuYWdlcjpSZW1vdmVDaXJjbGUoY2lyY2xlKQogICAgICAgIERyYXdNYW5hZ2VyOkNyZWF0ZUNpcmNsZShwb3NpdGlvbiwgcmFkaXVzLCB3aWR0aCwgY29sb3IpCiAgICAgICAgRHJhd01hbmFnZXI6T25EcmF3KCkKCl1dCmNsYXNzICdEcmF3TWFuYWdlcicKCi0tW1sKICAgIE5ldyBpbnN0YW5jZSBvZiBEcmF3TWFuYWdlcgpdXQpmdW5jdGlvbiBEcmF3TWFuYWdlcjpfX2luaXQoKQoKICAgIHNlbGYub2JqZWN0cyA9IHt9CgogICAgQWRkRHJhd0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpPbkRyYXcoKSBlbmQpCgplbmQKCi0tW1sKICAgIEFkZCBhbiBleGlzdGluZyBjaXJjbGUgdG8gdGhlIGRyYXcgbWFuYWdlcgoKICAgIEBwYXJhbSBjaXJjbGUgfCBjbGFzcyB8IF9DaXJjbGUgaW5zdGFuY2UKXV0KZnVuY3Rpb24gRHJhd01hbmFnZXI6QWRkQ2lyY2xlKGNpcmNsZSkKCiAgICBhc3NlcnQoY2lyY2xlLCAiRHJhd01hbmFnZXI6IGNpcmNsZSBpcyBpbnZhbGlkISIpCgogICAgZm9yIF8sIG9iamVjdCBpbiBpcGFpcnMoc2VsZi5vYmplY3RzKSBkbwogICAgICAgIGFzc2VydChvYmplY3Qgfj0gY2lyY2xlLCAiRHJhd01hbmFnZXI6IG9iamVjdCB3YXMgYWxyZWFkeSBpbiBEcmF3TWFuYWdlciIpCiAgICBlbmQKCiAgICB0YWJsZS5pbnNlcnQoc2VsZi5vYmplY3RzLCBjaXJjbGUpCgplbmQKCi0tW1sKICAgIFJlbW92ZXMgYSBjaXJjbGUgZnJvbSB0aGUgZHJhdyBtYW5hZ2VyCgogICAgQHBhcmFtIGNpcmNsZSB8IGNsYXNzIHwgX0NpcmNsZSBpbnN0YW5jZQpdXQpmdW5jdGlvbiBEcmF3TWFuYWdlcjpSZW1vdmVDaXJjbGUoY2lyY2xlKQoKICAgIGFzc2VydChjaXJjbGUsICJEcmF3TWFuYWdlcjpSZW1vdmVDaXJjbGUoKTogY2lyY2xlIGlzIGludmFsaWQhIikKCiAgICBmb3IgaW5kZXgsIG9iamVjdCBpbiBpcGFpcnMoc2VsZi5vYmplY3RzKSBkbwogICAgICAgIGlmIG9iamVjdCA9PSBjaXJjbGUgdGhlbgogICAgICAgICAgICB0YWJsZS5yZW1vdmUoc2VsZi5vYmplY3RzLCBpbmRleCkKICAgICAgICBlbmQKICAgIGVuZAoKZW5kCgotLVtbCiAgICBDcmVhdGUgYSBuZXcgY2lyY2xlIGFuZCBhZGQgaXQgYXN3ZWxsIHRvIHRoZSBEcmF3TWFuYWdlciBpbnN0YW5jZQoKICAgIEBwYXJhbSBwb3NpdGlvbiB8IHZlY3RvciB8IENlbnRlciBvZiB0aGUgY2lyY2xlCiAgICBAcGFyYW0gcmFkaXVzICAgfCBmbG9hdCAgfCBSYWRpdXMgb2YgdGhlIGNpcmNsZQogICAgQHBhcmFtIHdpZHRoICAgIHwgaW50ICAgIHwgV2lkdGggb2YgdGhlIGNpcmNsZSBvdXRsaW5lCiAgICBAcGFyYW0gY29sb3IgICAgfCB0YWJsZSAgfCBDb2xvciBvZiB0aGUgY2lyY2xlIGluIGEgdGFsZSBmb3JtYXQgeyBhLCByLCBnLCBiIH0KICAgIEByZXR1cm4gICAgICAgICB8IGNsYXNzICB8IEluc3RhbmNlIG9mIHRoZSBuZXdseSBjcmVhdGUgQ2lyY2xlIGNsYXNzCl1dCmZ1bmN0aW9uIERyYXdNYW5hZ2VyOkNyZWF0ZUNpcmNsZShwb3NpdGlvbiwgcmFkaXVzLCB3aWR0aCwgY29sb3IpCgogICAgbG9jYWwgY2lyY2xlID0gX0NpcmNsZShwb3NpdGlvbiwgcmFkaXVzLCB3aWR0aCwgY29sb3IpCiAgICBzZWxmOkFkZENpcmNsZShjaXJjbGUpCiAgICByZXR1cm4gY2lyY2xlCgplbmQKCi0tW1sKICAgIERPIE5PVCBDQUxMIFRISVMgTUFOVUFMTFkhIFRoaXMgd2lsbCBiZSBjYWxsZWQgYXV0b21hdGljYWxseS4KXV0KZnVuY3Rpb24gRHJhd01hbmFnZXI6T25EcmF3KCkKCiAgICBmb3IgXywgb2JqZWN0IGluIGlwYWlycyhzZWxmLm9iamVjdHMpIGRvCiAgICAgICAgaWYgb2JqZWN0LmVuYWJsZWQgdGhlbgogICAgICAgICAgICBvYmplY3Q6RHJhdygpCiAgICAgICAgZW5kCiAgICBlbmQKCmVuZAoKLS1bWwoKICAgICAgICAgICAgICAgICAgLi58JycnLnwgIHx8ICAgICAgICAgICAgICAgICAgJ3x8ICAgICAgICAgIAogICAgICAgICAgICAgICAgLnwnICAgICAnICAuLi4gIC4uLiAuLiAgICAuLi4uICAgfHwgICAgLi4uLiAgCiAgICAgICAgICAgICAgICB8fCAgICAgICAgICB8fCAgIHx8JyAnJyAufCAgICcnICB8fCAgLnwuLi58fCAKICAgICAgICAgICAgICAgICd8LiAgICAgIC4gIHx8ICAgfHwgICAgIHx8ICAgICAgIHx8ICB8fCAgICAgIAogICAgICAgICAgICAgICAgICcnfC4uLi4nICAufHwuIC58fC4gICAgICd8Li4uJyAufHwuICAnfC4uLicgCgogICAgRnVuY3Rpb25zOgogICAgICAgIF9DaXJjbGUocG9zaXRpb24sIHJhZGl1cywgd2lkdGgsIGNvbG9yKQoKICAgIE1lbWJlcnM6CiAgICAgICAgX0NpcmNsZS5lbmFibGVkICB8IGJvb2wgICB8IEVuYWJsZSBvciBkaWFibGUgdGhlIGNpcmNsZSAoZGlzcGxheWVkKQogICAgICAgIF9DaXJjbGUubW9kZSAgICAgfCBpbnQgICAgfCBTZWUgY2lyY2xlIG1vZGVzIGJlbG93CiAgICAgICAgX0NpcmNsZS5wb3NpdGlvbiB8IHZlY3RvciB8IENlbnRlciBvZiB0aGUgY2lyY2xlCiAgICAgICAgX0NpcmNsZS5yYWRpdXMgICB8IGZsb2F0ICB8IFJhZGl1cyBvZiB0aGUgY2lyY2xlCiAgICAgICAgLS0gVGhlc2UgYXJlIG5vdCBjaGFuZ2VhYmxlIHdoZW4gYSBtZW51IGlzIHNldAogICAgICAgIF9DaXJjbGUud2lkdGggICAgfCBpbnQgICAgfCBXaWR0aCBvZiB0aGUgY2lyY2xlIG91dGxpbmUKICAgICAgICBfQ2lyY2xlLmNvbG9yICAgIHwgdGFibGUgIHwgQ29sb3Igb2YgdGhlIGNpcmNsZSBpbiBhIHRhbGUgZm9ybWF0IHsgYSwgciwgZywgYiB9CiAgICAgICAgX0NpcmNsZS5xdWFsaXR5ICB8IGZsb2F0ICB8IFF1YWxpdHkgb2YgdGhlIGNpcmNsZSwgdGhlIGhpZ2hlciB0aGUgc21vb3RoZXIgdGhlIGNpcmNsZQoKICAgIE1ldGhvZHM6CiAgICAgICAgX0NpcmNsZTpBZGRUb01lbnUobWVudSwgcGFyYW1UZXh0LCBhZGRDb2xvciwgYWRkV2lkdGgsIGFkZFF1YWxpdHkpCiAgICAgICAgX0NpcmNsZTpTZXRFbmFibGVkKGVuYWJsZWQpCiAgICAgICAgX0NpcmNsZTpTZXQyRCgpCiAgICAgICAgX0NpcmNsZTpTZXQzRCgpCiAgICAgICAgX0NpcmNsZTpTZXRNaW5pbWFwKCkKICAgICAgICBfQ2lyY2xlOlNldFF1YWxpdHkocXVhbHRpeSkKICAgICAgICBfQ2lyY2xlOlNldERyYXdDb25kaXRpb24oY29uZGl0aW9uKQogICAgICAgIF9DaXJjbGU6TGlua1dpdGhTcGVsbChzcGVsbCwgZHJhd1doZW5SZWFkeSkKICAgICAgICBfQ2lyY2xlOkRyYXcoKQoKXV0KY2xhc3MgJ19DaXJjbGUnCgotLSBDaXJjbGUgbW9kZXMKQ0lSQ0xFXzJEICAgICAgPSAwCkNJUkNMRV8zRCAgICAgID0gMQpDSVJDTEVfTUlOSU1BUCA9IDIKCi0tIE51bWJlciBvZiBjdXJyZW50bHkgY3JlYXRlZCBjaXJjbGVzCmxvY2FsIGNpcmNsZUNvdW50ID0gMQoKLS1bWwogICAgTmV3IGluc3RhbmNlIG9mIENpcmNsZQoKICAgIEBwYXJhbSBwb3NpdGlvbiB8IHZlY3RvciB8IENlbnRlciBvZiB0aGUgY2lyY2xlCiAgICBAcGFyYW0gcmFkaXVzICAgfCBmbG9hdCAgfCBSYWRpdXMgb2YgdGhlIGNpcmNsZQogICAgQHBhcmFtIHdpZHRoICAgIHwgaW50ICAgIHwgV2lkdGggb2YgdGhlIGNpcmNsZSBvdXRsaW5lCiAgICBAcGFyYW0gY29sb3IgICAgfCB0YWJsZSAgfCBDb2xvciBvZiB0aGUgY2lyY2xlIGluIGEgdGFsZSBmb3JtYXQgeyBhLCByLCBnLCBiIH0KXV0KZnVuY3Rpb24gX0NpcmNsZTpfX2luaXQocG9zaXRpb24sIHJhZGl1cywgd2lkdGgsIGNvbG9yKQoKICAgIGFzc2VydChwb3NpdGlvbiBhbmQgcG9zaXRpb24ueCBhbmQgKHBvc2l0aW9uLnkgYW5kIHBvc2l0aW9uLnogb3IgcG9zaXRpb24ueSksICJfQ2lyY2xlOiBwb3NpdGlvbiBpcyBpbnZhbGlkISIpCiAgICBhc3NlcnQocmFkaXVzIGFuZCB0eXBlKHJhZGl1cykgPT0gIm51bWJlciIsICJfQ2lyY2xlOiByYWRpdXMgaXMgaW52YWxpZCEiKQogICAgYXNzZXJ0KG5vdCBjb2xvciBvciBjb2xvciBhbmQgdHlwZShjb2xvcikgPT0gInRhYmxlIiBhbmQgI2NvbG9yID09IDQsICJfQ2lyY2xlOiBjb2xvciBpcyBpbnZhbGlkISIpCgogICAgc2VsZi5lbmFibGVkICAgPSB0cnVlCiAgICBzZWxmLmNvbmRpdGlvbiA9IG5pbAoKICAgIHNlbGYubWVudSAgICAgICAgPSBuaWwKICAgIHNlbGYubWVudUVuYWJsZWQgPSBuaWwKICAgIHNlbGYubWVudUNvbG9yICAgPSBuaWwKICAgIHNlbGYubWVudVdpZHRoICAgPSBuaWwKICAgIHNlbGYubWVudVF1YWxpdHkgPSBuaWwKCiAgICBzZWxmLm1vZGUgPSBDSVJDTEVfM0QKCiAgICBzZWxmLnBvc2l0aW9uID0gcG9zaXRpb24KICAgIHNlbGYucmFkaXVzICAgPSByYWRpdXMKICAgIHNlbGYud2lkdGggICAgPSB3aWR0aCBvciAxCiAgICBzZWxmLmNvbG9yICAgID0gY29sb3Igb3IgeyAyNTUsIDI1NSwgMjU1LCAyNTUgfQogICAgc2VsZi5xdWFsaXR5ICA9IHJhZGl1cyAvIDUKCiAgICBzZWxmLl9jaXJjbGVJZCAgPSAiY2lyY2xlIiAuLiBjaXJjbGVDb3VudAogICAgc2VsZi5fY2lyY2xlTnVtID0gY2lyY2xlQ291bnQKCiAgICBjaXJjbGVDb3VudCA9IGNpcmNsZUNvdW50ICsgMQoKZW5kCgotLVtbCiAgICBBZGRzIHRoaXMgY2lyY2xlIHRvIGEgZ2l2ZW4gbWVudQoKICAgIEBwYXJhbSBtZW51ICAgICAgIHwgc2NyaXB0Q29uZmlnIHwgSW5zdGFuY2Ugb2Ygc2NyaXB0IGNvbmZpZyB0byBhZGQgdGhpcyBjaXJjbGUgdG8KICAgIEBwYXJhbSBwYXJhbVRleHQgIHwgc3RyaW5nICAgICAgIHwgVGV4dCBmb3IgdGhlIG1lbnUgZW50cnkKICAgIEBwYXJhbSBhZGRDb2xvciAgIHwgYm9vbCAgICAgICAgIHwgQWRkIGNvbG9yIG9wdGlvbgogICAgQHBhcmFtIGFkZFdpZHRoICAgfCBib29sICAgICAgICAgfCBBZGQgd2lkdGggb3B0aW9uCiAgICBAcGFyYW0gYWRkUXVhbGl0eSB8IGJvb2wgICAgICAgICB8IEFkZCBxdWFsaXR5IG9wdGlvbgogICAgQHJldHVybiAgICAgICAgICAgfCBjbGFzcyAgICAgICAgfCBUaGUgY3VycmVudCBpbnN0YW5jZQpdXQpmdW5jdGlvbiBfQ2lyY2xlOkFkZFRvTWVudShtZW51LCBwYXJhbVRleHQsIGFkZENvbG9yLCBhZGRXaWR0aCwgYWRkUXVhbGl0eSkKCiAgICBhc3NlcnQobWVudSwgIl9DaXJjbGU6IG1lbnUgaXMgaW52YWxpZCEiKQogICAgYXNzZXJ0KHNlbGYubWVudSA9PSBuaWwsICJfQ2lyY2xlOiBBbHJlYWR5IGJvdW5kIHRvIGEgbWVudSEiKQoKICAgIG1lbnU6YWRkU3ViTWVudShwYXJhbVRleHQgb3IgIkNpcmNsZSAiIC4uIHNlbGYuX2NpcmNsZU51bSwgc2VsZi5fY2lyY2xlSWQpCiAgICBzZWxmLm1lbnUgPSBtZW51W3NlbGYuX2NpcmNsZUlkXQoKICAgIC0tIEVuYWJsZWQKICAgIGxvY2FsIHBhcmFtSWQgPSBzZWxmLl9jaXJjbGVJZCAuLiAiZW5hYmxlZCIKICAgIHNlbGYubWVudTphZGRQYXJhbShwYXJhbUlkLCAiRW5hYmxlZCIsIFNDUklQVF9QQVJBTV9PTk9GRiwgc2VsZi5lbmFibGVkKQogICAgc2VsZi5tZW51RW5hYmxlZCA9IHNlbGYubWVudS5fcGFyYW1bI3NlbGYubWVudS5fcGFyYW1dCgogICAgaWYgYWRkQ29sb3Igb3IgYWRkV2lkdGggb3IgYWRkUXVhbGl0eSB0aGVuCgogICAgICAgIC0tIENvbG9yCiAgICAgICAgaWYgYWRkQ29sb3IgdGhlbgogICAgICAgICAgICBwYXJhbUlkID0gc2VsZi5fY2lyY2xlSWQgLi4gImNvbG9yIgogICAgICAgICAgICBzZWxmLm1lbnU6YWRkUGFyYW0ocGFyYW1JZCwgIkNvbG9yIiwgU0NSSVBUX1BBUkFNX0NPTE9SLCBzZWxmLmNvbG9yKQogICAgICAgICAgICBzZWxmLm1lbnVDb2xvciA9IHNlbGYubWVudS5fcGFyYW1bI3NlbGYubWVudS5fcGFyYW1dCiAgICAgICAgZW5kCgogICAgICAgIC0tIFdpZHRoCiAgICAgICAgaWYgYWRkV2lkdGggdGhlbgogICAgICAgICAgICBwYXJhbUlkID0gc2VsZi5fY2lyY2xlSWQgLi4gIndpZHRoIgogICAgICAgICAgICBzZWxmLm1lbnU6YWRkUGFyYW0ocGFyYW1JZCwgIldpZHRoIiwgU0NSSVBUX1BBUkFNX1NMSUNFLCBzZWxmLndpZHRoLCAxLCA1KQogICAgICAgICAgICBzZWxmLm1lbnVXaWR0aCA9IHNlbGYubWVudS5fcGFyYW1bI3NlbGYubWVudS5fcGFyYW1dCiAgICAgICAgZW5kCgogICAgICAgIC0tIFF1YWxpdHkKICAgICAgICBpZiBhZGRRdWFsaXR5IHRoZW4KICAgICAgICAgICAgcGFyYW1JZCA9IHNlbGYuX2NpcmNsZUlkIC4uICJxdWFsaXR5IgogICAgICAgICAgICBzZWxmLm1lbnU6YWRkUGFyYW0ocGFyYW1JZCwgIlF1YWxpdHkiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIG1hdGgucm91bmQoc2VsZi5xdWFsaXR5KSwgMTAsIG1hdGgucm91bmQoc2VsZi5yYWRpdXMgLyA1KSkKICAgICAgICAgICAgc2VsZi5tZW51UXVhbGl0eSA9IHNlbGYubWVudS5fcGFyYW1bI3NlbGYubWVudS5fcGFyYW1dCiAgICAgICAgZW5kCgogICAgZW5kCgogICAgcmV0dXJuIHNlbGYKCmVuZAoKLS1bWwogICAgU2V0IHRoZSBlbmFibGUgc3RhdHVzIG9mIHRoZSBjaXJjbGUKCiAgICBAcGFyYW0gZW5hYmxlZCB8IGJvb2wgIHwgRW5hYmxlIHN0YXRlIG9mIHRoaXMgY2lyY2xlCiAgICBAcmV0dXJuICAgICAgICB8IGNsYXNzIHwgVGhlIGN1cnJlbnQgaW5zdGFuY2UKXV0KZnVuY3Rpb24gX0NpcmNsZTpTZXRFbmFibGVkKGVuYWJsZWQpCgogICAgc2VsZi5lbmFibGVkID0gZW5hYmxlZAogICAgcmV0dXJuIHNlbGYKCmVuZAoKLS1bWwogICAgU2V0IHRoaXMgY2lyY2xlIHRvIGJlIGRpc3BsYXllZCAyRAoKICAgIEByZXR1cm4gfCBjbGFzcyB8IFRoZSBjdXJyZW50IGluc3RhbmNlCl1dCmZ1bmN0aW9uIF9DaXJjbGU6U2V0MkQoKQoKICAgIHNlbGYubW9kZSA9IENJUkNMRV8yRAogICAgcmV0dXJuIHNlbGYKCmVuZAoKLS1bWwogICAgU2V0IHRoaXMgY2lyY2xlIHRvIGJlIGRpc3BsYXllZCAzRAoKICAgIEByZXR1cm4gfCBjbGFzcyB8IFRoZSBjdXJyZW50IGluc3RhbmNlCl1dCmZ1bmN0aW9uIF9DaXJjbGU6U2V0M0QoKQoKICAgIHNlbGYubW9kZSA9IENJUkNMRV8zRAogICAgcmV0dXJuIHNlbGYKCmVuZAoKLS1bWwogICAgU2V0IHRoaXMgY2lyY2xlIHRvIGJlIGRpc3BsYXllZCBvbiB0aGUgbWluaW1hcAoKICAgIEByZXR1cm4gfCBjbGFzcyB8IFRoZSBjdXJyZW50IGluc3RhbmNlCl1dCmZ1bmN0aW9uIF9DaXJjbGU6U2V0TWluaW1hcCgpCgogICAgc2VsZi5tb2RlID0gQ0lSQ0xFX01JTklNQVAKICAgIHJldHVybiBzZWxmCgplbmQKCi0tW1sKICAgIFNldCB0aGUgZGlzcGxheSBxdWFsaXR5IG9mIHRoaXMgY2lyY2xlCgogICAgQHJldHVybiB8IGNsYXNzIHwgVGhlIGN1cnJlbnQgaW5zdGFuY2UKXV0KZnVuY3Rpb24gX0NpcmNsZTpTZXRRdWFsaXR5KHF1YWx0aXkpCgogICAgYXNzZXJ0KHF1YWx0aXkgYW5kIHR5cGUocXVhbHRpeSkgPT0gIm51bWJlciIsICJfQ2lyY2xlOiBxdWFsaXR5IGlzIGludmFsaWQhIikKICAgIHNlbGYucXVhbGl0eSA9IHF1YWxpdHkKICAgIHJldHVybiBzZWxmCgplbmQKCi0tW1sKICAgIFNldCB0aGUgZHJhdyBjb25kaXRpb24gb2YgdGhpcyBjaXJjbGUKCiAgICBAcmV0dXJuIHwgY2xhc3MgfCBUaGUgY3VycmVudCBpbnN0YW5jZQpdXQpmdW5jdGlvbiBfQ2lyY2xlOlNldERyYXdDb25kaXRpb24oY29uZGl0aW9uKQoKICAgIGFzc2VydChjb25kaXRpb24gYW5kIHR5cGUoY29uZGl0aW9uKSA9PSAiZnVuY3Rpb24iLCAiX0NpcmNsZTogY29uZGl0aW9uIGlzIGludmFsaWQhIikKICAgIHNlbGYuY29uZGl0aW9uID0gY29uZGl0aW9uCiAgICByZXR1cm4gc2VsZgoKZW5kCgotLVtbCiAgICBMaW5rcyB0aGUgc3BlbGwgcmFuZ2Ugd2l0aCB0aGUgY2lyY2xlIHJhZGl1cwoKICAgIEBwYXJhbSBzcGVsbCAgICAgICAgIHwgY2xhc3MgfCBJbnN0YW5jZSBvZiBTcGVsbCBjbGFzcwogICAgQHBhcmFtIGRyYXdXaGVuUmVhZHkgfCBib29sICB8IERlY2lkZXMgd2hldGhlciB0byBkcmF3IHRoZSBjaXJjbGUgd2hlbiB0aGUgc3BlbGwgaXMgcmVhZHkgb3Igbm90CiAgICBAcmV0dXJuICAgICAgICAgICAgICB8IGNsYXNzIHwgVGhlIGN1cnJlbnQgaW5zdGFuY2UKXV0KZnVuY3Rpb24gX0NpcmNsZTpMaW5rV2l0aFNwZWxsKHNwZWxsLCBkcmF3V2hlblJlYWR5KQoKICAgIGFzc2VydChzcGVsbCwgIl9DaXJjbGU6TGlua1dpdGhTcGVsbCgpOiBzcGVsbCBpcyBpbnZhbGlkIikKICAgIHNlbGYuX2xpbmtlZFNwZWxsID0gc3BlbGwKICAgIHNlbGYuX2xpbmtlZFNwZWxsUmVhZHkgPSBkcmF3V2hlblJlYWR5IG9yIGZhbHNlCiAgICByZXR1cm4gc2VsZgoKZW5kCgotLVtbCiAgICBEcmF3IHRoaXMgY2lyY2xlLCBzaG91bGQgb25seSBiZSBjYWxsZWQgZnJvbSBPbkRyYXcoKQpdXQpmdW5jdGlvbiBfQ2lyY2xlOkRyYXcoKQoKICAgIC0tIERvbid0IGRyYXcgaWYgY29uZGl0aW9uIGlzIG5vdCBtZXQKICAgIGlmIHNlbGYuY29uZGl0aW9uIH49IG5pbCBhbmQgc2VsZi5jb25kaXRpb24oKSA9PSBmYWxzZSB0aGVuIHJldHVybiBlbmQKCiAgICAtLSBVcGRhdGUgdmFsdWVzIGlmIGxpbmtlZCBzcGVsbCBpcyBnaXZlbgogICAgaWYgc2VsZi5fbGlua2VkU3BlbGwgdGhlbgogICAgICAgIGlmIHNlbGYuX2xpbmtlZFNwZWxsUmVhZHkgYW5kIG5vdCBzZWxmLl9saW5rZWRTcGVsbDpJc1JlYWR5KCkgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgLS0gVXBkYXRlIHRoZSByYWRpdXMgd2l0aCB0aGUgc3BlbGwgcmFuZ2UKICAgICAgICBzZWxmLnJhZGl1cyA9IHNlbGYuX2xpbmtlZFNwZWxsLnJhbmdlCiAgICBlbmQKCiAgICAtLSBNZW51IGZvdW5kCiAgICBpZiBzZWxmLm1lbnUgdGhlbiAKICAgICAgICBpZiBzZWxmLm1lbnVFbmFibGVkIH49IG5pbCB0aGVuCiAgICAgICAgICAgIGlmIG5vdCBzZWxmLm1lbnVbc2VsZi5tZW51RW5hYmxlZC52YXJdIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGVuZAogICAgICAgIGlmIHNlbGYubWVudUNvbG9yIH49IG5pbCB0aGVuCiAgICAgICAgICAgIHNlbGYuY29sb3IgPSBzZWxmLm1lbnVbc2VsZi5tZW51Q29sb3IudmFyXQogICAgICAgIGVuZAogICAgICAgIGlmIHNlbGYubWVudVdpZHRoIH49IG5pbCB0aGVuCiAgICAgICAgICAgIHNlbGYud2lkdGggPSBzZWxmLm1lbnVbc2VsZi5tZW51V2lkdGgudmFyXQogICAgICAgIGVuZAogICAgICAgIGlmIHNlbGYubWVudVF1YWxpdHkgfj0gbmlsIHRoZW4KICAgICAgICAgICAgc2VsZi5xdWFsaXR5ID0gc2VsZi5tZW51W3NlbGYubWVudVF1YWxpdHkudmFyXQogICAgICAgIGVuZAogICAgZW5kCgogICAgbG9jYWwgY2VudGVyID0gV29ybGRUb1NjcmVlbihEM0RYVkVDVE9SMyhzZWxmLnBvc2l0aW9uLngsIHNlbGYucG9zaXRpb24ueSwgc2VsZi5wb3NpdGlvbi56KSkKICAgIGlmIG5vdCBzZWxmOlBvaW50T25TY3JlZW4oY2VudGVyLngsIGNlbnRlci55KSBhbmQgc2VsZi5tb2RlIH49IENJUkNMRV9NSU5JTUFQIHRoZW4KICAgICAgICByZXR1cm4KICAgIGVuZAoKICAgIGlmIHNlbGYubW9kZSA9PSBDSVJDTEVfMkQgdGhlbgogICAgICAgIERyYXdDaXJjbGUyRChzZWxmLnBvc2l0aW9uLngsIHNlbGYucG9zaXRpb24ueSwgc2VsZi5yYWRpdXMsIHNlbGYud2lkdGgsIFRBUkdCKHNlbGYuY29sb3IpLCBzZWxmLnF1YWxpdHkpCiAgICBlbHNlaWYgc2VsZi5tb2RlID09IENJUkNMRV8zRCB0aGVuCiAgICAgICAgRHJhd0NpcmNsZTNEKHNlbGYucG9zaXRpb24ueCwgc2VsZi5wb3NpdGlvbi55LCBzZWxmLnBvc2l0aW9uLnosIHNlbGYucmFkaXVzLCBzZWxmLndpZHRoLCBUQVJHQihzZWxmLmNvbG9yKSwgc2VsZi5xdWFsaXR5KQogICAgZWxzZWlmIHNlbGYubW9kZSA9PSBDSVJDTEVfTUlOSU1BUCB0aGVuCiAgICAgICAgRHJhd0NpcmNsZU1pbmltYXAoc2VsZi5wb3NpdGlvbi54LCBzZWxmLnBvc2l0aW9uLnksIHNlbGYucG9zaXRpb24ueiwgc2VsZi5yYWRpdXMsIHNlbGYud2lkdGgsIFRBUkdCKHNlbGYuY29sb3IpLCBzZWxmLnF1YWxpdHkpCiAgICBlbHNlCiAgICAgICAgcHJpbnQoIkNpcmNsZTogU29tZXRoaW5nIGlzIHdyb25nIHdpdGggdGhlIGNpcmNsZS5tb2RlISIpCiAgICBlbmQKCmVuZAoKZnVuY3Rpb24gX0NpcmNsZTpQb2ludE9uU2NyZWVuKHgsIHkpCiAgICByZXR1cm4geCA8PSBXSU5ET1dfVyBhbmQgeCA+PSAwIGFuZCB5ID49IDAgYW5kIHkgPD0gV0lORE9XX0gKZW5kCgpmdW5jdGlvbiBfQ2lyY2xlOl9fZXEob3RoZXIpCiAgICByZXR1cm4gb3RoZXIuX2NpcmNsZUlkIGFuZCBvdGhlci5fY2lyY2xlSWQgPT0gc2VsZi5fY2lyY2xlSWQgb3IgZmFsc2UKZW5kCgotLVtbCgonfHwnJ3wuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd8fCcgICAgICAgfHwgICd8fCAgICAgIAogfHwgICB8fCAgIC4uLi4gICAuLiAuLiAuLiAgICAuLi4uICAgICAuLi4gLiAgIC4uLi4gICB8fCAgICAgICAuLi4gICB8fCAuLi4gIAogfHwgICAgfHwgJycgLnx8ICAgfHwgfHwgfHwgICcnIC58fCAgIHx8IHx8ICAufC4uLnx8ICB8fCAgICAgICAgfHwgICB8fCcgIHx8IAogfHwgICAgfHwgLnwnIHx8ICAgfHwgfHwgfHwgIC58JyB8fCAgICB8JycgICB8fCAgICAgICB8fCAgICAgICAgfHwgICB8fCAgICB8IAoufHwuLi58JyAgJ3wuLid8JyAufHwgfHwgfHwuICd8Li4nfCcgICd8fHx8LiAgJ3wuLi4nIC58fC4uLi4ufCAufHwuICAnfC4uLicgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnwuLi4uJyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoKICAgIERhbWFnZUxpYiAtIEhvbHkgY293LCBzbyBwcmVjaXNlIQoKICAgIEZ1bmN0aW9uczoKICAgICAgICBEYW1hZ2VMaWIoc291cmNlKQoKICAgIE1lbWJlcnM6CiAgICAgICAgRGFtYWdlTGliLnNvdXJjZSB8IEN1bml0IHwgU291cmNlIHVuaXQgZm9yIHdoaWNoIHRoZSBkYW1hZ2Ugc2hvdWxkIGJlIGNhbGN1bGF0ZWQKCiAgICBNZXRob2RzOgogICAgICAgIERhbWFnZUxpYjpSZWdpc3RlckRhbWFnZVNvdXJjZShzcGVsbElkLCBkYW1hZ2V0eXBlLCBiYXNlZGFtYWdlLCBwZXJsZXZlbCwgc2NhbGluZ3R5cGUsIHNjYWxpbmdzdGF0LCBwZXJjZW50c2NhbGluZywgY29uZGl0aW9uLCBleHRyYSkKICAgICAgICBEYW1hZ2VMaWI6R2V0U2NhbGluZ0RhbWFnZSh0YXJnZXQsIHNjYWxpbmd0eXBlLCBzY2FsaW5nc3RhdCwgcGVyY2VudHNjYWxpbmcpCiAgICAgICAgRGFtYWdlTGliOkdldFRydWVEYW1hZ2UodGFyZ2V0LCBzcGVsbCwgZGFtYWdldHlwZSwgYmFzZWRhbWFnZSwgcGVybGV2ZWwsIHNjYWxpbmd0eXBlLCBzY2FsaW5nc3RhdCwgcGVyY2VudHNjYWxpbmcsIGNvbmRpdGlvbiwgZXh0cmEpCiAgICAgICAgRGFtYWdlTGliOkNhbGNTcGVsbERhbWFnZSh0YXJnZXQsIHNwZWxsKQogICAgICAgIERhbWFnZUxpYjpDYWxjQ29tYm9EYW1hZ2UodGFyZ2V0LCBjb21ibykKICAgICAgICBEYW1hZ2VMaWI6SXNLaWxsYWJsZSh0YXJnZXQsIGNvbWJvKQogICAgICAgIERhbWFnZUxpYjpBZGRUb01lbnUobWVudSwgY29tYm8pCgogICAgLUF2YWlsYWJsZSBzcGVsbHMgYnkgZGVmYXVsdCAobm90IGFkZGVkIHlldCk6CiAgICAgICAgX0FBOiBSZXR1cm5zIHRoZSBhdXRvLWF0dGFjayBkYW1hZ2UuCiAgICAgICAgX0lHTklURTogUmV0dXJucyB0aGUgaWduaXRlIGRhbWFnZS4KICAgICAgICBfSVRFTVM6IFJldHVybnMgdGhlIGRhbWFnZSBkZWFsdCBieSBhbGwgdGhlIGl0ZW1zIGFjdGl2ZXMuCgogICAgLURhbWFnZSB0eXBlczoKICAgICAgICBfTUFHSUMKICAgICAgICBfUEhZU0lDQUwKICAgICAgICBfVFJVRQoKICAgIC1TY2FsaW5nIHR5cGVzOiBfQVAsIF9BRCwgX0JPTlVTX0FELCBfSEVBTFRILCBfQVJNT1IsIF9NUiwgX01BWEhFQUxUSCwgX01BWE1BTkEgCl1dCmNsYXNzICdEYW1hZ2VMaWInCgotLURhbWFnZSB0eXBlcwpfTUFHSUMsIF9QSFlTSUNBTCwgX1RSVUUgPSAwLCAxLCAyCgotLVBlcmNlbnRhZ2Ugc2NhbGUgdHlwZSdzIApfQVAsIF9BRCwgX0JPTlVTX0FELCBfSEVBTFRILCBfQVJNT1IsIF9NUiwgX01BWEhFQUxUSCwgX01BWE1BTkEgPSAxLCAyLCAzLCA0LCA1LCA2LCA3LCA4CgotLVBlcmNlbnRhZ2Ugc2NhbGUgZnVuY3Rpb25zCmxvY2FsIF9TY2FsaW5nRnVuY3Rpb25zID0gewogICAgW19BUF0gPSBmdW5jdGlvbih4LCB5KSByZXR1cm4geCAqIHkuc291cmNlLmFwIGVuZCwKICAgIFtfQURdID0gZnVuY3Rpb24oeCwgeSkgcmV0dXJuIHggKiB5LnNvdXJjZS50b3RhbERhbWFnZSBlbmQsCiAgICBbX0JPTlVTX0FEXSA9IGZ1bmN0aW9uKHgsIHkpIHJldHVybiB4ICogeS5zb3VyY2UuYWRkRGFtYWdlIGVuZCwKICAgIFtfQVJNT1JdID0gZnVuY3Rpb24oeCwgeSkgcmV0dXJuIHggKiB5LnNvdXJjZS5hcm1vciBlbmQsCiAgICBbX01SXSA9IGZ1bmN0aW9uKHgsIHkpIHJldHVybiB4ICogeS5zb3VyY2UubWFnaWNBcm1vciBlbmQsCiAgICBbX01BWEhFQUxUSF0gPSBmdW5jdGlvbih4LCB5KSByZXR1cm4geCAqIHkuc291cmNlLm1heEhlYXRoIGVuZCwKICAgIFtfTUFYTUFOQV0gPSBmdW5jdGlvbih4LCB5KSByZXR1cm4geCAqIHkuc291cmNlLm1heE1hbmEgZW5kLAp9CgotLVtbCiAgICBOZXcgaW5zdGFuY2Ugb2YgRGFtYWdlTGliCgogICAgQHBhcmFtIHNvdXJjZSB8IEN1bml0IHwgU291cmNlIHVuaXQgKGF0dGFja2VyLCBwbGF5ZXIgYnkgZGVmYXVsdCkKXV0KZnVuY3Rpb24gRGFtYWdlTGliOl9faW5pdChzb3VyY2UpCgogICAgc2VsZi5zb3VyY2VzID0ge30KICAgIHNlbGYuc291cmNlID0gc291cmNlIG9yIHBsYXllcgoKICAgIC0tRGFtYWdlIG11bHRpcGxpY2F0b3JzOgogICAgc2VsZi5NYWdpY19kYW1hZ2VfbSAgICA9IDEKICAgIHNlbGYuUGh5c2ljYWxfZGFtYWdlX20gPSAxCgogICAgLS0gTW9zdCBjb21tb24gZGFtYWdlIHNvdXJjZXMKICAgIHNlbGY6UmVnaXN0ZXJEYW1hZ2VTb3VyY2UoX0lHTklURSwgX1RSVUUsIDAsIDAsIF9UUlVFLCBfQVAsIDAsIGZ1bmN0aW9uKCkgcmV0dXJuIF9JR05JVEUgYW5kIChzZWxmLnNvdXJjZTpDYW5Vc2VTcGVsbChfSUdOSVRFKSA9PSBSRUFEWSkgZW5kLCBmdW5jdGlvbigpIHJldHVybiAoNTAgKyAyMCAqIHNlbGYuc291cmNlLmxldmVsKSBlbmQpCiAgICBzZWxmOlJlZ2lzdGVyRGFtYWdlU291cmNlKEl0ZW1NYW5hZ2VyOkdldEl0ZW0oIkRGRyIpOkdldElkKCksIF9NQUdJQywgMCwgMCwgX01BR0lDLCBfQVAsIDAsIGZ1bmN0aW9uKCkgcmV0dXJuIEl0ZW1NYW5hZ2VyOkdldEl0ZW0oIkRGRyIpOkdldFNsb3QoKSBhbmQgKHNlbGYuc291cmNlOkNhblVzZVNwZWxsKEl0ZW1NYW5hZ2VyOkdldEl0ZW0oIkRGRyIpOkdldFNsb3QoKSkgPT0gUkVBRFkpIGVuZCwgZnVuY3Rpb24odGFyZ2V0KSByZXR1cm4gMC4xNSAqIHRhcmdldC5tYXhIZWFsdGggZW5kKQogICAgc2VsZjpSZWdpc3RlckRhbWFnZVNvdXJjZShJdGVtTWFuYWdlcjpHZXRJdGVtKCJCT1RSSyIpOkdldElkKCksIF9NQUdJQywgMCwgMCwgX01BR0lDLCBfQVAsIDAsIGZ1bmN0aW9uKCkgcmV0dXJuIEl0ZW1NYW5hZ2VyOkdldEl0ZW0oIkJPVFJLIik6R2V0U2xvdCgpIGFuZCAoc2VsZi5zb3VyY2U6Q2FuVXNlU3BlbGwoSXRlbU1hbmFnZXI6R2V0SXRlbSgiQk9UUksiKTpHZXRTbG90KCkpID09IFJFQURZKSBlbmQsIGZ1bmN0aW9uKHRhcmdldCkgcmV0dXJuIDAuMTUgKiB0YXJnZXQubWF4SGVhbHRoIGVuZCkKICAgIHNlbGY6UmVnaXN0ZXJEYW1hZ2VTb3VyY2UoX0FBLCBfUEhZU0lDQUwsIDAsIDAsIF9QSFlTSUNBTCwgX0FELCAxKQoKZW5kCgotLVtbCiAgICBSZWdpc3RlciBhIG5ldyBzcGVsbAoKICAgIEBwYXJhbSBzcGVsbElkICAgICAgICB8IGludCAgICAgIHwgKHVuaXF1ZSkgU3BlbGwgaWQgdG8gYWRkLgogICAgCiAgICBAcGFyYW0gZGFtYWdldHlwZSAgICAgfCBpbnQgICAgICB8IFRoZSB0eXBlKHMpIG9mIHRoZSBiYXNlIGFuZCBwZXJsZXZlbCBkYW1hZ2UgKF9NQUdJQywgX1BIWVNJQ0FMLCBfVFJVRSkuCiAgICBAcGFyYW0gYmFzZWRhbWFnZSAgICAgfCBpbnQgICAgICB8IEJhc2UgZGFtYWdlKHMpIG9mIHRoZSBzcGVsbC4KICAgIEBwYXJhbSBwZXJsZXZlbCAgICAgICB8IGludCAgICAgIHwgRGFtYWdlKHMpIHNjYWxpbmcgcGVyIGxldmVsLgoKICAgIEBwYXJhbSBzY2FsaW5ndHlwZSAgICB8IGludCAgICAgIHwgVHlwZShzKSBvZiB0aGUgcGVyY2VudGFnZSBzY2FsZSAoX01BR0lDLCBfUEhZU0lDQUwsIF9UUlVFKS4KICAgIEBwYXJhbSBzY2FsaW5nc3RhdCAgICB8IGludCAgICAgIHwgU3RhdChzKSB0aGF0IHRoZSBkYW1hZ2Ugc2NhbGVzIHdpdGguCiAgICBAcGFyYW0gcGVyY2VudHNjYWxpbmcgfCBpbnQgICAgICB8IFBlcmNlbnRhZ2UocykgdGhlIHN0YXQgc2NhbGVzIHdpdGguCgogICAgQHBhcmFtIGNvbmRpdGlvbiAgICAgIHwgZnVuY3Rpb24gfCAob3B0aW9uYWwpIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRydWUgLyBmYWxzZSBkZXBlbmRpbmcgaWYgdGhlIGRhbWFnZSB3aWxsIGJlIHRha2VuIGludG8gYWNjb3VudCBvciBub3QsIHRoZSB0YXJnZXQgaXMgcGFzc2VkIGFzIHBhcmFtLgogICAgQHBhcmFtIGV4dHJhICAgICAgICAgIHwgZnVuY3Rpb24gfCAob3B0aW9uYWwpIEEgZnVuY3Rpb24gcmV0dXJuaW5nIGV4dHJhIGRhbWFnZSwgdGhlIHRhcmdldCBpcyBwYXNzZWQgYXMgcGFyYW0uCiAgICAKICAgIC1FeGFtcGxlIFNwZWxsczogCiAgICBUZWVtbyBROiAgODAgLyAxMjUgLyAxNzAgLyAyMTUgLyAyNjAgKCsgODAlIEFQKSAoTUFHSUMpCiAgICBEYW1hZ2VMaWI6UmVnaXN0ZXJEYW1hZ2VTb3VyY2UoX1EsIF9NQUdJQywgMzUsIDQ1LCBfTUFHSUMsIF9BUCwgMC44LCBmdW5jdGlvbigpIHJldHVybiAocGxheWVyOkNhblVzZVNwZWxsKF9RKSA9PSBSRUFEWSkgZW5kKQoKICAgIEFrYWxpcyBFOiAzMCAvIDU1IC8gODAgLyAxMDUgLyAxMzAgKCsgMzAlIEFQKSAoKyA2MCUgQUQpIChQSFlTSUNBTCkgCiAgICBEYW1hZ2VMaWI6UmVnaXN0ZXJEYW1hZ2VTb3VyY2UoX0UsIF9QSFlTSUNBTCwgNSwgMjUsIHtfUEhZU0lDQUwsX1BIWVNJQ0FMfSwge19BUCwgX0FEfSwgezAuMywgMC42fSwgZnVuY3Rpb24oKSByZXR1cm4gKHBsYXllcjpHZXRTcGVsbERhdGEoX1EpLmN1cnJlbnRDZCA8IDIpIG9yIChwbGF5ZXI6Q2FuVXNlU3BlbGwoX1EpID09IFJFQURZKSBlbmQpCgogICAgKiBkYW1hZ2V0eXBlLCBiYXNlZGFtYWdlLCBwZXJsZXZlbCBhbmQgc2NhbGluZ3R5cGUsIHNjYWxpbmdzdGF0LCBwZXJjZW50c2NhbGluZyBjYW4gYmUgdGFibGVzIGlmIHRoZXJlIGFyZSAyIG9yIG1vcmUgZGFtYWdlIHR5cGVzLgpdXQpmdW5jdGlvbiBEYW1hZ2VMaWI6UmVnaXN0ZXJEYW1hZ2VTb3VyY2Uoc3BlbGxJZCwgZGFtYWdldHlwZSwgYmFzZWRhbWFnZSwgcGVybGV2ZWwsIHNjYWxpbmd0eXBlLCBzY2FsaW5nc3RhdCwgcGVyY2VudHNjYWxpbmcsIGNvbmRpdGlvbiwgZXh0cmEpCgogICAgY29uZGl0aW9uID0gY29uZGl0aW9uIG9yIGZ1bmN0aW9uKCkgcmV0dXJuIHRydWUgZW5kCiAgICBpZiBzcGVsbElkIHRoZW4KICAgICAgICBzZWxmLnNvdXJjZXNbc3BlbGxJZF0gPSB7ZGFtYWdldHlwZSA9IGRhbWFnZXR5cGUsIGJhc2VkYW1hZ2UgPSBiYXNlZGFtYWdlLCBwZXJsZXZlbCA9IHBlcmxldmVsLCBjb25kaXRpb24gPSBjb25kaXRpb24sIGV4dHJhID0gZXh0cmEsIHNjYWxpbmd0eXBlID0gc2NhbGluZ3R5cGUsIHBlcmNlbnRzY2FsaW5nID0gcGVyY2VudHNjYWxpbmcsIHNjYWxpbmdzdGF0ID0gc2NhbGluZ3N0YXR9CiAgICBlbmQKCmVuZAoKZnVuY3Rpb24gRGFtYWdlTGliOkdldFNjYWxpbmdEYW1hZ2UodGFyZ2V0LCBzY2FsaW5ndHlwZSwgc2NhbGluZ3N0YXQsIHBlcmNlbnRzY2FsaW5nKQoKICAgIGxvY2FsIGFtb3VudCA9IChfU2NhbGluZ0Z1bmN0aW9uc1tzY2FsaW5nc3RhdF0gb3IgZnVuY3Rpb24oKSByZXR1cm4gMCBlbmQpKHBlcmNlbnRzY2FsaW5nLCBzZWxmKQoKICAgIGlmIHNjYWxpbmd0eXBlID09IF9NQUdJQyB0aGVuCiAgICAgICAgcmV0dXJuIHNlbGYuTWFnaWNfZGFtYWdlX20gKiBzZWxmLnNvdXJjZTpDYWxjTWFnaWNEYW1hZ2UodGFyZ2V0LCBhbW91bnQpCiAgICBlbHNlaWYgc2NhbGluZ3R5cGUgPT0gX1BIWVNJQ0FMIHRoZW4KICAgICAgICByZXR1cm4gc2VsZi5QaHlzaWNhbF9kYW1hZ2VfbSAqIHNlbGYuUGh5c2ljYWxfZGFtYWdlX20gKiBzZWxmLnNvdXJjZTpDYWxjRGFtYWdlKHRhcmdldCwgYW1vdW50KQogICAgZWxzZWlmIHNjYWxpbmd0eXBlID09IF9UUlVFIHRoZW4KICAgICAgICByZXR1cm4gYW1vdW50CiAgICBlbmQKCiAgICByZXR1cm4gMAoKZW5kCgpmdW5jdGlvbiBEYW1hZ2VMaWI6R2V0VHJ1ZURhbWFnZSh0YXJnZXQsIHNwZWxsLCBkYW1hZ2V0eXBlLCBiYXNlZGFtYWdlLCBwZXJsZXZlbCwgc2NhbGluZ3R5cGUsIHNjYWxpbmdzdGF0LCBwZXJjZW50c2NhbGluZywgY29uZGl0aW9uLCBleHRyYSkKCiAgICBiYXNlZGFtYWdlID0gYmFzZWRhbWFnZSBvciAwCiAgICBwZXJsZXZlbCA9IHBlcmxldmVsIG9yIDAKICAgIGNvbmRpdGlvbiA9IGNvbmRpdGlvbih0YXJnZXQpCiAgICBzY2FsaW5ndHlwZSA9IHNjYWxpbmd0eXBlIG9yIDAKICAgIHNjYWxpbmdzdGF0ID0gc2NhbGluZ3N0YXQgb3IgX0FQCiAgICBwZXJjZW50c2NhbGluZyA9IHBlcmNlbnRzY2FsaW5nIG9yIDAKICAgIGV4dHJhID0gZXh0cmEgb3IgZnVuY3Rpb24oKSByZXR1cm4gMCBlbmQKICAgIGxvY2FsIFNjYWxpbmdEYW1hZ2UgPSAwCgogICAgaWYgbm90IGNvbmRpdGlvbiB0aGVuIHJldHVybiAwIGVuZAoKICAgIGlmIHR5cGUoc2NhbGluZ3R5cGUpID09ICJudW1iZXIiIHRoZW4KICAgICAgICBTY2FsaW5nRGFtYWdlID0gU2NhbGluZ0RhbWFnZSArIHNlbGY6R2V0U2NhbGluZ0RhbWFnZSh0YXJnZXQsIHNjYWxpbmd0eXBlLCBzY2FsaW5nc3RhdCwgcGVyY2VudHNjYWxpbmcpCiAgICBlbHNlaWYgdHlwZShzY2FsaW5ndHlwZSkgPT0gInRhYmxlIiB0aGVuCiAgICAgICAgZm9yIGksIHYgaW4gaXBhaXJzKHNjYWxpbmd0eXBlKSBkbwogICAgICAgICAgICBTY2FsaW5nRGFtYWdlID0gU2NhbGluZ0RhbWFnZSArIHNlbGY6R2V0U2NhbGluZ0RhbWFnZSh0YXJnZXQsIHNjYWxpbmd0eXBlW2ldLCBzY2FsaW5nc3RhdFtpXSwgcGVyY2VudHNjYWxpbmdbaV0pCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBpZiBkYW1hZ2V0eXBlID09IF9NQUdJQyB0aGVuCiAgICAgICAgcmV0dXJuIHNlbGYuTWFnaWNfZGFtYWdlX20gKiBzZWxmLnNvdXJjZTpDYWxjTWFnaWNEYW1hZ2UodGFyZ2V0LCBiYXNlZGFtYWdlICsgcGVybGV2ZWwgKiBzZWxmLnNvdXJjZTpHZXRTcGVsbERhdGEoc3BlbGwpLmxldmVsICsgZXh0cmEodGFyZ2V0KSkgKyBTY2FsaW5nRGFtYWdlCiAgICBlbmQKICAgIGlmIGRhbWFnZXR5cGUgPT0gX1BIWVNJQ0FMIHRoZW4KICAgICAgICByZXR1cm4gc2VsZi5QaHlzaWNhbF9kYW1hZ2VfbSAqIHNlbGYuc291cmNlOkNhbGNEYW1hZ2UodGFyZ2V0LCBiYXNlZGFtYWdlICsgcGVybGV2ZWwgKiBzZWxmLnNvdXJjZTpHZXRTcGVsbERhdGEoc3BlbGwpLmxldmVsICsgZXh0cmEodGFyZ2V0KSkgKyBTY2FsaW5nRGFtYWdlCiAgICBlbmQKICAgIGlmIGRhbWFnZXR5cGUgPT0gX1RSVUUgdGhlbgogICAgICAgIHJldHVybiBiYXNlZGFtYWdlICsgcGVybGV2ZWwgKiBzZWxmLnNvdXJjZTpHZXRTcGVsbERhdGEoc3BlbGwpLmxldmVsICsgZXh0cmEodGFyZ2V0KSArIFNjYWxpbmdEYW1hZ2UKICAgIGVuZAoKICAgIHJldHVybiAwCgplbmQKCmZ1bmN0aW9uIERhbWFnZUxpYjpDYWxjU3BlbGxEYW1hZ2UodGFyZ2V0LCBzcGVsbCkKCiAgICBpZiBub3Qgc3BlbGwgdGhlbiByZXR1cm4gMCBlbmQKICAgIGxvY2FsIHNwZWxsZGF0YSA9IHNlbGYuc291cmNlc1tzcGVsbF0KICAgIGxvY2FsIHJlc3VsdCA9IDAKICAgIGFzc2VydChzcGVsbGRhdGEsICJEYW1hZ2VMaWI6IFRoZSBzcGVsbCBoYXMgdG8gYmUgYWRkZWQgZmlyc3QhIikKCiAgICBsb2NhbCBfdHlwZSA9IHR5cGUoc3BlbGxkYXRhLmRhbWFnZXR5cGUpCgogICAgaWYgX3R5cGUgPT0gIm51bWJlciIgdGhlbgogICAgICAgIHJlc3VsdCA9IHNlbGY6R2V0VHJ1ZURhbWFnZSh0YXJnZXQsIHNwZWxsLCBzcGVsbGRhdGEuZGFtYWdldHlwZSwgc3BlbGxkYXRhLmJhc2VkYW1hZ2UsIHNwZWxsZGF0YS5wZXJsZXZlbCwgc3BlbGxkYXRhLnNjYWxpbmd0eXBlLCBzcGVsbGRhdGEuc2NhbGluZ3N0YXQsIHNwZWxsZGF0YS5wZXJjZW50c2NhbGluZywgc3BlbGxkYXRhLmNvbmRpdGlvbiwgc3BlbGxkYXRhLmV4dHJhKQogICAgZWxzZWlmIF90eXBlID09ICJ0YWJsZSIgdGhlbgogICAgICAgIGZvciBpID0gMSwgI3NwZWxsZGF0YS5kYW1hZ2V0eXBlLCAxIGRvICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICsgc2VsZjpHZXRUcnVlRGFtYWdlKHRhcmdldCwgc3BlbGwsIHNwZWxsZGF0YS5kYW1hZ2V0eXBlW2ldLCBzcGVsbGRhdGEuYmFzZWRhbWFnZVtpXSwgc3BlbGxkYXRhLnBlcmxldmVsW2ldLCAwLCAwLCAwLCBzcGVsbGRhdGEuY29uZGl0aW9uKQogICAgICAgIGVuZAogICAgICAgIHJlc3VsdCA9IHJlc3VsdCArIHNlbGY6R2V0VHJ1ZURhbWFnZSh0YXJnZXQsIHNwZWxsLCAwLCAwLCAwLCBzcGVsbGRhdGEuc2NhbGluZ3R5cGUsIHNwZWxsZGF0YS5zY2FsaW5nc3RhdCwgc3BlbGxkYXRhLnBlcmNlbnRzY2FsaW5nLCBzcGVsbGRhdGEuY29uZGl0aW9uLCBzcGVsbGRhdGEuZXh0cmEpCiAgICBlbmQKCiAgICByZXR1cm4gcmVzdWx0CgplbmQKCmZ1bmN0aW9uIERhbWFnZUxpYjpDYWxjQ29tYm9EYW1hZ2UodGFyZ2V0LCBjb21ibykKCiAgICBsb2NhbCB0b3RhbGRhbWFnZSA9IDAKCiAgICBmb3IgaSwgc3BlbGwgaW4gaXBhaXJzKGNvbWJvKSBkbwogICAgICAgIGlmIHNwZWxsID09IEl0ZW1NYW5hZ2VyOkdldEl0ZW0oIkRGRyIpOkdldElkKCkgYW5kIEl0ZW1NYW5hZ2VyOkdldEl0ZW0oIkRGRyIpOklzUmVhZHkoKSB0aGVuCiAgICAgICAgICAgIHNlbGYuTWFnaWNfZGFtYWdlX20gPSAxLjIKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGZvciBpLCBzcGVsbCBpbiBpcGFpcnMoY29tYm8pIGRvCiAgICAgICAgdG90YWxkYW1hZ2UgPSB0b3RhbGRhbWFnZSArIHNlbGY6Q2FsY1NwZWxsRGFtYWdlKHRhcmdldCwgc3BlbGwpCiAgICBlbmQKCiAgICBzZWxmLk1hZ2ljX2RhbWFnZV9tID0gMQoKICAgIHJldHVybiB0b3RhbGRhbWFnZQoKZW5kCgotLVtbCiAgICBSZXR1cm5zIGlmIHRoZSB1bml0IHdpbGwgZGllIGFmdGVyIHRha2luZyB0aGUgY29tYm8gZGFtYWdlLgoKICAgIEBwYXJhbSB0YXJnZXQgfCBDdW5pdCB8IFRhcmdldC4KICAgIEBwYXJhbSBjb21ibyAgfCB0YWJsZSB8IFRoZSBjb21ibyB0YWJsZS4KXV0KZnVuY3Rpb24gRGFtYWdlTGliOklzS2lsbGFibGUodGFyZ2V0LCBjb21ibykKICAgIHJldHVybiB0YXJnZXQuaGVhbHRoIDw9IHNlbGY6Q2FsY0NvbWJvRGFtYWdlKHRhcmdldCwgY29tYm8pCmVuZAoKLS1bWwogICAgQWRkcyB0aGUgSGVhbHRoIGJhciBpbmRpY2F0b3JzIHRvIHRoZSBtZW51LgoKICAgIEBwYXJhbSBtZW51ICB8IHNjcmlwdENvbmZpZyB8IEFsbENsYXNzIG1lbnUgb3Igc3VibWVudSBpbnN0YW5jZS4KICAgIEBwYXJhbSBjb21ibyB8IHRhYmxlICAgICAgICB8IFRoZSBjb21ibyB0YWJsZS4KXV0KZnVuY3Rpb24gRGFtYWdlTGliOkFkZFRvTWVudShtZW51LCBjb21ibykKCiAgICBzZWxmLm1lbnUgPSBtZW51CiAgICBzZWxmLmNvbWJvID0gY29tYm8KICAgIHNlbGYudGlja2xpbWl0ID0gNSAtLTUgdGlja3MgcGVyIHNlY2NvbmQKICAgIHNlbGYuYmFyd2lkdGggPSAxMDAKICAgIHNlbGYuY2FjaGVkRGFtYWdlID0ge30KICAgIG1lbnU6YWRkUGFyYW0oIkRyYXdQcmVkaWN0ZWRIZWFsdGgiLCAiRHJhdyBkYW1hZ2UgYWZ0ZXIgY29tYm8uIiwgU0NSSVBUX1BBUkFNX09OT0ZGICwgdHJ1ZSkKICAgIHNlbGYuZW5hYmxlZCA9IG1lbnUuRHJhd1ByZWRpY3RlZEhlYWx0aAogICAgQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpPblRpY2soKSBlbmQpCiAgICBBZGREcmF3Q2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOk9uRHJhdygpIGVuZCkKCmVuZAoKZnVuY3Rpb24gRGFtYWdlTGliOk9uVGljaygpCgogICAgaWYgbm90IHNlbGYubWVudVsiRHJhd1ByZWRpY3RlZEhlYWx0aCJdIHRoZW4gcmV0dXJuIGVuZAogICAgc2VsZi5sYXN0dGljayA9IHNlbGYubGFzdHRpY2sgb3IgMAogICAgaWYgb3MuY2xvY2soKSAtIHNlbGYubGFzdHRpY2sgPiAxIC8gc2VsZi50aWNrbGltaXQgdGhlbgogICAgICAgIHNlbGYubGFzdHRpY2sgPSBvcy5jbG9jaygpCiAgICAgICAgZm9yIGksIGVuZW15IGluIGlwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbwogICAgICAgICAgICBpZiBWYWxpZFRhcmdldChlbmVteSkgdGhlbgogICAgICAgICAgICAgICAgc2VsZi5jYWNoZWREYW1hZ2VbZW5lbXkuaGFzaF0gPSBzZWxmOkNhbGNDb21ib0RhbWFnZShlbmVteSwgc2VsZi5jb21ibykKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKCmVuZAoKZnVuY3Rpb24gRGFtYWdlTGliOk9uRHJhdygpCgogICAgaWYgbm90IHNlbGYubWVudVsiRHJhd1ByZWRpY3RlZEhlYWx0aCJdIHRoZW4gcmV0dXJuIGVuZAogICAgZm9yIGksIGVuZW15IGluIGlwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbwogICAgICAgIGlmIFZhbGlkVGFyZ2V0KGVuZW15KSB0aGVuCiAgICAgICAgICAgIHNlbGY6RHJhd0luZGljYXRvcihlbmVteSkKICAgICAgICBlbmQKICAgIGVuZAoKZW5kCgpmdW5jdGlvbiBEYW1hZ2VMaWI6RHJhd0luZGljYXRvcihlbmVteSkKCiAgICBsb2NhbCBkYW1hZ2UgPSBzZWxmLmNhY2hlZERhbWFnZVtlbmVteS5oYXNoXSBvciAwCiAgICBsb2NhbCBTUG9zLCBFUG9zID0gR2V0RW5lbXlIUEJhclBvcyhlbmVteSkKCiAgICAtLSBWYWxpZGF0ZSBkYXRhCiAgICBpZiBub3QgU1BvcyB0aGVuIHJldHVybiBlbmQKCiAgICBsb2NhbCBiYXJ3aWR0aCA9IEVQb3MueCAtIFNQb3MueAogICAgbG9jYWwgUG9zaXRpb24gPSBTUG9zLnggKyBtYXRoLm1heCgwLCAoZW5lbXkuaGVhbHRoIC0gZGFtYWdlKSAvIGVuZW15Lm1heEhlYWx0aCkgKiBiYXJ3aWR0aAoKICAgIERyYXdUZXh0KCJ8IiwgMTYsIG1hdGguZmxvb3IoUG9zaXRpb24pLCBtYXRoLmZsb29yKFNQb3MueSArIDgpLCBBUkdCKDI1NSwwLDI1NSwwKSkKICAgIERyYXdUZXh0KCJIUDogIi4ubWF0aC5mbG9vcihlbmVteS5oZWFsdGggLSBkYW1hZ2UpLCAxMywgbWF0aC5mbG9vcihTUG9zLngpLCBtYXRoLmZsb29yKFNQb3MueSksIChlbmVteS5oZWFsdGggLSBkYW1hZ2UpID4gMCBhbmQgQVJHQigyNTUsIDAsIDI1NSwgMCkgb3IgIEFSR0IoMjU1LCAyNTUsIDAsIDApKQoKZW5kCgoKLS1bWwoKIC58JycnLnwgIHwnJ3x8Jyd8ICAufCcnJy58ICAKIHx8Li4gICcgICAgIHx8ICAgICB8fC4uICAnICAKICAnJ3x8fC4gICAgIHx8ICAgICAgJyd8fHwuICAKLiAgICAgJ3x8ICAgIHx8ICAgIC4gICAgICd8fCAKfCcuLi4ufCcgICAgLnx8LiAgIHwnLi4uLnwnICAKCiAgICBTaW1wbGUgVGFyZ2V0IFNlbGVjdG9yIChTVFMpIC0gV2h5IHVzaW5nIHRoZSByZWd1bGFyIG9uZSB3aGVuIHlvdSBjYW4gaGF2ZSBpdCBldmVuIG1vcmUgc2ltcGxlLgoKXV0KY2xhc3MgJ1NpbXBsZVRTJwoKZnVuY3Rpb24gU1RTX0dFVF9QUklPUklUWSh0YXJnZXQpCiAgICBpZiBub3QgU1RTX01FTlUgb3Igbm90IFNUU19NRU5VLlNUU1t0YXJnZXQuaGFzaF0gdGhlbgogICAgICAgIHJldHVybiAxCiAgICBlbHNlCiAgICAgICAgcmV0dXJuIFNUU19NRU5VLlNUU1t0YXJnZXQuaGFzaF0KICAgIGVuZAplbmQKClNUU19NRU5VID0gbmlsClNUU19ORUFSTU9VU0UgICAgICAgICAgICAgICAgICAgICA9IHtpZCA9IDEsIG5hbWUgPSAiTmVhciBtb3VzZSIsIHNvcnRmdW5jID0gZnVuY3Rpb24oYSwgYikgcmV0dXJuIF9HZXREaXN0YW5jZVNxcihtb3VzZVBvcywgYSkgPCBfR2V0RGlzdGFuY2VTcXIobW91c2VQb3MsIGIpIGVuZH0KU1RTX0xFU1NfQ0FTVF9NQUdJQyAgICAgICAgICAgICAgID0ge2lkID0gMiwgbmFtZSA9ICJMZXNzIGNhc3QgKG1hZ2ljKSIsIHNvcnRmdW5jID0gZnVuY3Rpb24oYSwgYikgcmV0dXJuIChwbGF5ZXI6Q2FsY01hZ2ljRGFtYWdlKGEsIDEwMCkgLyBhLmhlYWx0aCkgPiAocGxheWVyOkNhbGNNYWdpY0RhbWFnZShiLCAxMDApIC8gYi5oZWFsdGgpIGVuZH0KU1RTX0xFU1NfQ0FTVF9QSFlTSUNBTCAgICAgICAgICAgID0ge2lkID0gMywgbmFtZSA9ICJMZXNzIGNhc3QgKHBoeXNpY2FsKSIsIHNvcnRmdW5jID0gZnVuY3Rpb24oYSwgYikgcmV0dXJuIChwbGF5ZXI6Q2FsY0RhbWFnZShhLCAxMDApIC8gYS5oZWFsdGgpID4gKHBsYXllcjpDYWxjRGFtYWdlKGIsIDEwMCkgLyBiLmhlYWx0aCkgZW5kfQpTVFNfUFJJT1JJVFlfTEVTU19DQVNUX01BR0lDICAgICAgPSB7aWQgPSA0LCBuYW1lID0gIkxlc3MgY2FzdCBwcmlvcml0eSAobWFnaWMpIiwgc29ydGZ1bmMgPSBmdW5jdGlvbihhLCBiKSByZXR1cm4gU1RTX0dFVF9QUklPUklUWShhKSAqIChwbGF5ZXI6Q2FsY01hZ2ljRGFtYWdlKGEsIDEwMCkgLyBhLmhlYWx0aCkgPiBTVFNfR0VUX1BSSU9SSVRZKGIpICogKHBsYXllcjpDYWxjTWFnaWNEYW1hZ2UoYiwgMTAwKSAvIGIuaGVhbHRoKSBlbmR9ClNUU19QUklPUklUWV9MRVNTX0NBU1RfUEhZU0lDQUwgICA9IHtpZCA9IDUsIG5hbWUgPSAiTGVzcyBjYXN0IHByaW9yaXR5IChwaHlzaWNhbCkiLCBzb3J0ZnVuYyA9IGZ1bmN0aW9uKGEsIGIpIHJldHVybiBTVFNfR0VUX1BSSU9SSVRZKGEpICogKHBsYXllcjpDYWxjRGFtYWdlKGEsIDEwMCkgLyBhLmhlYWx0aCkgPiBTVFNfR0VUX1BSSU9SSVRZKGIpICogKHBsYXllcjpDYWxjRGFtYWdlKGIsIDEwMCkgLyBiLmhlYWx0aCkgZW5kfQpTVFNfQVZBSUxBQkxFX01PREVTID0ge1NUU19ORUFSTU9VU0UsIFNUU19MRVNTX0NBU1RfTUFHSUMsIFNUU19MRVNTX0NBU1RfUEhZU0lDQUwsIFNUU19QUklPUklUWV9MRVNTX0NBU1RfTUFHSUMsIFNUU19QUklPUklUWV9MRVNTX0NBU1RfUEhZU0lDQUx9CgpmdW5jdGlvbiBTaW1wbGVUUzpfX2luaXQobW9kZSkKICAgIHNlbGYubW9kZSA9IG1vZGUgYW5kIG1vZGUgb3IgU1RTX0xFU1NfQ0FTVF9QSFlTSUNBTAogICAgQWRkRHJhd0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpPbkRyYXcoKSBlbmQpCiAgICBBZGRNc2dDYWxsYmFjayhmdW5jdGlvbihtc2csIGtleSkgc2VsZjpPbk1zZyhtc2csIGtleSkgZW5kKQplbmQKCmZ1bmN0aW9uIFNpbXBsZVRTOklzVmFsaWQodGFyZ2V0LCByYW5nZSwgc2VsZWN0ZWQpCiAgICBpZiBWYWxpZFRhcmdldCh0YXJnZXQpIGFuZCAoX0dldERpc3RhbmNlU3FyKHRhcmdldCkgPD0gcmFuZ2Ugb3IgKHNlbGYuaGl0Ym94bW9kZSBhbmQgKF9HZXREaXN0YW5jZVNxcih0YXJnZXQpIDw9IChtYXRoLnNxcnQocmFuZ2UpICsgc2VsZi5WUDpHZXRIaXRCb3gobXlIZXJvKSArIHNlbGYuVlA6R2V0SGl0Qm94KHRhcmdldCkpIF4gMikpKSB0aGVuCiAgICAgICAgaWYgc2VsZWN0ZWQgb3IgKG5vdCAoSGFzQnVmZih0YXJnZXQsICJVbmR5aW5nUmFnZSIpIGFuZCAodGFyZ2V0LmhlYWx0aCA9PSAxKSkgYW5kIG5vdCBIYXNCdWZmKHRhcmdldCwgIkp1ZGljYXRvckludGVydmVudGlvbiIpKSB0aGVuCiAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpmdW5jdGlvbiBTaW1wbGVUUzpBZGRUb01lbnUobWVudSkKICAgIHNlbGYubWVudSA9IG1lbnUKICAgIHNlbGYubWVudTphZGRTdWJNZW51KCJUYXJnZXQgUHJpb3JpdHkiLCAiU1RTIikKICAgIGZvciBpLCB0YXJnZXQgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvCiAgICAgICAgICAgIHNlbGYubWVudS5TVFM6YWRkUGFyYW0odGFyZ2V0Lmhhc2gsIHRhcmdldC5jaGFyTmFtZSwgU0NSSVBUX1BBUkFNX1NMSUNFLCAxLCAxLCA1LCAwKQogICAgZW5kCiAgICBzZWxmLm1lbnUuU1RTOmFkZFBhcmFtKCJJbmZvIiwgIkluZm8iLCBTQ1JJUFRfUEFSQU1fSU5GTywgIjUgSGlnaGVzdCBwcmlvcml0eSIpCgogICAgbG9jYWwgbW9kZWxpc3QgPSB7fQogICAgZm9yIGksIG1vZGUgaW4gaXBhaXJzKFNUU19BVkFJTEFCTEVfTU9ERVMpIGRvCiAgICAgICAgdGFibGUuaW5zZXJ0KG1vZGVsaXN0LCBtb2RlLm5hbWUpCiAgICBlbmQKCiAgICBzZWxmLm1lbnU6YWRkUGFyYW0oIm1vZGUiLCAiVGFyZ2V0dGluZyBtb2RlOiAiLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgbW9kZWxpc3QpCiAgICBzZWxmLm1lbnVbIm1vZGUiXSA9IHNlbGYubW9kZS5pZAoKICAgIHNlbGYubWVudTphZGRQYXJhbSgiU2VsZWN0ZWQiLCAiRm9jdXMgc2VsZWN0ZWQgdGFyZ2V0IiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQoKICAgIFNUU19NRU5VID0gc2VsZi5tZW51CmVuZAoKZnVuY3Rpb24gU2ltcGxlVFM6T25Nc2cobXNnLCBrZXkpCiAgICBpZiBtc2cgPT0gV01fTEJVVFRPTkRPV04gdGhlbgogICAgICAgIGxvY2FsIE1pbmltdW1EaXN0YW5jZSA9IG1hdGguaHVnZQogICAgICAgIGxvY2FsIFNlbGVjdGVkVGFyZ2V0CiAgICAgICAgZm9yIGksIGVuZW15IGluIGlwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbwogICAgICAgICAgICBpZiBWYWxpZFRhcmdldChlbmVteSkgdGhlbgogICAgICAgICAgICAgICAgaWYgX0dldERpc3RhbmNlU3FyKGVuZW15LCBtb3VzZVBvcykgPD0gTWluaW11bURpc3RhbmNlIHRoZW4KICAgICAgICAgICAgICAgICAgICBNaW5pbXVtRGlzdGFuY2UgPSBfR2V0RGlzdGFuY2VTcXIoZW5lbXksIG1vdXNlUG9zKQogICAgICAgICAgICAgICAgICAgIFNlbGVjdGVkVGFyZ2V0ID0gZW5lbXkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICBpZiBTZWxlY3RlZFRhcmdldCBhbmQgTWluaW11bURpc3RhbmNlIDwgMTUwICogMTUwIHRoZW4KICAgICAgICAgICAgc2VsZi5TVGFyZ2V0ID0gU2VsZWN0ZWRUYXJnZXQKICAgICAgICBlbHNlCiAgICAgICAgICAgIHNlbGYuU1RhcmdldCA9IG5pbAogICAgICAgIGVuZAogICAgZW5kCmVuZAoKZnVuY3Rpb24gU2ltcGxlVFM6U2VsZWN0ZWRUYXJnZXQoKQogICAgcmV0dXJuIHNlbGYuU1RhcmdldAplbmQKCmZ1bmN0aW9uIFNpbXBsZVRTOkdldFRhcmdldChyYW5nZSwgbiwgZm9yY2Vtb2RlKQogICAgYXNzZXJ0KHJhbmdlLCAiU2ltcGxlVFM6IHJhbmdlIGNhbid0IGJlIG5pbCIpCiAgICByYW5nZSA9IHJhbmdlICogcmFuZ2UKICAgIGxvY2FsIFBvc2libGVUYXJnZXRzID0ge30KICAgIGxvY2FsIHNlbGVjdGVkID0gc2VsZjpTZWxlY3RlZFRhcmdldCgpCgogICAgaWYgc2VsZi5tZW51IHRoZW4KICAgICAgICBzZWxmLm1vZGUgPSBTVFNfQVZBSUxBQkxFX01PREVTW3NlbGYubWVudS5tb2RlXQogICAgICAgIGlmIHNlbGYubWVudS5TZWxlY3RlZCBhbmQgc2VsZWN0ZWQgYW5kIHNlbGVjdGVkLnR5cGUgPT0gcGxheWVyLnR5cGUgYW5kIHNlbGY6SXNWYWxpZChzZWxlY3RlZCwgcmFuZ2UsIHRydWUpIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBmb3IgaSwgZW5lbXkgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvCiAgICAgICAgaWYgc2VsZjpJc1ZhbGlkKGVuZW15LCByYW5nZSkgdGhlbgogICAgICAgICAgICB0YWJsZS5pbnNlcnQoUG9zaWJsZVRhcmdldHMsIGVuZW15KQogICAgICAgIGVuZAogICAgZW5kCiAgICB0YWJsZS5zb3J0KFBvc2libGVUYXJnZXRzLCBmb3JjZW1vZGUgYW5kIGZvcmNlbW9kZS5zb3J0ZnVuYyBvciBzZWxmLm1vZGUuc29ydGZ1bmMpCgogICAgcmV0dXJuIFBvc2libGVUYXJnZXRzW24gYW5kIG4gb3IgMV0KZW5kCgpmdW5jdGlvbiBTaW1wbGVUUzpPbkRyYXcoKQogICAgbG9jYWwgc2VsZWN0ZWQgPSBzZWxmOlNlbGVjdGVkVGFyZ2V0KCkKICAgIGlmIHNlbGYubWVudSBhbmQgc2VsZi5tZW51LlNlbGVjdGVkIGFuZCBWYWxpZFRhcmdldChzZWxlY3RlZCkgdGhlbgogICAgICAgIERyYXdDaXJjbGUzRChzZWxlY3RlZC54LCBzZWxlY3RlZC55LCBzZWxlY3RlZC56LCAxMDAsIDIsIEFSR0IoMTc1LCAwLCAyNTUsIDApLCAyNSkKICAgIGVuZAplbmQKCgotLVtbCgonfHwnICAgLiAgICAgICAgICAgICAgICAgICAgICAnfHwgICAgfHwnICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKIHx8ICAufHwuICAgIC4uLi4gIC4uIC4uIC4uICAgIHx8fCAgfHx8ICAgLi4uLiAgIC4uIC4uLiAgICAuLi4uICAgICAuLi4gLiAgIC4uLi4gIC4uLiAuLiAgCiB8fCAgIHx8ICAgLnwuLi58fCAgfHwgfHwgfHwgICB8J3wuLid8fCAgJycgLnx8ICAgfHwgIHx8ICAnJyAufHwgICB8fCB8fCAgLnwuLi58fCAgfHwnICcnIAogfHwgICB8fCAgIHx8ICAgICAgIHx8IHx8IHx8ICAgfCAnfCcgfHwgIC58JyB8fCAgIHx8ICB8fCAgLnwnIHx8ICAgIHwnJyAgIHx8ICAgICAgIHx8ICAgICAKLnx8LiAgJ3wuJyAgJ3wuLi4nIC58fCB8fCB8fC4gLnwuIHwgLnx8LiAnfC4uJ3wnIC58fC4gfHwuICd8Li4nfCcgICd8fHx8LiAgJ3wuLi4nIC58fC4gICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC58Li4uLicgICAgICAgICAgICAgICAgIAoKICAgIEl0ZW1NYW5hZ2VyIC0gQmV0dGVyIGhhbmRsZSB0aGVtIHByb3Blcmx5CgogICAgRnVuY3Rpb25zOgogICAgICAgIF9JdGVtTWFuYWdlcigpCgogICAgTWV0aG9kczoKICAgICAgICBfSXRlbU1hbmFnZXI6Q2FzdE9mZmVuc2l2ZUl0ZW1zKHRhcmdldCkKICAgICAgICBfSXRlbU1hbmFnZXI6R2V0SXRlbShuYW1lKQoKXV0KY2xhc3MgIl9JdGVtTWFuYWdlciIKCmZ1bmN0aW9uIF9JdGVtTWFuYWdlcjpfX2luaXQoKQogICAgc2VsZi5pdGVtcyA9IHsKICAgICAgICAgICAgWyJERkciXSA9IHtpZCA9IDMxMjgsIHJhbmdlID0gNjUwLCBjYW5jYXN0b25lbmVteSA9IHRydWV9LAogICAgICAgICAgICBbIkJPVFJLIl0gPSB7aWQgPSAzMTUzLCByYW5nZSA9IDQ1MCwgY2FuY2FzdG9uZW5lbXkgPSB0cnVlfQogICAgICAgIH0KCiAgICBzZWxmLnJlcXVlc3RlZGl0ZW1zID0ge30KZW5kCgotLVtbCiAgICBDYXN0cyBhbGwga25vd24gb2ZmZW5zaXZlIGl0ZW1zIG9uIHRoZSBnaXZlbiB0YXJnZXQKCiAgICBAcGFyYW0gdGFyZ2V0IHwgQ1VuaXQgfCBUYXJnZXQgdW5pdApdXQpmdW5jdGlvbiBfSXRlbU1hbmFnZXI6Q2FzdE9mZmVuc2l2ZUl0ZW1zKHRhcmdldCkKCiAgICBmb3IgbmFtZSwgaXRlbWRhdGEgaW4gcGFpcnMoc2VsZi5pdGVtcykgZG8KICAgICAgICBsb2NhbCBpdGVtID0gc2VsZjpHZXRJdGVtKG5hbWUpCiAgICAgICAgaWYgaXRlbTpJblJhbmdlKHRhcmdldCkgdGhlbgogICAgICAgICAgICBpdGVtOkNhc3QodGFyZ2V0KQogICAgICAgIGVuZAogICAgZW5kCgplbmQKCi0tW1sKICAgIEdldHMgdGhlIGl0ZW1zIGJ5IG5hbWUuCgogICAgQHBhcmFtIG5hbWUgICB8IHN0cmluZyB8IE5hbWUgb2YgdGhlIGl0ZW0gKG5vdCB0aGUgaW5nYW1lIG5hbWUsIHRoZSBuYW1lIHVzZWQgd2hlbiByZWdpc3RlcmluZywgbGlrZSBERkcpCiAgICBAcGFyYW0gcmV0dXJuIHwgY2xhc3MgIHwgSW5zdGFuY2Ugb2YgdGhlIGl0ZW0gdGhhdCB3YXMgcmVxdWVzdGVkIG9yIG5pbCBpZiBub3QgZm91bmQKXV0KZnVuY3Rpb24gX0l0ZW1NYW5hZ2VyOkdldEl0ZW0obmFtZSkKICAgIGFzc2VydChuYW1lIGFuZCBzZWxmLml0ZW1zW25hbWVdLCAiSXRlbU1hbmFnZXI6IEl0ZW0gbm90IGZvdW5kIikKICAgIGlmIG5vdCBzZWxmLnJlcXVlc3RlZGl0ZW1zW25hbWVdIHRoZW4KICAgICAgICBzZWxmLnJlcXVlc3RlZGl0ZW1zW25hbWVdID0gSXRlbShzZWxmLml0ZW1zW25hbWVdLmlkLCBzZWxmLml0ZW1zW25hbWVdLnJhbmdlKQogICAgZW5kCiAgICByZXR1cm4gc2VsZi5yZXF1ZXN0ZWRpdGVtc1tuYW1lXQplbmQKCi0tIE1ha2UgYSBnbG9iYWwgSXRlbU1hbmFnZXIgaW5zdGFuY2UuIFRoaXMgbWVhbnMgeW91IGRvbid0IG5lZWQgdG8gbWFrZSBhbiBpbnN0YW5jZSBmb3IgeW91cnNlbGYuCkl0ZW1NYW5hZ2VyID0gX0l0ZW1NYW5hZ2VyKCkKCgotLVtbCgonfHwnICAgLiAgICAgICAgICAgICAgICAgICAgICAKIHx8ICAufHwuICAgIC4uLi4gIC4uIC4uIC4uICAgCiB8fCAgIHx8ICAgLnwuLi58fCAgfHwgfHwgfHwgIAogfHwgICB8fCAgIHx8ICAgICAgIHx8IHx8IHx8ICAKLnx8LiAgJ3wuJyAgJ3wuLi4nIC58fCB8fCB8fC4gCgogICAgSXRlbSAtIEJlc3QgdXNlZCBpbiBJdGVtTWFuYWdlcgoKICAgIEZ1bmN0aW9uczoKICAgICAgICBJdGVtKGlkLCByYW5nZSkKCiAgICBNZXRob2RzOgogICAgICAgIEl0ZW06R2V0SWQoKQogICAgICAgIEl0ZW06R2V0UmFuZ2Uoc3FyKQogICAgICAgIEl0ZW06R2V0U2xvdCgpCiAgICAgICAgSXRlbTpVcGRhdGVTbG90KCkKICAgICAgICBJdGVtOklzUmVhZHkoKQogICAgICAgIEl0ZW06SW5SYW5nZSh0YXJnZXQpCiAgICAgICAgSXRlbTpDYXN0KHBhcmFtMSwgcGFyYW0yKQoKXV0KY2xhc3MgIkl0ZW0iCgotLVtbCiAgICBDcmVhdGUgYSBuZXcgaW5zdGFuY2Ugb2YgSXRlbQoKICAgIEBwYXJhbSBpZCAgICB8IGludGVnZXIgfCBJdGVtIGlkIAogICAgQHBhcmFtIHJhbmdlIHwgZmxvYXQgICB8IChvcHRpb25hbCkgUmFuZ2Ugb2YgdGhlIGl0ZW0KXV0KZnVuY3Rpb24gSXRlbTpfX2luaXQoaWQsIHJhbmdlKQoKICAgIGFzc2VydChpZCBhbmQgdHlwZShpZCkgPT0gIm51bWJlciIsICJJdGVtOiBpZCBpcyBpbnZhbGlkISIpCiAgICBhc3NlcnQobm90IHJhbmdlIG9yIHJhbmdlIGFuZCB0eXBlKHJhbmdlKSA9PSAibnVtYmVyIiwgIkl0ZW06IHJhbmdlIGlzIGludmFsaWQhIikKCiAgICBzZWxmLmlkID0gaWQKICAgIHNlbGYucmFuZ2UgPSByYW5nZQogICAgc2VsZi5yYW5nZVNxciA9IHJhbmdlIGFuZCByYW5nZSAqIHJhbmdlCiAgICBzZWxmLnNsb3QgPSBHZXRJbnZlbnRvcnlTbG90SXRlbShpZCkKCmVuZAoKLS1bWwogICAgUmV0dXJucyB0aGUgaWQgb2YgdGhlIGl0ZW0KCiAgICBAcmV0dXJuIHwgaW50ZWdlciB8IEl0ZW0gaWQKXV0KZnVuY3Rpb24gSXRlbTpHZXRJZCgpCiAgICByZXR1cm4gc2VsZi5pZAplbmQKCi0tW1sKICAgIFJldHVybnMgdGhlIHJhbmdlIG9mIHRoZSBpdGVtLCBvbmx5IHdvcmtpbmcgd2hlbiB0aGUgaXRlbSB3YXMgZGVmaW5lZCB3aXRoIGEgcmFuZ2UuCgogICAgQHBhcmFtIHNxciB8IGJvb2xlYW4gfCBSYW5nZSBzcXVhcmVkIG9yIG5vdAogICAgQHJldHVybiAgICB8IGZsb2F0ICAgfCBSYW5nZSBvZiB0aGUgaXRlbQpdXQpmdW5jdGlvbiBJdGVtOkdldFJhbmdlKHNxcikKICAgIHJldHVybiBzcXIgYW5kIHNlbGYucmFuZ2VTcXIgb3Igc2VsZi5yYW5nZQplbmQKCi0tW1sKICAgIFJldHVybiB0aGUgc2xvdCB0aGUgaXRlbSBpcyBpbgoKICAgIEByZXR1cm4gfCBpbnRlZ2VyIHwgU2xvdCBpdApdXQpmdW5jdGlvbiBJdGVtOkdldFNsb3QoKQogICAgc2VsZjpVcGRhdGVTbG90KCkKICAgIHJldHVybiBzZWxmLnNsb3QKZW5kCgotLVtbCiAgICBVcGRhdGVzIHRoZSBpdGVtIHNsb3QgdG8gdGhlIGN1cnJlbnQgb25lIChpZiBjaGFuZ2VkKQpdXQpmdW5jdGlvbiBJdGVtOlVwZGF0ZVNsb3QoKQogICAgc2VsZi5zbG90ID0gR2V0SW52ZW50b3J5U2xvdEl0ZW0oc2VsZi5pZCkKZW5kCgotLVtbCiAgICBSZXR1cm5zIGlmIHRoZSBpdGVtIGlzIHJlYWR5IHRvIGJlIGNhc3RlZCAob25seSB3b3JraW5nIHdoZW4gaXQncyBhbiBhY3RpdmUgaXRlbSkKCiAgICBAcmV0dXJuIHwgYm9vbGVhbiB8IFN0YXRlIG9mIHRoZSBpdGVtCl1dCmZ1bmN0aW9uIEl0ZW06SXNSZWFkeSgpCiAgICBzZWxmOlVwZGF0ZVNsb3QoKQogICAgcmV0dXJuIHNlbGYuc2xvdCBhbmQgKHBsYXllcjpDYW5Vc2VTcGVsbChzZWxmLnNsb3QpID09IFJFQURZKQplbmQKCi0tW1sKICAgIFJldHVybnMgaWYgdGhlIGl0ZW0gKGFjdHVhbGx5IHBsYXllcikgaXMgaW4gcmFuZ2Ugb2YgdGhlIHRhcmdldAoKICAgIEBwYXJhbSB0YXJnZXQgfCBDVW5pdCAgIHwgVGFyZ2V0IHVuaXQKICAgIEByZXR1cm4gICAgICAgfCBib29sZWFuIHwgSW4gcmFuZ2Ugb3Igbm90Cl1dCmZ1bmN0aW9uIEl0ZW06SW5SYW5nZSh0YXJnZXQpCiAgICByZXR1cm4gX0dldERpc3RhbmNlU3FyKHRhcmdldCkgPD0gc2VsZi5yYW5nZVNxcgplbmQKCi0tW1sKICAgIENhc3RzIHRoZSBpdGVtCgogICAgQHBhcmFtIHBhcmFtMSB8IENVbml0L2Zsb2F0IHwgRWl0aGVyIHRoZSB0YXJnZXQgdW5pdCBpdHNlbGYgb3IgYXMgcGFydCBvZiB0aGUgcG9zaXRpb24gdGhlIFggY29vcmRpbmF0ZQogICAgQHBhcmFtIHBhcmFtMiB8IGZsb2F0ICAgICAgIHwgKG9ubHkgdXNlIHdoZW4gcGFyYW0xIGlzIGdpdmVuKSBUaGUgWiBjb29yZGluYXRlCiAgICBAcmV0dXJuICAgICAgIHwgaW50ZWdlciAgICAgfCBUaGUgc3BlbGwgc3RhdGUKXV0KZnVuY3Rpb24gSXRlbTpDYXN0KHBhcmFtMSwgcGFyYW0yKQoKICAgIHNlbGY6VXBkYXRlU2xvdCgpCiAgICBpZiBzZWxmLnNsb3QgdGhlbgogICAgICAgIGlmIHBhcmFtMSB+PSBuaWwgYW5kIHBhcmFtMiB+PSBuaWwgdGhlbgogICAgICAgICAgICBDYXN0U3BlbGwoc2VsZi5zbG90LCBwYXJhbTEsIHBhcmFtMikKICAgICAgICBlbHNlaWYgcGFyYW0xIH49IG5pbCB0aGVuCiAgICAgICAgICAgIENhc3RTcGVsbChzZWxmLnNsb3QsIHBhcmFtMSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIENhc3RTcGVsbChzZWxmLnNsb3QpCiAgICAgICAgZW5kCiAgICAgICAgcmV0dXJuIFNQRUxMU1RBVEVfVFJJR0dFUkVECiAgICBlbmQKCmVuZAoKCi0tW1sKCid8fCAgICB8fCcgICAgICAgICAgICAgICAgICAgICAgICAgICAnfHwgJ3x8JyAgJ3wnICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiB8fHwgIHx8fCAgICAuLi4uICAuLiAuLi4gICAuLi4gLi4uICAgJ3wuICd8LiAgLicgIC4uLiAuLiAgIC4uLi4gICAuLi4gLi4uICAuLi4gLi4uICAgIC4uLi4gIC4uLiAuLiAgCiB8J3wuLid8fCAgLnwuLi58fCAgfHwgIHx8ICAgfHwgIHx8ICAgIHx8ICB8fCAgfCAgICB8fCcgJycgJycgLnx8ICAgfHwnICB8fCAgfHwnICB8fCAufC4uLnx8ICB8fCcgJycgCiB8ICd8JyB8fCAgfHwgICAgICAgfHwgIHx8ICAgfHwgIHx8ICAgICB8fHwgfHx8ICAgICB8fCAgICAgLnwnIHx8ICAgfHwgICAgfCAgfHwgICAgfCB8fCAgICAgICB8fCAgICAgCi58LiB8IC58fC4gICd8Li4uJyAufHwuIHx8LiAgJ3wuLid8LiAgICAgfCAgIHwgICAgIC58fC4gICAgJ3wuLid8JyAgfHwuLi4nICAgfHwuLi4nICAgJ3wuLi4nIC58fC4gICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgICAgICAgfHwgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJycnICAgICAnJycnICAgICAgICAgICAgICAgICAgICAgCgogICAgTWVudVdyYXBwZXIgLSBLZWVwIGl0IHNpbXBsZSEKCiAgICBJbnRyb2R1Y3Rpb246CiAgICAgICAgSWYgeW91IHdhbnQgdG8gdXNlIHRoZSBNZW51V3JhcHBlciB5b3UgbXVzdCBjcmVhdGUgeW91ciBtZW51IHdpdGggaXQhIFlvdSBjYW5ub3QgYWRkIHRoaXMgY2xhc3MgdG8KICAgICAgICBhbiBleGlzdGluZyBtZW51LiBPbmNlIHlvdSBoYXZlIGNyZWF0ZWQgYSBuZXcgaW5zdGFuY2UsIG1ha2Ugc3VyZSB5b3UgcmVtZW1iZXIgdGhlIGZvbGx3aW5nOgogICAgICAgICAgICAtIFRhcmdldCBzZWxlY3RvciBzdWItbWVudSBuYW1lOiB0cwogICAgICAgICAgICAtIE9yYndhbGtlciBzdWItbWVudSBuYW1lOiAgICAgICBvcmJ3YWxrZXIKICAgICAgICAgICAgLSBEcmF3aW5ncyBzdWItbWVudSBuYW1lOiAgICAgICAgZHJhd2luZ3MKICAgICAgICBJZiB5b3Ugd2FudCB0byB1c2UgdGhlc2Ugc3ViIG1lbnVzLCBzaW1wbHkgdXNlIHNvbWV0aGluZyBsaWtlIHRoaXM6CiAgICAgICAgICAgIE1lbnVXcmFwcGVyOkdldEhhbmRsZSgpLmRyYXdpbmdzOmFkZFBhcmFtKCJpbmZvIiwgIlRoaXMgaGFzIGJlZW4gY3JlYXRlZCB1c2luZyBNZW51V3JhcHBlciEiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpCiAgICAgICAgVGhpcyBtZWFucyB5b3UgY2FuIGdldCB0aGUgc2NyaXB0Q29uZmlnIGluc3RhbmNlIG9mIHRoZSB3cmFwcGVkIG1lbnUgYnkgdXNpbmcgdGhpczoKICAgICAgICAgICAgbG9jYWwgbXlNZW51ID0gTWVudVdyYXBwZXI6R2V0SGFuZGxlKCkKCiAgICBGdW5jdGlvbnM6CiAgICAgICAgTWVudVdyYXBwZXIobWVudU5hbWUsIG1lbnVJZCkKCiAgICBNZXRob2RzOgogICAgICAgIE1lbnVXcmFwcGVyOlNldFRhcmdldFNlbGVjdG9yKHRhcmdldFNlbGVjdG9yKQogICAgICAgIE1lbnVXcmFwcGVyOlNldE9yYndhbGtlcihvcmJ3YWxrZXIpCiAgICAgICAgTWVudVdyYXBwZXI6QWRkQ2lyY2xlKGNpcmNsZSwgYWRkQ29sb3IsIGFkZFdpZHRoLCBhZGRRdWFsaXR5KQogICAgICAgIE1lbnVXcmFwcGVyOkFkZENpcmNsZXMoY2lyY2xlVGFibGUsIGFkZENvbG9yLCBhZGRXaWR0aCwgYWRkUXVhbGl0eSkKICAgICAgICBNZW51V3JhcHBlcjpHZXRIYW5kbGUoKQoKXV0KY2xhc3MgJ01lbnVXcmFwcGVyJwoKLS1bWwogICAgQ3JlYXRlIGEgbmV3IE1lbnVXcmFwcGVyIGluc3RhbmNlCgogICAgQHBhcmFtIG1lbnVOYW1lIHwgc3RyaW5nIHwgRGlzcGxheSBuYW1lIG9mIHRoZSBtZW51CiAgICBAcGFyYW0gbWVudUlkICAgfCBzdHJpbmcgfCAob3B0aW9uYWwpIElEIG9mIHRoZSBtZW51IChmb3Igc2F2aW5nIHB1cnBvc2VzKQpdXQpmdW5jdGlvbiBNZW51V3JhcHBlcjpfX2luaXQobWVudU5hbWUsIG1lbnVJZCkKCiAgICBhc3NlcnQobWVudU5hbWUgYW5kIHR5cGUobWVudU5hbWUpID09ICJzdHJpbmciLCAiTWVudVdyYXBwZXI6IG1lbnVOYW1lIGlzIGludmFsaWQhIikKCiAgICBzZWxmLl9fbWVudSA9IHNjcmlwdENvbmZpZyhtZW51TmFtZSwgbWVudUlkIG9yIG1lbnVOYW1lKQoKZW5kCgotLVtbCiAgICBBZGRzIGEgU2ltcGxlVFMgaW5zdGFuY2UgdG8gdGhlIG1lbnUuCgogICAgQHBhcmFtIHRhcmdldFNlbGVjdG9yIHwgY2xhc3MgfCBTaW1wbGVUUyBpbnN0YW5jZQogICAgQHJldHVybiAgICAgICAgICAgICAgIHwgY2xhc3MgfCBzY3JpcHRDb25maWcgdGFyZ2V0IHNlbGVjdG9yIHN1Yi1tZW51Cl1dCmZ1bmN0aW9uIE1lbnVXcmFwcGVyOlNldFRhcmdldFNlbGVjdG9yKHRhcmdldFNlbGVjdG9yKQoKICAgIGFzc2VydCh0YXJnZXRTZWxlY3RvciwgIk1lbnVXcmFwcGVyOlNldFRhcmdldFNlbGVjdG9yKCk6IHRhcmdldFNlbGVjdG9yIGlzIG5vdCBhIHZhbGlkIFNpbXBsZVRTIGluc3RhbmNlISIpCiAgICBhc3NlcnQoc2VsZi5fX3RhcmdldFNlbGVjdG9yID09IG5pbCwgIk1lbnVXcmFwcGVyOlNldFRhcmdldFNlbGVjdG9yKCk6IHRhcmdldFNlbGVjdG9yIHdhcyBhbHJlYWR5IHNldCEiKQoKICAgIHNlbGYuX190YXJnZXRTZWxlY3RvciA9IHRhcmdldFNlbGVjdG9yCiAgICBzZWxmLl9fbWVudTphZGRTdWJNZW51KCJUYXJnZXQgU2VsZWN0b3IiLCAidHMiKQogICAgc2VsZi5fX3RhcmdldFNlbGVjdG9yOkFkZFRvTWVudShzZWxmLl9fbWVudS50cykKCiAgICByZXR1cm4gc2VsZi5fX21lbnUudHMKCmVuZAoKLS1bWwogICAgQWRkcyBhIFNPVyBpbnN0YW5jZSB0byB0aGUgbWVudQoKICAgIEBwYXJhbSBvcmJ3YWxrZXIgfCBjbGFzcyB8IFNPVyBpbnN0YW5jZQogICAgQHJldHVybiAgICAgICAgICB8IGNsYXNzIHwgc2NyaXRwQ29uZmlnIG9yYndhbGtlciBzdWItbWVudQpdXQpmdW5jdGlvbiBNZW51V3JhcHBlcjpTZXRPcmJ3YWxrZXIob3Jid2Fsa2VyKQoKICAgIGFzc2VydChvcmJ3YWxrZXIsICJNZW51V3JhcHBlcjpTZXRPcmJ3YWxrZXIoKTogb3Jid2Fsa2VyIGlzIG5vdCBhIHZhbGlkIFNPVyBpbnN0YW5jZSEiKQogICAgYXNzZXJ0KHNlbGYuX19vcmJ3YWxrZXIgPT0gbmlsLCAiTWVudVdyYXBwZXI6U2V0T3Jid2Fsa2VyKCk6IG9yd2Fsa2VyIHdhcyBhbHJlYWR5IHNldCEiKQoKICAgIHNlbGYuX19vcmJ3YWxrZXIgPSBvcmJ3YWxrZXIKICAgIHNlbGYuX19tZW51OmFkZFN1Yk1lbnUoIk9yYndhbGtlciIsICJvcmJ3YWxrZXIiKQogICAgc2VsZi5fX29yYndhbGtlcjpMb2FkVG9NZW51KHNlbGYuX19tZW51Lm9yYndhbGtlcikKCiAgICByZXR1cm4gc2VsZi5fX21lbnUub3Jid2Fsa2VyCgplbmQKCi0tW1sKICAgIEFkZHMgYSBjaXJjbGUgdG8gdGhlIGRyYXdpbmdzIHN1Yi1tZW51CgogICAgQHBhcmFtIGNpcmNsZSAgICAgIHwgY2xhc3MgfCBfQ2lyY2xlIGluc3RhbmNlCiAgICBAcGFyYW0gYWRkQ29sb3IgICAgfCBib29sICB8IChvcHRpb25hbCkgQWRkIGNvbG9yIG9wdGlvbgogICAgQHBhcmFtIGFkZFdpZHRoICAgIHwgYm9vbCAgfCAob3B0aW9uYWwpIEFkZCB3aWR0aCBvcHRpb24KICAgIEBwYXJhbSBhZGRRdWFsaXR5ICB8IGJvb2wgIHwgKG9wdGlvbmFsKSBBZGQgcXVhbGl0eSBvcHRpb24KICAgIEByZXR1cm4gICAgICAgICAgICB8IGNsYXNzIHwgc2NyaXB0Q29uZmlnIGRyYXdpbmdzIHN1Yi1tZW51Cl1dCmZ1bmN0aW9uIE1lbnVXcmFwcGVyOkFkZENpcmNsZShjaXJjbGUsIG5hbWUsIGFkZENvbG9yLCBhZGRXaWR0aCwgYWRkUXVhbGl0eSkKICAgIHJldHVybiBzZWxmOkFkZENpcmNsZXMoeyBbMV0gPSB7IGNpcmNsZSA9IGNpcmNsZSwgbmFtZSA9IG5hbWUgfSB9LCBhZGRDb2xvciwgYWRkV2lkdGgsIGFkZFF1YWxpdHkpCmVuZAoKLS1bWwogICAgQWRkcyBhIHRhYmxlIG9mIGNpcmNsZXMgdG8gdGhlIGRyYXdpbmdzIHN1Yi1tZW51CgogICAgQHBhcmFtIGNpcmNsZVRhYmxlIHwgdGFibGUgfCBUYWJsZSBjb250YWluaW5nIF9DaXJjbGUgaW5zdGFuY2VzCiAgICBAcGFyYW0gYWRkQ29sb3IgICAgfCBib29sICB8IChvcHRpb25hbCkgQWRkIGNvbG9yIG9wdGlvbgogICAgQHBhcmFtIGFkZFdpZHRoICAgIHwgYm9vbCAgfCAob3B0aW9uYWwpIEFkZCB3aWR0aCBvcHRpb24KICAgIEBwYXJhbSBhZGRRdWFsaXR5ICB8IGJvb2wgIHwgKG9wdGlvbmFsKSBBZGQgcXVhbGl0eSBvcHRpb24KICAgIEByZXR1cm4gICAgICAgICAgICB8IGNsYXNzIHwgc2NyaXB0Q29uZmlnIGRyYXdpbmdzIHN1Yi1tZW51Cl1dCmZ1bmN0aW9uIE1lbnVXcmFwcGVyOkFkZENpcmNsZXMoY2lyY2xlVGFibGUsIGFkZENvbG9yLCBhZGRXaWR0aCwgYWRkUXVhbGl0eSkKCiAgICBhc3NlcnQoY2lyY2xlVGFibGUgYW5kIHR5cGUoY2lyY2xlVGFibGUpID09ICJ0YWJsZSIsICJNZW51V3JhcHBlcjpBZGRDaXJjbGVzKCk6IGNpcmNsZVRhYmxlIGlzIG5vdCBhIHZhbGlkIHRhYmxlISIpCgogICAgZm9yIF8sIGVudHJ5IGluIGlwYWlycyhjaXJjbGVUYWJsZSkgZG8KCiAgICAgICAgYXNzZXJ0KGVudHJ5LmNpcmNsZSwgIk1lbnVXcmFwcGVyOkFkZENpcmNsZXMoKTogY2lyY2xlIGlzIG5vdCBhIHZhbGlkIF9DaXJjbGUgaW5zdGFuY2UhIikKICAgICAgICBhc3NlcnQoZW50cnkubmFtZSwgIk1lbnVXYXJwcGVyOkFkZENpcmNsZXMoKTogY2lyY2xlIG5hbWUgd2FzIG5vdCBnaXZlbiEiKQogICAgICAgIGFzc2VydChzZWxmLl9fY2lyY2xlcyA9PSBuaWwgb3Igbm90IHRhYmxlLmNvbnRhaW5zKHNlbGYuX19jaXJjbGVzLCBlbnRyeS5jaXJjbGUpLCAiTWVudVdyYXBwZXI6QWRkQ2lyY2xlcygpOiBUaGUgY2lyY2xlIHdhcyBhbHJlYWR5IGFkZGVkISIpCgogICAgICAgIGlmIG5vdCBzZWxmLl9fY2lyY2xlcyB0aGVuCiAgICAgICAgICAgIHNlbGYuX19jaXJjbGVzID0ge30KICAgICAgICBlbmQKCiAgICAgICAgaWYgbm90IHNlbGYuX19kcmF3aW5nIHRoZW4KICAgICAgICAgICAgc2VsZi5fX21lbnU6YWRkU3ViTWVudSgiRHJhd2luZ3MiLCAiZHJhd2luZ3MiKQogICAgICAgICAgICBzZWxmLl9fZHJhd2luZyA9IHNlbGYuX19tZW51LmRyYXdpbmdzCiAgICAgICAgZW5kCgogICAgICAgIGVudHJ5LmNpcmNsZTpBZGRUb01lbnUoc2VsZi5fX2RyYXdpbmcsIGVudHJ5Lm5hbWUsIGFkZENvbG9yLCBhZGRXaWR0aCwgYWRkUXVhbGl0eSkKCiAgICAgICAgdGFibGUuaW5zZXJ0KHNlbGYuX19jaXJjbGVzLCBlbnRyeS5jaXJjbGUpCgogICAgZW5kCgogICAgcmV0dXJuIHNlbGYuX19kcmF3aW5nCgplbmQKCi0tW1sKICAgIFJldHVybnMgdGhlIHdyYXBwZWQgc2NyaXB0Q29uZmlnCgogICAgQHJldHVybiB8IGNsYXNzIHwgc2NyaXB0Q29uZmlnIGluc3RhbmNlCl1dCmZ1bmN0aW9uIE1lbnVXcmFwcGVyOkdldEhhbmRsZSgpCiAgICByZXR1cm4gc2VsZi5fX21lbnUKZW5kCgoKLS1bWwoKJ3x8JyAgICAgICAgICAgIC4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4gICAgICAgICAgICAgICAgICAgCiB8fCAgLi4gLi4uICAgLnx8LiAgICAuLi4uICAuLi4gLi4gIC4uLiAuLiAgLi4uIC4uLiAgLi4uIC4uLiAgLnx8LiAgICAuLi4uICAuLi4gLi4gIAogfHwgICB8fCAgfHwgICB8fCAgIC58Li4ufHwgIHx8JyAnJyAgfHwnICcnICB8fCAgfHwgICB8fCcgIHx8ICB8fCAgIC58Li4ufHwgIHx8JyAnJyAKIHx8ICAgfHwgIHx8ICAgfHwgICB8fCAgICAgICB8fCAgICAgIHx8ICAgICAgfHwgIHx8ICAgfHwgICAgfCAgfHwgICB8fCAgICAgICB8fCAgICAgCi58fC4gLnx8LiB8fC4gICd8LicgICd8Li4uJyAufHwuICAgIC58fC4gICAgICd8Li4nfC4gIHx8Li4uJyAgICd8LicgICd8Li4uJyAufHwuICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJycnICAgICAgICAgICAgICAgICAgICAgICAgICAgCgogICAgSW50ZXJydXB0ZXIgLSBUaGV5IHdpbGwgbmV2ZXIgY2FzdCEKCiAgICBMaWtlIGFsd2FzeSB1bmRvY3VtZW50ZWQgYnkgaG9uZGEuLi4KXV0KY2xhc3MgJ0ludGVycnVwdGVyJwoKbG9jYWwgX0lOVEVSUlVQVElCTEVfU1BFTExTID0gewogICAgWyJLYXRhcmluYVIiXSAgICAgICAgICAgICAgICAgICAgICAgICAgPSB7IGNoYXJOYW1lID0gIkthdGFyaW5hIiwgICAgIERhbmdlckxldmVsID0gNSwgTWF4RHVyYXRpb24gPSAyLjUsIENhbk1vdmUgPSBmYWxzZSB9LAogICAgWyJNZWRpdGF0ZSJdICAgICAgICAgICAgICAgICAgICAgICAgICAgPSB7IGNoYXJOYW1lID0gIk1hc3RlcllpIiwgICAgIERhbmdlckxldmVsID0gMSwgTWF4RHVyYXRpb24gPSAyLjUsIENhbk1vdmUgPSBmYWxzZSB9LAogICAgWyJEcmFpbiJdICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSB7IGNoYXJOYW1lID0gIkZpZGRsZVN0aWNrcyIsIERhbmdlckxldmVsID0gMywgTWF4RHVyYXRpb24gPSAyLjUsIENhbk1vdmUgPSBmYWxzZSB9LAogICAgWyJDcm93c3Rvcm0iXSAgICAgICAgICAgICAgICAgICAgICAgICAgPSB7IGNoYXJOYW1lID0gIkZpZGRsZVN0aWNrcyIsIERhbmdlckxldmVsID0gNSwgTWF4RHVyYXRpb24gPSAyLjUsIENhbk1vdmUgPSBmYWxzZSB9LAogICAgWyJHYWxpb0lkb2xPZkR1cmFuZCJdICAgICAgICAgICAgICAgICAgPSB7IGNoYXJOYW1lID0gIkdhbGlvIiwgICAgICAgIERhbmdlckxldmVsID0gNSwgTWF4RHVyYXRpb24gPSAyLjUsIENhbk1vdmUgPSBmYWxzZSB9LAogICAgWyJNaXNzRm9ydHVuZUJ1bGxldFRpbWUiXSAgICAgICAgICAgICAgPSB7IGNoYXJOYW1lID0gIk1pc3NGb3J0dW5lIiwgIERhbmdlckxldmVsID0gNSwgTWF4RHVyYXRpb24gPSAyLjUsIENhbk1vdmUgPSBmYWxzZSB9LAogICAgWyJWZWxrb3pSIl0gICAgICAgICAgICAgICAgICAgICAgICAgICAgPSB7IGNoYXJOYW1lID0gIlZlbGtveiIsICAgICAgIERhbmdlckxldmVsID0gNSwgTWF4RHVyYXRpb24gPSAyLjUsIENhbk1vdmUgPSBmYWxzZSB9LAogICAgWyJJbmZpbml0ZUR1cmVzcyJdICAgICAgICAgICAgICAgICAgICAgPSB7IGNoYXJOYW1lID0gIldhcndpY2siLCAgICAgIERhbmdlckxldmVsID0gNSwgTWF4RHVyYXRpb24gPSAyLjUsIENhbk1vdmUgPSBmYWxzZSB9LAogICAgWyJBYnNvbHV0ZVplcm8iXSAgICAgICAgICAgICAgICAgICAgICAgPSB7IGNoYXJOYW1lID0gIk51bnUiLCAgICAgICAgIERhbmdlckxldmVsID0gNCwgTWF4RHVyYXRpb24gPSAyLjUsIENhbk1vdmUgPSBmYWxzZSB9LAogICAgWyJTaGVuU3RhbmRVbml0ZWQiXSAgICAgICAgICAgICAgICAgICAgPSB7IGNoYXJOYW1lID0gIlNoZW4iLCAgICAgICAgIERhbmdlckxldmVsID0gMywgTWF4RHVyYXRpb24gPSAyLjUsIENhbk1vdmUgPSBmYWxzZSB9LAogICAgWyJGYWxsZW5PbmUiXSAgICAgICAgICAgICAgICAgICAgICAgICAgPSB7IGNoYXJOYW1lID0gIkthcnRodXMiLCAgICAgIERhbmdlckxldmVsID0gNSwgTWF4RHVyYXRpb24gPSAyLjUsIENhbk1vdmUgPSBmYWxzZSB9LAogICAgWyJBbFphaGFyTmV0aGVyR3Jhc3AiXSAgICAgICAgICAgICAgICAgPSB7IGNoYXJOYW1lID0gIk1hbHphaGFyIiwgICAgIERhbmdlckxldmVsID0gNSwgTWF4RHVyYXRpb24gPSAyLjUsIENhbk1vdmUgPSBmYWxzZSB9LAogICAgWyJQYW50aGVvbl9HcmFuZFNreWZhbGxfSnVtcCJdICAgICAgICAgPSB7IGNoYXJOYW1lID0gIlBhbnRoZW9uIiwgICAgIERhbmdlckxldmVsID0gNSwgTWF4RHVyYXRpb24gPSAyLjUsIENhbk1vdmUgPSBmYWxzZSB9LAoKfQoKZnVuY3Rpb24gSW50ZXJydXB0ZXI6X19pbml0KG1lbnUsIGNiKQoKICAgIHNlbGYuY2FsbGJhY2tzID0ge30KICAgIHNlbGYuYWN0aXZlc3BlbGxzID0ge30KICAgIEFkZFRpY2tDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6T25UaWNrKCkgZW5kKQogICAgQWRkUHJvY2Vzc1NwZWxsQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgc3BlbGwpIHNlbGY6T25Qcm9jZXNzU3BlbGwodW5pdCwgc3BlbGwpIGVuZCkKICAgIGlmIG1lbnUgdGhlbgogICAgICAgIHNlbGY6QWRkVG9NZW51KG1lbnUpCiAgICBlbmQKICAgIGlmIGNiIHRoZW4KICAgICAgICBzZWxmOkFkZENhbGxiYWNrKGNiKQogICAgZW5kCgplbmQKCmZ1bmN0aW9uIEludGVycnVwdGVyOkFkZFRvTWVudShtZW51KQoKICAgIGFzc2VydChtZW51LCAiSW50ZXJydXB0ZXI6IG1lbnUgY2FuJ3QgYmUgbmlsISIpCiAgICBsb2NhbCBTcGVsbEFkZGVkID0gZmFsc2UKICAgIGxvY2FsIEVuZW15Q2hhbXBpb25jaGFyTmFtZXMgPSB7fQogICAgZm9yIGksIGVuZW15IGluIGlwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbwogICAgICAgIHRhYmxlLmluc2VydChFbmVteUNoYW1waW9uY2hhck5hbWVzLCBlbmVteS5jaGFyTmFtZSkKICAgIGVuZAogICAgbWVudTphZGRQYXJhbSgiRW5hYmxlZCIsICJFbmFibGVkIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQogICAgZm9yIHNwZWxsTmFtZSwgZGF0YSBpbiBwYWlycyhfSU5URVJSVVBUSUJMRV9TUEVMTFMpIGRvCiAgICAgICAgaWYgdGFibGUuY29udGFpbnMoRW5lbXlDaGFtcGlvbmNoYXJOYW1lcywgZGF0YS5jaGFyTmFtZSkgdGhlbgogICAgICAgICAgICBtZW51OmFkZFBhcmFtKHN0cmluZy5nc3ViKHNwZWxsTmFtZSwgIl8iLCAiIiksIGRhdGEuY2hhck5hbWUuLiIgLSAiLi5zcGVsbE5hbWUsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKICAgICAgICAgICAgU3BlbGxBZGRlZCA9IHRydWUKICAgICAgICBlbmQKICAgIGVuZAogICAgaWYgbm90IFNwZWxsQWRkZWQgdGhlbgogICAgICAgIG1lbnU6YWRkUGFyYW0oIkluZm8iLCAiSW5mbyIsIFNDUklQVF9QQVJBTV9JTkZPLCAiTm8gc3BlbGwgYXZhaWxhYmxlIHRvIGludGVycnVwdCIpCiAgICBlbmQKICAgIHNlbGYuTWVudSA9IG1lbnUKCmVuZAoKZnVuY3Rpb24gSW50ZXJydXB0ZXI6QWRkQ2FsbGJhY2soY2IpCgogICAgYXNzZXJ0KGNiIGFuZCB0eXBlKGNiKSA9PSAiZnVuY3Rpb24iLCAiSW50ZXJydXB0ZXI6IGNhbGxiYWNrIGlzIGludmFsaWQhIikKICAgIHRhYmxlLmluc2VydChzZWxmLmNhbGxiYWNrcywgY2IpCgplbmQKCmZ1bmN0aW9uIEludGVycnVwdGVyOlRyaWdnZXJDYWxsYmFja3ModW5pdCwgc3BlbGwpCgogICAgZm9yIGksIGNhbGxiYWNrIGluIGlwYWlycyhzZWxmLmNhbGxiYWNrcykgZG8KICAgICAgICBjYWxsYmFjayh1bml0LCBzcGVsbCkKICAgIGVuZAoKZW5kCgpmdW5jdGlvbiBJbnRlcnJ1cHRlcjpPblByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkKCiAgICBpZiBub3Qgc2VsZi5NZW51LkVuYWJsZWQgdGhlbiByZXR1cm4gZW5kCiAgICBpZiB1bml0LnRlYW0gfj0gbXlIZXJvLnRlYW0gdGhlbgogICAgICAgIGlmIF9JTlRFUlJVUFRJQkxFX1NQRUxMU1tzcGVsbC5uYW1lXSB0aGVuCiAgICAgICAgICAgIGxvY2FsIFNwZWxsVG9JbnRlcnJ1cHQgPSBfSU5URVJSVVBUSUJMRV9TUEVMTFNbc3BlbGwubmFtZV0KICAgICAgICAgICAgaWYgKHNlbGYuTWVudSBhbmQgc2VsZi5NZW51W3N0cmluZy5nc3ViKHNwZWxsLm5hbWUsICJfIiwgIiIpXSkgb3Igbm90IHNlbGYuTWVudSB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCBkYXRhID0ge3VuaXQgPSB1bml0LCBEYW5nZXJMZXZlbCA9IFNwZWxsVG9JbnRlcnJ1cHQuRGFuZ2VyTGV2ZWwsIGVuZFQgPSBvcy5jbG9jaygpICsgU3BlbGxUb0ludGVycnVwdC5NYXhEdXJhdGlvbiwgQ2FuTW92ZSA9IFNwZWxsVG9JbnRlcnJ1cHQuQ2FuTW92ZX0KICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChzZWxmLmFjdGl2ZXNwZWxscywgZGF0YSkKICAgICAgICAgICAgICAgIHNlbGY6VHJpZ2dlckNhbGxiYWNrcyhkYXRhLnVuaXQsIGRhdGEpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgplbmQKCmZ1bmN0aW9uIEludGVycnVwdGVyOk9uVGljaygpCgogICAgZm9yIGkgPSAjc2VsZi5hY3RpdmVzcGVsbHMsIDEsIC0xIGRvCiAgICAgICAgaWYgc2VsZi5hY3RpdmVzcGVsbHNbaV0uZW5kVCAtIG9zLmNsb2NrKCkgPiAwIHRoZW4KICAgICAgICAgICAgc2VsZjpUcmlnZ2VyQ2FsbGJhY2tzKHNlbGYuYWN0aXZlc3BlbGxzW2ldLnVuaXQsIHNlbGYuYWN0aXZlc3BlbGxzW2ldKQogICAgICAgIGVsc2UKICAgICAgICAgICAgdGFibGUucmVtb3ZlKHNlbGYuYWN0aXZlc3BlbGxzLCBpKQogICAgICAgIGVuZAogICAgZW5kCgplbmQKCgotLVtbCgogICAgfCAgICAgICAgICAgICAgICAuICAgIHx8ICAgLi58JycnLnwgICAgICAgICAgICAgICAgICAgICAgICAgICAnfHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgfHx8ICAgIC4uIC4uLiAgIC58fC4gIC4uLiAgLnwnICAgICAnICAgLi4uLiAgIC4uLiAuLi4gICAgLi4uLiAgIHx8ICAgIC4uLiAgICAuLi4uICAgIC4uLi4gIC4uLiAuLiAgCiAgfCAgfHwgICAgfHwgIHx8ICAgfHwgICAgfHwgIHx8ICAgIC4uLi4gJycgLnx8ICAgfHwnICB8fCAufCAgICcnICB8fCAgLnwgICd8LiB8fC4gJyAgLnwuLi58fCAgfHwnICcnIAogLicnJyd8LiAgIHx8ICB8fCAgIHx8ICAgIHx8ICAnfC4gICAgfHwgIC58JyB8fCAgIHx8ICAgIHwgfHwgICAgICAgfHwgIHx8ICAgfHwgLiAnfC4uIHx8ICAgICAgIHx8ICAgICAKLnwuICAufHwuIC58fC4gfHwuICAnfC4nIC58fC4gICcnfC4uLid8ICAnfC4uJ3wnICB8fC4uLicgICAnfC4uLicgLnx8LiAgJ3wuLnwnIHwnLi58JyAgJ3wuLi4nIC58fC4gICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJycnJyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCiAgICBBbnRpR2FwY2xvc2VyIC0gU3RheSBhd2F5IHBsZWFzZSwgdGhhbmtzLgoKICAgIEFuZCBhZ2FpbiB1bmRvY3VtZW50ZWQgYnkgaG9uZGEgLS4tCl1dCmNsYXNzICdBbnRpR2FwY2xvc2VyJwoKbG9jYWwgX0dBUENMT1NFUl9UQVJHRVRFRCwgX0dBUENMT1NFUl9TS0lMTFNIT1QgPSAxLCAyCi0tQWRkIG9ubHkgdmVyeSBmYXN0IHNraWxsc2hvdHMvdGFyZ2V0ZWQgc3BlbGxzIHNpbmNlIHZQcmVkaWN0aW9uIHdpbGwgaGFuZGxlIHRoZSBzbG93IGRhc2hlcyB0aGF0IHdpbGwgdHJpZ2dlciBPbkRhc2gKbG9jYWwgX0dBUENMT1NFUl9TUEVMTFMgPSB7CiAgICBbIkFhdHJveFEiXSAgICAgICAgICAgICAgPSAiQWF0cm94IiwKICAgIFsiQWthbGlTaGFkb3dEYW5jZSJdICAgICA9ICJBa2FsaSIsCiAgICBbIkhlYWRidXR0Il0gICAgICAgICAgICAgPSAiQWxpc3RhciIsCiAgICBbIkZpb3JhUSJdICAgICAgICAgICAgICAgPSAiRmlvcmEiLAogICAgWyJEaWFuYVRlbGVwb3J0Il0gICAgICAgID0gIkRpYW5hIiwKICAgIFsiRWxpc2VTcGlkZXJRQ2FzdCJdICAgICA9ICJFbGlzZSIsCiAgICBbIkZpenpQaWVyY2luZ1N0cmlrZSJdICAgPSAiRml6eiIsCiAgICBbIkdyYWdhc0UiXSAgICAgICAgICAgICAgPSAiR3JhZ2FzIiwKICAgIFsiSGVjYXJpbVVsdCJdICAgICAgICAgICA9ICJIZWNhcmltIiwKICAgIFsiSmFydmFuSVZEcmFnb25TdHJpa2UiXSA9ICJKYXJ2YW5JViIsCiAgICBbIklyZWxpYUdhdG90c3UiXSAgICAgICAgPSAiSXJlbGlhIiwKICAgIFsiSmF4TGVhcFN0cmlrZSJdICAgICAgICA9ICJKYXgiLAogICAgWyJLaGF6aXhFIl0gICAgICAgICAgICAgID0gIktoYXppeCIsCiAgICBbImtoYXppeGVsb25nIl0gICAgICAgICAgPSAiS2hheml4IiwKICAgIFsiTGVibGFuY1NsaWRlIl0gICAgICAgICA9ICJMZUJsYW5jIiwKICAgIFsiTGVibGFuY1NsaWRlTSJdICAgICAgICA9ICJMZUJsYW5jIiwKICAgIFsiQmxpbmRNb25rUVR3byJdICAgICAgICA9ICJMZWVTaW4iLAogICAgWyJMZW9uYVplbml0aEJsYWRlIl0gICAgID0gIkxlb25hIiwKICAgIFsiVUZTbGFzaCJdICAgICAgICAgICAgICA9ICJNYWxwaGl0ZSIsCiAgICBbIlBhbnRoZW9uX0xlYXBCYXNoIl0gICAgPSAiUGFudGhlb24iLAogICAgWyJQb3BweUhlcm9pY0NoYXJnZSJdICAgID0gIlBvcHB5IiwKICAgIFsiUmVuZWt0b25TbGljZUFuZERpY2UiXSA9ICJSZW5la3RvbiIsCiAgICBbIlJpdmVuVHJpQ2xlYXZlIl0gICAgICAgPSAiUml2ZW4iLAogICAgWyJTZWp1YW5pQXJjdGljQXNzYXVsdCJdID0gIlNlanVhbmkiLAogICAgWyJzbGFzaENhc3QiXSAgICAgICAgICAgID0gIlRyeW5kYW1lcmUiLAogICAgWyJWaVEiXSAgICAgICAgICAgICAgICAgID0gIlZpIiwKICAgIFsiTW9ua2V5S2luZ05pbWJ1cyJdICAgICA9ICJNb25rZXlLaW5nIiwKICAgIFsiWGVuWmhhb1N3ZWVwIl0gICAgICAgICA9ICJYaW5aaGFvIiwKICAgIFsiWWFzdW9EYXNoV3JhcHBlciJdICAgICA9ICJZYXN1byIKfQoKZnVuY3Rpb24gQW50aUdhcGNsb3NlcjpfX2luaXQobWVudSwgY2IpCgogICAgc2VsZi5jYWxsYmFja3MgPSB7fQogICAgc2VsZi5hY3RpdmVzcGVsbHMgPSB7fQogICAgQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpPblRpY2soKSBlbmQpCiAgICBBZGRQcm9jZXNzU3BlbGxDYWxsYmFjayhmdW5jdGlvbih1bml0LCBzcGVsbCkgc2VsZjpPblByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQogICAgaWYgbWVudSB0aGVuCiAgICAgICAgc2VsZjpBZGRUb01lbnUobWVudSkKICAgIGVuZAogICAgaWYgY2IgdGhlbgogICAgICAgIHNlbGY6QWRkQ2FsbGJhY2soY2IpCiAgICBlbmQKCmVuZAoKZnVuY3Rpb24gQW50aUdhcGNsb3NlcjpBZGRUb01lbnUobWVudSkKCiAgICBhc3NlcnQobWVudSwgIkFudGlHYXBjbG9zZXI6IG1lbnUgY2FuJ3QgYmUgbmlsISIpCiAgICBsb2NhbCBTcGVsbEFkZGVkID0gZmFsc2UKICAgIGxvY2FsIEVuZW15Q2hhbXBpb25jaGFyTmFtZXMgPSB7fQogICAgZm9yIGksIGVuZW15IGluIGlwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbwogICAgICAgIHRhYmxlLmluc2VydChFbmVteUNoYW1waW9uY2hhck5hbWVzLCBlbmVteS5jaGFyTmFtZSkKICAgIGVuZAogICAgbWVudTphZGRQYXJhbSgiRW5hYmxlZCIsICJFbmFibGVkIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQogICAgZm9yIHNwZWxsTmFtZSwgY2hhck5hbWUgaW4gcGFpcnMoX0dBUENMT1NFUl9TUEVMTFMpIGRvCiAgICAgICAgaWYgdGFibGUuY29udGFpbnMoRW5lbXlDaGFtcGlvbmNoYXJOYW1lcywgY2hhck5hbWUpIHRoZW4KICAgICAgICAgICAgbWVudTphZGRQYXJhbShzdHJpbmcuZ3N1YihzcGVsbE5hbWUsICJfIiwgIiIpLCBjaGFyTmFtZS4uIiAtICIuLnNwZWxsTmFtZSwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQogICAgICAgICAgICBTcGVsbEFkZGVkID0gdHJ1ZQogICAgICAgIGVuZAogICAgZW5kCiAgICBpZiBub3QgU3BlbGxBZGRlZCB0aGVuCiAgICAgICAgbWVudTphZGRQYXJhbSgiSW5mbyIsICJJbmZvIiwgU0NSSVBUX1BBUkFNX0lORk8sICJObyBzcGVsbCBhdmFpbGFibGUgdG8gaW50ZXJydXB0IikKICAgIGVuZAogICAgc2VsZi5NZW51ID0gbWVudQoKZW5kCgpmdW5jdGlvbiBBbnRpR2FwY2xvc2VyOkFkZENhbGxiYWNrKGNiKQoKICAgIGFzc2VydChjYiBhbmQgdHlwZShjYikgPT0gImZ1bmN0aW9uIiwgIkFudGlHYXBjbG9zZXI6IGNhbGxiYWNrIGlzIGludmFsaWQhIikKICAgIHRhYmxlLmluc2VydChzZWxmLmNhbGxiYWNrcywgY2IpCgplbmQKCmZ1bmN0aW9uIEFudGlHYXBjbG9zZXI6VHJpZ2dlckNhbGxiYWNrcyh1bml0LCBzcGVsbCkKCiAgICBmb3IgaSwgY2FsbGJhY2sgaW4gaXBhaXJzKHNlbGYuY2FsbGJhY2tzKSBkbwogICAgICAgIGNhbGxiYWNrKHVuaXQsIHNwZWxsKQogICAgZW5kCgplbmQKCmZ1bmN0aW9uIEFudGlHYXBjbG9zZXI6T25Qcm9jZXNzU3BlbGwodW5pdCwgc3BlbGwpCgogICAgaWYgbm90IHNlbGYuTWVudS5FbmFibGVkIHRoZW4gcmV0dXJuIGVuZAogICAgaWYgdW5pdC50ZWFtIH49IG15SGVyby50ZWFtIHRoZW4KICAgICAgICBpZiBfR0FQQ0xPU0VSX1NQRUxMU1tzcGVsbC5uYW1lXSB0aGVuCiAgICAgICAgICAgIGxvY2FsIEdhcGNsb3NlciA9IF9HQVBDTE9TRVJfU1BFTExTW3NwZWxsLm5hbWVdCiAgICAgICAgICAgIGlmIChzZWxmLk1lbnUgYW5kIHNlbGYuTWVudVtzdHJpbmcuZ3N1YihzcGVsbC5uYW1lLCAiXyIsICIiKV0pIG9yIG5vdCBzZWxmLk1lbnUgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgYWRkID0gZmFsc2UKICAgICAgICAgICAgICAgIGlmIHNwZWxsLnRhcmdldCBhbmQgc3BlbGwudGFyZ2V0LmlzTWUgdGhlbgogICAgICAgICAgICAgICAgICAgIGFkZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICBzdGFydFBvcyA9IFZlY3Rvcih1bml0LnZpc2lvblBvcykKICAgICAgICAgICAgICAgICAgICBlbmRQb3MgPSBteUhlcm8KICAgICAgICAgICAgICAgIGVsc2VpZiBub3Qgc3BlbGwudGFyZ2V0IHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBlbmRQb3MxID0gVmVjdG9yKHVuaXQudmlzaW9uUG9zKSArIDMwMCAqIChWZWN0b3Ioc3BlbGwuZW5kUG9zKSAtIFZlY3Rvcih1bml0LnZpc2lvblBvcykpOm5vcm1hbGl6ZWQoKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGVuZFBvczIgPSBWZWN0b3IodW5pdC52aXNpb25Qb3MpICsgMTAwICogKFZlY3RvcihzcGVsbC5lbmRQb3MpIC0gVmVjdG9yKHVuaXQudmlzaW9uUG9zKSk6bm9ybWFsaXplZCgpCiAgICAgICAgICAgICAgICAgICAgLS1UT0RPIGNoZWNrIGFuZ2xlcyBldGMKICAgICAgICAgICAgICAgICAgICBpZiAoX0dldERpc3RhbmNlU3FyKG15SGVyby52aXNpb25Qb3MsIHVuaXQudmlzaW9uUG9zKSA+IF9HZXREaXN0YW5jZVNxcihteUhlcm8udmlzaW9uUG9zLCBlbmRQb3MxKSBvciBfR2V0RGlzdGFuY2VTcXIobXlIZXJvLnZpc2lvblBvcywgdW5pdC52aXNpb25Qb3MpID4gX0dldERpc3RhbmNlU3FyKG15SGVyby52aXNpb25Qb3MsIGVuZFBvczIpKSAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBhZGQgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiBhZGQgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGRhdGEgPSB7dW5pdCA9IHVuaXQsIHNwZWxsID0gc3BlbGwubmFtZSwgc3RhcnRUID0gb3MuY2xvY2soKSwgZW5kVCA9IG9zLmNsb2NrKCkgKyAxLCBzdGFydFBvcyA9IHN0YXJ0UG9zLCBlbmRQb3MgPSBlbmRQb3N9CiAgICAgICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KHNlbGYuYWN0aXZlc3BlbGxzLCBkYXRhKQogICAgICAgICAgICAgICAgICAgIHNlbGY6VHJpZ2dlckNhbGxiYWNrcyhkYXRhLnVuaXQsIGRhdGEpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKCmVuZAoKZnVuY3Rpb24gQW50aUdhcGNsb3NlcjpPblRpY2soKQoKICAgIGZvciBpID0gI3NlbGYuYWN0aXZlc3BlbGxzLCAxLCAtMSBkbwogICAgICAgIGlmIHNlbGYuYWN0aXZlc3BlbGxzW2ldLmVuZFQgLSBvcy5jbG9jaygpID4gMCB0aGVuCiAgICAgICAgICAgIHNlbGY6VHJpZ2dlckNhbGxiYWNrcyhzZWxmLmFjdGl2ZXNwZWxsc1tpXS51bml0LCBzZWxmLmFjdGl2ZXNwZWxsc1tpXSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIHRhYmxlLnJlbW92ZShzZWxmLmFjdGl2ZXNwZWxscywgaSkKICAgICAgICBlbmQKICAgIGVuZAoKZW5kCgoKLS1bWwoKfCcnfHwnJ3wgIHx8ICAgICAgICAgICd8fCAgICAgICd8fCcgICAgICAgfHwgICAgICAgICAgICAgIHx8ICAgIC4gICAgICAgICAgICAgICAgICAgCiAgIHx8ICAgIC4uLiAgICAuLi4uICAgfHwgIC4uICAgfHwgICAgICAgLi4uICAuLiAuLiAuLiAgIC4uLiAgLnx8LiAgICAuLi4uICAuLi4gLi4gIAogICB8fCAgICAgfHwgIC58ICAgJycgIHx8IC4nICAgIHx8ICAgICAgICB8fCAgIHx8IHx8IHx8ICAgfHwgICB8fCAgIC58Li4ufHwgIHx8JyAnJyAKICAgfHwgICAgIHx8ICB8fCAgICAgICB8fCd8LiAgICB8fCAgICAgICAgfHwgICB8fCB8fCB8fCAgIHx8ICAgfHwgICB8fCAgICAgICB8fCAgICAgCiAgLnx8LiAgIC58fC4gICd8Li4uJyAufHwuIHx8LiAufHwuLi4uLnwgLnx8LiAufHwgfHwgfHwuIC58fC4gICd8LicgICd8Li4uJyAufHwuICAgIAoKICAgIFRpY2tMaW1pdGVyIC0gQmVjYXVzZSBwb3RhdG8gY29tcHV0ZXJzIGFsc28gdXNlIFNvdXJjZUxpYgoKICAgIEZ1bmN0aW9uczoKICAgICAgICBUaWNrTGltaXRlcihmdW5jLCBmcmVxdWVuY3kpCgpdXQpjbGFzcyAnVGlja0xpbWl0ZXInCgotLVtbCiAgICBTdGFydHMgVGlja0xpbWl0ZXIgaW5zdGFuY2UKCiAgICBAcGFyYW0gZnVuYyAgICAgICB8IGZ1bmN0aW9uIHwgVGhlIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZAogICAgQHBhcmFtIGZyZXF1ZW5jeSAgfCBpbnRlZ2VyICB8IFRoZSB0aW1lcyB0aGUgZnVuY3Rpb24gd2lsbCBjYWxsZWQgcGVyIHNlY29uZC4KXV0KZnVuY3Rpb24gVGlja0xpbWl0ZXI6X19pbml0KGZ1bmMsIGZyZXF1ZW5jeSkKCiAgICBhc3NlcnQoZnJlcXVlbmN5IGFuZCBmcmVxdWVuY3kgPiAwLCAiVGlja0xpbWl0ZXI6IGZyZWN1ZW5jeSBpcyBpbnZhbGlkISIpCiAgICBhc3NlcnQoZnVuYyBhbmQgdHlwZShmdW5jKSA9PSAiZnVuY3Rpb24iLCAiVGlja0xpbWl0ZXI6IGZ1bmMgaXMgaW52YWxpZCEiKQoKICAgIHNlbGYubGFzdHRpY2sgPSAwCiAgICBzZWxmLmludGVydmFsID0gMSAvIGZyZXF1ZW5jeQoKICAgIHNlbGYuZnVuYyA9IGZ1bmMKICAgIEFkZFRpY2tDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6T25UaWNrKCkgZW5kKQoKZW5kCgotLVtbCiAgICBJbnRlcm5hbCBjYWxsYmFjawpdXQpmdW5jdGlvbiBUaWNrTGltaXRlcjpPblRpY2soKQoKICAgIGlmIG9zLmNsb2NrKCkgLSBzZWxmLmxhc3R0aWNrID49IHNlbGYuaW50ZXJ2YWwgdGhlbgogICAgICAgIHNlbGYuZnVuYygpCiAgICAgICAgc2VsZi5sYXN0dGljayA9IG9zLmNsb2NrKCkKICAgIGVuZAoKZW5kCgoKLS1bWwoKJ3x8Jyd8LiAgICAgICAgICAgICAgICAgICd8fCAgICAgICAgICAgICAgICAuICAgJ3x8JyAgJ3x8JyAgICAgICAgICAgICAgICAgICAgICAgJ3x8ICAnfHwgICAgICAgICAgICAgICAgICAKIHx8ICAgfHwgIC4uLi4gICAgIC4uLi4gICB8fCAgLi4gICAgLi4uLiAgLnx8LiAgIHx8ICAgIHx8ICAgLi4uLiAgIC4uIC4uLiAgICAgIC4uIHx8ICAgfHwgICAgLi4uLiAgLi4uIC4uICAKIHx8Li4ufCcgJycgLnx8ICAufCAgICcnICB8fCAuJyAgIC58Li4ufHwgIHx8ICAgIHx8JycnJ3x8ICAnJyAufHwgICB8fCAgfHwgICAuJyAgJ3x8ICAgfHwgIC58Li4ufHwgIHx8JyAnJyAKIHx8ICAgICAgLnwnIHx8ICB8fCAgICAgICB8fCd8LiAgIHx8ICAgICAgIHx8ICAgIHx8ICAgIHx8ICAufCcgfHwgICB8fCAgfHwgICB8LiAgIHx8ICAgfHwgIHx8ICAgICAgIHx8ICAgICAKLnx8LiAgICAgJ3wuLid8JyAgJ3wuLi4nIC58fC4gfHwuICAnfC4uLicgICd8LicgLnx8LiAgLnx8LiAnfC4uJ3wnIC58fC4gfHwuICAnfC4uJ3x8LiAufHwuICAnfC4uLicgLnx8LiAgICAKCiAgICBQYWNrZXRIYW5kbGVyIC0gRXZlbiB0cmFjayBhbGwgZGVtIHBhY2tldHMsIG5vdCBqdXN0IHRoZSBlYXN5IG9uZXMhCgogICAgTWV0aG9kczoKICAgICAgICBQYWNrZXRIYW5kbGVyOkhvb2tJbmNvbWluZ1BhY2tldChoZWFkZXIsIGNhbGxiYWNrKQogICAgICAgIFBhY2tldEhhbmRsZXI6SG9va091dGdvaW5nUGFja2V0KGhlYWRlciwgY2FsbGJhY2spCgpdXQpjbGFzcyAnX1BhY2tldEhhbmRsZXInCgotLVtbCiAgICBDcmVhdGUgYSBuZXcgaW5zdGFuY2Ugb2YgX1BhY2tldEhhbmRsZXIuIFBsZWFzZSBkb24ndCBjYWxsIHRoaXMsIHVzZSB0aGUgZ2xvYmFsIFBhY2tldEhhbmRsZXIgaW5zdGVhZC4KXV0KZnVuY3Rpb24gX1BhY2tldEhhbmRsZXI6X19pbml0KCkKCiAgICBzZWxmLl9faW5jb21pbmdDYWxsYmFja3MgPSB7fQogICAgc2VsZi5fX291dGdvaW5nQ2FsbGJhY2tzID0ge30KCiAgICAtLSBSZWdpc3RlciBjYWxsYmFja3MKICAgIEFkZFNlbmRQYWNrZXRDYWxsYmFjayhmdW5jdGlvbihwKSBzZWxmOk9uU2VuZFBhY2tldChwKSBlbmQpCiAgICBBZGRSZWN2UGFja2V0Q2FsbGJhY2soZnVuY3Rpb24ocCkgc2VsZjpPblJlY3ZQYWNrZXQocCkgZW5kKQoKICAgIC0tIE9ubHkgcmVwbGFjZSB0aGUgZnVuY3Rpb24gb25jZQogICAgaWYgbm90IF9HLk9sZFNlbmRQYWNrZXQgdGhlbgogICAgICAgIC0tIFNhdmluZyB0aGUgb3JpZ2luYWwgU2VuZFBhY2tldCBmdW5jdGlvbiBmb3IgbGF0ZXIgdXNhZ2UKICAgICAgICBfRy5PbGRTZW5kUGFja2V0ID0gX0cuU2VuZFBhY2tldAoKICAgICAgICAtLSBPdmVycmlkZW4gcGFja2V0IHNlbmRpbmcKICAgICAgICBfRy5TZW5kUGFja2V0ID0gZnVuY3Rpb24ocCkKICAgICAgICAgICAgZm9yIGhlYWRlciwgY2FsbGJhY2tUYWJsZSBpbiBwYWlycyhzZWxmLl9fb3V0Z29pbmdDYWxsYmFja3MpIGRvCiAgICAgICAgICAgICAgICBpZiBoZWFkZXIgPT0gcC5oZWFkZXIgdGhlbgogICAgICAgICAgICAgICAgICAgIGZvciBfLCBjYWxsYmFjayBpbiBpcGFpcnMoY2FsbGJhY2tUYWJsZSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2socCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgX0cuT2xkU2VuZFBhY2tldChwKQogICAgICAgIGVuZAogICAgZW5kCgplbmQKCi0tW1sKICAgIEhvb2sgaW50byBhbiBpbmNvbWluZyBwYWNrZXQuCgogICAgQHBhcmFtIGhlYWRlciAgIHwgaW50ZWdlciAgfCBIZWFkZXIgaWQgdG8gaG9vayBpbnRvCiAgICBAcGFyYW0gY2FsbGJhY2sgfCBmdW5jdGlvbiB8IEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGUgcGFja2V0IGluIGJlaW5nIHJlY2VpdmVkCl1dCmZ1bmN0aW9uIF9QYWNrZXRIYW5kbGVyOkhvb2tJbmNvbWluZ1BhY2tldChoZWFkZXIsIGNhbGxiYWNrKQoKICAgIC0tIFByZWNoZWNrCiAgICBpZiBub3Qgc2VsZi5fX2luY29taW5nQ2FsbGJhY2tzW2hlYWRlcl0gdGhlbgogICAgICAgIHNlbGYuX19pbmNvbWluZ0NhbGxiYWNrc1toZWFkZXJdID0ge30KICAgIGVuZAoKICAgIHRhYmxlLmluc2VydChzZWxmLl9faW5jb21pbmdDYWxsYmFja3NbaGVhZGVyXSwgY2FsbGJhY2spCgplbmQKCi0tW1sKICAgIEhvb2sgaW50byBhbiBvdXRnb2luZyBwYWNrZXQuCgogICAgQHBhcmFtIGhlYWRlciAgIHwgaW50ZWdlciAgfCBIZWFkZXIgaWQgdG8gaG9vayBpbnRvCiAgICBAcGFyYW0gY2FsbGJhY2sgfCBmdW5jdGlvbiB8IEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGUgcGFja2V0IGluIGJlaW5nIHNlbnQKXV0KZnVuY3Rpb24gX1BhY2tldEhhbmRsZXI6SG9va091dGdvaW5nUGFja2V0KGhlYWRlciwgY2FsbGJhY2spCgogICAgLS0gUHJlY2hlY2sKICAgIGlmIG5vdCBzZWxmLl9fb3V0Z29pbmdDYWxsYmFja3NbaGVhZGVyXSB0aGVuCiAgICAgICAgc2VsZi5fX291dGdvaW5nQ2FsbGJhY2tzW2hlYWRlcl0gPSB7fQogICAgZW5kCgogICAgdGFibGUuaW5zZXJ0KHNlbGYuX19vdXRnb2luZ0NhbGxiYWNrc1toZWFkZXJdLCBjYWxsYmFjaykKCmVuZAoKLS1bWwogICAgSW50ZXJuYWwgY2FsbGJhY2sKXV0KZnVuY3Rpb24gX1BhY2tldEhhbmRsZXI6T25SZWN2UGFja2V0KHApCiAgICBmb3IgaGVhZGVyLCBjYWxsYmFja1RhYmxlIGluIHBhaXJzKHNlbGYuX19pbmNvbWluZ0NhbGxiYWNrcykgZG8KICAgICAgICBpZiBoZWFkZXIgPT0gcC5oZWFkZXIgdGhlbgogICAgICAgICAgICBmb3IgXywgY2FsbGJhY2sgaW4gaXBhaXJzKGNhbGxiYWNrVGFibGUpIGRvCiAgICAgICAgICAgICAgICBjYWxsYmFjayhwKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAplbmQKCi0tW1sKICAgIEludGVybmFsIGNhbGxiYWNrCl1dCmZ1bmN0aW9uIF9QYWNrZXRIYW5kbGVyOk9uU2VuZFBhY2tldChwKQogICAgZm9yIGhlYWRlciwgY2FsbGJhY2tUYWJsZSBpbiBwYWlycyhzZWxmLl9fb3V0Z29pbmdDYWxsYmFja3MpIGRvCiAgICAgICAgaWYgaGVhZGVyID09IHAuaGVhZGVyIHRoZW4KICAgICAgICAgICAgZm9yIF8sIGNhbGxiYWNrIGluIGlwYWlycyhjYWxsYmFja1RhYmxlKSBkbwogICAgICAgICAgICAgICAgY2FsbGJhY2socCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgotLSBDcmVhdGUgYSBnbG9iYWwgaW5zdHNhbmNlIG9mIFBhY2tldEhhbmRsZXIKUGFja2V0SGFuZGxlciA9IF9QYWNrZXRIYW5kbGVyKCkKCgotLVtbCgogLi58JycnLnwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd8fCcgICd8fCcgICAgICAgICAgICAgICAgICAgICAgICd8fCAgJ3x8ICAgICAgICAgICAgICAgICAgCi58JyAgICAgJyAgIC4uLi4gICAuLiAuLiAuLiAgICAgLi4uLiAgIHx8ICAgIHx8ICAgLi4uLiAgIC4uIC4uLiAgICAgIC4uIHx8ICAgfHwgICAgLi4uLiAgLi4uIC4uICAKfHwgICAgLi4uLiAnJyAufHwgICB8fCB8fCB8fCAgLnwuLi58fCAgfHwnJycnfHwgICcnIC58fCAgIHx8ICB8fCAgIC4nICAnfHwgICB8fCAgLnwuLi58fCAgfHwnICcnIAonfC4gICAgfHwgIC58JyB8fCAgIHx8IHx8IHx8ICB8fCAgICAgICB8fCAgICB8fCAgLnwnIHx8ICAgfHwgIHx8ICAgfC4gICB8fCAgIHx8ICB8fCAgICAgICB8fCAgICAgCiAnJ3wuLi4nfCAgJ3wuLid8JyAufHwgfHwgfHwuICAnfC4uLicgLnx8LiAgLnx8LiAnfC4uJ3wnIC58fC4gfHwuICAnfC4uJ3x8LiAufHwuICAnfC4uLicgLnx8LiAgICAKCiAgICBHYW1lSGFuZGxlciAtIEhvb2tzIGZvciBldmVyeXRoaW5nIGFuZCBzb21lIG5pY2UgZXh0cmEgc3R1ZmYgYXN3ZWxsCgpdXQpjbGFzcyAnX0dhbWVIYW5kbGVyJwoKZnVuY3Rpb24gX0dhbWVIYW5kbGVyOl9faW5pdCgpCmVuZAoKbG9jYWwgZ3JpZFNpemUgPSA1MApmdW5jdGlvbiBfR2FtZUhhbmRsZXI6R2V0R3JpZENvb3JkaW5hdGVzKHVuaXQpCgogICAgYXNzZXJ0KHVuaXQgYW5kIHVuaXQueCBhbmQgdW5pdC55IGFuZCB1bml0LnosICJHYW1lSGFuZGxlcjpHZXRHcmlkQ29vcmRpbmF0ZXMoKTogdW5pdCBpcyBpbnZhbGlkISIpCiAgICByZXR1cm4gVmVjdG9yKG1hdGguY2VpbCh1bml0LnggLyBncmlkU2l6ZSksIG1hdGguY2VpbCh1bml0LnkgLyBncmlkU2l6ZSksIG1hdGguY2VpbCh1bml0LnogLyBncmlkU2l6ZSkpCgplbmQKCmZ1bmN0aW9uIF9HYW1lSGFuZGxlcjpHZXRHYW1lQ29vcmRpbmF0ZXMoZ3JpZCkKCiAgICBhc3NlcnQoZ3JpZCBhbmQgZ3JpZC54IGFuZCBncmlkLnkgYW5kIGdyaWQueiwgIkdhbWVIYW5kbGVyOkdldEdhbWVDb29yZGluYXRlcygpOiBncmlkIGlzIGludmFsaWQiKQogICAgcmV0dXJuIFZlY3RvcihncmlkLnggKiBncmlkU2l6ZSwgZ3JpZC55ICogZ3JpZFNpemUsIGdyaWQueiAqIGdyaWRTaXplKQoKZW5kCgpmdW5jdGlvbiBfR2FtZUhhbmRsZXI6R2V0R3JpZEdhbWVDb29yZGluYXRlcyh1bml0KQoKICAgIGFzc2VydCh1bml0IGFuZCB1bml0LnggYW5kIHVuaXQueSBhbmQgdW5pdC56LCAiR2FtZUhhbmRsZXI6R2V0R3JpZEdhbWVDb29yZGluYXRlcygpOiB1bml0IGlzIGludmFsaWQhIikKICAgIHJldHVybiBzZWxmOkdldEdhbWVDb29yZGluYXRlcyhzZWxmOkdldEdyaWRDb29yZGluYXRlcyh1bml0KSkKCmVuZAoKLS0gQ3JlYXRlIGEgZ2xvYmFsIGluc3RhbmNlIG9mIEdhbWVIYW5kbGVyCkdhbWVIYW5kbGVyID0gX0dhbWVIYW5kbGVyKCkKCgotLVtbCgonfHwnICAnfCcgICAuICAgIHx8ICAnfHwgIAogfHwgICAgfCAgLnx8LiAgLi4uICAgfHwgIAogfHwgICAgfCAgIHx8ICAgIHx8ICAgfHwgIAogfHwgICAgfCAgIHx8ICAgIHx8ICAgfHwgIAogICd8Li4nICAgICd8LicgLnx8LiAufHwuIAoKICAgIFV0aWwgLSBKdXN0IHV0aWxzLgpdXQoKZnVuY3Rpb24gUHJvdGVjdFRhYmxlKHQpCgogICAgbG9jYWwgcHJveHkgPSB7fQogICAgbG9jYWwgbXQgPSB7CiAgICBfX2luZGV4ID0gdCwKICAgIF9fbmV3aW5kZXggPSBmdW5jdGlvbiAodCxrLHYpCiAgICAgICAgZXJyb3IoJ2F0dGVtcHQgdG8gdXBkYXRlIGEgcmVhZC1vbmx5IHRhYmxlJywgMikKICAgICAgICBlbmQKICAgIH0KICAgIHNldG1ldGF0YWJsZShwcm94eSwgbXQpCiAgICByZXR1cm4gcHJveHkKCmVuZAoKZnVuY3Rpb24gX0dldERpc3RhbmNlU3FyKHAxLCBwMikKCiAgICBwMiA9IHAyIG9yIHBsYXllcgogICAgaWYgcDEgYW5kIHAxLm5ldHdvcmtJRCBhbmQgKHAxLm5ldHdvcmtJRCB+PSAwKSBhbmQgcDEudmlzaW9uUG9zIHRoZW4gcDEgPSBwMS52aXNpb25Qb3MgZW5kCiAgICBpZiBwMiBhbmQgcDIubmV0d29ya0lEIGFuZCAocDIubmV0d29ya0lEIH49IDApIGFuZCBwMi52aXNpb25Qb3MgdGhlbiBwMiA9IHAyLnZpc2lvblBvcyBlbmQKICAgIHJldHVybiBHZXREaXN0YW5jZVNxcihwMSwgcDIpCiAgICAKZW5kCgpmdW5jdGlvbiBHZXRPYmplY3RzQXJvdW5kKHJhZGl1cywgcG9zaXRpb24sIGNvbmRpdGlvbikKCiAgICByYWRpdXMgPSBtYXRoLnBvdyhyYWRpdXMsIDIpCiAgICBwb3NpdGlvbiA9IHBvc2l0aW9uIG9yIHBsYXllcgogICAgbG9jYWwgb2JqZWN0c0Fyb3VuZCA9IHt9CiAgICBmb3IgaSA9IDEsIG9iak1hbmFnZXIubWF4T2JqZWN0cyBkbwogICAgICAgIGxvY2FsIG9iamVjdCA9IG9iak1hbmFnZXI6Z2V0T2JqZWN0KGkpCiAgICAgICAgaWYgb2JqZWN0IGFuZCBvYmplY3QudmFsaWQgYW5kIChjb25kaXRpb24gYW5kIGNvbmRpdGlvbihvYmplY3QpID09IHRydWUgb3Igbm90IGNvbmRpdGlvbikgYW5kIF9HZXREaXN0YW5jZVNxcihwb3NpdGlvbiwgb2JqZWN0KSA8PSByYWRpdXMgdGhlbgogICAgICAgICAgICB0YWJsZS5pbnNlcnQob2JqZWN0c0Fyb3VuZCwgb2JqZWN0KQogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gb2JqZWN0c0Fyb3VuZAoKZW5kCgpmdW5jdGlvbiBIYXNCdWZmKHVuaXQsIGJ1ZmZuYW1lKQoKICAgIGZvciBpID0gMSwgdW5pdC5idWZmQ291bnQgZG8KICAgICAgICBsb2NhbCB0QnVmZiA9IHVuaXQ6Z2V0QnVmZihpKQogICAgICAgIGlmIHRCdWZmLnZhbGlkIGFuZCBCdWZmSXNWYWxpZCh0QnVmZikgYW5kIHRCdWZmLm5hbWUgPT0gYnVmZm5hbWUgdGhlbgogICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gZmFsc2UKCmVuZAoKZnVuY3Rpb24gR2V0U3VtbW9uZXJTbG90KG5hbWUsIHVuaXQpCgogICAgdW5pdCA9IHVuaXQgb3IgcGxheWVyCiAgICBpZiB1bml0OkdldFNwZWxsRGF0YShTVU1NT05FUl8xKS5uYW1lID09IG5hbWUgdGhlbiByZXR1cm4gU1VNTU9ORVJfMSBlbmQKICAgIGlmIHVuaXQ6R2V0U3BlbGxEYXRhKFNVTU1PTkVSXzIpLm5hbWUgPT0gbmFtZSB0aGVuIHJldHVybiBTVU1NT05FUl8yIGVuZAoKZW5kCgpmdW5jdGlvbiBHZXRFbmVteUhQQmFyUG9zKGVuZW15KQoKICAgIC0tIFByZXZlbnQgZXJyb3Igc3BhbW1pbmcKICAgIGlmIG5vdCBlbmVteS5iYXJEYXRhIHRoZW4KICAgICAgICBpZiBub3QgX0cuX19zb3VyY2VMaWJfYmFyRGF0YUluZm9ybWVkIHRoZW4KICAgICAgICAgICAgcHJpbnQoIlNvdXJjZUxpYjogYmFyRGF0YSB3YXMgbm90IGZvdW5kLCBzcHVkZ3kgcGxlYXNlLi4uIikKICAgICAgICAgICAgX0cuX19zb3VyY2VMaWJfYmFyRGF0YUluZm9ybWVkID0gdHJ1ZQogICAgICAgIGVuZAogICAgICAgIHJldHVybgogICAgZW5kCgogICAgbG9jYWwgYmFyUG9zID0gR2V0VW5pdEhQQmFyUG9zKGVuZW15KQogICAgbG9jYWwgYmFyUG9zT2Zmc2V0ID0gR2V0VW5pdEhQQmFyT2Zmc2V0KGVuZW15KQogICAgbG9jYWwgYmFyT2Zmc2V0ID0gUG9pbnQoZW5lbXkuYmFyRGF0YS5QZXJjZW50YWdlT2Zmc2V0LngsIGVuZW15LmJhckRhdGEuUGVyY2VudGFnZU9mZnNldC55KQogICAgbG9jYWwgYmFyUG9zUGVyY2VudGFnZU9mZnNldCA9IFBvaW50KGVuZW15LmJhckRhdGEuUGVyY2VudGFnZU9mZnNldC54LCBlbmVteS5iYXJEYXRhLlBlcmNlbnRhZ2VPZmZzZXQueSkKCiAgICBsb2NhbCBCYXJQb3NPZmZzZXRYID0gMTY5CiAgICBsb2NhbCBCYXJQb3NPZmZzZXRZID0gNDcKICAgIGxvY2FsIENvcnJlY3Rpb25YID0gMTYKICAgIGxvY2FsIENvcnJlY3Rpb25ZID0gNAoKICAgIGJhclBvcy54ID0gYmFyUG9zLnggKyAoYmFyUG9zT2Zmc2V0LnggLSAwLjUgKyBiYXJQb3NQZXJjZW50YWdlT2Zmc2V0LngpICogQmFyUG9zT2Zmc2V0WCArIENvcnJlY3Rpb25YCiAgICBiYXJQb3MueSA9IGJhclBvcy55ICsgKGJhclBvc09mZnNldC55IC0gMC41ICsgYmFyUG9zUGVyY2VudGFnZU9mZnNldC55KSAqIEJhclBvc09mZnNldFkgKyBDb3JyZWN0aW9uWSAKCiAgICBsb2NhbCBTdGFydFBvcyA9IFBvaW50KGJhclBvcy54LCBiYXJQb3MueSkKICAgIGxvY2FsIEVuZFBvcyA9IFBvaW50KGJhclBvcy54ICsgMTAzLCBiYXJQb3MueSkKCiAgICByZXR1cm4gUG9pbnQoU3RhcnRQb3MueCwgU3RhcnRQb3MueSksIFBvaW50KEVuZFBvcy54LCBFbmRQb3MueSkKCmVuZAoKZnVuY3Rpb24gQ291bnRPYmplY3RzTmVhclBvcyhwb3MsIHJhbmdlLCByYWRpdXMsIG9iamVjdHMpCgogICAgbG9jYWwgbiA9IDAKICAgIGZvciBpLCBvYmplY3QgaW4gaXBhaXJzKG9iamVjdHMpIGRvCiAgICAgICAgaWYgX0dldERpc3RhbmNlU3FyKHBvcywgb2JqZWN0KSA8PSByYWRpdXMgKiByYWRpdXMgdGhlbgogICAgICAgICAgICBuID0gbiArIDEKICAgICAgICBlbmQKICAgIGVuZAoKICAgIHJldHVybiBuCgplbmQKCmZ1bmN0aW9uIEdldEJlc3RDaXJjdWxhckZhcm1Qb3NpdGlvbihyYW5nZSwgcmFkaXVzLCBvYmplY3RzKQoKICAgIGxvY2FsIEJlc3RQb3MgCiAgICBsb2NhbCBCZXN0SGl0ID0gMAogICAgZm9yIGksIG9iamVjdCBpbiBpcGFpcnMob2JqZWN0cykgZG8KICAgICAgICBsb2NhbCBoaXQgPSBDb3VudE9iamVjdHNOZWFyUG9zKG9iamVjdC52aXNpb25Qb3Mgb3Igb2JqZWN0LCByYW5nZSwgcmFkaXVzLCBvYmplY3RzKQogICAgICAgIGlmIGhpdCA+IEJlc3RIaXQgdGhlbgogICAgICAgICAgICBCZXN0SGl0ID0gaGl0CiAgICAgICAgICAgIEJlc3RQb3MgPSBWZWN0b3Iob2JqZWN0KQogICAgICAgICAgICBpZiBCZXN0SGl0ID09ICNvYmplY3RzIHRoZW4KICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZW5kCiAgICAgICAgIGVuZAogICAgZW5kCgogICAgcmV0dXJuIEJlc3RQb3MsIEJlc3RIaXQKCmVuZAoKZnVuY3Rpb24gQ291bnRPYmplY3RzT25MaW5lU2VnbWVudChTdGFydFBvcywgRW5kUG9zLCB3aWR0aCwgb2JqZWN0cykKCiAgICBsb2NhbCBuID0gMAogICAgZm9yIGksIG9iamVjdCBpbiBpcGFpcnMob2JqZWN0cykgZG8KICAgICAgICBsb2NhbCBwb2ludFNlZ21lbnQsIHBvaW50TGluZSwgaXNPblNlZ21lbnQgPSBWZWN0b3JQb2ludFByb2plY3Rpb25PbkxpbmVTZWdtZW50KFN0YXJ0UG9zLCBFbmRQb3MsIG9iamVjdCkKICAgICAgICBpZiBpc09uU2VnbWVudCBhbmQgR2V0RGlzdGFuY2VTcXIocG9pbnRTZWdtZW50LCBvYmplY3QpIDwgd2lkdGggKiB3aWR0aCB0aGVuCiAgICAgICAgICAgIG4gPSBuICsgMQogICAgICAgIGVuZAogICAgZW5kCgogICAgcmV0dXJuIG4KCmVuZAoKZnVuY3Rpb24gR2V0QmVzdExpbmVGYXJtUG9zaXRpb24ocmFuZ2UsIHdpZHRoLCBvYmplY3RzKQoKICAgIGxvY2FsIEJlc3RQb3MgCiAgICBsb2NhbCBCZXN0SGl0ID0gMAogICAgZm9yIGksIG9iamVjdCBpbiBpcGFpcnMob2JqZWN0cykgZG8KICAgICAgICBsb2NhbCBFbmRQb3MgPSBWZWN0b3IobXlIZXJvLnZpc2lvblBvcykgKyByYW5nZSAqIChWZWN0b3Iob2JqZWN0KSAtIFZlY3RvcihteUhlcm8udmlzaW9uUG9zKSk6bm9ybWFsaXplZCgpCiAgICAgICAgbG9jYWwgaGl0ID0gQ291bnRPYmplY3RzT25MaW5lU2VnbWVudChteUhlcm8udmlzaW9uUG9zLCBFbmRQb3MsIHdpZHRoLCBvYmplY3RzKQogICAgICAgIGlmIGhpdCA+IEJlc3RIaXQgdGhlbgogICAgICAgICAgICBCZXN0SGl0ID0gaGl0CiAgICAgICAgICAgIEJlc3RQb3MgPSBWZWN0b3Iob2JqZWN0KQogICAgICAgICAgICBpZiBCZXN0SGl0ID09ICNvYmplY3RzIHRoZW4KICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZW5kCiAgICAgICAgIGVuZAogICAgZW5kCgogICAgcmV0dXJuIEJlc3RQb3MsIEJlc3RIaXQKCmVuZAoKZnVuY3Rpb24gR2V0UHJlZGljdGVkUG9zaXRpb25zVGFibGUoVlAsIHQsIGRlbGF5LCB3aWR0aCwgcmFuZ2UsIHNwZWVkLCBzb3VyY2UsIGNvbGxpc2lvbikKCiAgICBsb2NhbCByZXN1bHQgPSB7fQogICAgZm9yIGksIHRhcmdldCBpbiBpcGFpcnModCkgZG8KICAgICAgICBsb2NhbCBDYXN0UG9zaXRpb24sIEhpdGNoYW5jZSwgUG9zaXRpb24gPSBWUDpHZXRDaXJjdWxhckNhc3RQb3NpdGlvbih0YXJnZXQsIGRlbGF5LCB3aWR0aCwgcmFuZ2UsIHNwZWVkLCBzb3VyY2UsIGNvbGxpc2lvbikgCiAgICAgICAgdGFibGUuaW5zZXJ0KHJlc3VsdCwgUG9zaXRpb24pCiAgICBlbmQKICAgIHJldHVybiByZXN1bHQKCmVuZAoKZnVuY3Rpb24gTWVyZ2VUYWJsZXModDEsIHQyKQoKICAgIGZvciBpID0gMSwgI3QyIGRvCiAgICAgICAgdDFbI3QxICsgMV0gPSB0MltpXQogICAgZW5kCiAgICByZXR1cm4gdDEKCmVuZAoKZnVuY3Rpb24gU2VsZWN0VW5pdHModW5pdHMsIGNvbmRpdGlvbikKICAgIAogICAgbG9jYWwgcmVzdWx0ID0ge30KICAgIGZvciBpLCB1bml0IGluIGlwYWlycyh1bml0cykgZG8KICAgICAgICBpZiBjb25kaXRpb24odW5pdCkgdGhlbgogICAgICAgICAgICB0YWJsZS5pbnNlcnQocmVzdWx0LCB1bml0KQogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gcmVzdWx0CgplbmQKCmZ1bmN0aW9uIFNwZWxsVG9TdHJpbmcoaWQpCgogICAgaWYgaWQgPT0gX1EgdGhlbiByZXR1cm4gIlEiIGVuZAogICAgaWYgaWQgPT0gX1cgdGhlbiByZXR1cm4gIlciIGVuZAogICAgaWYgaWQgPT0gX0UgdGhlbiByZXR1cm4gIkUiIGVuZAogICAgaWYgaWQgPT0gX1IgdGhlbiByZXR1cm4gIlIiIGVuZAoKZW5kCgpmdW5jdGlvbiBUQVJHQihjb2xvclRhYmxlKQoKICAgIGFzc2VydChjb2xvclRhYmxlIGFuZCB0eXBlKGNvbG9yVGFibGUpID09ICJ0YWJsZSIgYW5kICNjb2xvclRhYmxlID09IDQsICJUQVJHQjogY29sb3JUYWJsZSBpcyBpbnZhbGlkISIpCiAgICByZXR1cm4gQVJHQihjb2xvclRhYmxlWzFdLCBjb2xvclRhYmxlWzJdLCBjb2xvclRhYmxlWzNdLCBjb2xvclRhYmxlWzRdKQoKZW5kCgpmdW5jdGlvbiBQaW5nQ2xpZW50KHgsIHksIHBpbmdUeXBlKQogICAgUGFja2V0KCJSX1BJTkciLCB7eCA9IHksIHkgPSB5LCB0eXBlID0gcGluZ1R5cGUgYW5kIHBpbmdUeXBlIG9yIFBJTkdfRkFMTEJBQ0t9KTpyZWNlaXZlKCkKZW5kCgpsb2NhbCBfX3V0aWxfYXV0b0F0dGFjayAgID0geyAiZnJvc3RhcnJvdyIgfQpsb2NhbCBfX3V0aWxfbm9BdXRvQXR0YWNrID0geyAic2h5dmFuYWRvdWJsZWF0dGFja2RyYWdvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaHl2YW5hZG91YmxlYXR0YWNrIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1vbmtleWtpbmdkb3VibGVhdHRhY2siIH0KZnVuY3Rpb24gSXNBQVNwZWxsKHNwZWxsKQoKICAgIGlmIG5vdCBzcGVsbCBvciBub3Qgc3BlbGwubmFtZSB0aGVuIHJldHVybiBlbmQKCiAgICBmb3IgXywgc3BlbGxOYW1lIGluIGlwYWlycyhfX3V0aWxfYXV0b0F0dGFjaykgZG8KICAgICAgICBpZiBzcGVsbE5hbWUgPT0gc3BlbGwubmFtZTpsb3dlcigpIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGZvciBfLCBzcGVsbE5hbWUgaW4gaXBhaXJzKF9fdXRpbF9ub0F1dG9BdHRhY2spIGRvCiAgICAgICAgaWYgc3BlbGxOYW1lID09IHNwZWxsLm5hbWU6bG93ZXIoKSB0aGVuCiAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIGVuZAogICAgZW5kCgogICAgaWYgc3BlbGwubmFtZTpsb3dlcigpOmZpbmQoImF0dGFjayIpIHRoZW4KICAgICAgICByZXR1cm4gdHJ1ZQogICAgZW5kCgogICAgcmV0dXJuIGZhbHNlCgplbmQKCi0tIFNvdXJjZTogaHR0cDovL2x1YS11c2Vycy5vcmcvd2lraS9Db3B5VGFibGUKZnVuY3Rpb24gVGFibGVEZWVwQ29weShvcmlnKQoKICAgIGxvY2FsIG9yaWdfdHlwZSA9IHR5cGUob3JpZykKICAgIGxvY2FsIGNvcHkKICAgIGlmIG9yaWdfdHlwZSA9PSAndGFibGUnIHRoZW4KICAgICAgICBjb3B5ID0ge30KICAgICAgICBmb3Igb3JpZ19rZXksIG9yaWdfdmFsdWUgaW4gbmV4dCwgb3JpZywgbmlsIGRvCiAgICAgICAgICAgIGNvcHlbZGVlcGNvcHkob3JpZ19rZXkpXSA9IGRlZXBjb3B5KG9yaWdfdmFsdWUpCiAgICAgICAgZW5kCiAgICAgICAgc2V0bWV0YXRhYmxlKGNvcHksIGRlZXBjb3B5KGdldG1ldGF0YWJsZShvcmlnKSkpCiAgICBlbHNlIC0tIG51bWJlciwgc3RyaW5nLCBib29sZWFuLCBldGMKICAgICAgICBjb3B5ID0gb3JpZwogICAgZW5kCiAgICByZXR1cm4gY29weQoKZW5kCgoKLS1bWwoKJ3x8JyAgICAgICAgICAgfHwgICAgLiAgICB8fCAgICAgICAgICAnfHwgICB8fCAgICAgICAgICAgICAgICAgICAgLiAgICB8fCAgICAgICAgICAgICAgICAgICAKIHx8ICAuLiAuLi4gICAuLi4gIC58fC4gIC4uLiAgIC4uLi4gICAgfHwgIC4uLiAgLi4uLi4uICAgLi4uLiAgIC58fC4gIC4uLiAgICAuLi4gICAuLiAuLi4gICAKIHx8ICAgfHwgIHx8ICAgfHwgICB8fCAgICB8fCAgJycgLnx8ICAgfHwgICB8fCAgJyAgLnwnICAnJyAufHwgICB8fCAgICB8fCAgLnwgICd8LiAgfHwgIHx8ICAKIHx8ICAgfHwgIHx8ICAgfHwgICB8fCAgICB8fCAgLnwnIHx8ICAgfHwgICB8fCAgIC58JyAgICAufCcgfHwgICB8fCAgICB8fCAgfHwgICB8fCAgfHwgIHx8ICAKLnx8LiAufHwuIHx8LiAufHwuICAnfC4nIC58fC4gJ3wuLid8JyAufHwuIC58fC4gfHwuLi4ufCAnfC4uJ3wnICAnfC4nIC58fC4gICd8Li58JyAufHwuIHx8LiAKCl1dCgotLSBXZSBhcmUgY3VycmVudGx5IG1vdmluZyB0byBHaXRIdWIsIGdpbW1lIGEgc2VjIHRvIGNyZWF0ZSBhIHJlcG8gb3ZlciB0aGVyZSA7KQoKLS0gVXBkYXRlIHNjcmlwdAppZiBhdXRvVXBkYXRlIHRoZW4KICAgIFNvdXJjZVVwZGF0ZXIoIlNvdXJjZUxpYiIsIHZlcnNpb24sICJyYXcuZ2l0aHViLmNvbSIsICIvVGhlUmVhbFNvdXJjZS9wdWJsaWMvbWFzdGVyL2NvbW1vbi9Tb3VyY2VMaWIubHVhIiwgTElCX1BBVEggLi4gIlNvdXJjZUxpYi5sdWEiLCAiL1RoZVJlYWxTb3VyY2UvcHVibGljL21hc3Rlci9jb21tb24vU291cmNlTGliLnZlcnNpb24iKTpTZXRTaWxlbnQoc2lsZW50VXBkYXRlKTpDaGVja1VwZGF0ZSgpCmVuZAoKLS0gU2V0IGVuZW15IGJhciBkYXRhCmZvciBpLCBlbmVteSBpbiBpcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8KICAgIGVuZW15LmJhckRhdGEgPSB7UGVyY2VudGFnZU9mZnNldCA9IHt4ID0gMCwgeSA9IDB9IH0tLUdldEVuZW15QmFyRGF0YSgpLS1zcGFkZ2UgcGxzCmVuZAoKLS1TdW1tb25lciBzcGVsbHMKX0lHTklURSAgPSBHZXRTdW1tb25lclNsb3QoIlN1bW1vbmVyRG90IikKX0ZMQVNIICAgPSBHZXRTdW1tb25lclNsb3QoIlN1bW1vbmVyRmxhc2giKQpfRVhIQVVTVCA9IEdldFN1bW1vbmVyU2xvdCgiU3VtbW9uZXJFeGhhdXN0IikKCi0tT3RoZXJzCl9BQSA9IDEwMDAwCl9QQVNJVkUgPSAxMDAwMQo="

function _ReplaceAutoUpdate(LibName)
	AutoUpdateOverWriteFile = io.open(LIB_PATH.."/"..LibName..".lua", "r")
	AutoUpdateOverWriteString = AutoUpdateOverWriteFile:read("*a")
	AutoUpdateOverWriteFile:close()
	AutoUpdateOverWriteString = string.gsub(AutoUpdateOverWriteString, "local AUTOUPDATE = true", "local AUTOUPDATE = false")
	AutoUpdateOverWriteString = string.gsub(AutoUpdateOverWriteString, "local autoUpdate   = true", "local autoUpdate   = false")
	AutoUpdateOverWriteFile = io.open(LIB_PATH.."/"..LibName..".lua", "w+")
	AutoUpdateOverWriteFile:write(AutoUpdateOverWriteString)
	AutoUpdateOverWriteFile:close()
end


	if FileExist(LIB_PATH.."/SOW.lua") and _GetLocalVersion("SOW", 17, 21) < 1.129 then os.remove(LIB_PATH.."/SOW.lua")	end
	if FileExist(LIB_PATH.."/VPREDICTION.lua") and _GetLocalVersion("VPREDICTION", 17, 20) < 2.51 then os.remove(LIB_PATH.."/VPREDICTION.lua")	end
	if FileExist(LIB_PATH.."/SOURCELIB.lua") and _GetLocalVersion("SOURCELIB", 16, 20) < 1.058 then os.remove(LIB_PATH.."/SOURCELIB.lua")	end

	if not FileExist(LIB_PATH.."/SOW.lua") then
		AutoUpdateOverWriteString = Base64Decrypt(StoredSOW)
		AutoUpdateOverWriteFile = io.open(LIB_PATH.."/SOW.lua", "w+")
		AutoUpdateOverWriteFile:write(AutoUpdateOverWriteString)
		AutoUpdateOverWriteFile:close()
	else
		_ReplaceAutoUpdate("SOW")
	end

	if not FileExist(LIB_PATH.."/VPrediction.lua") then
		AutoUpdateOverWriteString = Base64Decrypt(StoredVPred)
		AutoUpdateOverWriteFile = io.open(LIB_PATH.."/VPrediction.lua", "w+")
		AutoUpdateOverWriteFile:write(AutoUpdateOverWriteString)
		AutoUpdateOverWriteFile:close()
	else
		_ReplaceAutoUpdate("VPrediction")
	end

	if not FileExist(LIB_PATH.."/SourceLib.lua") then
		AutoUpdateOverWriteString = Base64Decrypt(StoredSourceLib)
		AutoUpdateOverWriteFile = io.open(LIB_PATH.."/SourceLib.lua", "w+")
		AutoUpdateOverWriteFile:write(AutoUpdateOverWriteString)
		AutoUpdateOverWriteFile:close()
	else
		_ReplaceAutoUpdate("SourceLib")
	end
