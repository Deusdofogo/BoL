--[[

	Shadow Vayne Script by Superx321
	Version: 2.88

	For Functions & Changelog, check the Thread on the BoL Forums:
	http://botoflegends.com/forum/topic/18939-shadow-vayne-the-mighty-hunter/

	If anything is not working or u wish a new Function, let me know it

	Thx to Jus & Hellsing for minor helping, Manciuszz for his Gapcloserlist and Klokje for his Interruptlist
	]]
--~ 	VIP_USER = false
if myHero.charName ~= "Vayne" then return end
if not VIP_USER then
	rawset(_G, "LoadVIPScript", function() return end)
end

local informationTable, AAInfoTable, CastedLastE, ScriptStartTick = {}, {}, 0, 0
local TickCountScriptStart, OnLoadDone, spellExpired, Beta = GetTickCount(), nil, true, false
local ScriptOnLoadDone, LastAttackedEnemy = false, nil
local LastPrioUpdate = 0
local DownloadStarted = false
local HookSOWMenu = {}
if FileExist(SCRIPT_PATH.."/Common/Selector.lua") then UseVIPSelector = true end
local UseVIPSelector = false
if GetSave("scriptConfig").SV_MAIN_autoup.autoupcheck == nil then GetSave("scriptConfig").SV_MAIN_autoup.autoupcheck = true end
local SV_AutoUpdate = GetSave("scriptConfig").SV_MAIN_autoup.autoupcheck

function OnLoad()
--~ 	os.remove(LIB_PATH.."ShadowVayne.Version")
--~ 	os.remove(LIB_PATH.."SourceLib.Version")

--~ 			NewSourceLibFile = io.open(LIB_PATH.."/SOW.lua", "r")
--~ 			CryptedString = NewSourceLibFile:read("*a")
--~ 			NewSourceLibFile = io.open(LIB_PATH.."/SOWCrypted.lua", "w+")
--~ 			NewSourceLibFile:write(enc(CryptedString))
--~ 			NewSourceLibFile:close()


end

function enc(data)
	local b='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
    return ((data:gsub('.', function(x)
        local r,b='',x:byte()
        for i=8,1,-1 do r=r..(b%2^i-b%2^(i-1)>0 and '1' or '0') end
        return r;
    end)..'0000'):gsub('%d%d%d?%d?%d?%d?', function(x)
        if (#x < 6) then return '' end
        local c=0
        for i=1,6 do c=c+(x:sub(i,i)=='1' and 2^(6-i) or 0) end
        return b:sub(c+1,c+1)
    end)..({ '', '==', '=' })[#data%3+1])
end

function OnTick()
	if not ScriptStartOver then
		if not UpdateDone_SourceLib then
			_CheckUpdate_SourceLib()
		else
			if not UpdateDone_VPrediction then
				_CheckUpdate_VPrediction()
			else
				if not UpdateDone_SOW then
					_CheckUpdate_SOW()
				else
					ScriptStartOver = true
					VP = VPrediction(true)
					_LoadTables()
					_CheckSACMMASOW()
					_LoadMenu()
					AddTickCallback(_GetRunningModes)
					AddTickCallback(_CheckEnemyStunnAble)
					AddTickCallback(_NonTargetGapCloserAfterCast)
					AddTickCallback(_UseBotRK)
					AddTickCallback(_ClickThreshLantern)
					AddTickCallback(_UsePermaShows)
					AddTickCallback(_CheckUpdate_ShadowVayne)
					if UseVIPSelector then require "Selector" end
					if UseVIPSelector then AddTickCallback(_UseSelector) end
					autoLevelSetFunction(_AutoLevelSpell)
					autoLevelSetSequence({0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0})
					ScriptOnLoadDone = true
					HidePermaShow = {["LaneClear OnHold:"] = true,["Orbwalk OnHold:"] = true, ["LastHit OnHold:"] = true, ["HybridMode OnHold:"] = true,}
					HidePermaShow["Condemn on next BasicAttack:"] = true
					HidePermaShow["Auto Carry"] = true
					HidePermaShow["Last Hit"] = true
					HidePermaShow["Mixed Mode"] = true
					HidePermaShow["Lane Clear"] = true
					HidePermaShow["              Sida's Auto Carry: Reborn"] = true
					HidePermaShow["Auto-Condemn"] = true
					HidePermaShow["ShadowVayne found. Set the Keysettings there!"] = true
				end
			end
		end
	end
end

function _CheckSACMMASOW()
	if AutoCarry ~= nil then
		if AutoCarry.Helper ~= nil then
			Skills, Keys, Items, Data, Jungle, Helper, MyHero, Minions, Crosshair, Orbwalker = AutoCarry.Helper:GetClasses()
			SACLoaded = true
		else
			REVLoaded = true
			REVMenu = _G.AutoCarry.AutoCarry.MainMenu
		end
	end

	if _G.MMA_Loaded then
		MMALoaded = false
	end

	if FileExist(SCRIPT_PATH.."/Common/SOW.lua") then
		SOWLoaded = true
	end
end

function OnDraw()
	if ScriptOnLoadDone then
		if VayneMenu.draw.DrawNeededAutohits then
			for i, enemy in ipairs(GetEnemyHeroes()) do
				DrawText(tostring(_GetNeededAutoHits(enemy)),16,GetUnitHPBarPos(enemy).x,GetUnitHPBarPos(enemy).y,0xFF80FF00)
			end
		end

		if VayneMenu.draw.DrawERange then
			if VayneMenu.draw.DrawEColor == 1 then
				DrawCircle(myHero.x, myHero.y, myHero.z, 710, 0x80FFFF)
			elseif VayneMenu.draw.DrawEColor == 2 then
				DrawCircle(myHero.x, myHero.y, myHero.z, 710, 0x0080FF)
			elseif VayneMenu.draw.DrawEColor == 3 then
				DrawCircle(myHero.x, myHero.y, myHero.z, 710, 0x5555FF)
			elseif VayneMenu.draw.DrawEColor == 4 then
				DrawCircle(myHero.x, myHero.y, myHero.z, 710, 0xFF2D2D)
			elseif VayneMenu.draw.DrawEColor == 5 then
				DrawCircle(myHero.x, myHero.y, myHero.z, 710, 0x8B42B3)
			end
		end

		if VayneMenu.draw.DrawAARange then
			if VayneMenu.draw.DrawAAColor == 1 then
				DrawCircle(myHero.x, myHero.y, myHero.z, 655, 0x80FFFF)
			elseif VayneMenu.draw.DrawAAColor == 2 then
				DrawCircle(myHero.x, myHero.y, myHero.z, 655, 0x0080FF)
			elseif VayneMenu.draw.DrawAAColor == 3 then
				DrawCircle(myHero.x, myHero.y, myHero.z, 655, 0x5555FF)
			elseif VayneMenu.draw.DrawAAColor == 4 then
				DrawCircle(myHero.x, myHero.y, myHero.z, 655, 0xFF2D2D)
			elseif VayneMenu.draw.DrawAAColor == 5 then
				DrawCircle(myHero.x, myHero.y, myHero.z, 655, 0x8B42B3)
			end
		end
	end
end

function OnProcessSpell(unit, spell)
	if not myHero.dead and ScriptOnLoadDone then
		-- AntiGapCloser Targeted Spells
		if isAGapcloserUnitTarget[unit.charName] and spell.name == isAGapcloserUnitTarget[unit.charName].spell and unit.team ~= myHero.team then
			if spell.target ~= nil and spell.target.hash == myHero.hash then
				if VayneMenu.anticapcloser[(unit.charName)..(isAGapcloserUnitTarget[unit.charName].spellKey)][(unit.charName).."AutoCarry"] and ShadowVayneAutoCarry then _CastESpell(unit, "Gapcloser Targeted ("..(spell.name)..") / AutoCarry Mode") end
				if VayneMenu.anticapcloser[(unit.charName)..(isAGapcloserUnitTarget[unit.charName].spellKey)][(unit.charName).."LastHit"] and ShadowVayneMixedMode then _CastESpell(unit, "Gapcloser Targeted ("..(spell.name)..") / Lasthit Mode") end
				if VayneMenu.anticapcloser[(unit.charName)..(isAGapcloserUnitTarget[unit.charName].spellKey)][(unit.charName).."MixedMode"] and ShadowVayneLaneClear then _CastESpell(unit, "Gapcloser Targeted ("..(spell.name)..") / Mixed Mode") end
				if VayneMenu.anticapcloser[(unit.charName)..(isAGapcloserUnitTarget[unit.charName].spellKey)][(unit.charName).."LaneClear"] and ShadowVayneLastHit then _CastESpell(unit, "Gapcloser Targeted ("..(spell.name)..") / Laneclear Mode") end
				if VayneMenu.anticapcloser[(unit.charName)..(isAGapcloserUnitTarget[unit.charName].spellKey)][(unit.charName).."Always"] then _CastESpell(unit, "Gapcloser Targeted ("..(spell.name)..") / Always") end
				if VayneMenu.autostunn.OverwriteAutoCarry and ShadowVayneAutoCarry then  _CastESpell(unit, "Gapcloser Targeted ("..(spell.name)..") / AutoCarry Mode") end
				if VayneMenu.autostunn.OverwriteMixedMode and ShadowVayneMixedMode then  _CastESpell(unit, "Gapcloser Targeted ("..(spell.name)..") / AutoCarry Mode") end
				if VayneMenu.autostunn.OverwriteLaneClear and ShadowVayneLaneClear then  _CastESpell(unit, "Gapcloser Targeted ("..(spell.name)..") / AutoCarry Mode") end
				if VayneMenu.autostunn.OverwriteLastHit and ShadowVayneLastHit then  _CastESpell(unit, "Gapcloser Targeted ("..(spell.name)..") / AutoCarry Mode") end
				if VayneMenu.autostunn.Overwritealways then  _CastESpell(unit, "Gapcloser Targeted ("..(spell.name)..") / AutoCarry Mode") end
			end
		end

		-- AntiGapCloser Interrupt Spells
		if isAChampToInterrupt[spell.name] and unit.charName == isAChampToInterrupt[spell.name].champ and GetDistance(unit) <= 715 and unit.team ~= myHero.team then
			if VayneMenu.interrupt[(unit.charName)..(isAChampToInterrupt[spell.name].spellKey)][(unit.charName).."AutoCarry"] and ShadowVayneAutoCarry then _CastESpell(unit, "Interrupt ("..(spell.name)..") / AutoCarry Mode") end
			if VayneMenu.interrupt[(unit.charName)..(isAChampToInterrupt[spell.name].spellKey)][(unit.charName).."LastHit"] and ShadowVayneMixedMode then _CastESpell(unit, "Interrupt ("..(spell.name)..") / Lasthit Mode") end
			if VayneMenu.interrupt[(unit.charName)..(isAChampToInterrupt[spell.name].spellKey)][(unit.charName).."MixedMode"] and ShadowVayneLaneClear then _CastESpell(unit, "Interrupt ("..(spell.name)..") / Mixed Mode") end
			if VayneMenu.interrupt[(unit.charName)..(isAChampToInterrupt[spell.name].spellKey)][(unit.charName).."LaneClear"] and ShadowVayneLastHit then _CastESpell(unit, "Interrupt ("..(spell.name)..") / Laneclear Mode") end
			if VayneMenu.interrupt[(unit.charName)..(isAChampToInterrupt[spell.name].spellKey)][(unit.charName).."Always"] then _CastESpell(unit, "Interrupt ("..(spell.name)..") / Always") end
		end

		if unit.isMe then
			if spell.name:find("Attack") then
				LastAttackedEnemy = spell.target
				if VayneMenu.keysetting.basiccondemn and spell.target.type == myHero.type then -- Auto-E after AA
					_CastESpell(spell.target, "E After Autohit ("..(spell.target.charName)..")", (spell.windUpTime - GetLatency() / 2000))
					VayneMenu.keysetting.basiccondemn = false
				end

				if VayneMenu.tumble.Qautocarry and ShadowVayneAutoCarry then DelayAction(function() CastSpell(_Q, mousePos.x, mousePos.z) end, (spell.windUpTime - GetLatency() / 2000)) end
				if VayneMenu.tumble.Qmixedmode and ShadowVayneMixedMode then DelayAction(function() CastSpell(_Q, mousePos.x, mousePos.z) end, (spell.windUpTime - GetLatency() / 2000)) end
				if VayneMenu.tumble.Qlaneclear and ShadowVayneLaneClear then DelayAction(function() CastSpell(_Q, mousePos.x, mousePos.z) end, (spell.windUpTime - GetLatency() / 2000)) end
				if VayneMenu.tumble.Qlasthit and ShadowVayneLastHit then DelayAction(function() CastSpell(_Q, mousePos.x, mousePos.z) end, (spell.windUpTime - GetLatency() / 2000)) end
				if VayneMenu.tumble.Qalways then DelayAction(function() CastSpell(_Q, mousePos.x, mousePos.z) end, (spell.windUpTime - GetLatency() / 2000)) end
			end


			if spell.name:find("VayneCondemn") then -- E detected, cooldown for next E 500 ticks
				CastedLastE = GetTickCount() + 500
			end
		end

		if isAGapcloserUnitNoTarget[spell.name] and GetDistance(unit) <= 2000 and (spell.target == nil or spell.target.isMe) and unit.team ~= myHero.team then
			if VayneMenu.anticapcloser[(unit.charName)..(isAGapcloserUnitNoTarget[spell.name].spellKey)][(unit.charName).."AutoCarry"] and ShadowVayneAutoCarry then spellExpired = false end
			if VayneMenu.anticapcloser[(unit.charName)..(isAGapcloserUnitNoTarget[spell.name].spellKey)][(unit.charName).."LastHit"] and ShadowVayneMixedMode then spellExpired = false end
			if VayneMenu.anticapcloser[(unit.charName)..(isAGapcloserUnitNoTarget[spell.name].spellKey)][(unit.charName).."MixedMode"] and ShadowVayneLaneClear then spellExpired = false end
			if VayneMenu.anticapcloser[(unit.charName)..(isAGapcloserUnitNoTarget[spell.name].spellKey)][(unit.charName).."LaneClear"] and ShadowVayneLastHit then spellExpired = false end
			if VayneMenu.anticapcloser[(unit.charName)..(isAGapcloserUnitNoTarget[spell.name].spellKey)][(unit.charName).."Always"] then spellExpired = false end
			if VayneMenu.autostunn.OverwriteAutoCarry and ShadowVayneAutoCarry then spellExpired = false end
			if VayneMenu.autostunn.OverwriteMixedMode and ShadowVayneMixedMode then spellExpired = false end
			if VayneMenu.autostunn.OverwriteLaneClear and ShadowVayneLaneClear then spellExpired = false end
			if VayneMenu.autostunn.OverwriteLastHit and ShadowVayneLastHit then spellExpired = false end
			if VayneMenu.autostunn.Overwritealways then spellExpired = false end
			informationTable = {
				spellSource = unit,
				spellCastedTick = GetTickCount(),
				spellStartPos = Point(spell.startPos.x, spell.startPos.z),
				spellEndPos = Point(spell.endPos.x, spell.endPos.z),
				spellRange = isAGapcloserUnitNoTarget[spell.name].range,
				spellSpeed = isAGapcloserUnitNoTarget[spell.name].projSpeed,
				spellName = spell.name
			}
		end
	end
end

function _AutoLevelSpell()
	if GetGame().map.index == 8 and myHero.level < 4 then
		LevelSpell(_Q)
		LevelSpell(_W)
		LevelSpell(_E)
	end

	if VayneMenu.autolevel.UseAutoLevelfirst and myHero.level < 4 then
		return AutoLevelSpellTable[AutoLevelSpellTable["SpellOrder"][VayneMenu.autolevel.first3level]][myHero.level]
	end

	if VayneMenu.autolevel.UseAutoLevelrest and myHero.level > 3 then
		return AutoLevelSpellTable[AutoLevelSpellTable["SpellOrder"][VayneMenu.autolevel.restlevel]][myHero.level]
	end
end

function _GetNeededAutoHits(enemy)
		local PredictHP = math.ceil(enemy.health)
		local ThisAA = 0
		local BladeSlot = GetInventorySlotItem(3153)
		local TrueDMGPercent = ((enemy.maxHealth/100))*(3+(myHero:GetSpellData(_W).level))
		if myHero:GetSpellData(_W).level > 0 then TargetTrueDmg = math.floor((((enemy.maxHealth/100)*(3+(myHero:GetSpellData(_W).level)))+(10+(myHero:GetSpellData(_W).level)*10))/3) else	TargetTrueDmg = 0 end
		while PredictHP > 0 do
			ThisAA = ThisAA + 1
			DMGThisAA = math.floor((math.floor(myHero.totalDamage)) * 100 / (100 + enemy.armor))
			if BladeSlot ~= nil then BladeDMG = math.floor(math.floor(PredictHP)*5 / (100 + enemy.armor)) else BladeDMG = 0 end
			MyDMG = DMGThisAA + BladeDMG + TargetTrueDmg
			PredictHP = PredictHP - MyDMG
		end

		if ThisAA ~= math.floor(ThisAA/3)*3 then
			local PredictHP = math.ceil(enemy.health)
			for i = 1,math.floor(ThisAA/3)*3,1 do
				DMGThisAA = math.floor((math.floor(myHero.totalDamage)) * 100 / (100 + enemy.armor))
				if BladeSlot ~= nil then BladeDMG = math.floor(math.floor(PredictHP)*5 / (100 + enemy.armor)) else BladeDMG = 0 end
				MyDMG = DMGThisAA + BladeDMG + TargetTrueDmg
				PredictHP = PredictHP - MyDMG
			end

			for i = 1,2,1 do
				DMGThisAA = math.floor((math.floor(myHero.totalDamage)) * 100 / (100 + enemy.armor))
				if BladeSlot ~= nil then BladeDMG = math.floor(math.floor(PredictHP)*5 / (100 + enemy.armor)) else BladeDMG = 0 end
				MyDMG = DMGThisAA + BladeDMG
				PredictHP = PredictHP - MyDMG
			end

			if PredictHP > 0 then
				ThisAA = (math.ceil(ThisAA/3)*3)
			end
		end
	return ThisAA
end

function _UseSelector()
	if VIP_USER and _G.Selector_Enabled and not myHero.dead and UseVIPSelector then
		local currentTarget = GetTarget()
		if currentTarget ~= nil and currentTarget.type == "obj_AI_Hero" and ValidTarget(currentTarget, 2000, true) then
			selected = currentTarget
		else
			selected = nil
		end
		if selected ~= nil then
			SOW:ForceTarget(selected)
		else
--~ 		GetSelectorTarget = Selector.GetTarget(Selector.LESSCASTADVANCED, "AD", {distance = 650})
		GetSelectorTarget = Selector.GetTarget()
			if GetSelectorTarget ~= nil then
				SOW:ForceTarget(target)
			end
		end
	end
end

function _UsePermaShows()
	CustomPermaShow("AutoCarry", VayneMenu.keysetting.autocarry, VayneMenu.permashowsettings.carrypermashow)
	CustomPermaShow("MixedMode", VayneMenu.keysetting.mixedmode, VayneMenu.permashowsettings.mixedpermashow)
	CustomPermaShow("LaneClear", VayneMenu.keysetting.laneclear, VayneMenu.permashowsettings.laneclearpermashow)
	CustomPermaShow("LastHit", VayneMenu.keysetting.lasthit, VayneMenu.permashowsettings.lasthitpermashow)
	CustomPermaShow("Auto-E after next BasicAttack", VayneMenu.keysetting.basiccondemn, VayneMenu.permashowsettings.epermashow)
end

function OnCreateObj(Obj)
	if Obj.name == "ThreshLantern" then
		LanternObj = Obj
	end
end

function _CastESpell(Target, Reason, Delay)
	if VIP_USER and VayneMenu.vip.EPackets then
		DelayAction(function() Packet('S_CAST', { spellId = _E, targetNetworkId = Target.networkID }):send(true) end, Delay)
	else
		DelayAction(function() CastSpell(_E, Target) end, Delay)
	end
	CastedLastE = GetTickCount() + 500
end

function _CheckEnemyStunnAble()
	if not myHero.dead and myHero:CanUseSpell(_E) == READY and CastedLastE < GetTickCount() then
		for i, enemy in ipairs(GetEnemyHeroes()) do
			if 	(VayneMenu.targets[enemy.charName][(enemy.charName).."AutoCarry"] and ShadowVayneAutoCarry) or
				(VayneMenu.targets[enemy.charName][(enemy.charName).."MixedMode"] and ShadowVayneMixedMode) or
				(VayneMenu.targets[enemy.charName][(enemy.charName).."LaneClear"] and ShadowVayneLaneClear) or
				(VayneMenu.targets[enemy.charName][(enemy.charName).."LastHit"] and ShadowVayneLastHit) or
				(VayneMenu.targets[enemy.charName][(enemy.charName).."Always"])	then
				if GetDistance(enemy, myHero) <= 1000 and not enemy.dead and enemy.visible then
					local CurrentDirection = (Vector(enemy) - ChampInfoTable[enemy.charName].CurrentVector)
					if CurrentDirection ~= Vector(0,0,0) then
						CurrentDirection = CurrentDirection:normalized()
					end
					ChampInfoTable[enemy.charName].CurrentAngle = ChampInfoTable[enemy.charName].CurrentDirection:dotP( CurrentDirection )
					ChampInfoTable[enemy.charName].CurrentDirection = CurrentDirection
					ChampInfoTable[enemy.charName].CurrentVector = Vector(enemy)
					if ChampInfoTable[enemy.charName].CurrentDirection ~= Vector(0,0,0) then
						if ChampInfoTable[enemy.charName].CurrentAngle and ChampInfoTable[enemy.charName].CurrentAngle > 0.8 then
							local AfterCastPos = Vector(enemy) + ChampInfoTable[enemy.charName].CurrentDirection * (enemy.ms * 0.0005)
							local timeElapsed = _GetCollisionTime(AfterCastPos, ChampInfoTable[enemy.charName].CurrentDirection, enemy.ms, myHero, 2200 )
							if timeElapsed ~= nil then
								StunnPos =  Vector(enemy) + ChampInfoTable[enemy.charName].CurrentDirection * enemy.ms * (timeElapsed + 0.5)/2
							end
						end
					else
						StunnPos = Vector(enemy)
					end
					if GetDistance(Vector(StunnPos), myHero) <= 710 then
						local BushFound, Bushpos = false, nil
						for i = 1, VayneMenu.autostunn.pushDistance, 10  do
							local CheckWallPos = Vector(StunnPos) + (Vector(StunnPos) - myHero):normalized()*(i)
							if IsWallOfGrass(D3DXVECTOR3(CheckWallPos.x, CheckWallPos.y, CheckWallPos.z)) and not BushFound then
								BushFound = true
								BushPos = CheckWallPos
							end
							if IsWall(D3DXVECTOR3(CheckWallPos.x, CheckWallPos.y, CheckWallPos.z)) then
								if UnderTurret(D3DXVECTOR3(CheckWallPos.x, CheckWallPos.y, CheckWallPos.z), true) then
									if VayneMenu.autostunn.towerstunn then
										_CastPacketSpell(_E, enemy)
										CastedLastE = GetTickCount() + 500
										_ScriptDebugMsg("Target: "..(enemy.charName)..", Reason: Autostunn, Field: UnderTower, Bush: "..(tostring(BushFound)), "stunndebug")
										break
									end
								else
									_CastPacketSpell(_E, enemy)
									if BushFound and VayneMenu.autostunn.trinket and myHero:CanUseSpell(ITEM_7) == 0 then
										CastSpell(ITEM_7, BushPos.x, BushPos.z)
									end
									_ScriptDebugMsg("Target: "..(enemy.charName)..", Reason: Autostunn, Field: NoTower, Bush: "..(tostring(BushFound)), "stunndebug")
									break
								end
							end
						end
					end
				end
			end
		end
	end
end

function _GetCollisionTime (targetPos, targetDir, targetSpeed, sourcePos, projSpeed ) --Function done by Yomie from EzCondemn
	local velocity = targetDir * targetSpeed

	local velocityX = velocity.x
	local velocityY = velocity.z

	local relStart = targetPos - sourcePos

	local relStartX = relStart.x
	local relStartY = relStart.z

	local a = velocityX * velocityX + velocityY * velocityY - projSpeed * projSpeed
	local b = 2 * velocityX * relStartX + 2 * velocityY * relStartY
	local c = relStartX * relStartX + relStartY * relStartY

	local disc = b * b - 4 * a * c

	if disc >= 0 then
		local t1 = -( b + math.sqrt( disc )) / (2 * a )
		local t2 = -( b - math.sqrt( disc )) / (2 * a )


		if t1 and t2 and t1 > 0 and t2 > 0 then
			if t1 > t2 then
				return t2
			else
				return t1
			end
		elseif t1 and t1 > 0 then
			return t1
		elseif t2 and t2 > 0 then
			return t2
		end
	end

	return nil
end

function _CastPacketSpell(SpellToCast, TargetToCast)
	if VIP_USER and VayneMenu.vip.EPackets then
		Packet('S_CAST', { spellId = SpellToCast, targetNetworkId = TargetToCast.networkID }):send(true)
		CastedLastE = GetTickCount() + 500
	else
		CastSpell(_E, TargetToCast)
		CastedLastE = GetTickCount() + 500
	end

end

function _NonTargetGapCloserAfterCast()
	if not myHero.dead and myHero:CanUseSpell(_E) == READY then
		if spellExpired == false and (GetTickCount() - informationTable.spellCastedTick) <= (informationTable.spellRange/informationTable.spellSpeed)*1000 then
			local spellDirection     = (informationTable.spellEndPos - informationTable.spellStartPos):normalized()
			local spellStartPosition = informationTable.spellStartPos + spellDirection
			local spellEndPosition   = informationTable.spellStartPos + spellDirection * informationTable.spellRange
			local heroPosition = Point(myHero.x, myHero.z)
			local SkillShot = LineSegment(Point(spellStartPosition.x, spellStartPosition.y), Point(spellEndPosition.x, spellEndPosition.y))
			if heroPosition:distance(SkillShot) <= 250 then
				if VayneMenu.vip.EPackets then _CastESpell(informationTable.spellSource, "Gapcloser NonTargeted ("..(informationTable.spellName)..")") end
			end
		else
			spellExpired = true
			informationTable = {}
		end
	end
end

function _PrintScriptMsg(Msg)
	PrintChat("<font color=\"#F0Ff8d\"><b>ShadowVayne:</b></font> <font color=\"#FF0F0F\">"..Msg.."</font>")
end

function _ScriptDebugMsg(Msg, DebugMode)
	if VayneMenu.debug[DebugMode] then
		print("<font color=\"#F0Ff8d\"><b>ShadowVayne Debug:</b></font> <font color=\"#FF0F0F\">"..Msg.."</font>")
	end
end

function _GetRunningModes()
--~ Get the Keysettings from SV
	ShadowVayneAutoCarry = VayneMenu.keysetting.autocarry
	ShadowVayneMixedMode = VayneMenu.keysetting.mixedmode
	ShadowVayneLaneClear = VayneMenu.keysetting.laneclear
	ShadowVayneLastHit = VayneMenu.keysetting.lasthit

--~ Reset All Modes to false
	if SACLoaded then Keys.AutoCarry,Keys.MixedMode,Keys.LaneClear,Keys.LastHit = false,false,false,false end
	if RevampedLoaded then REVMenu.AutoCarry,REVMenu.MixedMode,REVMenu.LaneClear,REVMenu.LastHit = false,false,false,false end
	if SOWLoaded then SOWMenu._param[7].key,SOWMenu._param[8].key,SOWMenu._param[9].key,SOWMenu._param[10].key = 5,5,5,5 end
	if SOWLoaded then SOWMenu.Mode0,SOWMenu.Mode1,SOWMenu.Mode2,SOWMenu.Mode3 = false,false,false,false end
	if MMALoaded then _G.MMA_Orbwalker,_G.MMA_HybridMode,_G.MMA_LaneClear,_G.MMA_LastHit = false,false,false,false end

--~ Check if one List is Empty
	if VayneMenu.keysetting._param[StartParam].listTable[VayneMenu.keysetting.AutoCarryOrb] == nil then VayneMenu.keysetting.AutoCarryOrb = 1 end
	if VayneMenu.keysetting._param[StartParam+1].listTable[VayneMenu.keysetting.MixedModeOrb] == nil then VayneMenu.keysetting.MixedModeOrb = 1 end
	if VayneMenu.keysetting._param[StartParam+2].listTable[VayneMenu.keysetting.LaneClearOrb] == nil then VayneMenu.keysetting.LaneClearOrb = 1 end
	if VayneMenu.keysetting._param[StartParam+3].listTable[VayneMenu.keysetting.LastHitOrb] == nil then VayneMenu.keysetting.LastHitOrb = 1 end

--~ Get what is Selected
	AutoCarryOrbText = VayneMenu.keysetting._param[StartParam].listTable[VayneMenu.keysetting.AutoCarryOrb]
	MixedModeOrbText = VayneMenu.keysetting._param[StartParam+1].listTable[VayneMenu.keysetting.MixedModeOrb]
	LaneClearOrbText = VayneMenu.keysetting._param[StartParam+2].listTable[VayneMenu.keysetting.LaneClearOrb]
	LastHitOrbText = VayneMenu.keysetting._param[StartParam+3].listTable[VayneMenu.keysetting.LastHitOrb]

--~ Set the Modes
	if AutoCarryOrbText == "MMA" then _G.MMA_Orbwalker = ShadowVayneAutoCarry end
	if AutoCarryOrbText == "Reborn" then Keys.AutoCarry = ShadowVayneAutoCarry end
	if AutoCarryOrbText == "SOW" then SOWMenu.Mode0 = ShadowVayneAutoCarry end
	if AutoCarrycOrbText == "Revamped" then REVMenu.AutoCarry = ShadowVayneAutoCarry end

	if MixedModeOrbText == "MMA" then _G.MMA_HybridMode = ShadowVayneMixedMode end
	if MixedModeOrbText == "Reborn" then Keys.MixedMode = ShadowVayneMixedMode end
	if MixedModeOrbText == "SOW" then SOWMenu.Mode1 = ShadowVayneMixedMode end
	if MixedModeOrbText == "Revamped" then REVMenu.MixedMode = ShadowVayneMixedMode end

	if LaneClearOrbText == "MMA" then _G.MMA_LaneClear = ShadowVayneLaneClear end
	if LaneClearOrbText == "Reborn" then Keys.LaneClear = ShadowVayneLaneClear end
	if LaneClearOrbText == "SOW" then SOWMenu.Mode2 = ShadowVayneLaneClear end
	if LaneClearOrbText == "Revamped" then REVMenu.LaneClear = ShadowVayneLaneClear end

	if LastHitOrbText == "MMA" then _G.MMA_LastHit = ShadowVayneLastHit end
	if LastHitOrbText == "Reborn" then Keys.LastHit = ShadowVayneLastHit end
	if LastHitOrbText == "SOW" then SOWMenu.Mode3 = ShadowVayneLastHit end
	if LastHitOrbText == "Revamped" then REVMenu.LastHit = ShadowVayneLastHit end
end

function _LoadMenu()
	VayneMenu = scriptConfig("[SV] ShadowVayne", "SV_MAIN")
	SOWMenu = scriptConfig("[SV] SimpleOrbWalker Settings", "SV_SOW")
	VayneMenu:addSubMenu("[Condemn]: AntiGapCloser Settings", "anticapcloser")
	VayneMenu:addSubMenu("[Condemn]: AutoStunn Settings", "autostunn")
	VayneMenu:addSubMenu("[Condemn]: AutoStunn Targets", "targets")
	VayneMenu:addSubMenu("[Condemn]: Interrupt Settings", "interrupt")
	VayneMenu:addSubMenu("[Tumble]: Settings", "tumble")
	VayneMenu:addSubMenu("[Misc]: Key Settings", "keysetting")
	VayneMenu:addSubMenu("[Misc]: AutoLevelSpells Settings", "autolevel")
	VayneMenu:addSubMenu("[Misc]: VIP Settings", "vip")
	VayneMenu:addSubMenu("[Misc]: PermaShow Settings", "permashowsettings")
	VayneMenu:addSubMenu("[Misc]: AutoUpdate Settings", "autoup")
	VayneMenu:addSubMenu("[Misc]: Draw Settings", "draw")
	VayneMenu:addSubMenu("[BotRK]: Settings", "botrksettings")
	VayneMenu:addSubMenu("[QSS]: Settings", "qqs")
	VayneMenu:addSubMenu("[Debug]: Settings", "debug")
	VayneMenu.qqs:addParam("nil","QSS/Cleanse is not Supported yet", SCRIPT_PARAM_INFO, "")
	if not VIP_USER or not UseVIPSelector then
		TSSMenu = scriptConfig("[SV] SimpleTargetSelector Settings", "SV_TSS")
		STS = SimpleTS(STS_LESS_CAST_PHYSICAL)
		SOWi = SOW(VP, STS)
		SOWi:LoadToMenu(SOWMenu)
		STS:AddToMenu(TSSMenu)
	else
		SOWi = SOW(VP)
		SOWi:LoadToMenu(SOWMenu)
		if UseVIPSelector then Selector.Instance() end
	end

	VayneMenu.keysetting:addParam("nil","Basic Key Settings", SCRIPT_PARAM_INFO, "")
	VayneMenu.keysetting:addParam("basiccondemn","Condemn on next BasicAttack:", SCRIPT_PARAM_ONKEYTOGGLE, false, string.byte( "E" ))
	VayneMenu.keysetting:addParam("threshlantern","Grab the Thresh lantern: ", SCRIPT_PARAM_ONKEYDOWN, false, string.byte( "T" ))
	VayneMenu.keysetting.basiccondemn = false
	VayneMenu.keysetting:addParam("nil","", SCRIPT_PARAM_INFO, "")
	VayneMenu.keysetting:addParam("nil","General Key Settings", SCRIPT_PARAM_INFO, "")
	VayneMenu.keysetting:addParam("autocarry","Auto Carry Mode Key:", SCRIPT_PARAM_ONKEYDOWN, false, string.byte( "V" ))
	VayneMenu.keysetting:addParam("mixedmode","Mixed Mode Key:", SCRIPT_PARAM_ONKEYDOWN, false, string.byte( "C" ))
	VayneMenu.keysetting:addParam("laneclear","Lane Clear Mode Key:", SCRIPT_PARAM_ONKEYDOWN, false, string.byte( "M" ))
	VayneMenu.keysetting:addParam("lasthit","Last Hit Mode Key:", SCRIPT_PARAM_ONKEYDOWN, false, string.byte( "N" ))
	VayneMenu.keysetting:addParam("nil","", SCRIPT_PARAM_INFO, "")

	if SOWLoaded then VayneMenu.keysetting:addParam("nil","SimpleOrbWalker found", SCRIPT_PARAM_INFO, "") end
	if SACLoaded then VayneMenu.keysetting:addParam("nil","Sida's Auto Carry: Reborn found", SCRIPT_PARAM_INFO, "") end
	if REVLoaded then VayneMenu.keysetting:addParam("nil","Sida's Auto Carry: Revamped found", SCRIPT_PARAM_INFO, "") end
	if MMALoaded then VayneMenu.keysetting:addParam("nil","Marksmen Mighty Assistant found", SCRIPT_PARAM_INFO, "") end
	VayneMenu.keysetting:addParam("nil","", SCRIPT_PARAM_INFO, "")
	VayneMenu.keysetting:addParam("nil","Choose...", SCRIPT_PARAM_INFO, "")
	if SOWLoaded then
		if MMALoaded then
			if SACLoaded then
				OrbWalkerTable = { "SOW", "MMA", "Reborn"}
				StartParam, OrbWalkers = 16,3
			elseif REVLoaded then
				OrbWalkerTable = { "SOW", "MMA", "Revamped"}
				StartParam, OrbWalkers = 16,3
			else
				OrbWalkerTable = { "SOW", "MMA"}
				StartParam, OrbWalkers = 15,2
			end
		else
			if SACLoaded then
				OrbWalkerTable = { "SOW", "Reborn"}
				StartParam, OrbWalkers = 15,2
			elseif REVLoaded then
				OrbWalkerTable = { "SOW", "Revamped"}
				StartParam, OrbWalkers = 15,2
			else
				OrbWalkerTable = { "SOW"}
				StartParam, OrbWalkers = 14,1
			end
		end
	end


	VayneMenu.keysetting:addParam("AutoCarryOrb", "Orbwalker in AutoCarry: ", SCRIPT_PARAM_LIST, 1, OrbWalkerTable)
	VayneMenu.keysetting:addParam("MixedModeOrb", "Orbwalker in MixedMode: ", SCRIPT_PARAM_LIST, 1, OrbWalkerTable)
	VayneMenu.keysetting:addParam("LaneClearOrb", "Orbwalker in LaneClear: ", SCRIPT_PARAM_LIST, 1, OrbWalkerTable)
	VayneMenu.keysetting:addParam("LastHitOrb", "Orbwalker in LastHit: ", SCRIPT_PARAM_LIST, 1, OrbWalkerTable)

	for i, enemy in ipairs(GetEnemyHeroes()) do
--~ 	Gapcloser Menu Targeted Skills
		if isAGapcloserUnitTarget[enemy.charName] then
			VayneMenu.anticapcloser:addSubMenu((enemy.charName).." "..(isAGapcloserUnitTarget[enemy.charName].spellKey), (enemy.charName)..(isAGapcloserUnitTarget[enemy.charName].spellKey))
			VayneMenu.anticapcloser[(enemy.charName)..(isAGapcloserUnitTarget[enemy.charName].spellKey)]:addParam("sep", "Interrupt "..(enemy.charName).." "..(isAGapcloserUnitTarget[enemy.charName].spellKey)..":", SCRIPT_PARAM_INFO, "")
			VayneMenu.anticapcloser[(enemy.charName)..(isAGapcloserUnitTarget[enemy.charName].spellKey)]:addParam((enemy.charName).."AutoCarry", "in AutoCarry", SCRIPT_PARAM_ONOFF, true)
			VayneMenu.anticapcloser[(enemy.charName)..(isAGapcloserUnitTarget[enemy.charName].spellKey)]:addParam((enemy.charName).."MixedMode", "in MixedMode", SCRIPT_PARAM_ONOFF, true)
			VayneMenu.anticapcloser[(enemy.charName)..(isAGapcloserUnitTarget[enemy.charName].spellKey)]:addParam((enemy.charName).."LaneClear", "in LaneClear", SCRIPT_PARAM_ONOFF, false)
			VayneMenu.anticapcloser[(enemy.charName)..(isAGapcloserUnitTarget[enemy.charName].spellKey)]:addParam((enemy.charName).."LastHit", "in LastHit", SCRIPT_PARAM_ONOFF, false)
			VayneMenu.anticapcloser[(enemy.charName)..(isAGapcloserUnitTarget[enemy.charName].spellKey)]:addParam((enemy.charName).."Always", "Always", SCRIPT_PARAM_ONOFF, false)
		end

--~ 	Gapcloser Menu NoTargeted Skills
		for _, TableInfo in pairs(isAGapcloserUnitNoTarget) do
			if TableInfo.champ == enemy.charName then
				VayneMenu.anticapcloser:addSubMenu((enemy.charName).." "..(TableInfo.spellKey), (enemy.charName)..(TableInfo.spellKey))
				VayneMenu.anticapcloser[(enemy.charName)..(TableInfo.spellKey)]:addParam("sep", "Interrupt "..(enemy.charName).." "..(TableInfo.spellKey)..":", SCRIPT_PARAM_INFO, "")
				VayneMenu.anticapcloser[(enemy.charName)..(TableInfo.spellKey)]:addParam((enemy.charName).."AutoCarry", "in AutoCarry", SCRIPT_PARAM_ONOFF, true)
				VayneMenu.anticapcloser[(enemy.charName)..(TableInfo.spellKey)]:addParam((enemy.charName).."MixedMode", "in MixedMode", SCRIPT_PARAM_ONOFF, true)
				VayneMenu.anticapcloser[(enemy.charName)..(TableInfo.spellKey)]:addParam((enemy.charName).."LaneClear", "in LaneClear", SCRIPT_PARAM_ONOFF, false)
				VayneMenu.anticapcloser[(enemy.charName)..(TableInfo.spellKey)]:addParam((enemy.charName).."LastHit", "in LastHit", SCRIPT_PARAM_ONOFF, false)
				VayneMenu.anticapcloser[(enemy.charName)..(TableInfo.spellKey)]:addParam((enemy.charName).."Always", "Always", SCRIPT_PARAM_ONOFF, false)
			end
		end

--~ 	Autostunn Target Menu
		VayneMenu.targets:addSubMenu(enemy.charName, enemy.charName)
		VayneMenu.targets[enemy.charName]:addParam("sep", "Stunn "..(enemy.charName), SCRIPT_PARAM_INFO, "")
		VayneMenu.targets[enemy.charName]:addParam((enemy.charName).."AutoCarry", "in AutoCarry", SCRIPT_PARAM_ONOFF, true)
		VayneMenu.targets[enemy.charName]:addParam((enemy.charName).."MixedMode", "in MixedMode", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.targets[enemy.charName]:addParam((enemy.charName).."LaneClear", "in LaneClear", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.targets[enemy.charName]:addParam((enemy.charName).."LastHit", "in LastHit", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.targets[enemy.charName]:addParam((enemy.charName).."Always", "Always", SCRIPT_PARAM_ONOFF, false)

--~ 	Interrupt Champs Menu
		for _, TableInfo in pairs(isAChampToInterrupt) do
			if TableInfo.champ == enemy.charName then
				VayneMenu.interrupt:addSubMenu((enemy.charName).." "..(TableInfo.spellKey), (enemy.charName)..(TableInfo.spellKey))
				VayneMenu.interrupt[(enemy.charName)..(TableInfo.spellKey)]:addParam("sep", "Interrupt "..(enemy.charName).." "..(TableInfo.spellKey), SCRIPT_PARAM_INFO, "")
				VayneMenu.interrupt[(enemy.charName)..(TableInfo.spellKey)]:addParam((enemy.charName).."AutoCarry", "in AutoCarry", SCRIPT_PARAM_ONOFF, true)
				VayneMenu.interrupt[(enemy.charName)..(TableInfo.spellKey)]:addParam((enemy.charName).."MixedMode", "in MixedMode", SCRIPT_PARAM_ONOFF, true)
				VayneMenu.interrupt[(enemy.charName)..(TableInfo.spellKey)]:addParam((enemy.charName).."LaneClear", "in LaneClear", SCRIPT_PARAM_ONOFF, true)
				VayneMenu.interrupt[(enemy.charName)..(TableInfo.spellKey)]:addParam((enemy.charName).."LastHit", "in LastHit", SCRIPT_PARAM_ONOFF, true)
				VayneMenu.interrupt[(enemy.charName)..(TableInfo.spellKey)]:addParam((enemy.charName).."Always", "Always", SCRIPT_PARAM_ONOFF, true)
			end
		end
	end

--~ 	AutoStunn Settings Menu
		VayneMenu.autostunn:addParam("pushDistance", "Push Distance", SCRIPT_PARAM_SLICE, 390, 0, 450, 0)
--~ 		VayneMenu.autostunn:addParam("accuracy", "Accuracy", SCRIPT_PARAM_SLICE, 5, 1, 10, 0)
		VayneMenu.autostunn:addParam("towerstunn", "Stunn if Enemy lands unter a Tower", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.autostunn:addParam("trinket", "Use Auto-Trinket Bush", SCRIPT_PARAM_ONOFF, true)

--~ 	Gapcloser Overwrite Menu
		VayneMenu.anticapcloser:addParam("fap", "", SCRIPT_PARAM_INFO, "","" )
		VayneMenu.anticapcloser:addParam("fap", "Gapcloser Overwrite:", SCRIPT_PARAM_INFO, "","" )
		VayneMenu.anticapcloser:addParam("OverwriteAutoCarry", "Enable All Gapcloser in AutoCarry", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.anticapcloser:addParam("OverwriteMixedMode", "Enable All Gapcloser in Mixedmode", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.anticapcloser:addParam("OverwriteLaneClear", "Enable All Gapcloser in LaneClear", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.anticapcloser:addParam("OverwriteLastHit", "Enable All Gapcloser in LastHit", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.anticapcloser:addParam("OverwriteAlways", "Enalbe All Gapcloser always", SCRIPT_PARAM_ONOFF, false)

--~ 	Draw Menu
		VayneMenu.draw:addParam("DrawERange", "Draw E Range", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.draw:addParam("DrawAARange", "Draw Basicattack Range", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.draw:addParam("DrawNeededAutohits", "Draw Needed Autohits", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.draw:addParam("DrawEColor", "E Range Color", SCRIPT_PARAM_LIST, 1, { "Riot standard", "Green", "Blue", "Red", "Purple" })
		VayneMenu.draw:addParam("DrawAAColor", "Basicattack Range Color", SCRIPT_PARAM_LIST, 1, { "Riot standard", "Green", "Blue", "Red", "Purple" })

--~ 	Autolevel Menu
		VayneMenu.autolevel:addParam("UseAutoLevelfirst", "Use AutoLevelSpells Level 1-3", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.autolevel:addParam("UseAutoLevelrest", "Use AutoLevelSpells Level 4-18", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.autolevel:addParam("first3level", "Level 1-3:", SCRIPT_PARAM_LIST, 1, { "Q-W-E", "Q-E-W", "W-Q-E", "W-E-Q", "E-Q-W", "E-W-Q" })
		VayneMenu.autolevel:addParam("restlevel", "Level 4-18:", SCRIPT_PARAM_LIST, 1, { "Q-W-E", "Q-E-W", "W-Q-E", "W-E-Q", "E-Q-W", "E-W-Q" })
		VayneMenu.autolevel:addParam("fap", "", SCRIPT_PARAM_INFO, "","" )
		VayneMenu.autolevel:addParam("fap", "You can Click on the \"Q-W-E\"", SCRIPT_PARAM_INFO, "","" )
		VayneMenu.autolevel:addParam("fap", "to change the Autospellorder", SCRIPT_PARAM_INFO, "","" )

--~ 	Vip Menu
		VayneMenu.vip:addParam("EPackets", "Use Packets for E Cast (VIP Only)", SCRIPT_PARAM_ONOFF, true)
--~ 		VayneMenu.vip:addParam("vpred", "Use VPrediction (VIP Only)", SCRIPT_PARAM_ONOFF, true)
		VayneMenu.vip:addParam("selector", "Use Selector (VIP Only)", SCRIPT_PARAM_ONOFF, true)

--~ 	PermaShow Menu
		VayneMenu.permashowsettings:addParam("epermashow", "PermaShow \"E on Next BasicAttack\"", SCRIPT_PARAM_ONOFF, true)
		VayneMenu.permashowsettings:addParam("carrypermashow", "PermaShow: AutoCarry", SCRIPT_PARAM_ONOFF, true)
		VayneMenu.permashowsettings:addParam("mixedpermashow", "PermaShow: Mixed Mode", SCRIPT_PARAM_ONOFF, true)
		VayneMenu.permashowsettings:addParam("laneclearpermashow", "PermaShow: Laneclear", SCRIPT_PARAM_ONOFF, true)
		VayneMenu.permashowsettings:addParam("lasthitpermashow", "PermaShow: Last hit", SCRIPT_PARAM_ONOFF, true)
		VayneMenu.keysetting:permaShow("basiccondemn")

--~ 	AutoUpdate Menu
		VayneMenu.autoup:addParam("autoupcheck", "AutoUpdate", SCRIPT_PARAM_ONOFF, true)
--~ 		VayneMenu.autoup:addParam("autoupdown", "Download Available Updates", SCRIPT_PARAM_ONOFF, true)
		VayneMenu.autoup:addParam("fap", "", SCRIPT_PARAM_INFO, "","" )
		VayneMenu.autoup:addParam("fap", "Set this to Off for Superfast load", SCRIPT_PARAM_INFO, "","" )
--~ 		VayneMenu.autoup:addParam("fap", "The second will download it", SCRIPT_PARAM_INFO, "","" )

--~ 	BotRK Settings Menu
		VayneMenu.botrksettings:addParam("botrkautocarry", "Use BotRK in AutoCarry", SCRIPT_PARAM_ONOFF, true)
		VayneMenu.botrksettings:addParam("botrkmixedmode", "Use BotRK in MixedMode", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.botrksettings:addParam("botrklaneclear", "Use BotRK in LaneClear", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.botrksettings:addParam("botrklasthit", "Use BotRK in LastHit", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.botrksettings:addParam("botrkalways", "Use BotRK always", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.botrksettings:addParam("botrkmaxheal", "Max Own Health Percent", SCRIPT_PARAM_SLICE, 50, 1, 100, 0)
		VayneMenu.botrksettings:addParam("botrkminheal", "Min Enemy Health Percent", SCRIPT_PARAM_SLICE, 20, 1, 100, 0)

--~ 	Tumble Settings Menu
		VayneMenu.tumble:addParam("Qautocarry", "Use Tumble in AutoCarry", SCRIPT_PARAM_ONOFF, true)
		VayneMenu.tumble:addParam("Qmixedmode", "Use Tumble in MixedMode", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.tumble:addParam("Qlaneclear", "Use Tumble in LaneClear", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.tumble:addParam("Qlasthit", "Use Tumble in LastHit", SCRIPT_PARAM_ONOFF, false)
		VayneMenu.tumble:addParam("Qalways", "Use Tumble always", SCRIPT_PARAM_ONOFF, false)

--~ 	Debug Settings Menu
		VayneMenu.debug:addParam("stunndebug", "Debug AutoStunn", SCRIPT_PARAM_ONOFF, false)
end

function _CheckUpdate_ShadowVayne()
	if not UpdateDone_ShadowVayne then
		os.remove(LIB_PATH.."/ShadowVayne.Version")
		if SV_AutoUpdate then
			--~ Get Local Version
			if LocalVersion_ShadowVayne == nil then
				LocalVersionFile = io.open(SCRIPT_PATH..(GetCurrentEnv().FILE_NAME), "r")
				LocalVersion_ShadowVayne = string.sub(LocalVersionFile:read("*a"), 51, 54)
			end

			--~ Get Server Version
			if ServerVersion_ShadowVayne == nil then
				if not Downloading and not Downloaded_ShadowVayne then
					DownloadFile("http://raw.github.com/Superx321/BoL/master/ShadowVayne.Version?rand="..tostring(math.random(1,10000)), LIB_PATH.."/ShadowVayne.Version", function () Downloading = false end)
					Downloading = true
					Downloaded_ShadowVayne = true
				end
				if FileExist(LIB_PATH.."/ShadowVayne.Version") and not Downloading then
					ServerVersionFile = io.open((LIB_PATH.."/ShadowVayne.Version"), "r")
					ServerVersion_ShadowVayne = ServerVersionFile:read("*a")
					ServerVersionFile:close()
				end
			end

			--~ Check for Updates and Download
			if ServerVersion_ShadowVayne ~= nil and LocalVersion_ShadowVayne ~= nil then
				if ServerVersion_ShadowVayne > LocalVersion_ShadowVayne then
					_PrintScriptMsg("New Version ("..ServerVersion_ShadowVayne..") available, downloading...")
					SHADOWVAYNE_SCRIPT_URL = "http://raw.github.com/Superx321/BoL/master/ShadowVayne.lua?rand="..tostring(math.random(1,10000))
					SHADOWVAYNE_PATH = SCRIPT_PATH..(GetCurrentEnv().FILE_NAME)
					if not Downloading then
						DownloadFile(SHADOWVAYNE_SCRIPT_URL, SHADOWVAYNE_PATH, function ()
						_PrintScriptMsg("Updated to Version "..(ServerVersion_ShadowVayne)..". Please reload with F9")
						UpdateDone_ShadowVayne = true
						Downloading = false
							end)
						Downloading = true
					end
				else
					_PrintScriptMsg("No Updates available. Loaded Version "..LocalVersion_ShadowVayne)
					UpdateDone_ShadowVayne = true
				end
			end
		else
			_PrintScriptMsg("AutoUpdate is off. Loaded Version "..LocalVersion_ShadowVayne)
			UpdateDone_ShadowVayne = true
		end
	end
end

function _CheckUpdate_SourceLib()
	if not UpdateDone_SourceLib then
		--~ Get Local Version
		if LocalVersion_SourceLib == nil then
			if FileExist(LIB_PATH.."/SourceLib.lua") then
				LocalVersionFile = io.open(LIB_PATH.."/SourceLib.lua", "r")
				LocalVersionString = LocalVersionFile:read("*a")
				LocalVersionPos, Dummy = string.find(LocalVersionString, "local version")
				if string.find(LocalVersionString, "local autoUpdate   = true") then
					LocalVersion_SourceLib = 1.000
				else
					LocalVersion_SourceLib = tonumber(string.sub(LocalVersionString, LocalVersionPos+16, LocalVersionPos+21))
				end
			else
				LocalVersion_SourceLib = 1.000
			end
		end

		--~ Check for Updates and Download
		if LocalVersion_SourceLib ~= nil then
			if LocalVersion_SourceLib ~= 1.058 then
				NewSourceLibString = "LS0gQ2hhbmdlIGF1dG9VcGRhdGUgdG8gZmFsc2UgaWYgeW91IHdpc2ggdG8gbm90IHJlY2VpdmUgYXV0byB1cGRhdGVzLgotLSBDaGFuZ2Ugc2lsZW50VXBkYXRlIHRvIHRydWUgaWYgeW91IHdpc2ggbm90IHRvIHJlY2VpdmUgYW55IG1lc3NhZ2UgcmVnYXJkaW5nIHVwZGF0ZXMKbG9jYWwgYXV0b1VwZGF0ZSAgID0gZmFsc2UKbG9jYWwgc2lsZW50VXBkYXRlID0gZmFsc2UKCmxvY2FsIHZlcnNpb24gPSAxLjA1OAoKLS1bWwoKICAgICAgX19fX19fX19fICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLl9fX18gICAgLl9fX19fLgogICAgIC8gICBfX19fXy8gX19fXyAgX18gX19fX19fX19fICAgX19fXyAgX19fXyB8ICAgIHwgICB8X19cXyB8X18KICAgICBcX19fX18gIFwgLyAgXyBcfCAgfCAgXF8gIF9fIFxfLyBfX19cLyBfXyBcfCAgICB8ICAgfCAgfHwgX18gXAogICAgIC8gICAgICAgICggIDxfPiApICB8ICAvfCAgfCBcL1wgIFxfX1wgIF9fXy98ICAgIHxfX198ICB8fCBcX1wgXAogICAgL19fX19fX18gIC9cX19fXy98X19fXy8gfF9ffCAgICBcX19fICA+X19fICA+X19fX19fXyBcX198fF9fXyAgLwogICAgICAgICAgICBcLyAgICAgICAgICAgICAgICAgICAgICAgICAgXC8gICAgXC8gICAgICAgIFwvICAgICAgIFwvCgogICAgU291cmNlTGliIC0gYSBjb21tb24gbGlicmFyeSBieSBUZWFtIFRoZVNvdXJjZQogICAgQ29weXJpZ2h0IChDKSAyMDE0ICBUZWFtIFRoZVNvdXJjZQoKICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAgICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQogICAgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3IKICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgogICAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCiAgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgogICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQogICAgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KCiAgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogICAgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvLgoKCiAgICBJbnRyb2R1Y3Rpb246CiAgICAgICAgV2Ugd2VyZSB0aXJlZCBvZiB1cGRhdGluZyBldmVyeSBzaW5nbGUgc2NyaXB0IHdlIGRldmVsb3BlZCBzbyBmYXIgc28gd2UgZGVjaWRlZCB0byBoYXZlIGl0IGEgbGl0dGxlIGJpdAogICAgICAgIG1vcmUgZHluYW1pYyB3aXRoIGEgY3VzdG9tIGxpYnJhcnkgd2hpY2ggd2UgY2FuIHVwZGF0ZSBpbnN0ZWFkIGFuZCBldmVyeSBzY3JpcHQgdXNpbmcgaXQgd2lsbCBhdXRvbWF0aWNhbGx5CiAgICAgICAgYmUgdXBkYXRlZCAob2YgY291cnNlIG9ubHkgdGhlIHBhcnRzIHdoaWNoIGFyZSBpbiB0aGlzIGxpYikuIFNvIGxldCdzIHNheSBwYWNrZXQgY2FzdGluZyBnZXQncyBmdWNrZWQgdXAKICAgICAgICBvciB3ZSB3YW50IHRvIGNoYW5nZSB0aGUgd2F5IHNvbWUgZHJhd2luZyBpcyBkb25lLCB3ZSBqdXN0IG5lZWQgdG8gdXBkYXRlIGl0IGhlcmUgYW5kIGFsbCBzY3JpcHRzIHdpbGwgaGF2ZQogICAgICAgIHRoZSBzYW1lIHR3ZWFrcyB0aGVuLgoKICAgIENvbnRlbnRzOgogICAgICAgIFJlcXVpcmUgICAgICAgICAtLSBBIGJhc2ljIGJ1dCBwb3dlcmZ1bCBsaWJyYXJ5IGRvd25sb2FkZXIKICAgICAgICBTb3VyY2VVcGRhdGVyICAgLS0gT25lIG9mIHRoZSBtb3N0IGJhc2ljIGZ1bmN0aW9ucyBmb3IgZXZlcnkgc2NyaXB0IHdlIHVzZQogICAgICAgIFNwZWxsICAgICAgICAgICAtLSBTcGVsbHMgaGFuZGxlZCB0aGUgd2F5IHRoZXkgc2hvdWxkIGJlIGhhbmRsZWQKICAgICAgICBEcmF3TWFuYWdlciAgICAgLS0gRWFzeSBkcmF3aW5nIG9mIGFsbCBraW5kIG9mIHRoaW5ncywgY29tZXMgYWxvbmcgd2l0aCBzb21lIG90aGVyIGNsYXNzZXMgc3VjaCBhcyBDaXJjbGUKICAgICAgICBEYW1hZ2VMaWIgICAgICAgLS0gQ2FsY3VsYXRlIHRoZSBkYW1hZ2UgZG9uZSBkbyBvdGhlcnMgYW5kIGV2ZW4gcHJpbnQgaXQgb24gdGhlaXIgaGVhbHRoYmFyCiAgICAgICAgU1RTICAgICAgICAgICAgIC0tIFNpbXBsZVRhcmdldFNlbGVjdG9yIGlzIGEgc2ltcGxlIGFuZCB5ZXQgcG93ZXJmdWwgdGFyZ2V0IHNlbGVjdG9yIHRvIHByb3ZpZGUgdmVyeSBiYXNpYyB0YXJnZXQgc2VsZWN0aW5nCiAgICAgICAgTWVudVdyYXBwZXIgICAgIC0tIEVhc3kgbWVudSBjcmVhdGlvbiB3aXRoIG9ubHkgYSBmZXcgbGluZXMKICAgICAgICBJbnRlcnJ1cHRlciAgICAgLS0gRWFzeSB3YXkgdG8gaGFuZGxlIGludGVycnVwdGFibGUgc3BlbGxzCiAgICAgICAgQW50aUdldGNsb3NlciAgIC0tIE5ldmVyIGxldCB0aGVtIGdldCBjbG9zZSB0byB5b3UKCl1dCgotLSBUZW1wb3JhcnkgaGVyZSB1bnRpbCBpdCdzIGluY2x1ZGVkIGluIEJvTCBpdHNlbGYKaWYgVklQX1VTRVIgdGhlbgogICAgQWRkQnVnc3BsYXRDYWxsYmFjayhmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgcCA9IENMb0xQYWNrZXQoMHg5QikKICAgICAgICBwLmR3QXJnMSA9IDEKICAgICAgICBwLmR3QXJnMiA9IDAKICAgICAgICBwOkVuY29kZTQoMCkKICAgICAgICBTZW5kUGFja2V0KHApCiAgICBlbmQpCmVuZAoKLS1bWwoKJ3x8Jyd8LiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8CiB8fCAgIHx8ICAgIC4uLi4gICAgLi4uIC4gIC4uLiAuLi4gIC4uLiAgLi4uIC4uICAgIC4uLi4KIHx8Jyd8JyAgIC58Li4ufHwgLicgICB8fCAgIHx8ICB8fCAgIHx8ICAgfHwnICcnIC58Li4ufHwKIHx8ICAgfC4gIHx8ICAgICAgfC4gICB8fCAgIHx8ICB8fCAgIHx8ICAgfHwgICAgIHx8Ci58fC4gICd8JyAgJ3wuLi4nICd8Li4nfHwgICAnfC4uJ3wuIC58fC4gLnx8LiAgICAgJ3wuLi4nCiAgICAgICAgICAgICAgICAgICAgICAgfHwKICAgICAgICAgICAgICAgICAgICAgICcnJycKCiAgICBSZXF1aXJlIC0gQSBzaW1wbGUgbGlicmFyeSBkb3dubG9hZGVyCgogICAgSW50cm9kdWN0aW9uOgogICAgICAgIElmIHlvdSB3YW50IHRvIHVzZSB0aGlzIGNsYXNzIHlvdSBuZWVkIHRvIHB1dCB0aGlzIGF0IHRoZSBiZWdpbm5pbmcgb2YgeW91IHNjcmlwdC4KICAgICAgICBFeGFtcGxlOgogICAgICAgICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgIGlmIHBsYXllci5jaGFyTmFtZSB+PSAiQnJhbmQiIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICByZXF1aXJlICJTb3VyY2VMaWIiCgogICAgICAgICAgICBsb2NhbCBsaWJEb3dubG9hZGVyID0gUmVxdWlyZSgiQnJhbmQgc2NyaXB0IikKICAgICAgICAgICAgbGliRG93bmxvYWRlcjpBZGQoIlZQcmVkaWN0aW9uIiwgImh0dHBzOi8vYml0YnVja2V0Lm9yZy9ob25kYTcvYm9sL3Jhdy9tYXN0ZXIvQ29tbW9uL1ZQcmVkaWN0aW9uLmx1YSIpCiAgICAgICAgICAgIGxpYkRvd25sb2FkZXI6QWRkKCJTT1ciLCAgICAgICAgICJodHRwczovL2JpdGJ1Y2tldC5vcmcvaG9uZGE3L2JvbC9yYXcvbWFzdGVyL0NvbW1vbi9TT1cubHVhIikKICAgICAgICAgICAgbGliRG93bmxvYWRlcjpDaGVjaygpCgogICAgICAgICAgICBpZiBsaWJEb3dubG9hZGVyLmRvd25sb2FkTmVlZGVkIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgRnVuY3Rpb25zOgogICAgICAgIFJlcXVpcmUobXlOYW1lKQoKICAgIE1lbWJlcnM6CiAgICAgICAgUmVxdWlyZS5kb3dubG9hZE5lZWRlZAoKICAgIE1ldGhvZHM6CiAgICAgICAgUmVxdWlyZTpBZGQobmFtZSwgdXJsKQogICAgICAgIFJlcXVpcmU6Q2hlY2soKQpdXQpjbGFzcyAnUmVxdWlyZScKCmZ1bmN0aW9uIF9fcmVxdWlyZV9hZnRlckRvd25sb2FkKHJlcXVpcmVJbnN0YW5jZSkKCiAgICByZXF1aXJlSW5zdGFuY2UuZG93bmxvYWRDb3VudCA9IHJlcXVpcmVJbnN0YW5jZS5kb3dubG9hZENvdW50IC0gMQogICAgaWYgcmVxdWlyZUluc3RhbmNlLmRvd25sb2FkQ291bnQgPT0gMCB0aGVuCiAgICAgICAgcHJpbnQoIjxmb250IGNvbG9yPVwiIzY2OTlmZlwiPjxiPiIgLi4gcmVxdWlyZUluc3RhbmNlLm15TmFtZSAuLiAiOjwvYj48L2ZvbnQ+IDxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPlJlcXVpcmVkIGxpYnJhcmllcyBkb3dubG9hZGVkISBQbGVhc2UgcmVsb2FkITwvZm9udD4iKQogICAgZW5kCgplbmQKCmZ1bmN0aW9uIFJlcXVpcmU6X19pbml0KG15TmFtZSkKCiAgICBzZWxmLm15TmFtZSA9IG15TmFtZSBvciBHZXRDdXJyZW50RW52KCkuRklMRV9OQU1FCiAgICBzZWxmLmRvd25sb2FkTmVlZGVkID0gZmFsc2UKCiAgICBzZWxmLnJlcXVpcmVtZW50cyA9IHt9CgplbmQKCmZ1bmN0aW9uIFJlcXVpcmU6QWRkKG5hbWUsIHVybCkKCiAgICBhc3NlcnQobmFtZSBhbmQgdHlwZShuYW1lKSA9PSAic3RyaW5nIiBhbmQgdXJsIGFuZCB0eXBlKHVybCkgPT0gInN0cmluZyIsICJSZXF1aXJlOkFkZCgpOiBTb21lIG9yIGFsbCBhcmd1bWVudHMgYXJlIGludmFsaWQuIikKCiAgICBzZWxmLnJlcXVpcmVtZW50c1tuYW1lXSA9IHVybAoKICAgIHJldHVybiBzZWxmCgplbmQKCmZ1bmN0aW9uIFJlcXVpcmU6Q2hlY2soKQoKICAgIGZvciBzY3JpcHROYW1lLCBzY3JpcHRVcmwgaW4gcGFpcnMoc2VsZi5yZXF1aXJlbWVudHMpIGRvCiAgICAgICAgbG9jYWwgc2NyaXB0RmlsZSA9IExJQl9QQVRIIC4uIHNjcmlwdE5hbWUgLi4gIi5sdWEiCiAgICAgICAgaWYgRmlsZUV4aXN0KHNjcmlwdEZpbGUpIHRoZW4KICAgICAgICAgICAgcmVxdWlyZShzY3JpcHROYW1lKQogICAgICAgIGVsc2UKICAgICAgICAgICAgc2VsZi5kb3dubG9hZE5lZWRlZCA9IHRydWUKICAgICAgICAgICAgc2VsZi5kb3dubG9hZENvdW50ID0gc2VsZi5kb3dubG9hZENvdW50IGFuZCBzZWxmLmRvd25sb2FkQ291bnQgKyAxIG9yIDEKICAgICAgICAgICAgRG93bmxvYWRGaWxlKHNjcmlwdFVybCwgc2NyaXB0RmlsZSwgZnVuY3Rpb24oKSBfX3JlcXVpcmVfYWZ0ZXJEb3dubG9hZChzZWxmKSBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICByZXR1cm4gc2VsZgoKZW5kCgoKLS1bWwoKIC58JycnLnwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3x8JyAgJ3wnICAgICAgICAgICAgICAgJ3x8ICAgICAgICAgICAgLgogfHwuLiAgJyAgICAuLi4gICAuLi4gLi4uICAuLi4gLi4gICAgLi4uLiAgICAuLi4uICAgfHwgICAgfCAgLi4uIC4uLiAgICAgLi4gfHwgICAuLi4uICAgLnx8LiAgICAuLi4uICAuLi4gLi4KICAnJ3x8fC4gIC58ICAnfC4gIHx8ICB8fCAgIHx8JyAnJyAufCAgICcnIC58Li4ufHwgIHx8ICAgIHwgICB8fCcgIHx8ICAuJyAgJ3x8ICAnJyAufHwgICB8fCAgIC58Li4ufHwgIHx8JyAnJwouICAgICAnfHwgfHwgICB8fCAgfHwgIHx8ICAgfHwgICAgIHx8ICAgICAgfHwgICAgICAgfHwgICAgfCAgIHx8ICAgIHwgIHwuICAgfHwgIC58JyB8fCAgIHx8ICAgfHwgICAgICAgfHwKfCcuLi4ufCcgICAnfC4ufCcgICd8Li4nfC4gLnx8LiAgICAgJ3wuLi4nICAnfC4uLicgICAnfC4uJyAgICB8fC4uLicgICAnfC4uJ3x8LiAnfC4uJ3wnICAnfC4nICAnfC4uLicgLnx8LgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJycnCgoKICAgIFNvdXJjZVVwZGF0ZXIgLSBhIHNpbXBsZSB1cGRhdGVyIGNsYXNzCgogICAgSW50cm9kdWN0aW9uOgogICAgICAgIFNjcmlwdHMgdGhhdCB3YW50IHRvIHVzZSB0aGlzIGNsYXNzIG5lZWQgdG8gaGF2ZSBhIHZlcnNpb24gZmllbGQgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgc2NyaXB0LCBsaWtlIHRoaXM6CiAgICAgICAgICAgIGxvY2FsIHZlcnNpb24gPSBZT1VSX1ZFUlNJT04gKFlPVVJfVkVSU0lPTiBjYW4gZWl0aGVyIGJlIGEgc3RyaW5nIGEgYSBudW1lcmljIHZhbHVlISkKICAgICAgICBJdCBkb2VzIG5vdCBuZWVkIHRvIGJlIGV4YWN0bHkgYXQgdGhlIGJlZ2lubmluZywgbGlrZSBpbiB0aGlzIHNjcmlwdCwgYnV0IGl0IGhhcyB0byBiZSB3aXRoaW4gdGhlIGZpcnN0IDEwMAogICAgICAgIGNoYXJzIG9mIHRoZSBmaWxlLCBvdGhlcndpc2UgdGhlIHdlYnJlc3VsdCB3b24ndCBzZWUgdGhlIGZpZWxkLCBhcyBpdCBnYXRoZXJzIG9ubHkgYWJvdXQgMTAwIGNoYXJzCgogICAgRnVuY3Rpb25zOgogICAgICAgIFNvdXJjZVVwZGF0ZXIoc2NyaXB0TmFtZSwgdmVyc2lvbiwgaG9zdCwgdXBkYXRlUGF0aCwgZmlsZVBhdGgsIHZlcnNpb25QYXRoKQoKICAgIE1lbWJlcnM6CiAgICAgICAgU291cmNlVXBkYXRlci5zaWxlbnQgfCBib29sIHwgRGVmaW5lcyB3aGVhdGhlciB0byBwcmludCBub3RpZmljYXRpb25zIG9yIG5vdAoKICAgIE1ldGhvZHM6CiAgICAgICAgU291cmNlVXBkYXRlcjpTZXRTaWxlbnQoc2lsZW50KQogICAgICAgIFNvdXJjZVVwZGF0ZXI6Q2hlY2tVcGRhdGUoKQoKXV0KY2xhc3MgJ1NvdXJjZVVwZGF0ZXInCgotLVtbCiAgICBDcmVhdGUgYSBuZXcgaW5zdGFuY2Ugb2YgU291cmNlVXBkYXRlcgoKICAgIEBwYXJhbSBzY3JpcHROYW1lICB8IHN0cmluZyAgICAgICAgfCBOYW1lIG9mIHRoZSBzY3JpcHQgd2hpY2ggc2hvdWxkIGJlIHVzZWQgd2hlbiBwcmludGVkIGluIGNoYXQKICAgIEBwYXJhbSB2ZXJzaW9uICAgICB8IGZsb2F0L3N0cmluZyAgfCBDdXJyZW50IHZlcnNpb24gb2YgdGhlIHNjcmlwdAogICAgQHBhcmFtIGhvc3QgICAgICAgIHwgc3RyaW5nICAgICAgICB8IEhvc3QsIGZvciBleGFtcGxlICJiaXRidWNrZXQub3JnIiBvciAicmF3LmdpdGh1Yi5jb20iCiAgICBAcGFyYW0gdXBkYXRlUGF0aCAgfCBzdHJpbmcgICAgICAgIHwgUmF3IHBhdGggdG8gdGhlIHNjcmlwdCB3aGljaCBzaG91bGQgYmUgdXBkYXRlZAogICAgQHBhcmFtIGZpbGVQYXRoICAgIHwgc3RyaW5nICAgICAgICB8IFBhdGggdG8gdGhlIGZpbGUgd2hpY2ggc2hvdWxkIGJlIHJlcGxhY2VkIHdoZW4gdXBkYXRpbmcgdGhlIHNjcmlwdAogICAgQHBhcmFtIHZlcnNpb25QYXRoIHwgc3RyaW5nICAgICAgICB8IChvcHRpb25hbCkgUGF0aCB0byBhIHZlcnNpb24gZmlsZSB0byBjaGVjayBhZ2FpbnN0LiBUaGUgdmVyc2lvbiBmaWxlIG1heSBvbmx5IGNvbnRhaW4gdGhlIHZlcnNpb24uCl1dCmZ1bmN0aW9uIFNvdXJjZVVwZGF0ZXI6X19pbml0KHNjcmlwdE5hbWUsIHZlcnNpb24sIGhvc3QsIHVwZGF0ZVBhdGgsIGZpbGVQYXRoLCB2ZXJzaW9uUGF0aCkKCiAgICBzZWxmLnByaW50TWVzc2FnZSA9IGZ1bmN0aW9uKG1lc3NhZ2UpIGlmIG5vdCBzZWxmLnNpbGVudCB0aGVuIHByaW50KCI8Zm9udCBjb2xvcj1cIiM2Njk5ZmZcIj48Yj4iIC4uIHNlbGYuVVBEQVRFX1NDUklQVF9OQU1FIC4uICI6PC9iPjwvZm9udD4gPGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IiAuLiBtZXNzYWdlIC4uICI8L2ZvbnQ+IikgZW5kIGVuZAogICAgc2VsZi5nZXRWZXJzaW9uID0gZnVuY3Rpb24odmVyc2lvbikgcmV0dXJuIHRvbnVtYmVyKHN0cmluZy5tYXRjaCh2ZXJzaW9uLCAiJWQrJS4/JWQqIikpIGVuZAoKICAgIHNlbGYuVVBEQVRFX1NDUklQVF9OQU1FID0gc2NyaXB0TmFtZQogICAgc2VsZi5VUERBVEVfSE9TVCA9IGhvc3QKICAgIHNlbGYuVVBEQVRFX1BBVEggPSB1cGRhdGVQYXRoIC4uICI/cmFuZD0iLi5tYXRoLnJhbmRvbSgxLDEwMDAwKQogICAgc2VsZi5VUERBVEVfVVJMID0gImh0dHBzOi8vIi4uc2VsZi5VUERBVEVfSE9TVC4uc2VsZi5VUERBVEVfUEFUSAoKICAgIC0tIFVzZWQgZm9yIHZlcnNpb24gZmlsZXMKICAgIHNlbGYuVkVSU0lPTl9QQVRIID0gdmVyc2lvblBhdGggYW5kIHZlcnNpb25QYXRoIC4uICI/cmFuZD0iLi5tYXRoLnJhbmRvbSgxLDEwMDAwKQogICAgc2VsZi5WRVJTSU9OX1VSTCA9IHZlcnNpb25QYXRoIGFuZCAiaHR0cHM6Ly8iLi5zZWxmLlVQREFURV9IT1NULi5zZWxmLlZFUlNJT05fUEFUSAoKICAgIHNlbGYuVVBEQVRFX0ZJTEVfUEFUSCA9IGZpbGVQYXRoCgogICAgc2VsZi5GSUxFX1ZFUlNJT04gPSBzZWxmLmdldFZlcnNpb24odmVyc2lvbikKICAgIHNlbGYuU0VSVkVSX1ZFUlNJT04gPSBuaWwKCiAgICBzZWxmLnNpbGVudCA9IGZhbHNlCgplbmQKCi0tW1sKICAgIEFsbG93cyBvciBkaXNhbGxvd3MgdGhlIHVwZGF0ZXIgdG8gcHJpbnQgaW5mbyBhYm91dCB1cGRhdGluZwoKICAgIEBwYXJhbSAgfCBib29sICAgfCBNZXNzYWdlIG91dHB1dCBvciBub3QKICAgIEByZXR1cm4gfCBjbGFzcyAgfCBUaGUgY3VycmVudCBpbnN0YW5jZQpdXQpmdW5jdGlvbiBTb3VyY2VVcGRhdGVyOlNldFNpbGVudChzaWxlbnQpCgogICAgc2VsZi5zaWxlbnQgPSBzaWxlbnQKICAgIHJldHVybiBzZWxmCgplbmQKCi0tW1sKICAgIENoZWNrIGZvciBhbiB1cGRhdGUgYW5kIGRvd25sb2FkcyBpdCB3aGVuIGF2YWlsYWJsZQpdXQpmdW5jdGlvbiBTb3VyY2VVcGRhdGVyOkNoZWNrVXBkYXRlKCkKCiAgICBsb2NhbCB3ZWJSZXN1bHQgPSBHZXRXZWJSZXN1bHQoc2VsZi5VUERBVEVfSE9TVCwgc2VsZi5WRVJTSU9OX1BBVEggb3Igc2VsZi5VUERBVEVfUEFUSCkKICAgIGlmIHdlYlJlc3VsdCB0aGVuCiAgICAgICAgaWYgc2VsZi5WRVJTSU9OX1BBVEggdGhlbgogICAgICAgICAgICBzZWxmLlNFUlZFUl9WRVJTSU9OID0gd2ViUmVzdWx0CiAgICAgICAgZWxzZQogICAgICAgICAgICBzZWxmLlNFUlZFUl9WRVJTSU9OID0gc3RyaW5nLm1hdGNoKHdlYlJlc3VsdCwgIiVzKmxvY2FsJXMrdmVyc2lvbiVzKz0lcysuKiVkKyUuJWQrIikKICAgICAgICBlbmQKICAgICAgICBpZiBzZWxmLlNFUlZFUl9WRVJTSU9OIHRoZW4KICAgICAgICAgICAgc2VsZi5TRVJWRVJfVkVSU0lPTiA9IHNlbGYuZ2V0VmVyc2lvbihzZWxmLlNFUlZFUl9WRVJTSU9OKQogICAgICAgICAgICBpZiBzZWxmLkZJTEVfVkVSU0lPTiA8IHNlbGYuU0VSVkVSX1ZFUlNJT04gdGhlbgogICAgICAgICAgICAgICAgc2VsZi5wcmludE1lc3NhZ2UoIk5ldyB2ZXJzaW9uIGF2YWlsYWJsZTogdiIgLi4gc2VsZi5TRVJWRVJfVkVSU0lPTikKICAgICAgICAgICAgICAgIHNlbGYucHJpbnRNZXNzYWdlKCJVcGRhdGluZywgcGxlYXNlIGRvbid0IHByZXNzIEY5IikKICAgICAgICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uICgpIERvd25sb2FkRmlsZShzZWxmLlVQREFURV9VUkwsIHNlbGYuVVBEQVRFX0ZJTEVfUEFUSCwgZnVuY3Rpb24gKCkgc2VsZi5wcmludE1lc3NhZ2UoIlN1Y2Nlc3NmdWxseSB1cGRhdGVkLCBwbGVhc2UgcmVsb2FkISIpIGVuZCkgZW5kLCAyKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBzZWxmLnByaW50TWVzc2FnZSgiWW91J3ZlIGdvdCB0aGUgbGF0ZXN0IHZlcnNpb246IHYiIC4uIHNlbGYuU0VSVkVSX1ZFUlNJT04pCiAgICAgICAgICAgIGVuZAogICAgICAgIGVsc2UKICAgICAgICAgICAgc2VsZi5wcmludE1lc3NhZ2UoIlNvbWV0aGluZyB3ZW50IHdyb25nISBQbGVhc2UgbWFudWFsbHkgdXBkYXRlIHRoZSBzY3JpcHQhIikKICAgICAgICBlbmQKICAgIGVsc2UKICAgICAgICBzZWxmLnByaW50TWVzc2FnZSgiRXJyb3IgZG93bmxvYWRpbmcgdmVyc2lvbiBpbmZvISIpCiAgICBlbmQKCmVuZAoKCi0tW1sKCiAufCcnJy58ICAgICAgICAgICAgICAgICAgICd8fCAgJ3x8CiB8fC4uICAnICAuLi4gLi4uICAgIC4uLi4gICB8fCAgIHx8CiAgJyd8fHwuICAgfHwnICB8fCAufC4uLnx8ICB8fCAgIHx8Ci4gICAgICd8fCAgfHwgICAgfCB8fCAgICAgICB8fCAgIHx8CnwnLi4uLnwnICAgfHwuLi4nICAgJ3wuLi4nIC58fC4gLnx8LgogICAgICAgICAgIHx8CiAgICAgICAgICAnJycnCgogICAgU3BlbGwgLSBIYW5kbGVkIHdpdGggZWFzZSEKCiAgICBGdW5jdGlvbnM6CiAgICAgICAgU3BlbGwoc3BlbGxJZCwgcmFuZ2UsIHBhY2tldENhc3QpCgogICAgTWVtYmVyczoKICAgICAgICBTcGVsbC5yYW5nZSAgICAgICAgICB8IGZsb2F0ICB8IFJhbmdlIG9mIHRoZSBzcGVsbCwgcGxlYXNlIGRvIE5PVCBjaGFuZ2UgdGhpcyB2YWx1ZSwgdXNlIFNwZWxsOlNldFJhbmdlKCkgaW5zdGVhZAogICAgICAgIFNwZWxsLnJhbmdlU3FyICAgICAgIHwgZmxvYXQgIHwgU3F1YXJlZCByYW5nZSBvZiB0aGUgc3BlbGwsIHBsZWFzZSBkbyBOT1QgY2hhbmdlIHRoaXMgdmFsdWUsIHVzZSBTcGVsbDpTZXRSYW5nZSgpIGluc3RlYWQKICAgICAgICBTcGVsbC5wYWNrZXRDYXN0ICAgICB8IGJvb2wgICB8IFNldCBwYWNrZXQgY2FzdCBzdGF0ZQogICAgICAgIC0tIFRoaXMgb25seSBhcHBsaWVzIGZvciBza2lsbHNob3RzCiAgICAgICAgU3BlbGwuc291cmNlUG9zaXRpb24gfCB2ZWN0b3IgfCBGcm9tIHdoZXJlIHRoZSBzcGVsbCBpcyBjYXN0ZWQsIGRlZmF1bHQ6IHBsYXllcgogICAgICAgIFNwZWxsLnNvdXJjZVJhbmdlICAgIHwgdmVjdG9yIHwgRnJvbSB3aGVyZSB0aGUgcmFuZ2Ugc2hvdWxkIGJlIGNhbGN1bGF0ZWQsIGRlZmF1bHQ6IHBsYXllcgogICAgICAgIC0tIFRoaXMgb25seSBhcHBsaWVzIGZvciBBT0Ugc2tpbGxzaG90cwogICAgICAgIFNwZWxsLm1pblRhcmdldHNBb2UgIHwgaW50ICAgIHwgU2V0IG1pbmltdW0gdGFyZ2V0cyBmb3IgQU9FIGRhbWFnZQoKICAgIE1ldGhvZHM6CiAgICAgICAgU3BlbGw6U2V0UmFuZ2UocmFuZ2UpCiAgICAgICAgU3BlbGw6U2V0U291cmNlKHNvdXJjZSkKICAgICAgICBTcGVsbDpTZXRTb3VyY2VQb3NpdGlvbihzb3VyY2UpCiAgICAgICAgU3BlbGw6U2V0U291cmNlUmFuZ2Uoc291cmNlKQoKICAgICAgICBTcGVsbDpTZXRTa2lsbHNob3QoVlAsIHNraWxsc2hvdFR5cGUsIHdpZHRoLCBkZWxheSwgc3BlZWQsIGNvbGxpc2lvbikKICAgICAgICBTcGVsbDpTZXRBT0UodXNlQW9lLCByYWRpdXMsIG1pblRhcmdldHNBb2UpCgogICAgICAgIFNwZWxsOlNldENoYXJnZWQoc3BlbGxOYW1lLCBjaGFyZ2VEdXJhdGlvbiwgbWF4UmFuZ2UsIHRpbWVUb01heFJhbmdlLCBhYm9ydENvbmRpdGlvbikKICAgICAgICBTcGVsbDpJc0NoYXJnaW5nKCkKICAgICAgICBTcGVsbDpDaGFyZ2UoKQoKICAgICAgICBTcGVsbDpTZXRIaXRDaGFuY2UoaGl0Q2hhbmNlKQogICAgICAgIFNwZWxsOlZhbGlkVGFyZ2V0KHRhcmdldCkKCiAgICAgICAgU3BlbGw6R2V0UHJlZGljdGlvbih0YXJnZXQpCiAgICAgICAgU3BlbGw6Q2FzdElmRGFzaGluZyh0YXJnZXQpCiAgICAgICAgU3BlbGw6Q2FzdElmSW1tb2JpbGUodGFyZ2V0KQogICAgICAgIFNwZWxsOkNhc3QocGFyYW0xLCBwYXJhbTIpCgogICAgICAgIFNwZWxsOkFkZEF1dG9tYXRpb24oYXV0b21hdGlvbklkLCBmdW5jKQogICAgICAgIFNwZWxsOlJlbW92ZUF1dG9tYXRpb24oYXV0b21hdGlvbklkKQogICAgICAgIFNwZWxsOkNsZWFyQXV0b21hdGlvbnMoKQoKICAgICAgICBTcGVsbDpUcmFja0Nhc3Rpbmcoc3BlbGxOYW1lKQogICAgICAgIFNwZWxsOldpbGxIaXRUYXJnZXQoKQogICAgICAgIFNwZWxsOlJlZ2lzdGVyQ2FzdENhbGxiYWNrKGZ1bmMpCgogICAgICAgIFNwZWxsOkdldExhc3RDYXN0VGltZSgpCgogICAgICAgIFNwZWxsOklzSW5SYW5nZSh0YXJnZXQsIGZyb20pCiAgICAgICAgU3BlbGw6SXNSZWFkeSgpCiAgICAgICAgU3BlbGw6R2V0TWFuYVVzYWdlKCkKICAgICAgICBTcGVsbDpHZXRDb29sZG93bigpCiAgICAgICAgU3BlbGw6R2V0TGV2ZWwoKQogICAgICAgIFNwZWxsOkdldE5hbWUoKQoKXV0KY2xhc3MgJ1NwZWxsJwoKLS0gQ2xhc3MgcmVsYXRlZCBjb25zdGFudHMKU0tJTExTSE9UX0xJTkVBUiAgID0gMApTS0lMTFNIT1RfQ0lSQ1VMQVIgPSAxClNLSUxMU0hPVF9DT05FICAgICA9IDIKCi0tIERpZmZlcmVudCBTcGVsbFN0YXRlcyByZXR1cm5lZCB3aGVuIFNwZWxsOkNhc3QoKSBpcyBjYWxsZWQKU1BFTExTVEFURV9UUklHR0VSRUQgICAgICAgICAgPSAwClNQRUxMU1RBVEVfT1VUX09GX1JBTkdFICAgICAgID0gMQpTUEVMTFNUQVRFX0xPV0VSX0hJVENIQU5DRSAgICA9IDIKU1BFTExTVEFURV9DT0xMSVNJT04gICAgICAgICAgPSAzClNQRUxMU1RBVEVfTk9UX0VOT1VHSF9UQVJHRVRTID0gNApTUEVMTFNUQVRFX05PVF9EQVNISU5HICAgICAgICA9IDUKU1BFTExTVEFURV9EQVNISU5HX0NBTlRfSElUICAgPSA2ClNQRUxMU1RBVEVfTk9UX0lNTU9CSUxFICAgICAgID0gNwpTUEVMTFNUQVRFX0lOVkFMSURfVEFSR0VUICAgICA9IDgKU1BFTExTVEFURV9OT1RfVFJJR0dFUkVEICAgICAgPSA5CgotLSBTcGVsbCBpZGVudGlmaWVyIG51bWJlciB1c2VkIGZvciBjb21wYXJpbmcgc3BlbGxzCmxvY2FsIHNwZWxsTnVtID0gMQoKLS1bWwogICAgTmV3IGluc3RhbmNlIG9mIFNwZWxsCgogICAgQHBhcmFtIHNwZWxsSWQgICAgfCBpbnQgICB8IFNwZWxsIElEIChfUSwgX1csIF9FLCBfUikKICAgIEBwYXJhbSByYW5nZSAgICAgIHwgZmxvYXQgfCBSYW5nZSBvZiB0aGUgc3BlbGwKICAgIEBwYXJhbSBwYWNrZXRDYXN0IHwgYm9vbCAgfCAob3B0aW9uYWwpIEVuYWJsZSBwYWNrZXQgY2FzdGluZwpdXQpmdW5jdGlvbiBTcGVsbDpfX2luaXQoc3BlbGxJZCwgcmFuZ2UsIHBhY2tldENhc3QpCgogICAgYXNzZXJ0KHNwZWxsSWQgfj0gbmlsIGFuZCByYW5nZSB+PSBuaWwgYW5kIHR5cGUoc3BlbGxJZCkgPT0gIm51bWJlciIgYW5kIHR5cGUocmFuZ2UpID09ICJudW1iZXIiLCAiU3BlbGw6IENhbid0IGluaXRpYWxpemUgU3BlbGwgd2l0aG91dCB2YWxpZCBhcmd1bWVudHMuIikKCiAgICBzZWxmLnNwZWxsSWQgPSBzcGVsbElkCiAgICBzZWxmOlNldFJhbmdlKHJhbmdlKQogICAgc2VsZi5wYWNrZXRDYXN0ID0gcGFja2V0Q2FzdCBvciBmYWxzZQoKICAgIHNlbGY6U2V0U291cmNlKHBsYXllcikKCiAgICBzZWxmLl9hdXRvbWF0aW9ucyA9IHt9CgogICAgc2VsZi5fc3BlbGxOdW0gPSBzcGVsbE51bQogICAgc3BlbGxOdW0gPSBzcGVsbE51bSArIDEKCmVuZAoKLS1bWwogICAgVXBkYXRlIHRoZSBzcGVsbCByYW5nZSB3aXRoIHRoZSBuZXcgZ2l2ZW4gdmFsdWUKCiAgICBAcGFyYW0gcmFuZ2UgfCBmbG9hdCB8IFJhbmdlIG9mIHRoZSBzcGVsbAogICAgQHJldHVybiAgICAgIHwgY2xhc3MgfCBUaGUgY3VycmVudCBpbnN0YW5jZQpdXQpmdW5jdGlvbiBTcGVsbDpTZXRSYW5nZShyYW5nZSkKCiAgICBhc3NlcnQocmFuZ2UgYW5kIHR5cGUocmFuZ2UpID09ICJudW1iZXIiLCAiU3BlbGw6IHJhbmdlIGlzIGludmFsaWQiKQoKICAgIHNlbGYucmFuZ2UgPSByYW5nZQogICAgc2VsZi5yYW5nZVNxciA9IG1hdGgucG93KHJhbmdlLCAyKQoKICAgIHJldHVybiBzZWxmCgplbmQKCi0tW1sKICAgIFVwZGF0ZSBib3RoIHRoZSBzb3VyY2VQb3NpdGlvbiBhbmQgc291cmNlUmFuZ2UgZnJvbSB3aGVyZSBldmVyeXRoaW5nIHdpbGwgYmUgY2FsY3VsYXRlZAoKICAgIEBwYXJhbSBzb3VyY2UgfCBDdW5pdCB8IFNvdXJjZSBwb3NpdGlvbiwgZm9yIGV4YW1wbGUgcGxheWVyCiAgICBAcmV0dXJuICAgICAgIHwgY2xhc3MgfCBUaGUgY3VycmVudCBpbnN0YW5jZQpdXQpmdW5jdGlvbiBTcGVsbDpTZXRTb3VyY2Uoc291cmNlKQoKICAgIGFzc2VydChzb3VyY2UsICJTcGVsbDogc291cmNlIGNhbid0IGJlIG5pbCEiKQoKICAgIHNlbGYuc291cmNlUG9zaXRpb24gPSBzb3VyY2UKICAgIHNlbGYuc291cmNlUmFuZ2UgICAgPSBzb3VyY2UKCiAgICByZXR1cm4gc2VsZgoKZW5kCgotLVtbCiAgICBVcGRhdGUgdGhlIHNvdXJjZSBwb3NvdGlvbiBmcm9tIHdoZXJlIHRoZSBzcGVsbCB3aWxsIGJlIHNob3QKCiAgICBAcGFyYW0gc291cmNlIHwgQ3VuaXQgfCBTb3VyY2UgcG9zaXRpb24gZnJvbSB3aGVyZSB0aGUgc3BlbGwgd2lsbCBiZSBzaG90LCBwbGF5ZXIgYnkgZGVmYXVsdAogICAgQCByZXR1cm4gICAgICB8IGNsYXNzIHwgVGhlIGN1cnJlbnQgaW5zdGFuY2UKXV0KZnVuY3Rpb24gU3BlbGw6U2V0U291cmNlUG9zaXRpb24oc291cmNlKQoKICAgIGFzc2VydChzb3VyY2UsICJTcGVsbDogc291cmNlIGNhbid0IGJlIG5pbCEiKQoKICAgIHNlbGYuc291cmNlUG9zaXRpb24gPSBzb3VyY2UKCiAgICByZXR1cm4gc2VsZgoKZW5kCgotLVtbCiAgICBVcGRhdGUgdGhlIHNvdXJjZSB1bml0IGZyb20gd2hlcmUgdGhlIHJhbmdlIHdpbGwgYmUgY2FsY3VsYXRlZAoKICAgIEBwYXJhbSBzb3VyY2UgfCBDdW5pdCB8IFNvdXJjZSBvYmplY3QgdW5pdCBmcm9tIHdoZXJlIHRoZSByYW5nZSBzaG91bGQgYmUgY2FsY3VsZWQKICAgIEByZXR1cm4gICAgICAgfCBjbGFzcyB8IFRoZSBjdXJyZW50IGluc3RhbmNlCl1dCmZ1bmN0aW9uIFNwZWxsOlNldFNvdXJjZVJhbmdlKHNvdXJjZSkKCiAgICBhc3NlcnQoc291cmNlLCAiU3BlbGw6IHNvdXJjZSBjYW4ndCBiZSBuaWwhIikKCiAgICBzZWxmLnNvdXJjZVJhbmdlID0gc291cmNlCgogICAgcmV0dXJuIHNlbGYKCmVuZAoKLS1bWwogICAgRGVmaW5lIHRoaXMgc3BlbGwgYXMgc2tpbGxzaG90IChjYW4ndCBiZSByZXZlcnNlZCkKCiAgICBAcGFyYW0gVlAgICAgICAgICAgICB8IGNsYXNzIHwgSW5zdGFuY2Ugb2YgVlByZWRpY3Rpb24KICAgIEBwYXJhbSBza2lsbHNob3RUeXBlIHwgaW50ICAgfCBUeXBlIG9mIHRoaXMgc2tpbGxzaG90CiAgICBAcGFyYW0gd2lkdGggICAgICAgICB8IGZsb2F0IHwgV2lkdGggb2YgdGhlIHNraWxsc2hvdAogICAgQHBhcmFtIGRlbGF5ICAgICAgICAgfCBmbG9hdCB8IChvcHRpb25hbCkgRGVsYXkgaW4gc2Vjb25kcwogICAgQHBhcmFtIHNwZWVkICAgICAgICAgfCBmbG9hdCB8IChvcHRpb25hbCkgU3BlZWQgaW4gdW5pdHMgcGVyIHNlY29uZAogICAgQHBhcmFtIGNvbGxpc2lvbiAgICAgfCBib29sICB8IChvcHRpb25hbCkgUmVzcGVjdCB1bml0IGNvbGxpc2lvbiB3aGVuIGNhc3RpbmcKICAgIEByZXJ1cm4gICAgICAgICAgICAgIHwgY2xhc3MgfCBUaGUgY3VycmVudCBpbnN0YW5jZQpdXQpmdW5jdGlvbiBTcGVsbDpTZXRTa2lsbHNob3QoVlAsIHNraWxsc2hvdFR5cGUsIHdpZHRoLCBkZWxheSwgc3BlZWQsIGNvbGxpc2lvbikKCiAgICBhc3NlcnQoc2tpbGxzaG90VHlwZSB+PSBuaWwsICJTcGVsbDogTmVlZCBhdCBsZWFzdCB0aGUgc2tpbGxzaG90IHR5cGUhIikKCiAgICBzZWxmLlZQID0gVlAKICAgIHNlbGYuc2tpbGxzaG90VHlwZSA9IHNraWxsc2hvdFR5cGUKICAgIHNlbGYud2lkdGggPSB3aWR0aCBvciAwCiAgICBzZWxmLmRlbGF5ID0gZGVsYXkgb3IgMAogICAgc2VsZi5zcGVlZCA9IHNwZWVkCiAgICBzZWxmLmNvbGxpc2lvbiA9IGNvbGxpc2lvbgoKICAgIGlmIG5vdCBzZWxmLmhpdENoYW5jZSB0aGVuIHNlbGYuaGl0Q2hhbmNlID0gMiBlbmQKCiAgICByZXR1cm4gc2VsZgoKZW5kCgotLVtbCiAgICBTZXQgdGhlIEFPRSBzdGF0dXMgb2YgdGhpcyBzcGVsbCwgdGhpcyBjYW4gYmUgY2hhbmdlZCBsYXRlcgoKICAgIEBwYXJhbSB1c2VBb2UgICAgICAgIHwgYm9vbCAgfCBOZXcgQU9FIHN0YXRlCiAgICBAcGFyYW0gcmFkaXVzICAgICAgICB8IGZsb2F0IHwgUmFkaXVzIG9mIHRoZSBBT0UgZGFtYWdlCiAgICBAcGFyYW0gbWluVGFyZ2V0c0FvZSB8IGludCAgIHwgTWluaW11bSB0YXJnZXRzIHRvIGJlIGhpdHRlZCBieSB0aGUgQU9FIGRhbWFnZQogICAgQHJlcnVybiAgICAgICAgICAgICAgfCBjbGFzcyB8IFRoZSBjdXJyZW50IGluc3RhbmNlCl1dCmZ1bmN0aW9uIFNwZWxsOlNldEFPRSh1c2VBb2UsIHJhZGl1cywgbWluVGFyZ2V0c0FvZSkKCiAgICBzZWxmLnVzZUFvZSA9IHVzZUFvZSBvciBmYWxzZQogICAgc2VsZi5yYWRpdXMgPSByYWRpdXMgb3Igc2VsZi53aWR0aAogICAgc2VsZi5taW5UYXJnZXRzQW9lID0gbWluVGFyZ2V0c0FvZSBvciAwCgogICAgcmV0dXJuIHNlbGYKCmVuZAoKLS1bWwogICAgRGVmaW5lIHRoaXMgc3BlbGwgYXMgY2hhcmdlZCBzcGVsbAoKICAgIEBwYXJhbSBzcGVsbE5hbWUgICAgICB8IHN0cmluZyAgIHwgTmFtZSBvZiB0aGUgc3BlbGwsIGV4YW1wbGU6IFZhcnVzUQogICAgQHBhcmFtIGNoYXJnZUR1cmF0aW9uIHwgZmxvYXQgICAgfCBTZWNvbmRzIG9mIHRoZSBzcGVsbCB0byBjaGFyZ2UsIGFmdGVyIHRoZSB0aW1lIHRoZSBjaGFyZ2UgZXhwaXJlcwogICAgQHBhcmFtIG1heFJhZ2UgICAgICAgIHwgZmxvYXQgICAgfCBNYXggcmFuZ2UgdGhlIHNwZWxsIHdpbGwgaGF2ZSBhZnRlciBmdWxseSBjaGFyZ2luZwogICAgQHBhcmFtIHRpbWVUb01heFJhbmdlIHwgZmxvYXQgICAgfCBUaW1lIGluIHNlY29uZHMgdG8gcmVhY2ggbWF4IHJhbmdlIGFmdGVyIGNhc3RpbmcgdGhlIHNwZWxsCiAgICBAcGFyYW0gYWJvcnRDb25kaXRpb24gfCBmdW5jdGlvbiB8IChvcHRpb25hbCkgQSBmdW5jdGlvbiB3aGljaCByZXR1cm5zIHRydWUgd2hlbiB0aGUgY2hhcmdlIHByb2Nlc3Mgc2hvdWxkIGJlIHN0b3BwZWQuCl1dCmZ1bmN0aW9uIFNwZWxsOlNldENoYXJnZWQoc3BlbGxOYW1lLCBjaGFyZ2VEdXJhdGlvbiwgbWF4UmFuZ2UsIHRpbWVUb01heFJhbmdlLCBhYm9ydENvbmRpdGlvbikKCiAgICBhc3NlcnQoc2VsZi5za2lsbHNob3RUeXBlLCAiU3BlbGw6U2V0Q2hhcmdlZCgpOiBPbmx5IHNraWxsc2hvdHMgY2FuIGJlIGRlZmluZWQgYXMgY2hhcmdlZCBzcGVsbHMhIikKICAgIGFzc2VydChzcGVsbE5hbWUgYW5kIHR5cGUoc3BlbGxOYW1lKSA9PSAic3RyaW5nIiBhbmQgY2hhcmdlRHVyYXRpb24gYW5kIHR5cGUoY2hhcmdlRHVyYXRpb24pID09ICJudW1iZXIiLCAiU3BlbGw6U2V0Q2hhcmdlZCgpOiBTb21lIG9yIGFsbCBhcmd1bWVudHMgYXJlIGludmFsaWQhIikKICAgIGFzc2VydChzZWxmLl9fY2hhcmdlZCA9PSBuaWwsICJTcGVsbDpTZXRDaGFyZ2VkKCk6IEFscmVhZHkgbWFya2VkIGFzIGNoYXJnZWQgc3BlbGwhIikKCiAgICBzZWxmLl9fY2hhcmdlZCAgICAgICAgICAgPSB0cnVlCiAgICBzZWxmLl9fY2hhcmdlZF9hYm9ydGVkICAgPSB0cnVlCiAgICBzZWxmLl9fY2hhcmdlZF9zcGVsbE5hbWUgPSBzcGVsbE5hbWUKICAgIHNlbGYuX19jaGFyZ2VkX2R1cmF0aW9uICA9IGNoYXJnZUR1cmF0aW9uCgogICAgc2VsZi5fX2NoYXJnZWRfbWF4UmFuZ2UgICAgICAgPSBtYXhSYW5nZQogICAgc2VsZi5fX2NoYXJnZWRfY2hhcmdlVGltZSAgICAgPSB0aW1lVG9NYXhSYW5nZQogICAgc2VsZi5fX2NoYXJnZWRfYWJvcnRDb25kaXRpb24gPSBhYm9ydENvbmRpdGlvbiBvciBmdW5jdGlvbiAoKSByZXR1cm4gZmFsc2UgZW5kCgogICAgc2VsZi5fX2NoYXJnZWRfYWN0aXZlICAgPSBmYWxzZQogICAgc2VsZi5fX2NoYXJnZWRfY2FzdFRpbWUgPSAwCgogICAgLS0gUmVnaXN0ZXIgY2FsbGJhY2tzCiAgICBpZiBub3Qgc2VsZi5fX3RpY2tDYWxsYmFjayB0aGVuCiAgICAgICAgQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpPblRpY2soKSBlbmQpCiAgICAgICAgc2VsZi5fX3RpY2tDYWxsYmFjayA9IHRydWUKICAgIGVuZAoKICAgIGlmIG5vdCBzZWxmLl9fc2VuZFBhY2tldENhbGxiYWNrIHRoZW4KICAgICAgICBBZGRTZW5kUGFja2V0Q2FsbGJhY2soZnVuY3Rpb24ocCkgc2VsZjpPblNlbmRQYWNrZXQocCkgZW5kKQogICAgICAgIHNlbGYuX19zZW5kUGFja2V0Q2FsbGJhY2sgPSB0cnVlCiAgICBlbmQKCiAgICBpZiBub3Qgc2VsZi5fX3Byb2Nlc3NTcGVsbENhbGxiYWNrIHRoZW4KICAgICAgICBBZGRQcm9jZXNzU3BlbGxDYWxsYmFjayhmdW5jdGlvbih1bml0LCBzcGVsbCkgc2VsZjpPblByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQogICAgICAgIHNlbGYuX19wcm9jZXNzU3BlbGxDYWxsYmFjayA9IHRydWUKICAgIGVuZAoKICAgIHJldHVybiBzZWxmCgplbmQKCi0tW1sKICAgIFJldHVybnMgd2hldGhlciB0aGUgc3BlbGwgaXMgY3VycmVudGx5IGNoYXJnaW5nIG9yIG5vdAoKICAgIEByZXR1cm4gfCBib29sIHwgU3BlbGwgY2hhcmdpbmcgb3Igbm90Cl1dCmZ1bmN0aW9uIFNwZWxsOklzQ2hhcmdpbmcoKQogICAgcmV0dXJuIHNlbGYuX19jaGFyZ2VkX2Fib3J0Q29uZGl0aW9uKCkgPT0gZmFsc2UgYW5kIHNlbGYuX19jaGFyZ2VkX2FjdGl2ZQplbmQKCi0tW1sKICAgIENoYXJnZXMgdGhlIHNwZWxsCl1dCmZ1bmN0aW9uIFNwZWxsOkNoYXJnZSgpCgogICAgYXNzZXJ0KHNlbGYuX19jaGFyZ2VkLCAiU3BlbGw6Q2hhcmdlKCk6IFNwZWxsIGlzIG5vdCBkZWZpbmVkIGFzIGNoYXJnZWFibGUgc3BlbGwhIikKCiAgICBpZiBub3Qgc2VsZjpJc0NoYXJnaW5nKCkgdGhlbgogICAgICAgIFBhY2tldCgiU19DQVNUIiwge3NwZWxsSWQgPSBzZWxmLnNwZWxsSWR9KTpzZW5kKCkKICAgIGVuZAoKZW5kCgotLSBJbnRlcm5hbCBmdW5jdGlvbiwgZG8gbm90IHVzZSEKZnVuY3Rpb24gU3BlbGw6X0Fib3J0Q2hhcmdlKCkKICAgIGlmIHNlbGYuX19jaGFyZ2VkIGFuZCBzZWxmLl9fY2hhcmdlZF9hY3RpdmUgdGhlbgogICAgICAgIHNlbGYuX19jaGFyZ2VkX2Fib3J0ZWQgPSB0cnVlCiAgICAgICAgc2VsZi5fX2NoYXJnZWRfYWN0aXZlICA9IGZhbHNlCiAgICAgICAgc2VsZjpTZXRSYW5nZShzZWxmLl9fY2hhcmdlZF9pbml0aWFsUmFuZ2UpCiAgICBlbmQKZW5kCgotLVtbCiAgICBTZXQgdGhlIGhpdENoYW5jZSBvZiB0aGUgcHJlZGljdGVkIHRhcmdldCBwb3NpdGlvbiB3aGVuIHRvIGNhc3QKCiAgICBAcGFyYW0gaGl0Q2hhbmNlIHwgaW50ICAgfCBOZXcgaGl0Q2hhbmNlIGZvciBwcmVkaWN0ZWQgcG9zaXRpb25zCiAgICBAcmVydXJuICAgICAgICAgIHwgY2xhc3MgfCBUaGUgY3VycmVudCBpbnN0YW5jZQpdXQpmdW5jdGlvbiBTcGVsbDpTZXRIaXRDaGFuY2UoaGl0Q2hhbmNlKQoKICAgIHNlbGYuaGl0Q2hhbmNlID0gaGl0Q2hhbmNlIG9yIDIKCiAgICByZXR1cm4gc2VsZgoKZW5kCgotLVtbCiAgICBDaGVja3MgaWYgdGhlIGdpdmVuIHRhcmdldCBpcyB2YWxpZCBmb3IgdGhlIHNwZWxsCgogICAgQHBhcmFtIHRhcmdldCB8IHVzZXJkYXRhIHwgVGFyZ2V0IHRvIGJlIGNoZWNrZWQgaWYgdmFsaWQKICAgIEByZXR1cm4gICAgICAgfCBib29sICAgICB8IFZhbGlkIHRhcmdldCBvciBub3QKXV0KZnVuY3Rpb24gU3BlbGw6VmFsaWRUYXJnZXQodGFyZ2V0LCByYW5nZSkKCiAgICByZXR1cm4gVmFsaWRUYXJnZXQodGFyZ2V0LCByYW5nZSBvciBzZWxmLnJhbmdlKQoKZW5kCgotLVtbCiAgICBSZXR1cm5zIHRoZSBwcmVkaWN0aW9uIHJlc3VsdHMgZnJvbSBWUHJlZGljdGlvbiB0byB1c2UgZm9yIGN1c3RvbSByZWFzb25zCgogICAgQHJldHVybiB8IHZhcmlvdXMgZGF0YSB8IFRoZSBvcmlnaW5hbCByZXN1bHQgZnJvbSBWUHJlZGljdGlvbgpdXQpmdW5jdGlvbiBTcGVsbDpHZXRQcmVkaWN0aW9uKHRhcmdldCkKCiAgICBpZiBzZWxmLnNraWxsc2hvdFR5cGUgfj0gbmlsIHRoZW4KICAgICAgICBpZiBzZWxmLnNraWxsc2hvdFR5cGUgPT0gU0tJTExTSE9UX0xJTkVBUiB0aGVuCiAgICAgICAgICAgIGlmIHNlbGYudXNlQW9lIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLlZQOkdldExpbmVBT0VDYXN0UG9zaXRpb24odGFyZ2V0LCBzZWxmLmRlbGF5LCBzZWxmLnJhZGl1cywgc2VsZi5yYW5nZSwgc2VsZi5zcGVlZCwgc2VsZi5zb3VyY2VQb3NpdGlvbikKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuVlA6R2V0TGluZUNhc3RQb3NpdGlvbih0YXJnZXQsIHNlbGYuZGVsYXksIHNlbGYud2lkdGgsIHNlbGYucmFuZ2UsIHNlbGYuc3BlZWQsIHNlbGYuc291cmNlUG9zaXRpb24sIHNlbGYuY29sbGlzaW9uKQogICAgICAgICAgICBlbmQKICAgICAgICBlbHNlaWYgc2VsZi5za2lsbHNob3RUeXBlID09IFNLSUxMU0hPVF9DSVJDVUxBUiB0aGVuCiAgICAgICAgICAgIGlmIHNlbGYudXNlQW9lIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLlZQOkdldENpcmN1bGFyQU9FQ2FzdFBvc2l0aW9uKHRhcmdldCwgc2VsZi5kZWxheSwgc2VsZi5yYWRpdXMsIHNlbGYucmFuZ2UsIHNlbGYuc3BlZWQsIHNlbGYuc291cmNlUG9zaXRpb24pCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLlZQOkdldENpcmN1bGFyQ2FzdFBvc2l0aW9uKHRhcmdldCwgc2VsZi5kZWxheSwgc2VsZi53aWR0aCwgc2VsZi5yYW5nZSwgc2VsZi5zcGVlZCwgc2VsZi5zb3VyY2VQb3NpdGlvbiwgc2VsZi5jb2xsaXNpb24pCiAgICAgICAgICAgIGVuZAogICAgICAgICBlbHNlaWYgc2VsZi5za2lsbHNob3RUeXBlID09IFNLSUxMU0hPVF9DT05FIHRoZW4KICAgICAgICAgICAgaWYgc2VsZi51c2VBb2UgdGhlbgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuVlA6R2V0Q29uZUFPRUNhc3RQb3NpdGlvbih0YXJnZXQsIHNlbGYuZGVsYXksIHNlbGYucmFkaXVzLCBzZWxmLnJhbmdlLCBzZWxmLnNwZWVkLCBzZWxmLnNvdXJjZVBvc2l0aW9uKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5WUDpHZXRMaW5lQ2FzdFBvc2l0aW9uKHRhcmdldCwgc2VsZi5kZWxheSwgc2VsZi53aWR0aCwgc2VsZi5yYW5nZSwgc2VsZi5zcGVlZCwgc2VsZi5zb3VyY2VQb3NpdGlvbiwgc2VsZi5jb2xsaXNpb24pCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgplbmQKCi0tW1sKICAgIFRyaWVzIHRvIGNhc3QgdGhlIHNwZWxsIHdoZW4gdGhlIHRhcmdldCBpcyBkYXNoaW5nCgogICAgQHBhcmFtIHRhcmdldCB8IEN1bml0IHwgRGFzaGluZyB0YXJnZXQgdG8gYXR0YWNrCiAgICBAcGFyYW0gcmV0dXJuIHwgaW50ICAgfCBTcGVsbFN0YXRlIG9mIHRoZSBjdXJyZW50IHNwZWxsCl1dCmZ1bmN0aW9uIFNwZWxsOkNhc3RJZkRhc2hpbmcodGFyZ2V0KQoKICAgIC0tIERvbid0IGNhbGN1bGF0ZSBzdHVmZiB3aGVuIHRhcmdldCBpcyBpbnZhbGlkCiAgICBpZiBub3QgVmFsaWRUYXJnZXQodGFyZ2V0KSB0aGVuIHJldHVybiBTUEVMTFNUQVRFX0lOVkFMSURfVEFSR0VUIGVuZAoKICAgIGlmIHNlbGYuc2tpbGxzaG90VHlwZSB+PSBuaWwgdGhlbgogICAgICAgIGxvY2FsIGlzRGFzaGluZywgY2FuSGl0LCBwb3NpdGlvbiA9IHNlbGYuVlA6SXNEYXNoaW5nKHRhcmdldCwgc2VsZi5kZWxheSArIDAuMDcgKyBHZXRMYXRlbmN5KCkgLyAyMDAwLCBzZWxmLndpZHRoLCBzZWxmLnNwZWVkLCBzZWxmLnNvdXJjZVBvc2l0aW9uKQoKICAgICAgICAtLSBPdXQgb2YgcmFuZ2UKICAgICAgICBpZiBzZWxmLnJhbmdlU3FyIDwgX0dldERpc3RhbmNlU3FyKHNlbGYuc291cmNlUmFuZ2UsIHBvc2l0aW9uKSB0aGVuIHJldHVybiBTUEVMTFNUQVRFX09VVF9PRl9SQU5HRSBlbmQKCiAgICAgICAgaWYgaXNEYXNoaW5nIGFuZCBjYW5IaXQgdGhlbgoKICAgICAgICAgICAgLS0gQ29sbGlzaW9uCiAgICAgICAgICAgIGlmIG5vdCBzZWxmLmNvbGxpc2lvbiBvciBzZWxmLmNvbGxpc2lvbiBhbmQgbm90IHNlbGYuVlA6Q2hlY2tNaW5pb25Db2xsaXNpb24odGFyZ2V0LCBwb3NpdGlvbiwgc2VsZi5kZWxheSArIDAuMDcgKyBHZXRMYXRlbmN5KCkgLyAyMDAwLCBzZWxmLndpZHRoLCBzZWxmLnJhbmdlLCBzZWxmLnNwZWVkLCBzZWxmLnNvdXJjZVBvc2l0aW9uLCBmYWxzZSwgdHJ1ZSkgdGhlbgogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGY6X19DYXN0KHNlbGYuc3BlbGxJZCwgcG9zaXRpb24ueCwgcG9zaXRpb24ueikKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcmV0dXJuIFNQRUxMU1RBVEVfQ09MTElTSU9OCiAgICAgICAgICAgIGVuZAoKICAgICAgICBlbHNlaWYgbm90IGlzRGFzaGluZyB0aGVuIHJldHVybiBTUEVMTFNUQVRFX05PVF9EQVNISU5HCiAgICAgICAgZWxzZSByZXR1cm4gU1BFTExTVEFURV9EQVNISU5HX0NBTlRfSElUIGVuZAogICAgZWxzZQogICAgICAgIGxvY2FsIGlzRGFzaGluZywgY2FuSGl0LCBwb3NpdGlvbiA9IHNlbGYuVlA6SXNEYXNoaW5nKHRhcmdldCwgMC4yNSArIDAuMDcgKyBHZXRMYXRlbmN5KCkgLyAyMDAwLCAxLCBtYXRoLmh1Z2UsIHNlbGYuc291cmNlUG9zaXRpb24pCgogICAgICAgIC0tIE91dCBvZiByYW5nZQogICAgICAgIGlmIHNlbGYucmFuZ2VTcXIgPCBfR2V0RGlzdGFuY2VTcXIoc2VsZi5zb3VyY2VSYW5nZSwgcG9zaXRpb24pIHRoZW4gcmV0dXJuIFNQRUxMU1RBVEVfT1VUX09GX1JBTkdFIGVuZAoKICAgICAgICBpZiBpc0Rhc2hpbmcgYW5kIGNhbkhpdCB0aGVuCiAgICAgICAgICAgIHJldHVybiBzZWxmOl9fQ2FzdChwb3NpdGlvbi54LCBwb3NpdGlvbi56KQogICAgICAgIGVsc2VpZiBub3QgaXNEYXNoaW5nIHRoZW4gcmV0dXJuIFNQRUxMU1RBVEVfTk9UX0RBU0hJTkcKICAgICAgICBlbHNlIHJldHVybiBTUEVMTFNUQVRFX0RBU0hJTkdfQ0FOVF9ISVQgZW5kCiAgICBlbmQKCiAgICByZXR1cm4gU1BFTExTVEFURV9OT1RfVFJJR0dFUkVECgplbmQKCi0tW1sKICAgIFRyaWVzIHRvIGNhc3QgdGhlIHNwZWxsIHdoZW4gdGhlIHRhcmdldCBpcyBpbW1vYmlsZQoKICAgIEBwYXJhbSB0YXJnZXQgfCBDdW5pdCB8IEltbW9iaWxlIHRhcmdldCB0byBhdHRhY2sKICAgIEBwYXJhbSByZXR1cm4gfCBpbnQgICB8IFNwZWxsU3RhdGUgb2YgdGhlIGN1cnJlbnQgc3BlbGwKXV0KZnVuY3Rpb24gU3BlbGw6Q2FzdElmSW1tb2JpbGUodGFyZ2V0KQoKICAgIC0tIERvbid0IGNhbGN1bGF0ZSBzdHVmZiB3aGVuIHRhcmdldCBpcyBpbnZhbGlkCiAgICBpZiBub3QgVmFsaWRUYXJnZXQodGFyZ2V0KSB0aGVuIHJldHVybiBTUEVMTFNUQVRFX0lOVkFMSURfVEFSR0VUIGVuZAoKICAgIGlmIHNlbGYuc2tpbGxzaG90VHlwZSB+PSBuaWwgdGhlbgogICAgICAgIGxvY2FsIGlzSW1tb2JpbGUsIHBvc2l0aW9uID0gc2VsZi5WUDpJc0ltbW9iaWxlKHRhcmdldCwgc2VsZi5kZWxheSArIDAuMDcgKyBHZXRMYXRlbmN5KCkgLyAyMDAwLCBzZWxmLndpZHRoLCBzZWxmLnNwZWVkLCBzZWxmLnNvdXJjZVBvc2l0aW9uKQoKICAgICAgICAtLSBPdXQgb2YgcmFuZ2UKICAgICAgICBpZiBzZWxmLnJhbmdlU3FyIDwgX0dldERpc3RhbmNlU3FyKHNlbGYuc291cmNlUmFuZ2UsIHBvc2l0aW9uKSB0aGVuIHJldHVybiBTUEVMTFNUQVRFX09VVF9PRl9SQU5HRSBlbmQKCiAgICAgICAgaWYgaXNJbW1vYmlsZSB0aGVuCgogICAgICAgICAgICAtLSBDb2xsaXNpb24KICAgICAgICAgICAgaWYgbm90IHNlbGYuY29sbGlzaW9uIG9yIChzZWxmLmNvbGxpc2lvbiBhbmQgbm90IHNlbGYuVlA6Q2hlY2tNaW5pb25Db2xsaXNpb24odGFyZ2V0LCBwb3NpdGlvbiwgc2VsZi5kZWxheSArIDAuMDcgKyBHZXRMYXRlbmN5KCkgLyAyMDAwLCBzZWxmLndpZHRoLCBzZWxmLnJhbmdlLCBzZWxmLnNwZWVkLCBzZWxmLnNvdXJjZVBvc2l0aW9uLCBmYWxzZSwgdHJ1ZSkpIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiBzZWxmOl9fQ2FzdChwb3NpdGlvbi54LCBwb3NpdGlvbi56KQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICByZXR1cm4gU1BFTExTVEFURV9DT0xMSVNJT04KICAgICAgICAgICAgZW5kCgogICAgICAgIGVsc2UgcmV0dXJuIFNQRUxMU1RBVEVfTk9UX0lNTU9CSUxFIGVuZAogICAgZWxzZQogICAgICAgIGxvY2FsIGlzSW1tb2JpbGUsIHBvc2l0aW9uID0gc2VsZi5WUDpJc0ltbW9iaWxlKHRhcmdldCwgMC4yNSArIDAuMDcgKyBHZXRMYXRlbmN5KCkgLyAyMDAwLCAxLCBtYXRoLmh1Z2UsIHNlbGYuc291cmNlUG9zaXRpb24pCgogICAgICAgIC0tIE91dCBvZiByYW5nZQogICAgICAgIGlmIHNlbGYucmFuZ2VTcXIgPCBfR2V0RGlzdGFuY2VTcXIoc2VsZi5zb3VyY2VSYW5nZSwgdGFyZ2V0KSB0aGVuIHJldHVybiBTUEVMTFNUQVRFX09VVF9PRl9SQU5HRSBlbmQKCiAgICAgICAgaWYgaXNJbW1vYmlsZSB0aGVuCiAgICAgICAgICAgIHJldHVybiBzZWxmOl9fQ2FzdCh0YXJnZXQpCiAgICAgICAgZWxzZQogICAgICAgICAgICByZXR1cm4gU1BFTExTVEFURV9OT1RfSU1NT0JJTEUKICAgICAgICBlbmQKICAgIGVuZAoKICAgIHJldHVybiBTUEVMTFNUQVRFX05PVF9UUklHR0VSRUQKCmVuZAoKLS1bWwogICAgQ2FzdCB0aGUgc3BlbGwsIHJlc3BlY3RpbmcgcHJldmlvdXNseSBtYWRlIGRlY2lzaW9ucyBhYm91dCBza2lsbHNob3RzIGFuZCBBT0Ugc3R1ZmYKCiAgICBAcGFyYW0gcGFyYW0xIHwgdXNlcmRhdGEvZmxvYXQgfCBXaGVuIHBhcmFtMiBpcyBuaWwgdGhlbiB0aGlzIGNhbiBiZSB0aGUgdGFyZ2V0IG9iamVjdCwgb3RoZXJ3aXNlIHRoaXMgaXMgdGhlIFggY29vcmRpbmF0ZSBvZiB0aGUgc2tpbGxzaG90IHBvc2l0aW9uCiAgICBAcGFyYW0gcGFyYW0yIHwgZmxvYXQgICAgICAgICAgfCBaIGNvb3JkaW5hdGUgb2YgdGhlIHNraWxsc2hvdCBwb3NpdGlvbgogICAgQHBhcmFtIHJldHVybiB8IGludCAgICAgICAgICAgIHwgU3BlbGxTdGF0ZSBvZiB0aGUgY3VycmVudCBzcGVsbApdXQpmdW5jdGlvbiBTcGVsbDpDYXN0KHBhcmFtMSwgcGFyYW0yKQoKICAgIGlmIHNlbGYuc2tpbGxzaG90VHlwZSB+PSBuaWwgYW5kIHBhcmFtMSB+PSBuaWwgYW5kIHBhcmFtMiA9PSBuaWwgdGhlbgoKICAgICAgICAtLSBEb24ndCBjYWxjdWxhdGUgc3R1ZmYgd2hlbiB0YXJnZXQgaXMgaW52YWxpZAogICAgICAgIGlmIG5vdCBWYWxpZFRhcmdldChwYXJhbTEpIHRoZW4gcmV0dXJuIFNQRUxMU1RBVEVfSU5WQUxJRF9UQVJHRVQgZW5kCgogICAgICAgIGxvY2FsIGNhc3RQb3NpdGlvbiwgaGl0Q2hhbmNlLCBwb3NpdGlvbiwgblRhcmdldHMKICAgICAgICBpZiBzZWxmLnNraWxsc2hvdFR5cGUgPT0gU0tJTExTSE9UX0xJTkVBUiBvciBzZWxmLnNraWxsc2hvdFR5cGUgPT0gU0tJTExTSE9UX0NPTkUgdGhlbgogICAgICAgICAgICBpZiBzZWxmLnVzZUFvZSB0aGVuCiAgICAgICAgICAgICAgICBjYXN0UG9zaXRpb24sIGhpdENoYW5jZSwgblRhcmdldHMgPSBzZWxmOkdldFByZWRpY3Rpb24ocGFyYW0xKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBjYXN0UG9zaXRpb24sIGhpdENoYW5jZSwgcG9zaXRpb24gPSBzZWxmOkdldFByZWRpY3Rpb24ocGFyYW0xKQogICAgICAgICAgICAgICAgLS0gT3V0IG9mIHJhbmdlCiAgICAgICAgICAgICAgICBpZiBzZWxmLnJhbmdlU3FyIDwgX0dldERpc3RhbmNlU3FyKHNlbGYuc291cmNlUmFuZ2UsIHBvc2l0aW9uKSB0aGVuIHJldHVybiBTUEVMTFNUQVRFX09VVF9PRl9SQU5HRSBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZWxzZWlmIHNlbGYuc2tpbGxzaG90VHlwZSA9PSBTS0lMTFNIT1RfQ0lSQ1VMQVIgdGhlbgogICAgICAgICAgICBpZiBzZWxmLnVzZUFvZSB0aGVuCiAgICAgICAgICAgICAgICBjYXN0UG9zaXRpb24sIGhpdENoYW5jZSwgblRhcmdldHMgPSBzZWxmOkdldFByZWRpY3Rpb24ocGFyYW0xKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBjYXN0UG9zaXRpb24sIGhpdENoYW5jZSwgcG9zaXRpb24gPSBzZWxmOkdldFByZWRpY3Rpb24ocGFyYW0xKQogICAgICAgICAgICAgICAgLS0gT3V0IG9mIHJhbmdlCiAgICAgICAgICAgICAgICBpZiBtYXRoLnBvdyhzZWxmLnJhbmdlICsgc2VsZi53aWR0aCArIHNlbGYuVlA6R2V0SGl0Qm94KHBhcmFtMSksIDIpIDwgX0dldERpc3RhbmNlU3FyKHNlbGYuc291cmNlUmFuZ2UsIHBvc2l0aW9uKSB0aGVuIHJldHVybiBTUEVMTFNUQVRFX09VVF9PRl9SQU5HRSBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIC0tIEFPRSBub3QgZW5vdWdoIHRhcmdldHMKICAgICAgICBpZiBuVGFyZ2V0cyBhbmQgblRhcmdldHMgPCBzZWxmLm1pblRhcmdldHNBb2UgdGhlbiByZXR1cm4gU1BFTExTVEFURV9OT1RfRU5PVUdIX1RBUkdFVFMgZW5kCgogICAgICAgIC0tIENvbGxpc2lvbiBkZXRlY3RlZAogICAgICAgIGlmIGhpdENoYW5jZSA9PSAtMSB0aGVuIHJldHVybiBTUEVMTFNUQVRFX0NPTExJU0lPTiBlbmQKCiAgICAgICAgLS0gSGl0Y2hhbmNlIHRvbyBsb3cKICAgICAgICBpZiBoaXRDaGFuY2UgYW5kIGhpdENoYW5jZSA8IHNlbGYuaGl0Q2hhbmNlIHRoZW4gcmV0dXJuIFNQRUxMU1RBVEVfTE9XRVJfSElUQ0hBTkNFIGVuZAoKICAgICAgICAtLSBPdXQgb2YgcmFuZ2UKICAgICAgICBpZiBzZWxmLnJhbmdlU3FyIDwgX0dldERpc3RhbmNlU3FyKHNlbGYuc291cmNlUmFuZ2UsIGNhc3RQb3NpdGlvbikgdGhlbiByZXR1cm4gU1BFTExTVEFURV9PVVRfT0ZfUkFOR0UgZW5kCgogICAgICAgIHBhcmFtMSA9IGNhc3RQb3NpdGlvbi54CiAgICAgICAgcGFyYW0yID0gY2FzdFBvc2l0aW9uLnoKICAgIGVuZAoKICAgIC0tIENhc3QgdGhlIHNwZWxsCiAgICByZXR1cm4gc2VsZjpfX0Nhc3QocGFyYW0xLCBwYXJhbTIpCgplbmQKCi0tW1sKICAgIEludGVybmFsIGZ1bmN0aW9uLCBkbyBub3QgdXNlIHRoaXMhCl1dCmZ1bmN0aW9uIFNwZWxsOl9fQ2FzdChwYXJhbTEsIHBhcmFtMikKCiAgICBpZiBzZWxmLnBhY2tldENhc3QgdGhlbgogICAgICAgIGlmIHBhcmFtMSB+PSBuaWwgYW5kIHBhcmFtMiB+PSBuaWwgdGhlbgogICAgICAgICAgICBQYWNrZXQoIlNfQ0FTVCIsIHtzcGVsbElkID0gc2VsZi5zcGVsbElkLCB0b1ggPSBwYXJhbTEsIHRvWSA9IHBhcmFtMiwgZnJvbVggPSBwYXJhbTEsIGZyb21ZID0gcGFyYW0yfSk6c2VuZCgpCiAgICAgICAgZWxzZWlmIHBhcmFtMSB+PSBuaWwgdGhlbgogICAgICAgICAgICBQYWNrZXQoIlNfQ0FTVCIsIHtzcGVsbElkID0gc2VsZi5zcGVsbElkLCB0b1ggPSBwYXJhbTEueCwgdG9ZID0gcGFyYW0xLnosIGZyb21YID0gcGFyYW0xLngsIGZyb21ZID0gcGFyYW0xLnosIHRhcmdldE5ldHdvcmtJZCA9IHBhcmFtMS5uZXR3b3JrSUR9KTpzZW5kKCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIFBhY2tldCgiU19DQVNUIiwge3NwZWxsSWQgPSBzZWxmLnNwZWxsSWQsIHRvWCA9IHBsYXllci54LCB0b1kgPSBwbGF5ZXIueiwgZnJvbVggPSBwbGF5ZXIueCwgZnJvbVkgPSBwbGF5ZXIueiwgdGFyZ2V0TmV0d29ya0lkID0gcGxheWVyLm5ldHdvcmtJRH0pOnNlbmQoKQogICAgICAgIGVuZAogICAgZWxzZQogICAgICAgIGlmIHBhcmFtMSB+PSBuaWwgYW5kIHBhcmFtMiB+PSBuaWwgdGhlbgogICAgICAgICAgICBDYXN0U3BlbGwoc2VsZi5zcGVsbElkLCBwYXJhbTEsIHBhcmFtMikKICAgICAgICBlbHNlaWYgcGFyYW0xIH49IG5pbCB0aGVuCiAgICAgICAgICAgIENhc3RTcGVsbChzZWxmLnNwZWxsSWQsIHBhcmFtMSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIENhc3RTcGVsbChzZWxmLnNwZWxsSWQpCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICByZXR1cm4gU1BFTExTVEFURV9UUklHR0VSRUQKCmVuZAoKLS1bWwogICAgQWRkIGFuIGF1dG9tYXRpb24gdG8gdGhlIHNwZWxsIHRvIGxldCBpdCBjYXN0IGl0c2VsZiB3aGVuIGEgY2VydGFpbiBjb25kaXRpb24gaXMgbWV0CgogICAgQHBhcmFtIGF1dG9tYXRpb25JZCB8IHN0cmluZy9pbnQgfCBUaGUgSUQgb2YgdGhlIGF1dG9tYXRpb24sIGV4YW1wbGUgIkFudGlHYXBDbG9zZXIiCiAgICBAcGFyYW0gZnVuYyAgICAgICAgIHwgZnVuY3Rpb24gICB8IEZ1bmN0aW9uIHRvIGJlIGNhbGxlZCB3aGVuIGNoZWNraW5nLCBzaG91bGQgcmV0dXJuIGEgYm9vbCB2YWx1ZSBpbmRpY2F0aW5nIGlmIGl0IHNob3VsZCBiZSBjYXN0ZWQgYW5kIG9wdGlvbmFsbHkgdGhlIGNhc3QgcGFyYW1zIChleDogdGFyZ2V0IG9yIHggYW5kIHopCl1dCmZ1bmN0aW9uIFNwZWxsOkFkZEF1dG9tYXRpb24oYXV0b21hdGlvbklkLCBmdW5jKQoKICAgIGFzc2VydChhdXRvbWF0aW9uSWQsICJTcGVsbDogYXV0b21hdGlvbklkIGlzIGludmFsaWQhIikKICAgIGFzc2VydChmdW5jIGFuZCB0eXBlKGZ1bmMpID09ICJmdW5jdGlvbiIsICJTcGVsbDogZnVuYyBpcyBpbnZhbGlkISIpCgogICAgZm9yIGluZGV4LCBhdXRvbWF0aW9uIGluIGlwYWlycyhzZWxmLl9hdXRvbWF0aW9ucykgZG8KICAgICAgICBpZiBhdXRvbWF0aW9uLmlkID09IGF1dG9tYXRpb25JZCB0aGVuIHJldHVybiBlbmQKICAgIGVuZAoKICAgIHRhYmxlLmluc2VydChzZWxmLl9hdXRvbWF0aW9ucywgeyBpZCA9PSBhdXRvbWF0aW9uSWQsIGZ1bmMgPSBmdW5jIH0pCgogICAgLS0gUmVnaXN0ZXIgY2FsbGJhY2tzCiAgICBpZiBub3Qgc2VsZi5fX3RpY2tDYWxsYmFjayB0aGVuCiAgICAgICAgQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpPblRpY2soKSBlbmQpCiAgICAgICAgc2VsZi5fX3RpY2tDYWxsYmFjayA9IHRydWUKICAgIGVuZAoKZW5kCgotLVtbCiAgICBSZW1vdmUgYW5kIGF1dG9tYXRpb24gYnkgaXQncyBpZAoKICAgIEBwYXJhbSBhdXRvbWF0aW9uSWQgfCBzdHJpbmcvaW50IHwgVGhlIElEIG9mIHRoZSBhdXRvbWF0aW9uLCBleGFtcGxlICJBbnRpR2FwQ2xvc2VyIgpdXQpmdW5jdGlvbiBTcGVsbDpSZW1vdmVBdXRvbWF0aW9uKGF1dG9tYXRpb25JZCkKCiAgICBhc3NlcnQoYXV0b21hdGlvbklkLCAiU3BlbGw6IGF1dG9tYXRpb25JZCBpcyBpbnZhbGlkISIpCgogICAgZm9yIGluZGV4LCBhdXRvbWF0aW9uIGluIGlwYWlycyhzZWxmLl9hdXRvbWF0aW9ucykgZG8KICAgICAgICBpZiBhdXRvbWF0aW9uLmlkID09IGF1dG9tYXRpb25JZCB0aGVuCiAgICAgICAgICAgIHRhYmxlLnJlbW92ZShzZWxmLl9hdXRvbWF0aW9ucywgaW5kZXgpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZW5kCiAgICBlbmQKCmVuZAoKLS1bWwogICAgQ2xlYXIgYWxsIGF1dG9tYXRpb25zIGFzc2luZ2VkIHRvIHRoaXMgc3BlbGwKXV0KZnVuY3Rpb24gU3BlbGw6Q2xlYXJBdXRvbWF0aW9ucygpCiAgICBzZWxmLl9hdXRvbWF0aW9ucyA9IHt9CmVuZAoKLS1bWwogICAgVHJhY2sgdGhlIHNwZWxsIGxpa2UgaW4gT25Qcm9jZXNzU3BlbGwgdG8gYWRkIG1vcmUgZmVhdHVyZXMgdG8gdGhpcyBTcGVsbCBpbnN0YW5jZQoKICAgIEBwYXJhbSBzcGVsbE5hbWUgfCBzdHJpbmcvdGFibGUgfCBDYXNlIGluc2Vuc2l0aXZlIG5hbWUocykgb2YgdGhlIHNwZWxsCiAgICBAcmV0dXJuICAgICAgICAgIHwgY2xhc3MgICAgICAgIHwgVGhlIGN1cnJlbnQgaW5zdGFuY2UKXV0KZnVuY3Rpb24gU3BlbGw6VHJhY2tDYXN0aW5nKHNwZWxsTmFtZSkKCiAgICBhc3NlcnQoc3BlbGxOYW1lLCAiU3BlbGw6VHJhY2tDYXN0aW5nKCk6IHNwZWxsTmFtZSBpcyBpbnZhbGlkISIpCiAgICBhc3NlcnQoc2VsZi5fX3RyYWNrZWRfc3BlbGxOYW1lcyA9PSBuaWwsICJTcGVsbDpUcmFja0Nhc3RpbmcoKTogVGhpcyBzcGVsbCBpcyBhbHJlYWR5IHRyYWNrZWQhIikKICAgIGFzc2VydCh0eXBlKHNwZWxsTmFtZSkgPT0gInN0cmluZyIgb3IgdHlwZShzcGVsbE5hbWUpID09ICJ0YWJsZSIsICJTcGVsbDpUcmFja0Nhc3RpbmcoKTogVHlwZSBvZiBzcGVsbE5hbWUgaXMgaW52YWxpZDogIiAuLiB0eXBlKHNwZWxsTmFtZSkpCgogICAgc2VsZi5fX3RyYWNrZWRfc3BlbGxOYW1lcyA9IHR5cGUoc3BlbGxOYW1lKSA9PSAidGFibGUiIGFuZCBzcGVsbE5hbWUgb3IgeyBzcGVsbE5hbWUgfQoKICAgIC0tIFJlZ2lzdGVyIGNhbGxiYWNrcwogICAgaWYgbm90IHNlbGYuX19wcm9jZXNzU3BlbGxDYWxsYmFjayB0aGVuCiAgICAgICAgQWRkUHJvY2Vzc1NwZWxsQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgc3BlbGwpIHNlbGY6T25Qcm9jZXNzU3BlbGwodW5pdCwgc3BlbGwpIGVuZCkKICAgICAgICBzZWxmLl9fcHJvY2Vzc1NwZWxsQ2FsbGJhY2sgPSB0cnVlCiAgICBlbmQKCiAgICByZXR1cm4gc2VsZgoKZW5kCgotLVtbCiAgICBXaGVuIHRoZSBzcGVsbCBpcyBjYXN0ZWQgYW5kIGFib3V0IHRvIGhpdCBhIHRhcmdldCwgdGhpcyB3aWxsIHJldHVybiB0aGUgZm9sbG93aW5nCgogICAgQHJldHVybiB8IENVbml0LGZsb2F0IHwgVGhlIHRhcmdldCB1bml0LCB0aGUgcmVtYWluaW5nIHRpbWUgaW4gc2Vjb25kcyBpdCB3aWxsIHRha2UgdG8gaGl0IHRoZSB0YXJnZXQsIG90aGVyd2lzZSBuaWwKXV0KZnVuY3Rpb24gU3BlbGw6V2lsbEhpdFRhcmdldCgpCgogICAgLS0gVE9ETzogVlByZWRpY3Rpb24gZXhwZXJ0J3Mgd29yayA7RAoKZW5kCgotLVtbCiAgICBSZWdpc3RlciBhIGZ1bmN0aW9uIHdoaWNoIHdpbGwgYmUgdHJpZ2dlcmVkIHdoZW4gdGhlIHNwZWxsIGlzIGJlaW5nIGNhc3RlZCB0aGUgZnVuY3Rpb24gd2lsbCBiZSBnaXZlbiB0aGUgc3BlbGwgb2JqZWN0IGFzIHBhcmFtZXRlcgoKICAgIEBwYXJhbSBmdW5jIHwgZnVuY3Rpb24gfCBGdW5jdGlvbiB0byBiZSBjYWxsZWQgd2hlbiB0aGUgc3BlbGwgaXMgYmVpbmcgcHJvY2Vzc2VkIChjYXN0ZWQpCl1dCmZ1bmN0aW9uIFNwZWxsOlJlZ2lzdGVyQ2FzdENhbGxiYWNrKGZ1bmMpCgogICAgYXNzZXJ0KGZ1bmMgYW5kIHR5cGUoZnVuYykgPT0gImZ1bmN0aW9uIiBhbmQgc2VsZi5fX3RyYWNrZWRfY2FzdENhbGxiYWNrID09IG5pbCwgIlNwZWxsOlJlZ2lzdGVyQ2FzdENhbGxiYWNrKCk6IGZ1bmMgaXMgZWl0aGVyIGludmFsaWQgb3IgYSBjYWxsYmFjayBpcyBhbHJlYWR5IHJlZ2lzdGVyZWQhIikKCiAgICBzZWxmLl9fdHJhY2tlZF9jYXN0Q2FsbGJhY2sgPSBmdW5jCgplbmQKCi0tW1sKICAgIFJldHVybnMgdGhlIG9zLmNsb2NrKCkgdGltZSB3aGVuIHRoZSBzcGVsbCB3YXMgbGFzdCBjYXN0ZWQKCiAgICBAcmV0dXJuIHwgZmxvYXQgfCBUaW1lIGluIHNlY29uZHMgd2hlbiB0aGUgc3BlbGwgd2FzIGxhc3QgY2FzdGVkIG9yIG5pbCBpZiB0aGUgc3BlbGwgd2FzIG5ldmVyIGNhc3RlZCBvciBzcGVsbCBpcyBub3QgdHJhY2tlZApdXQpmdW5jdGlvbiBTcGVsbDpHZXRMYXN0Q2FzdFRpbWUoKQogICAgcmV0dXJuIHNlbGYuX190cmFja2VkX2xhc3RDYXN0VGltZSBvciAwCmVuZAoKLS1bWwogICAgR2V0IGlmIHRoZSB0YXJnZXQgaXMgaW4gcmFuZ2UKCiAgICBAcmV0dXJuIHwgYm9vbCB8IEluIHJhbmdlIG9yIG5vdApdXQpmdW5jdGlvbiBTcGVsbDpJc0luUmFuZ2UodGFyZ2V0LCBmcm9tKQogICAgcmV0dXJuIHNlbGYucmFuZ2VTcXIgPj0gX0dldERpc3RhbmNlU3FyKHRhcmdldCwgZnJvbSBvciBzZWxmLnNvdXJjZVBvc2l0aW9uKQplbmQKCi0tW1sKICAgIEdldCBpZiB0aGUgc3BlbGwgaXMgcmVhZHkgb3Igbm90CgogICAgQHJldHVybiB8IGJvb2wgfCBTcGVsbCBzdGF0ZSByZWFkeSBvciBub3QKXV0KZnVuY3Rpb24gU3BlbGw6SXNSZWFkeSgpCiAgICByZXR1cm4gcGxheWVyOkNhblVzZVNwZWxsKHNlbGYuc3BlbGxJZCkgPT0gUkVBRFkKZW5kCgotLVtbCiAgICBHZXQgdGhlIG1hbmEgdXNhZ2Ugb2YgdGhlIHNwZWxsCgogICAgQHJldHVybiB8IGZsb2F0IHwgTWFuYSB1c2FnZSBvZiB0aGUgc3BlbGwKXV0KZnVuY3Rpb24gU3BlbGw6R2V0TWFuYVVzYWdlKCkKICAgIHJldHVybiBwbGF5ZXI6R2V0U3BlbGxEYXRhKHNlbGYuc3BlbGxJZCkubWFuYQplbmQKCi0tW1sKICAgIEdldCB0aGUgQ1VSUkVOVCBjb29sZG93biBvZiB0aGUgc3BlbGwKCiAgICBAcmV0dXJuIHwgZmxvYXQgfCBDdXJyZW50IGNvb2xkb3duIG9mIHRoZSBzcGVsbApdXQpmdW5jdGlvbiBTcGVsbDpHZXRDb29sZG93bihjdXJyZW50KQogICAgcmV0dXJuIGN1cnJlbnQgYW5kIHBsYXllcjpHZXRTcGVsbERhdGEoc2VsZi5zcGVsbElkKS5jdXJyZW50Q2Qgb3IgcGxheWVyOkdldFNwZWxsRGF0YShzZWxmLnNwZWxsSWQpLnRvdGFsQ29vbGRvd24KZW5kCgotLVtbCiAgICBHZXQgdGhlIHN0YXQgcG9pbnRzIGFzc2luZ2VkIHRvIHRoaXMgc3BlbGwgKGxldmVsKQoKICAgIEByZXR1cm4gfCBpbnQgfCBTdGF0IHBvaW50cyBhc3NpbmdlZCB0byB0aGlzIHNwZWxsIChsZXZlbCkKXV0KZnVuY3Rpb24gU3BlbGw6R2V0TGV2ZWwoKQogICAgcmV0dXJuIHBsYXllcjpHZXRTcGVsbERhdGEoc2VsZi5zcGVsbElkKS5sZXZlbAplbmQKCi0tW1sKICAgIEdldCB0aGUgbmFtZSBvZiB0aGUgc3BlbGwKCiAgICBAcmV0dXJuIHwgc3RyaW5nIHwgTmFtZSBvZiB0aGUgdGhlIHNwZWxsCl1dCmZ1bmN0aW9uIFNwZWxsOkdldE5hbWUoKQogICAgcmV0dXJuIHBsYXllcjpHZXRTcGVsbERhdGEoc2VsZi5zcGVsbElkKS5uYW1lCmVuZAoKLS1bWwogICAgSW50ZXJuYWwgY2FsbGJhY2ssIGRvbid0IHVzZSB0aGlzIQpdXQpmdW5jdGlvbiBTcGVsbDpPblRpY2soKQoKICAgIC0tIEF1dG9tYXRpb25zCiAgICBpZiBzZWxmLl9hdXRvbWF0aW9ucyBhbmQgI3NlbGYuX2F1dG9tYXRpb25zID4gMCB0aGVuCiAgICAgICAgZm9yIF8sIGF1dG9tYXRpb24gaW4gaXBhaXJzKHNlbGYuX2F1dG9tYXRpb25zKSBkbwogICAgICAgICAgICBsb2NhbCBkb0Nhc3QsIHBhcmFtMSwgcGFyYW0yID0gYXV0b21hdGlvbi5mdW5jKCkKICAgICAgICAgICAgaWYgZG9DYXN0ID09IHRydWUgdGhlbgogICAgICAgICAgICAgICAgc2VsZjpDYXN0KHBhcmFtMSwgcGFyYW0yKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAoKICAgIC0tIENoYXJnZWQgc3BlbGxzCiAgICBpZiBzZWxmLl9fY2hhcmdlZCB0aGVuCiAgICAgICAgaWYgc2VsZjpJc0NoYXJnaW5nKCkgdGhlbgogICAgICAgICAgICBzZWxmOlNldFJhbmdlKG1hdGgubWluKHNlbGYuX19jaGFyZ2VkX2luaXRpYWxSYW5nZSArIChzZWxmLl9fY2hhcmdlZF9tYXhSYW5nZSAtIHNlbGYuX19jaGFyZ2VkX2luaXRpYWxSYW5nZSkgKiAoKG9zLmNsb2NrKCkgLSBzZWxmLl9fY2hhcmdlZF9jYXN0VGltZSkgLyBzZWxmLl9fY2hhcmdlZF9jaGFyZ2VUaW1lKSwgc2VsZi5fX2NoYXJnZWRfbWF4UmFuZ2UpKQogICAgICAgIGVsc2VpZiBub3Qgc2VsZi5fX2NoYXJnZWRfYWJvcnRlZCBhbmQgb3MuY2xvY2soKSAtIHNlbGYuX19jaGFyZ2VkX2Nhc3RUaW1lID4gMC4xIHRoZW4KICAgICAgICAgICAgc2VsZjpfQWJvcnRDaGFyZ2UoKQogICAgICAgIGVuZAogICAgZW5kCgplbmQKCi0tW1sKICAgIEludGVybmFsIGNhbGxiYWNrLCBkb24ndCB1c2UgdGhpcyEKXV0KZnVuY3Rpb24gU3BlbGw6T25Qcm9jZXNzU3BlbGwodW5pdCwgc3BlbGwpCgogICAgaWYgdW5pdCBhbmQgdW5pdC52YWxpZCBhbmQgdW5pdC5pc01lIGFuZCBzcGVsbCBhbmQgc3BlbGwubmFtZSB0aGVuCgogICAgICAgIC0tIFRyYWNrZWQgc3BlbGxzCiAgICAgICAgaWYgc2VsZi5fX3RyYWNrZWRfc3BlbGxOYW1lcyB0aGVuCiAgICAgICAgICAgIGZvciBfLCB0cmFja2VkU3BlbGwgaW4gaXBhaXJzKHNlbGYuX190cmFja2VkX3NwZWxsTmFtZXMpIGRvCiAgICAgICAgICAgICAgICBpZiB0cmFja2VkU3BlbGw6bG93ZXIoKSA9PSBzcGVsbC5uYW1lOmxvd2VyKCkgdGhlbgogICAgICAgICAgICAgICAgICAgIHNlbGYuX190cmFja2VkX2xhc3RDYXN0VGltZSA9IG9zLmNsb2NrKCkKICAgICAgICAgICAgICAgICAgICBzZWxmLl9fdHJhY2tlZF9jYXN0Q2FsbGJhY2soc3BlbGwpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIC0tIENoYXJnZWQgc3BlbGxzCiAgICAgICAgaWYgc2VsZi5fX2NoYXJnZWQgYW5kIHNlbGYuX19jaGFyZ2VkX3NwZWxsTmFtZTpsb3dlcigpID09IHNwZWxsLm5hbWU6bG93ZXIoKSB0aGVuCiAgICAgICAgICAgIHNlbGYuX19jaGFyZ2VkX2FjdGl2ZSAgICAgICA9IHRydWUKICAgICAgICAgICAgc2VsZi5fX2NoYXJnZWRfYWJvcnRlZCAgICAgID0gZmFsc2UKICAgICAgICAgICAgc2VsZi5fX2NoYXJnZWRfaW5pdGlhbFJhbmdlID0gc2VsZi5yYW5nZQogICAgICAgICAgICBzZWxmLl9fY2hhcmdlZF9jYXN0VGltZSAgICAgPSBvcy5jbG9jaygpCiAgICAgICAgICAgIHNlbGYuX19jaGFyZ2VkX2NvdW50ICAgICAgICA9IHNlbGYuX19jaGFyZ2VkX2NvdW50IGFuZCBzZWxmLl9fY2hhcmdlZF9jb3VudCArIDEgb3IgMQogICAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbihjaGFyZ2VDb3VudCkKICAgICAgICAgICAgICAgIGlmIHNlbGYuX19jaGFyZ2VkX2NvdW50ID09IGNoYXJnZUNvdW50IHRoZW4KICAgICAgICAgICAgICAgICAgICBzZWxmOl9BYm9ydENoYXJnZSgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kLCBzZWxmLl9fY2hhcmdlZF9kdXJhdGlvbiwgeyBzZWxmLl9fY2hhcmdlZF9jb3VudCB9KQogICAgICAgIGVuZAoKICAgIGVuZAoKZW5kCgotLVtbCiAgICBJbnRlcm5hbCBjYWxsYmFjaywgZG9uJ3QgdXNlIHRoaXMhCl1dCmZ1bmN0aW9uIFNwZWxsOk9uU2VuZFBhY2tldChwKQoKICAgIC0tIENoYXJnZWQgc3BlbGxzCiAgICBpZiBzZWxmLl9fY2hhcmdlZCB0aGVuCiAgICAgICAgaWYgcC5oZWFkZXIgPT0gMjI5IHRoZW4KICAgICAgICAgICAgaWYgb3MuY2xvY2soKSAtIHNlbGYuX19jaGFyZ2VkX2Nhc3RUaW1lIDw9IDAuMSB0aGVuCiAgICAgICAgICAgICAgICBwOkJsb2NrKCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZWxzZWlmIHAuaGVhZGVyID09IFBhY2tldC5oZWFkZXJzLlNfQ0FTVCB0aGVuCiAgICAgICAgICAgIGxvY2FsIHBhY2tldCA9IFBhY2tldChwKQogICAgICAgICAgICBpZiBwYWNrZXQ6Z2V0KCJzcGVsbElkIikgPT0gc2VsZi5zcGVsbElkIHRoZW4KICAgICAgICAgICAgICAgIGlmIG9zLmNsb2NrKCkgLSBzZWxmLl9fY2hhcmdlZF9jYXN0VGltZSA8PSBzZWxmLl9fY2hhcmdlZF9kdXJhdGlvbiB0aGVuCiAgICAgICAgICAgICAgICAgICAgc2VsZjpfQWJvcnRDaGFyZ2UoKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIG5ld1BhY2tldCA9IENMb0xQYWNrZXQoMjI5KQogICAgICAgICAgICAgICAgICAgIG5ld1BhY2tldDpFbmNvZGVGKHBsYXllci5uZXR3b3JrSUQpCiAgICAgICAgICAgICAgICAgICAgbmV3UGFja2V0OkVuY29kZTEoMHg4MCkKICAgICAgICAgICAgICAgICAgICBuZXdQYWNrZXQ6RW5jb2RlRihtb3VzZVBvcy54KQogICAgICAgICAgICAgICAgICAgIG5ld1BhY2tldDpFbmNvZGVGKG1vdXNlUG9zLnkpCiAgICAgICAgICAgICAgICAgICAgbmV3UGFja2V0OkVuY29kZUYobW91c2VQb3MueikKICAgICAgICAgICAgICAgICAgICBTZW5kUGFja2V0KG5ld1BhY2tldCkKICAgICAgICAgICAgICAgICAgICBwOkJsb2NrKCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAoKZW5kCgpmdW5jdGlvbiBTcGVsbDpfX2VxKG90aGVyKQoKICAgIHJldHVybiBvdGhlciBhbmQgb3RoZXIuX3NwZWxsTnVtIGFuZCBvdGhlci5fc3BlbGxOdW0gPT0gc2VsZi5fc3BlbGxOdW0gb3IgZmFsc2UKCmVuZAoKCi0tW1sKCid8fCcnfC4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3x8ICAgIHx8JwogfHwgICB8fCAgLi4uIC4uICAgLi4uLiAgIC4uLiAuLi4gLi4uICB8fHwgIHx8fCAgIC4uLi4gICAuLiAuLi4gICAgLi4uLiAgICAgLi4uIC4gICAuLi4uICAuLi4gLi4KIHx8ICAgIHx8ICB8fCcgJycgJycgLnx8ICAgfHwgIHx8ICB8ICAgfCd8Li4nfHwgICcnIC58fCAgIHx8ICB8fCAgJycgLnx8ICAgfHwgfHwgIC58Li4ufHwgIHx8JyAnJwogfHwgICAgfHwgIHx8ICAgICAufCcgfHwgICAgfHx8IHx8fCAgICB8ICd8JyB8fCAgLnwnIHx8ICAgfHwgIHx8ICAufCcgfHwgICAgfCcnICAgfHwgICAgICAgfHwKLnx8Li4ufCcgIC58fC4gICAgJ3wuLid8JyAgICB8ICAgfCAgICAufC4gfCAufHwuICd8Li4nfCcgLnx8LiB8fC4gJ3wuLid8JyAgJ3x8fHwuICAnfC4uLicgLnx8LgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC58Li4uLicKCiAgICBEcmF3TWFuYWdlciAtIFRpcmVkIG9mIGhhdmluZyB0byBkcmF3IGV2ZXJ5dGhpbmcgb3ZlciBhbmQgb3ZlciBhZ2Fpbj8gVGhlbiB1c2UgdGhpcyEKCiAgICBGdW5jdGlvbnM6CiAgICAgICAgRHJhd01hbmFnZXIoKQoKICAgIE1ldGhvZHM6CiAgICAgICAgRHJhd01hbmFnZXI6QWRkQ2lyY2xlKGNpcmNsZSkKICAgICAgICBEcmF3TWFuYWdlcjpSZW1vdmVDaXJjbGUoY2lyY2xlKQogICAgICAgIERyYXdNYW5hZ2VyOkNyZWF0ZUNpcmNsZShwb3NpdGlvbiwgcmFkaXVzLCB3aWR0aCwgY29sb3IpCiAgICAgICAgRHJhd01hbmFnZXI6T25EcmF3KCkKCl1dCmNsYXNzICdEcmF3TWFuYWdlcicKCi0tW1sKICAgIE5ldyBpbnN0YW5jZSBvZiBEcmF3TWFuYWdlcgpdXQpmdW5jdGlvbiBEcmF3TWFuYWdlcjpfX2luaXQoKQoKICAgIHNlbGYub2JqZWN0cyA9IHt9CgogICAgQWRkRHJhd0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpPbkRyYXcoKSBlbmQpCgplbmQKCi0tW1sKICAgIEFkZCBhbiBleGlzdGluZyBjaXJjbGUgdG8gdGhlIGRyYXcgbWFuYWdlcgoKICAgIEBwYXJhbSBjaXJjbGUgfCBjbGFzcyB8IF9DaXJjbGUgaW5zdGFuY2UKXV0KZnVuY3Rpb24gRHJhd01hbmFnZXI6QWRkQ2lyY2xlKGNpcmNsZSkKCiAgICBhc3NlcnQoY2lyY2xlLCAiRHJhd01hbmFnZXI6IGNpcmNsZSBpcyBpbnZhbGlkISIpCgogICAgZm9yIF8sIG9iamVjdCBpbiBpcGFpcnMoc2VsZi5vYmplY3RzKSBkbwogICAgICAgIGFzc2VydChvYmplY3Qgfj0gY2lyY2xlLCAiRHJhd01hbmFnZXI6IG9iamVjdCB3YXMgYWxyZWFkeSBpbiBEcmF3TWFuYWdlciIpCiAgICBlbmQKCiAgICB0YWJsZS5pbnNlcnQoc2VsZi5vYmplY3RzLCBjaXJjbGUpCgplbmQKCi0tW1sKICAgIFJlbW92ZXMgYSBjaXJjbGUgZnJvbSB0aGUgZHJhdyBtYW5hZ2VyCgogICAgQHBhcmFtIGNpcmNsZSB8IGNsYXNzIHwgX0NpcmNsZSBpbnN0YW5jZQpdXQpmdW5jdGlvbiBEcmF3TWFuYWdlcjpSZW1vdmVDaXJjbGUoY2lyY2xlKQoKICAgIGFzc2VydChjaXJjbGUsICJEcmF3TWFuYWdlcjpSZW1vdmVDaXJjbGUoKTogY2lyY2xlIGlzIGludmFsaWQhIikKCiAgICBmb3IgaW5kZXgsIG9iamVjdCBpbiBpcGFpcnMoc2VsZi5vYmplY3RzKSBkbwogICAgICAgIGlmIG9iamVjdCA9PSBjaXJjbGUgdGhlbgogICAgICAgICAgICB0YWJsZS5yZW1vdmUoc2VsZi5vYmplY3RzLCBpbmRleCkKICAgICAgICBlbmQKICAgIGVuZAoKZW5kCgotLVtbCiAgICBDcmVhdGUgYSBuZXcgY2lyY2xlIGFuZCBhZGQgaXQgYXN3ZWxsIHRvIHRoZSBEcmF3TWFuYWdlciBpbnN0YW5jZQoKICAgIEBwYXJhbSBwb3NpdGlvbiB8IHZlY3RvciB8IENlbnRlciBvZiB0aGUgY2lyY2xlCiAgICBAcGFyYW0gcmFkaXVzICAgfCBmbG9hdCAgfCBSYWRpdXMgb2YgdGhlIGNpcmNsZQogICAgQHBhcmFtIHdpZHRoICAgIHwgaW50ICAgIHwgV2lkdGggb2YgdGhlIGNpcmNsZSBvdXRsaW5lCiAgICBAcGFyYW0gY29sb3IgICAgfCB0YWJsZSAgfCBDb2xvciBvZiB0aGUgY2lyY2xlIGluIGEgdGFsZSBmb3JtYXQgeyBhLCByLCBnLCBiIH0KICAgIEByZXR1cm4gICAgICAgICB8IGNsYXNzICB8IEluc3RhbmNlIG9mIHRoZSBuZXdseSBjcmVhdGUgQ2lyY2xlIGNsYXNzCl1dCmZ1bmN0aW9uIERyYXdNYW5hZ2VyOkNyZWF0ZUNpcmNsZShwb3NpdGlvbiwgcmFkaXVzLCB3aWR0aCwgY29sb3IpCgogICAgbG9jYWwgY2lyY2xlID0gX0NpcmNsZShwb3NpdGlvbiwgcmFkaXVzLCB3aWR0aCwgY29sb3IpCiAgICBzZWxmOkFkZENpcmNsZShjaXJjbGUpCiAgICByZXR1cm4gY2lyY2xlCgplbmQKCi0tW1sKICAgIERPIE5PVCBDQUxMIFRISVMgTUFOVUFMTFkhIFRoaXMgd2lsbCBiZSBjYWxsZWQgYXV0b21hdGljYWxseS4KXV0KZnVuY3Rpb24gRHJhd01hbmFnZXI6T25EcmF3KCkKCiAgICBmb3IgXywgb2JqZWN0IGluIGlwYWlycyhzZWxmLm9iamVjdHMpIGRvCiAgICAgICAgaWYgb2JqZWN0LmVuYWJsZWQgdGhlbgogICAgICAgICAgICBvYmplY3Q6RHJhdygpCiAgICAgICAgZW5kCiAgICBlbmQKCmVuZAoKLS1bWwoKICAgICAgICAgICAgICAgICAgLi58JycnLnwgIHx8ICAgICAgICAgICAgICAgICAgJ3x8CiAgICAgICAgICAgICAgICAufCcgICAgICcgIC4uLiAgLi4uIC4uICAgIC4uLi4gICB8fCAgICAuLi4uCiAgICAgICAgICAgICAgICB8fCAgICAgICAgICB8fCAgIHx8JyAnJyAufCAgICcnICB8fCAgLnwuLi58fAogICAgICAgICAgICAgICAgJ3wuICAgICAgLiAgfHwgICB8fCAgICAgfHwgICAgICAgfHwgIHx8CiAgICAgICAgICAgICAgICAgJyd8Li4uLicgIC58fC4gLnx8LiAgICAgJ3wuLi4nIC58fC4gICd8Li4uJwoKICAgIEZ1bmN0aW9uczoKICAgICAgICBfQ2lyY2xlKHBvc2l0aW9uLCByYWRpdXMsIHdpZHRoLCBjb2xvcikKCiAgICBNZW1iZXJzOgogICAgICAgIF9DaXJjbGUuZW5hYmxlZCAgfCBib29sICAgfCBFbmFibGUgb3IgZGlhYmxlIHRoZSBjaXJjbGUgKGRpc3BsYXllZCkKICAgICAgICBfQ2lyY2xlLm1vZGUgICAgIHwgaW50ICAgIHwgU2VlIGNpcmNsZSBtb2RlcyBiZWxvdwogICAgICAgIF9DaXJjbGUucG9zaXRpb24gfCB2ZWN0b3IgfCBDZW50ZXIgb2YgdGhlIGNpcmNsZQogICAgICAgIF9DaXJjbGUucmFkaXVzICAgfCBmbG9hdCAgfCBSYWRpdXMgb2YgdGhlIGNpcmNsZQogICAgICAgIC0tIFRoZXNlIGFyZSBub3QgY2hhbmdlYWJsZSB3aGVuIGEgbWVudSBpcyBzZXQKICAgICAgICBfQ2lyY2xlLndpZHRoICAgIHwgaW50ICAgIHwgV2lkdGggb2YgdGhlIGNpcmNsZSBvdXRsaW5lCiAgICAgICAgX0NpcmNsZS5jb2xvciAgICB8IHRhYmxlICB8IENvbG9yIG9mIHRoZSBjaXJjbGUgaW4gYSB0YWxlIGZvcm1hdCB7IGEsIHIsIGcsIGIgfQogICAgICAgIF9DaXJjbGUucXVhbGl0eSAgfCBmbG9hdCAgfCBRdWFsaXR5IG9mIHRoZSBjaXJjbGUsIHRoZSBoaWdoZXIgdGhlIHNtb290aGVyIHRoZSBjaXJjbGUKCiAgICBNZXRob2RzOgogICAgICAgIF9DaXJjbGU6QWRkVG9NZW51KG1lbnUsIHBhcmFtVGV4dCwgYWRkQ29sb3IsIGFkZFdpZHRoLCBhZGRRdWFsaXR5KQogICAgICAgIF9DaXJjbGU6U2V0RW5hYmxlZChlbmFibGVkKQogICAgICAgIF9DaXJjbGU6U2V0MkQoKQogICAgICAgIF9DaXJjbGU6U2V0M0QoKQogICAgICAgIF9DaXJjbGU6U2V0TWluaW1hcCgpCiAgICAgICAgX0NpcmNsZTpTZXRRdWFsaXR5KHF1YWx0aXkpCiAgICAgICAgX0NpcmNsZTpTZXREcmF3Q29uZGl0aW9uKGNvbmRpdGlvbikKICAgICAgICBfQ2lyY2xlOkxpbmtXaXRoU3BlbGwoc3BlbGwsIGRyYXdXaGVuUmVhZHkpCiAgICAgICAgX0NpcmNsZTpEcmF3KCkKCl1dCmNsYXNzICdfQ2lyY2xlJwoKLS0gQ2lyY2xlIG1vZGVzCkNJUkNMRV8yRCAgICAgID0gMApDSVJDTEVfM0QgICAgICA9IDEKQ0lSQ0xFX01JTklNQVAgPSAyCgotLSBOdW1iZXIgb2YgY3VycmVudGx5IGNyZWF0ZWQgY2lyY2xlcwpsb2NhbCBjaXJjbGVDb3VudCA9IDEKCi0tW1sKICAgIE5ldyBpbnN0YW5jZSBvZiBDaXJjbGUKCiAgICBAcGFyYW0gcG9zaXRpb24gfCB2ZWN0b3IgfCBDZW50ZXIgb2YgdGhlIGNpcmNsZQogICAgQHBhcmFtIHJhZGl1cyAgIHwgZmxvYXQgIHwgUmFkaXVzIG9mIHRoZSBjaXJjbGUKICAgIEBwYXJhbSB3aWR0aCAgICB8IGludCAgICB8IFdpZHRoIG9mIHRoZSBjaXJjbGUgb3V0bGluZQogICAgQHBhcmFtIGNvbG9yICAgIHwgdGFibGUgIHwgQ29sb3Igb2YgdGhlIGNpcmNsZSBpbiBhIHRhbGUgZm9ybWF0IHsgYSwgciwgZywgYiB9Cl1dCmZ1bmN0aW9uIF9DaXJjbGU6X19pbml0KHBvc2l0aW9uLCByYWRpdXMsIHdpZHRoLCBjb2xvcikKCiAgICBhc3NlcnQocG9zaXRpb24gYW5kIHBvc2l0aW9uLnggYW5kIChwb3NpdGlvbi55IGFuZCBwb3NpdGlvbi56IG9yIHBvc2l0aW9uLnkpLCAiX0NpcmNsZTogcG9zaXRpb24gaXMgaW52YWxpZCEiKQogICAgYXNzZXJ0KHJhZGl1cyBhbmQgdHlwZShyYWRpdXMpID09ICJudW1iZXIiLCAiX0NpcmNsZTogcmFkaXVzIGlzIGludmFsaWQhIikKICAgIGFzc2VydChub3QgY29sb3Igb3IgY29sb3IgYW5kIHR5cGUoY29sb3IpID09ICJ0YWJsZSIgYW5kICNjb2xvciA9PSA0LCAiX0NpcmNsZTogY29sb3IgaXMgaW52YWxpZCEiKQoKICAgIHNlbGYuZW5hYmxlZCAgID0gdHJ1ZQogICAgc2VsZi5jb25kaXRpb24gPSBuaWwKCiAgICBzZWxmLm1lbnUgICAgICAgID0gbmlsCiAgICBzZWxmLm1lbnVFbmFibGVkID0gbmlsCiAgICBzZWxmLm1lbnVDb2xvciAgID0gbmlsCiAgICBzZWxmLm1lbnVXaWR0aCAgID0gbmlsCiAgICBzZWxmLm1lbnVRdWFsaXR5ID0gbmlsCgogICAgc2VsZi5tb2RlID0gQ0lSQ0xFXzNECgogICAgc2VsZi5wb3NpdGlvbiA9IHBvc2l0aW9uCiAgICBzZWxmLnJhZGl1cyAgID0gcmFkaXVzCiAgICBzZWxmLndpZHRoICAgID0gd2lkdGggb3IgMQogICAgc2VsZi5jb2xvciAgICA9IGNvbG9yIG9yIHsgMjU1LCAyNTUsIDI1NSwgMjU1IH0KICAgIHNlbGYucXVhbGl0eSAgPSByYWRpdXMgLyA1CgogICAgc2VsZi5fY2lyY2xlSWQgID0gImNpcmNsZSIgLi4gY2lyY2xlQ291bnQKICAgIHNlbGYuX2NpcmNsZU51bSA9IGNpcmNsZUNvdW50CgogICAgY2lyY2xlQ291bnQgPSBjaXJjbGVDb3VudCArIDEKCmVuZAoKLS1bWwogICAgQWRkcyB0aGlzIGNpcmNsZSB0byBhIGdpdmVuIG1lbnUKCiAgICBAcGFyYW0gbWVudSAgICAgICB8IHNjcmlwdENvbmZpZyB8IEluc3RhbmNlIG9mIHNjcmlwdCBjb25maWcgdG8gYWRkIHRoaXMgY2lyY2xlIHRvCiAgICBAcGFyYW0gcGFyYW1UZXh0ICB8IHN0cmluZyAgICAgICB8IFRleHQgZm9yIHRoZSBtZW51IGVudHJ5CiAgICBAcGFyYW0gYWRkQ29sb3IgICB8IGJvb2wgICAgICAgICB8IEFkZCBjb2xvciBvcHRpb24KICAgIEBwYXJhbSBhZGRXaWR0aCAgIHwgYm9vbCAgICAgICAgIHwgQWRkIHdpZHRoIG9wdGlvbgogICAgQHBhcmFtIGFkZFF1YWxpdHkgfCBib29sICAgICAgICAgfCBBZGQgcXVhbGl0eSBvcHRpb24KICAgIEByZXR1cm4gICAgICAgICAgIHwgY2xhc3MgICAgICAgIHwgVGhlIGN1cnJlbnQgaW5zdGFuY2UKXV0KZnVuY3Rpb24gX0NpcmNsZTpBZGRUb01lbnUobWVudSwgcGFyYW1UZXh0LCBhZGRDb2xvciwgYWRkV2lkdGgsIGFkZFF1YWxpdHkpCgogICAgYXNzZXJ0KG1lbnUsICJfQ2lyY2xlOiBtZW51IGlzIGludmFsaWQhIikKICAgIGFzc2VydChzZWxmLm1lbnUgPT0gbmlsLCAiX0NpcmNsZTogQWxyZWFkeSBib3VuZCB0byBhIG1lbnUhIikKCiAgICBtZW51OmFkZFN1Yk1lbnUocGFyYW1UZXh0IG9yICJDaXJjbGUgIiAuLiBzZWxmLl9jaXJjbGVOdW0sIHNlbGYuX2NpcmNsZUlkKQogICAgc2VsZi5tZW51ID0gbWVudVtzZWxmLl9jaXJjbGVJZF0KCiAgICAtLSBFbmFibGVkCiAgICBsb2NhbCBwYXJhbUlkID0gc2VsZi5fY2lyY2xlSWQgLi4gImVuYWJsZWQiCiAgICBzZWxmLm1lbnU6YWRkUGFyYW0ocGFyYW1JZCwgIkVuYWJsZWQiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHNlbGYuZW5hYmxlZCkKICAgIHNlbGYubWVudUVuYWJsZWQgPSBzZWxmLm1lbnUuX3BhcmFtWyNzZWxmLm1lbnUuX3BhcmFtXQoKICAgIGlmIGFkZENvbG9yIG9yIGFkZFdpZHRoIG9yIGFkZFF1YWxpdHkgdGhlbgoKICAgICAgICAtLSBDb2xvcgogICAgICAgIGlmIGFkZENvbG9yIHRoZW4KICAgICAgICAgICAgcGFyYW1JZCA9IHNlbGYuX2NpcmNsZUlkIC4uICJjb2xvciIKICAgICAgICAgICAgc2VsZi5tZW51OmFkZFBhcmFtKHBhcmFtSWQsICJDb2xvciIsIFNDUklQVF9QQVJBTV9DT0xPUiwgc2VsZi5jb2xvcikKICAgICAgICAgICAgc2VsZi5tZW51Q29sb3IgPSBzZWxmLm1lbnUuX3BhcmFtWyNzZWxmLm1lbnUuX3BhcmFtXQogICAgICAgIGVuZAoKICAgICAgICAtLSBXaWR0aAogICAgICAgIGlmIGFkZFdpZHRoIHRoZW4KICAgICAgICAgICAgcGFyYW1JZCA9IHNlbGYuX2NpcmNsZUlkIC4uICJ3aWR0aCIKICAgICAgICAgICAgc2VsZi5tZW51OmFkZFBhcmFtKHBhcmFtSWQsICJXaWR0aCIsIFNDUklQVF9QQVJBTV9TTElDRSwgc2VsZi53aWR0aCwgMSwgNSkKICAgICAgICAgICAgc2VsZi5tZW51V2lkdGggPSBzZWxmLm1lbnUuX3BhcmFtWyNzZWxmLm1lbnUuX3BhcmFtXQogICAgICAgIGVuZAoKICAgICAgICAtLSBRdWFsaXR5CiAgICAgICAgaWYgYWRkUXVhbGl0eSB0aGVuCiAgICAgICAgICAgIHBhcmFtSWQgPSBzZWxmLl9jaXJjbGVJZCAuLiAicXVhbGl0eSIKICAgICAgICAgICAgc2VsZi5tZW51OmFkZFBhcmFtKHBhcmFtSWQsICJRdWFsaXR5IiwgU0NSSVBUX1BBUkFNX1NMSUNFLCBtYXRoLnJvdW5kKHNlbGYucXVhbGl0eSksIDEwLCBtYXRoLnJvdW5kKHNlbGYucmFkaXVzIC8gNSkpCiAgICAgICAgICAgIHNlbGYubWVudVF1YWxpdHkgPSBzZWxmLm1lbnUuX3BhcmFtWyNzZWxmLm1lbnUuX3BhcmFtXQogICAgICAgIGVuZAoKICAgIGVuZAoKICAgIHJldHVybiBzZWxmCgplbmQKCi0tW1sKICAgIFNldCB0aGUgZW5hYmxlIHN0YXR1cyBvZiB0aGUgY2lyY2xlCgogICAgQHBhcmFtIGVuYWJsZWQgfCBib29sICB8IEVuYWJsZSBzdGF0ZSBvZiB0aGlzIGNpcmNsZQogICAgQHJldHVybiAgICAgICAgfCBjbGFzcyB8IFRoZSBjdXJyZW50IGluc3RhbmNlCl1dCmZ1bmN0aW9uIF9DaXJjbGU6U2V0RW5hYmxlZChlbmFibGVkKQoKICAgIHNlbGYuZW5hYmxlZCA9IGVuYWJsZWQKICAgIHJldHVybiBzZWxmCgplbmQKCi0tW1sKICAgIFNldCB0aGlzIGNpcmNsZSB0byBiZSBkaXNwbGF5ZWQgMkQKCiAgICBAcmV0dXJuIHwgY2xhc3MgfCBUaGUgY3VycmVudCBpbnN0YW5jZQpdXQpmdW5jdGlvbiBfQ2lyY2xlOlNldDJEKCkKCiAgICBzZWxmLm1vZGUgPSBDSVJDTEVfMkQKICAgIHJldHVybiBzZWxmCgplbmQKCi0tW1sKICAgIFNldCB0aGlzIGNpcmNsZSB0byBiZSBkaXNwbGF5ZWQgM0QKCiAgICBAcmV0dXJuIHwgY2xhc3MgfCBUaGUgY3VycmVudCBpbnN0YW5jZQpdXQpmdW5jdGlvbiBfQ2lyY2xlOlNldDNEKCkKCiAgICBzZWxmLm1vZGUgPSBDSVJDTEVfM0QKICAgIHJldHVybiBzZWxmCgplbmQKCi0tW1sKICAgIFNldCB0aGlzIGNpcmNsZSB0byBiZSBkaXNwbGF5ZWQgb24gdGhlIG1pbmltYXAKCiAgICBAcmV0dXJuIHwgY2xhc3MgfCBUaGUgY3VycmVudCBpbnN0YW5jZQpdXQpmdW5jdGlvbiBfQ2lyY2xlOlNldE1pbmltYXAoKQoKICAgIHNlbGYubW9kZSA9IENJUkNMRV9NSU5JTUFQCiAgICByZXR1cm4gc2VsZgoKZW5kCgotLVtbCiAgICBTZXQgdGhlIGRpc3BsYXkgcXVhbGl0eSBvZiB0aGlzIGNpcmNsZQoKICAgIEByZXR1cm4gfCBjbGFzcyB8IFRoZSBjdXJyZW50IGluc3RhbmNlCl1dCmZ1bmN0aW9uIF9DaXJjbGU6U2V0UXVhbGl0eShxdWFsdGl5KQoKICAgIGFzc2VydChxdWFsdGl5IGFuZCB0eXBlKHF1YWx0aXkpID09ICJudW1iZXIiLCAiX0NpcmNsZTogcXVhbGl0eSBpcyBpbnZhbGlkISIpCiAgICBzZWxmLnF1YWxpdHkgPSBxdWFsaXR5CiAgICByZXR1cm4gc2VsZgoKZW5kCgotLVtbCiAgICBTZXQgdGhlIGRyYXcgY29uZGl0aW9uIG9mIHRoaXMgY2lyY2xlCgogICAgQHJldHVybiB8IGNsYXNzIHwgVGhlIGN1cnJlbnQgaW5zdGFuY2UKXV0KZnVuY3Rpb24gX0NpcmNsZTpTZXREcmF3Q29uZGl0aW9uKGNvbmRpdGlvbikKCiAgICBhc3NlcnQoY29uZGl0aW9uIGFuZCB0eXBlKGNvbmRpdGlvbikgPT0gImZ1bmN0aW9uIiwgIl9DaXJjbGU6IGNvbmRpdGlvbiBpcyBpbnZhbGlkISIpCiAgICBzZWxmLmNvbmRpdGlvbiA9IGNvbmRpdGlvbgogICAgcmV0dXJuIHNlbGYKCmVuZAoKLS1bWwogICAgTGlua3MgdGhlIHNwZWxsIHJhbmdlIHdpdGggdGhlIGNpcmNsZSByYWRpdXMKCiAgICBAcGFyYW0gc3BlbGwgICAgICAgICB8IGNsYXNzIHwgSW5zdGFuY2Ugb2YgU3BlbGwgY2xhc3MKICAgIEBwYXJhbSBkcmF3V2hlblJlYWR5IHwgYm9vbCAgfCBEZWNpZGVzIHdoZXRoZXIgdG8gZHJhdyB0aGUgY2lyY2xlIHdoZW4gdGhlIHNwZWxsIGlzIHJlYWR5IG9yIG5vdAogICAgQHJldHVybiAgICAgICAgICAgICAgfCBjbGFzcyB8IFRoZSBjdXJyZW50IGluc3RhbmNlCl1dCmZ1bmN0aW9uIF9DaXJjbGU6TGlua1dpdGhTcGVsbChzcGVsbCwgZHJhd1doZW5SZWFkeSkKCiAgICBhc3NlcnQoc3BlbGwsICJfQ2lyY2xlOkxpbmtXaXRoU3BlbGwoKTogc3BlbGwgaXMgaW52YWxpZCIpCiAgICBzZWxmLl9saW5rZWRTcGVsbCA9IHNwZWxsCiAgICBzZWxmLl9saW5rZWRTcGVsbFJlYWR5ID0gZHJhd1doZW5SZWFkeSBvciBmYWxzZQogICAgcmV0dXJuIHNlbGYKCmVuZAoKLS1bWwogICAgRHJhdyB0aGlzIGNpcmNsZSwgc2hvdWxkIG9ubHkgYmUgY2FsbGVkIGZyb20gT25EcmF3KCkKXV0KZnVuY3Rpb24gX0NpcmNsZTpEcmF3KCkKCiAgICAtLSBEb24ndCBkcmF3IGlmIGNvbmRpdGlvbiBpcyBub3QgbWV0CiAgICBpZiBzZWxmLmNvbmRpdGlvbiB+PSBuaWwgYW5kIHNlbGYuY29uZGl0aW9uKCkgPT0gZmFsc2UgdGhlbiByZXR1cm4gZW5kCgogICAgLS0gVXBkYXRlIHZhbHVlcyBpZiBsaW5rZWQgc3BlbGwgaXMgZ2l2ZW4KICAgIGlmIHNlbGYuX2xpbmtlZFNwZWxsIHRoZW4KICAgICAgICBpZiBzZWxmLl9saW5rZWRTcGVsbFJlYWR5IGFuZCBub3Qgc2VsZi5fbGlua2VkU3BlbGw6SXNSZWFkeSgpIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIC0tIFVwZGF0ZSB0aGUgcmFkaXVzIHdpdGggdGhlIHNwZWxsIHJhbmdlCiAgICAgICAgc2VsZi5yYWRpdXMgPSBzZWxmLl9saW5rZWRTcGVsbC5yYW5nZQogICAgZW5kCgogICAgLS0gTWVudSBmb3VuZAogICAgaWYgc2VsZi5tZW51IHRoZW4KICAgICAgICBpZiBzZWxmLm1lbnVFbmFibGVkIH49IG5pbCB0aGVuCiAgICAgICAgICAgIGlmIG5vdCBzZWxmLm1lbnVbc2VsZi5tZW51RW5hYmxlZC52YXJdIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGVuZAogICAgICAgIGlmIHNlbGYubWVudUNvbG9yIH49IG5pbCB0aGVuCiAgICAgICAgICAgIHNlbGYuY29sb3IgPSBzZWxmLm1lbnVbc2VsZi5tZW51Q29sb3IudmFyXQogICAgICAgIGVuZAogICAgICAgIGlmIHNlbGYubWVudVdpZHRoIH49IG5pbCB0aGVuCiAgICAgICAgICAgIHNlbGYud2lkdGggPSBzZWxmLm1lbnVbc2VsZi5tZW51V2lkdGgudmFyXQogICAgICAgIGVuZAogICAgICAgIGlmIHNlbGYubWVudVF1YWxpdHkgfj0gbmlsIHRoZW4KICAgICAgICAgICAgc2VsZi5xdWFsaXR5ID0gc2VsZi5tZW51W3NlbGYubWVudVF1YWxpdHkudmFyXQogICAgICAgIGVuZAogICAgZW5kCgogICAgbG9jYWwgY2VudGVyID0gV29ybGRUb1NjcmVlbihEM0RYVkVDVE9SMyhzZWxmLnBvc2l0aW9uLngsIHNlbGYucG9zaXRpb24ueSwgc2VsZi5wb3NpdGlvbi56KSkKICAgIGlmIG5vdCBzZWxmOlBvaW50T25TY3JlZW4oY2VudGVyLngsIGNlbnRlci55KSBhbmQgc2VsZi5tb2RlIH49IENJUkNMRV9NSU5JTUFQIHRoZW4KICAgICAgICByZXR1cm4KICAgIGVuZAoKICAgIGlmIHNlbGYubW9kZSA9PSBDSVJDTEVfMkQgdGhlbgogICAgICAgIERyYXdDaXJjbGUyRChzZWxmLnBvc2l0aW9uLngsIHNlbGYucG9zaXRpb24ueSwgc2VsZi5yYWRpdXMsIHNlbGYud2lkdGgsIFRBUkdCKHNlbGYuY29sb3IpLCBzZWxmLnF1YWxpdHkpCiAgICBlbHNlaWYgc2VsZi5tb2RlID09IENJUkNMRV8zRCB0aGVuCiAgICAgICAgRHJhd0NpcmNsZTNEKHNlbGYucG9zaXRpb24ueCwgc2VsZi5wb3NpdGlvbi55LCBzZWxmLnBvc2l0aW9uLnosIHNlbGYucmFkaXVzLCBzZWxmLndpZHRoLCBUQVJHQihzZWxmLmNvbG9yKSwgc2VsZi5xdWFsaXR5KQogICAgZWxzZWlmIHNlbGYubW9kZSA9PSBDSVJDTEVfTUlOSU1BUCB0aGVuCiAgICAgICAgRHJhd0NpcmNsZU1pbmltYXAoc2VsZi5wb3NpdGlvbi54LCBzZWxmLnBvc2l0aW9uLnksIHNlbGYucG9zaXRpb24ueiwgc2VsZi5yYWRpdXMsIHNlbGYud2lkdGgsIFRBUkdCKHNlbGYuY29sb3IpLCBzZWxmLnF1YWxpdHkpCiAgICBlbHNlCiAgICAgICAgcHJpbnQoIkNpcmNsZTogU29tZXRoaW5nIGlzIHdyb25nIHdpdGggdGhlIGNpcmNsZS5tb2RlISIpCiAgICBlbmQKCmVuZAoKZnVuY3Rpb24gX0NpcmNsZTpQb2ludE9uU2NyZWVuKHgsIHkpCiAgICByZXR1cm4geCA8PSBXSU5ET1dfVyBhbmQgeCA+PSAwIGFuZCB5ID49IDAgYW5kIHkgPD0gV0lORE9XX0gKZW5kCgpmdW5jdGlvbiBfQ2lyY2xlOl9fZXEob3RoZXIpCiAgICByZXR1cm4gb3RoZXIuX2NpcmNsZUlkIGFuZCBvdGhlci5fY2lyY2xlSWQgPT0gc2VsZi5fY2lyY2xlSWQgb3IgZmFsc2UKZW5kCgotLVtbCgonfHwnJ3wuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd8fCcgICAgICAgfHwgICd8fAogfHwgICB8fCAgIC4uLi4gICAuLiAuLiAuLiAgICAuLi4uICAgICAuLi4gLiAgIC4uLi4gICB8fCAgICAgICAuLi4gICB8fCAuLi4KIHx8ICAgIHx8ICcnIC58fCAgIHx8IHx8IHx8ICAnJyAufHwgICB8fCB8fCAgLnwuLi58fCAgfHwgICAgICAgIHx8ICAgfHwnICB8fAogfHwgICAgfHwgLnwnIHx8ICAgfHwgfHwgfHwgIC58JyB8fCAgICB8JycgICB8fCAgICAgICB8fCAgICAgICAgfHwgICB8fCAgICB8Ci58fC4uLnwnICAnfC4uJ3wnIC58fCB8fCB8fC4gJ3wuLid8JyAgJ3x8fHwuICAnfC4uLicgLnx8Li4uLi58IC58fC4gICd8Li4uJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnwuLi4uJwoKICAgIERhbWFnZUxpYiAtIEhvbHkgY293LCBzbyBwcmVjaXNlIQoKICAgIEZ1bmN0aW9uczoKICAgICAgICBEYW1hZ2VMaWIoc291cmNlKQoKICAgIE1lbWJlcnM6CiAgICAgICAgRGFtYWdlTGliLnNvdXJjZSB8IEN1bml0IHwgU291cmNlIHVuaXQgZm9yIHdoaWNoIHRoZSBkYW1hZ2Ugc2hvdWxkIGJlIGNhbGN1bGF0ZWQKCiAgICBNZXRob2RzOgogICAgICAgIERhbWFnZUxpYjpSZWdpc3RlckRhbWFnZVNvdXJjZShzcGVsbElkLCBkYW1hZ2V0eXBlLCBiYXNlZGFtYWdlLCBwZXJsZXZlbCwgc2NhbGluZ3R5cGUsIHNjYWxpbmdzdGF0LCBwZXJjZW50c2NhbGluZywgY29uZGl0aW9uLCBleHRyYSkKICAgICAgICBEYW1hZ2VMaWI6R2V0U2NhbGluZ0RhbWFnZSh0YXJnZXQsIHNjYWxpbmd0eXBlLCBzY2FsaW5nc3RhdCwgcGVyY2VudHNjYWxpbmcpCiAgICAgICAgRGFtYWdlTGliOkdldFRydWVEYW1hZ2UodGFyZ2V0LCBzcGVsbCwgZGFtYWdldHlwZSwgYmFzZWRhbWFnZSwgcGVybGV2ZWwsIHNjYWxpbmd0eXBlLCBzY2FsaW5nc3RhdCwgcGVyY2VudHNjYWxpbmcsIGNvbmRpdGlvbiwgZXh0cmEpCiAgICAgICAgRGFtYWdlTGliOkNhbGNTcGVsbERhbWFnZSh0YXJnZXQsIHNwZWxsKQogICAgICAgIERhbWFnZUxpYjpDYWxjQ29tYm9EYW1hZ2UodGFyZ2V0LCBjb21ibykKICAgICAgICBEYW1hZ2VMaWI6SXNLaWxsYWJsZSh0YXJnZXQsIGNvbWJvKQogICAgICAgIERhbWFnZUxpYjpBZGRUb01lbnUobWVudSwgY29tYm8pCgogICAgLUF2YWlsYWJsZSBzcGVsbHMgYnkgZGVmYXVsdCAobm90IGFkZGVkIHlldCk6CiAgICAgICAgX0FBOiBSZXR1cm5zIHRoZSBhdXRvLWF0dGFjayBkYW1hZ2UuCiAgICAgICAgX0lHTklURTogUmV0dXJucyB0aGUgaWduaXRlIGRhbWFnZS4KICAgICAgICBfSVRFTVM6IFJldHVybnMgdGhlIGRhbWFnZSBkZWFsdCBieSBhbGwgdGhlIGl0ZW1zIGFjdGl2ZXMuCgogICAgLURhbWFnZSB0eXBlczoKICAgICAgICBfTUFHSUMKICAgICAgICBfUEhZU0lDQUwKICAgICAgICBfVFJVRQoKICAgIC1TY2FsaW5nIHR5cGVzOiBfQVAsIF9BRCwgX0JPTlVTX0FELCBfSEVBTFRILCBfQVJNT1IsIF9NUiwgX01BWEhFQUxUSCwgX01BWE1BTkEKXV0KY2xhc3MgJ0RhbWFnZUxpYicKCi0tRGFtYWdlIHR5cGVzCl9NQUdJQywgX1BIWVNJQ0FMLCBfVFJVRSA9IDAsIDEsIDIKCi0tUGVyY2VudGFnZSBzY2FsZSB0eXBlJ3MKX0FQLCBfQUQsIF9CT05VU19BRCwgX0hFQUxUSCwgX0FSTU9SLCBfTVIsIF9NQVhIRUFMVEgsIF9NQVhNQU5BID0gMSwgMiwgMywgNCwgNSwgNiwgNywgOAoKLS1QZXJjZW50YWdlIHNjYWxlIGZ1bmN0aW9ucwpsb2NhbCBfU2NhbGluZ0Z1bmN0aW9ucyA9IHsKICAgIFtfQVBdID0gZnVuY3Rpb24oeCwgeSkgcmV0dXJuIHggKiB5LnNvdXJjZS5hcCBlbmQsCiAgICBbX0FEXSA9IGZ1bmN0aW9uKHgsIHkpIHJldHVybiB4ICogeS5zb3VyY2UudG90YWxEYW1hZ2UgZW5kLAogICAgW19CT05VU19BRF0gPSBmdW5jdGlvbih4LCB5KSByZXR1cm4geCAqIHkuc291cmNlLmFkZERhbWFnZSBlbmQsCiAgICBbX0FSTU9SXSA9IGZ1bmN0aW9uKHgsIHkpIHJldHVybiB4ICogeS5zb3VyY2UuYXJtb3IgZW5kLAogICAgW19NUl0gPSBmdW5jdGlvbih4LCB5KSByZXR1cm4geCAqIHkuc291cmNlLm1hZ2ljQXJtb3IgZW5kLAogICAgW19NQVhIRUFMVEhdID0gZnVuY3Rpb24oeCwgeSkgcmV0dXJuIHggKiB5LnNvdXJjZS5tYXhIZWF0aCBlbmQsCiAgICBbX01BWE1BTkFdID0gZnVuY3Rpb24oeCwgeSkgcmV0dXJuIHggKiB5LnNvdXJjZS5tYXhNYW5hIGVuZCwKfQoKLS1bWwogICAgTmV3IGluc3RhbmNlIG9mIERhbWFnZUxpYgoKICAgIEBwYXJhbSBzb3VyY2UgfCBDdW5pdCB8IFNvdXJjZSB1bml0IChhdHRhY2tlciwgcGxheWVyIGJ5IGRlZmF1bHQpCl1dCmZ1bmN0aW9uIERhbWFnZUxpYjpfX2luaXQoc291cmNlKQoKICAgIHNlbGYuc291cmNlcyA9IHt9CiAgICBzZWxmLnNvdXJjZSA9IHNvdXJjZSBvciBwbGF5ZXIKCiAgICAtLURhbWFnZSBtdWx0aXBsaWNhdG9yczoKICAgIHNlbGYuTWFnaWNfZGFtYWdlX20gICAgPSAxCiAgICBzZWxmLlBoeXNpY2FsX2RhbWFnZV9tID0gMQoKICAgIC0tIE1vc3QgY29tbW9uIGRhbWFnZSBzb3VyY2VzCiAgICBzZWxmOlJlZ2lzdGVyRGFtYWdlU291cmNlKF9JR05JVEUsIF9UUlVFLCAwLCAwLCBfVFJVRSwgX0FQLCAwLCBmdW5jdGlvbigpIHJldHVybiBfSUdOSVRFIGFuZCAoc2VsZi5zb3VyY2U6Q2FuVXNlU3BlbGwoX0lHTklURSkgPT0gUkVBRFkpIGVuZCwgZnVuY3Rpb24oKSByZXR1cm4gKDUwICsgMjAgKiBzZWxmLnNvdXJjZS5sZXZlbCkgZW5kKQogICAgc2VsZjpSZWdpc3RlckRhbWFnZVNvdXJjZShJdGVtTWFuYWdlcjpHZXRJdGVtKCJERkciKTpHZXRJZCgpLCBfTUFHSUMsIDAsIDAsIF9NQUdJQywgX0FQLCAwLCBmdW5jdGlvbigpIHJldHVybiBJdGVtTWFuYWdlcjpHZXRJdGVtKCJERkciKTpHZXRTbG90KCkgYW5kIChzZWxmLnNvdXJjZTpDYW5Vc2VTcGVsbChJdGVtTWFuYWdlcjpHZXRJdGVtKCJERkciKTpHZXRTbG90KCkpID09IFJFQURZKSBlbmQsIGZ1bmN0aW9uKHRhcmdldCkgcmV0dXJuIDAuMTUgKiB0YXJnZXQubWF4SGVhbHRoIGVuZCkKICAgIHNlbGY6UmVnaXN0ZXJEYW1hZ2VTb3VyY2UoSXRlbU1hbmFnZXI6R2V0SXRlbSgiQk9UUksiKTpHZXRJZCgpLCBfTUFHSUMsIDAsIDAsIF9NQUdJQywgX0FQLCAwLCBmdW5jdGlvbigpIHJldHVybiBJdGVtTWFuYWdlcjpHZXRJdGVtKCJCT1RSSyIpOkdldFNsb3QoKSBhbmQgKHNlbGYuc291cmNlOkNhblVzZVNwZWxsKEl0ZW1NYW5hZ2VyOkdldEl0ZW0oIkJPVFJLIik6R2V0U2xvdCgpKSA9PSBSRUFEWSkgZW5kLCBmdW5jdGlvbih0YXJnZXQpIHJldHVybiAwLjE1ICogdGFyZ2V0Lm1heEhlYWx0aCBlbmQpCiAgICBzZWxmOlJlZ2lzdGVyRGFtYWdlU291cmNlKF9BQSwgX1BIWVNJQ0FMLCAwLCAwLCBfUEhZU0lDQUwsIF9BRCwgMSkKCmVuZAoKLS1bWwogICAgUmVnaXN0ZXIgYSBuZXcgc3BlbGwKCiAgICBAcGFyYW0gc3BlbGxJZCAgICAgICAgfCBpbnQgICAgICB8ICh1bmlxdWUpIFNwZWxsIGlkIHRvIGFkZC4KCiAgICBAcGFyYW0gZGFtYWdldHlwZSAgICAgfCBpbnQgICAgICB8IFRoZSB0eXBlKHMpIG9mIHRoZSBiYXNlIGFuZCBwZXJsZXZlbCBkYW1hZ2UgKF9NQUdJQywgX1BIWVNJQ0FMLCBfVFJVRSkuCiAgICBAcGFyYW0gYmFzZWRhbWFnZSAgICAgfCBpbnQgICAgICB8IEJhc2UgZGFtYWdlKHMpIG9mIHRoZSBzcGVsbC4KICAgIEBwYXJhbSBwZXJsZXZlbCAgICAgICB8IGludCAgICAgIHwgRGFtYWdlKHMpIHNjYWxpbmcgcGVyIGxldmVsLgoKICAgIEBwYXJhbSBzY2FsaW5ndHlwZSAgICB8IGludCAgICAgIHwgVHlwZShzKSBvZiB0aGUgcGVyY2VudGFnZSBzY2FsZSAoX01BR0lDLCBfUEhZU0lDQUwsIF9UUlVFKS4KICAgIEBwYXJhbSBzY2FsaW5nc3RhdCAgICB8IGludCAgICAgIHwgU3RhdChzKSB0aGF0IHRoZSBkYW1hZ2Ugc2NhbGVzIHdpdGguCiAgICBAcGFyYW0gcGVyY2VudHNjYWxpbmcgfCBpbnQgICAgICB8IFBlcmNlbnRhZ2UocykgdGhlIHN0YXQgc2NhbGVzIHdpdGguCgogICAgQHBhcmFtIGNvbmRpdGlvbiAgICAgIHwgZnVuY3Rpb24gfCAob3B0aW9uYWwpIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRydWUgLyBmYWxzZSBkZXBlbmRpbmcgaWYgdGhlIGRhbWFnZSB3aWxsIGJlIHRha2VuIGludG8gYWNjb3VudCBvciBub3QsIHRoZSB0YXJnZXQgaXMgcGFzc2VkIGFzIHBhcmFtLgogICAgQHBhcmFtIGV4dHJhICAgICAgICAgIHwgZnVuY3Rpb24gfCAob3B0aW9uYWwpIEEgZnVuY3Rpb24gcmV0dXJuaW5nIGV4dHJhIGRhbWFnZSwgdGhlIHRhcmdldCBpcyBwYXNzZWQgYXMgcGFyYW0uCgogICAgLUV4YW1wbGUgU3BlbGxzOgogICAgVGVlbW8gUTogIDgwIC8gMTI1IC8gMTcwIC8gMjE1IC8gMjYwICgrIDgwJSBBUCkgKE1BR0lDKQogICAgRGFtYWdlTGliOlJlZ2lzdGVyRGFtYWdlU291cmNlKF9RLCBfTUFHSUMsIDM1LCA0NSwgX01BR0lDLCBfQVAsIDAuOCwgZnVuY3Rpb24oKSByZXR1cm4gKHBsYXllcjpDYW5Vc2VTcGVsbChfUSkgPT0gUkVBRFkpIGVuZCkKCiAgICBBa2FsaXMgRTogMzAgLyA1NSAvIDgwIC8gMTA1IC8gMTMwICgrIDMwJSBBUCkgKCsgNjAlIEFEKSAoUEhZU0lDQUwpCiAgICBEYW1hZ2VMaWI6UmVnaXN0ZXJEYW1hZ2VTb3VyY2UoX0UsIF9QSFlTSUNBTCwgNSwgMjUsIHtfUEhZU0lDQUwsX1BIWVNJQ0FMfSwge19BUCwgX0FEfSwgezAuMywgMC42fSwgZnVuY3Rpb24oKSByZXR1cm4gKHBsYXllcjpHZXRTcGVsbERhdGEoX1EpLmN1cnJlbnRDZCA8IDIpIG9yIChwbGF5ZXI6Q2FuVXNlU3BlbGwoX1EpID09IFJFQURZKSBlbmQpCgogICAgKiBkYW1hZ2V0eXBlLCBiYXNlZGFtYWdlLCBwZXJsZXZlbCBhbmQgc2NhbGluZ3R5cGUsIHNjYWxpbmdzdGF0LCBwZXJjZW50c2NhbGluZyBjYW4gYmUgdGFibGVzIGlmIHRoZXJlIGFyZSAyIG9yIG1vcmUgZGFtYWdlIHR5cGVzLgpdXQpmdW5jdGlvbiBEYW1hZ2VMaWI6UmVnaXN0ZXJEYW1hZ2VTb3VyY2Uoc3BlbGxJZCwgZGFtYWdldHlwZSwgYmFzZWRhbWFnZSwgcGVybGV2ZWwsIHNjYWxpbmd0eXBlLCBzY2FsaW5nc3RhdCwgcGVyY2VudHNjYWxpbmcsIGNvbmRpdGlvbiwgZXh0cmEpCgogICAgY29uZGl0aW9uID0gY29uZGl0aW9uIG9yIGZ1bmN0aW9uKCkgcmV0dXJuIHRydWUgZW5kCiAgICBpZiBzcGVsbElkIHRoZW4KICAgICAgICBzZWxmLnNvdXJjZXNbc3BlbGxJZF0gPSB7ZGFtYWdldHlwZSA9IGRhbWFnZXR5cGUsIGJhc2VkYW1hZ2UgPSBiYXNlZGFtYWdlLCBwZXJsZXZlbCA9IHBlcmxldmVsLCBjb25kaXRpb24gPSBjb25kaXRpb24sIGV4dHJhID0gZXh0cmEsIHNjYWxpbmd0eXBlID0gc2NhbGluZ3R5cGUsIHBlcmNlbnRzY2FsaW5nID0gcGVyY2VudHNjYWxpbmcsIHNjYWxpbmdzdGF0ID0gc2NhbGluZ3N0YXR9CiAgICBlbmQKCmVuZAoKZnVuY3Rpb24gRGFtYWdlTGliOkdldFNjYWxpbmdEYW1hZ2UodGFyZ2V0LCBzY2FsaW5ndHlwZSwgc2NhbGluZ3N0YXQsIHBlcmNlbnRzY2FsaW5nKQoKICAgIGxvY2FsIGFtb3VudCA9IChfU2NhbGluZ0Z1bmN0aW9uc1tzY2FsaW5nc3RhdF0gb3IgZnVuY3Rpb24oKSByZXR1cm4gMCBlbmQpKHBlcmNlbnRzY2FsaW5nLCBzZWxmKQoKICAgIGlmIHNjYWxpbmd0eXBlID09IF9NQUdJQyB0aGVuCiAgICAgICAgcmV0dXJuIHNlbGYuTWFnaWNfZGFtYWdlX20gKiBzZWxmLnNvdXJjZTpDYWxjTWFnaWNEYW1hZ2UodGFyZ2V0LCBhbW91bnQpCiAgICBlbHNlaWYgc2NhbGluZ3R5cGUgPT0gX1BIWVNJQ0FMIHRoZW4KICAgICAgICByZXR1cm4gc2VsZi5QaHlzaWNhbF9kYW1hZ2VfbSAqIHNlbGYuUGh5c2ljYWxfZGFtYWdlX20gKiBzZWxmLnNvdXJjZTpDYWxjRGFtYWdlKHRhcmdldCwgYW1vdW50KQogICAgZWxzZWlmIHNjYWxpbmd0eXBlID09IF9UUlVFIHRoZW4KICAgICAgICByZXR1cm4gYW1vdW50CiAgICBlbmQKCiAgICByZXR1cm4gMAoKZW5kCgpmdW5jdGlvbiBEYW1hZ2VMaWI6R2V0VHJ1ZURhbWFnZSh0YXJnZXQsIHNwZWxsLCBkYW1hZ2V0eXBlLCBiYXNlZGFtYWdlLCBwZXJsZXZlbCwgc2NhbGluZ3R5cGUsIHNjYWxpbmdzdGF0LCBwZXJjZW50c2NhbGluZywgY29uZGl0aW9uLCBleHRyYSkKCiAgICBiYXNlZGFtYWdlID0gYmFzZWRhbWFnZSBvciAwCiAgICBwZXJsZXZlbCA9IHBlcmxldmVsIG9yIDAKICAgIGNvbmRpdGlvbiA9IGNvbmRpdGlvbih0YXJnZXQpCiAgICBzY2FsaW5ndHlwZSA9IHNjYWxpbmd0eXBlIG9yIDAKICAgIHNjYWxpbmdzdGF0ID0gc2NhbGluZ3N0YXQgb3IgX0FQCiAgICBwZXJjZW50c2NhbGluZyA9IHBlcmNlbnRzY2FsaW5nIG9yIDAKICAgIGV4dHJhID0gZXh0cmEgb3IgZnVuY3Rpb24oKSByZXR1cm4gMCBlbmQKICAgIGxvY2FsIFNjYWxpbmdEYW1hZ2UgPSAwCgogICAgaWYgbm90IGNvbmRpdGlvbiB0aGVuIHJldHVybiAwIGVuZAoKICAgIGlmIHR5cGUoc2NhbGluZ3R5cGUpID09ICJudW1iZXIiIHRoZW4KICAgICAgICBTY2FsaW5nRGFtYWdlID0gU2NhbGluZ0RhbWFnZSArIHNlbGY6R2V0U2NhbGluZ0RhbWFnZSh0YXJnZXQsIHNjYWxpbmd0eXBlLCBzY2FsaW5nc3RhdCwgcGVyY2VudHNjYWxpbmcpCiAgICBlbHNlaWYgdHlwZShzY2FsaW5ndHlwZSkgPT0gInRhYmxlIiB0aGVuCiAgICAgICAgZm9yIGksIHYgaW4gaXBhaXJzKHNjYWxpbmd0eXBlKSBkbwogICAgICAgICAgICBTY2FsaW5nRGFtYWdlID0gU2NhbGluZ0RhbWFnZSArIHNlbGY6R2V0U2NhbGluZ0RhbWFnZSh0YXJnZXQsIHNjYWxpbmd0eXBlW2ldLCBzY2FsaW5nc3RhdFtpXSwgcGVyY2VudHNjYWxpbmdbaV0pCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBpZiBkYW1hZ2V0eXBlID09IF9NQUdJQyB0aGVuCiAgICAgICAgcmV0dXJuIHNlbGYuTWFnaWNfZGFtYWdlX20gKiBzZWxmLnNvdXJjZTpDYWxjTWFnaWNEYW1hZ2UodGFyZ2V0LCBiYXNlZGFtYWdlICsgcGVybGV2ZWwgKiBzZWxmLnNvdXJjZTpHZXRTcGVsbERhdGEoc3BlbGwpLmxldmVsICsgZXh0cmEodGFyZ2V0KSkgKyBTY2FsaW5nRGFtYWdlCiAgICBlbmQKICAgIGlmIGRhbWFnZXR5cGUgPT0gX1BIWVNJQ0FMIHRoZW4KICAgICAgICByZXR1cm4gc2VsZi5QaHlzaWNhbF9kYW1hZ2VfbSAqIHNlbGYuc291cmNlOkNhbGNEYW1hZ2UodGFyZ2V0LCBiYXNlZGFtYWdlICsgcGVybGV2ZWwgKiBzZWxmLnNvdXJjZTpHZXRTcGVsbERhdGEoc3BlbGwpLmxldmVsICsgZXh0cmEodGFyZ2V0KSkgKyBTY2FsaW5nRGFtYWdlCiAgICBlbmQKICAgIGlmIGRhbWFnZXR5cGUgPT0gX1RSVUUgdGhlbgogICAgICAgIHJldHVybiBiYXNlZGFtYWdlICsgcGVybGV2ZWwgKiBzZWxmLnNvdXJjZTpHZXRTcGVsbERhdGEoc3BlbGwpLmxldmVsICsgZXh0cmEodGFyZ2V0KSArIFNjYWxpbmdEYW1hZ2UKICAgIGVuZAoKICAgIHJldHVybiAwCgplbmQKCmZ1bmN0aW9uIERhbWFnZUxpYjpDYWxjU3BlbGxEYW1hZ2UodGFyZ2V0LCBzcGVsbCkKCiAgICBpZiBub3Qgc3BlbGwgdGhlbiByZXR1cm4gMCBlbmQKICAgIGxvY2FsIHNwZWxsZGF0YSA9IHNlbGYuc291cmNlc1tzcGVsbF0KICAgIGxvY2FsIHJlc3VsdCA9IDAKICAgIGFzc2VydChzcGVsbGRhdGEsICJEYW1hZ2VMaWI6IFRoZSBzcGVsbCBoYXMgdG8gYmUgYWRkZWQgZmlyc3QhIikKCiAgICBsb2NhbCBfdHlwZSA9IHR5cGUoc3BlbGxkYXRhLmRhbWFnZXR5cGUpCgogICAgaWYgX3R5cGUgPT0gIm51bWJlciIgdGhlbgogICAgICAgIHJlc3VsdCA9IHNlbGY6R2V0VHJ1ZURhbWFnZSh0YXJnZXQsIHNwZWxsLCBzcGVsbGRhdGEuZGFtYWdldHlwZSwgc3BlbGxkYXRhLmJhc2VkYW1hZ2UsIHNwZWxsZGF0YS5wZXJsZXZlbCwgc3BlbGxkYXRhLnNjYWxpbmd0eXBlLCBzcGVsbGRhdGEuc2NhbGluZ3N0YXQsIHNwZWxsZGF0YS5wZXJjZW50c2NhbGluZywgc3BlbGxkYXRhLmNvbmRpdGlvbiwgc3BlbGxkYXRhLmV4dHJhKQogICAgZWxzZWlmIF90eXBlID09ICJ0YWJsZSIgdGhlbgogICAgICAgIGZvciBpID0gMSwgI3NwZWxsZGF0YS5kYW1hZ2V0eXBlLCAxIGRvCiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdCArIHNlbGY6R2V0VHJ1ZURhbWFnZSh0YXJnZXQsIHNwZWxsLCBzcGVsbGRhdGEuZGFtYWdldHlwZVtpXSwgc3BlbGxkYXRhLmJhc2VkYW1hZ2VbaV0sIHNwZWxsZGF0YS5wZXJsZXZlbFtpXSwgMCwgMCwgMCwgc3BlbGxkYXRhLmNvbmRpdGlvbikKICAgICAgICBlbmQKICAgICAgICByZXN1bHQgPSByZXN1bHQgKyBzZWxmOkdldFRydWVEYW1hZ2UodGFyZ2V0LCBzcGVsbCwgMCwgMCwgMCwgc3BlbGxkYXRhLnNjYWxpbmd0eXBlLCBzcGVsbGRhdGEuc2NhbGluZ3N0YXQsIHNwZWxsZGF0YS5wZXJjZW50c2NhbGluZywgc3BlbGxkYXRhLmNvbmRpdGlvbiwgc3BlbGxkYXRhLmV4dHJhKQogICAgZW5kCgogICAgcmV0dXJuIHJlc3VsdAoKZW5kCgpmdW5jdGlvbiBEYW1hZ2VMaWI6Q2FsY0NvbWJvRGFtYWdlKHRhcmdldCwgY29tYm8pCgogICAgbG9jYWwgdG90YWxkYW1hZ2UgPSAwCgogICAgZm9yIGksIHNwZWxsIGluIGlwYWlycyhjb21ibykgZG8KICAgICAgICBpZiBzcGVsbCA9PSBJdGVtTWFuYWdlcjpHZXRJdGVtKCJERkciKTpHZXRJZCgpIGFuZCBJdGVtTWFuYWdlcjpHZXRJdGVtKCJERkciKTpJc1JlYWR5KCkgdGhlbgogICAgICAgICAgICBzZWxmLk1hZ2ljX2RhbWFnZV9tID0gMS4yCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBmb3IgaSwgc3BlbGwgaW4gaXBhaXJzKGNvbWJvKSBkbwogICAgICAgIHRvdGFsZGFtYWdlID0gdG90YWxkYW1hZ2UgKyBzZWxmOkNhbGNTcGVsbERhbWFnZSh0YXJnZXQsIHNwZWxsKQogICAgZW5kCgogICAgc2VsZi5NYWdpY19kYW1hZ2VfbSA9IDEKCiAgICByZXR1cm4gdG90YWxkYW1hZ2UKCmVuZAoKLS1bWwogICAgUmV0dXJucyBpZiB0aGUgdW5pdCB3aWxsIGRpZSBhZnRlciB0YWtpbmcgdGhlIGNvbWJvIGRhbWFnZS4KCiAgICBAcGFyYW0gdGFyZ2V0IHwgQ3VuaXQgfCBUYXJnZXQuCiAgICBAcGFyYW0gY29tYm8gIHwgdGFibGUgfCBUaGUgY29tYm8gdGFibGUuCl1dCmZ1bmN0aW9uIERhbWFnZUxpYjpJc0tpbGxhYmxlKHRhcmdldCwgY29tYm8pCiAgICByZXR1cm4gdGFyZ2V0LmhlYWx0aCA8PSBzZWxmOkNhbGNDb21ib0RhbWFnZSh0YXJnZXQsIGNvbWJvKQplbmQKCi0tW1sKICAgIEFkZHMgdGhlIEhlYWx0aCBiYXIgaW5kaWNhdG9ycyB0byB0aGUgbWVudS4KCiAgICBAcGFyYW0gbWVudSAgfCBzY3JpcHRDb25maWcgfCBBbGxDbGFzcyBtZW51IG9yIHN1Ym1lbnUgaW5zdGFuY2UuCiAgICBAcGFyYW0gY29tYm8gfCB0YWJsZSAgICAgICAgfCBUaGUgY29tYm8gdGFibGUuCl1dCmZ1bmN0aW9uIERhbWFnZUxpYjpBZGRUb01lbnUobWVudSwgY29tYm8pCgogICAgc2VsZi5tZW51ID0gbWVudQogICAgc2VsZi5jb21ibyA9IGNvbWJvCiAgICBzZWxmLnRpY2tsaW1pdCA9IDUgLS01IHRpY2tzIHBlciBzZWNjb25kCiAgICBzZWxmLmJhcndpZHRoID0gMTAwCiAgICBzZWxmLmNhY2hlZERhbWFnZSA9IHt9CiAgICBtZW51OmFkZFBhcmFtKCJEcmF3UHJlZGljdGVkSGVhbHRoIiwgIkRyYXcgZGFtYWdlIGFmdGVyIGNvbWJvLiIsIFNDUklQVF9QQVJBTV9PTk9GRiAsIHRydWUpCiAgICBzZWxmLmVuYWJsZWQgPSBtZW51LkRyYXdQcmVkaWN0ZWRIZWFsdGgKICAgIEFkZFRpY2tDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6T25UaWNrKCkgZW5kKQogICAgQWRkRHJhd0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpPbkRyYXcoKSBlbmQpCgplbmQKCmZ1bmN0aW9uIERhbWFnZUxpYjpPblRpY2soKQoKICAgIGlmIG5vdCBzZWxmLm1lbnVbIkRyYXdQcmVkaWN0ZWRIZWFsdGgiXSB0aGVuIHJldHVybiBlbmQKICAgIHNlbGYubGFzdHRpY2sgPSBzZWxmLmxhc3R0aWNrIG9yIDAKICAgIGlmIG9zLmNsb2NrKCkgLSBzZWxmLmxhc3R0aWNrID4gMSAvIHNlbGYudGlja2xpbWl0IHRoZW4KICAgICAgICBzZWxmLmxhc3R0aWNrID0gb3MuY2xvY2soKQogICAgICAgIGZvciBpLCBlbmVteSBpbiBpcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8KICAgICAgICAgICAgaWYgVmFsaWRUYXJnZXQoZW5lbXkpIHRoZW4KICAgICAgICAgICAgICAgIHNlbGYuY2FjaGVkRGFtYWdlW2VuZW15Lmhhc2hdID0gc2VsZjpDYWxjQ29tYm9EYW1hZ2UoZW5lbXksIHNlbGYuY29tYm8pCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgplbmQKCmZ1bmN0aW9uIERhbWFnZUxpYjpPbkRyYXcoKQoKICAgIGlmIG5vdCBzZWxmLm1lbnVbIkRyYXdQcmVkaWN0ZWRIZWFsdGgiXSB0aGVuIHJldHVybiBlbmQKICAgIGZvciBpLCBlbmVteSBpbiBpcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8KICAgICAgICBpZiBWYWxpZFRhcmdldChlbmVteSkgdGhlbgogICAgICAgICAgICBzZWxmOkRyYXdJbmRpY2F0b3IoZW5lbXkpCiAgICAgICAgZW5kCiAgICBlbmQKCmVuZAoKZnVuY3Rpb24gRGFtYWdlTGliOkRyYXdJbmRpY2F0b3IoZW5lbXkpCgogICAgbG9jYWwgZGFtYWdlID0gc2VsZi5jYWNoZWREYW1hZ2VbZW5lbXkuaGFzaF0gb3IgMAogICAgbG9jYWwgU1BvcywgRVBvcyA9IEdldEVuZW15SFBCYXJQb3MoZW5lbXkpCgogICAgLS0gVmFsaWRhdGUgZGF0YQogICAgaWYgbm90IFNQb3MgdGhlbiByZXR1cm4gZW5kCgogICAgbG9jYWwgYmFyd2lkdGggPSBFUG9zLnggLSBTUG9zLngKICAgIGxvY2FsIFBvc2l0aW9uID0gU1Bvcy54ICsgbWF0aC5tYXgoMCwgKGVuZW15LmhlYWx0aCAtIGRhbWFnZSkgLyBlbmVteS5tYXhIZWFsdGgpICogYmFyd2lkdGgKCiAgICBEcmF3VGV4dCgifCIsIDE2LCBtYXRoLmZsb29yKFBvc2l0aW9uKSwgbWF0aC5mbG9vcihTUG9zLnkgKyA4KSwgQVJHQigyNTUsMCwyNTUsMCkpCiAgICBEcmF3VGV4dCgiSFA6ICIuLm1hdGguZmxvb3IoZW5lbXkuaGVhbHRoIC0gZGFtYWdlKSwgMTMsIG1hdGguZmxvb3IoU1Bvcy54KSwgbWF0aC5mbG9vcihTUG9zLnkpLCAoZW5lbXkuaGVhbHRoIC0gZGFtYWdlKSA+IDAgYW5kIEFSR0IoMjU1LCAwLCAyNTUsIDApIG9yICBBUkdCKDI1NSwgMjU1LCAwLCAwKSkKCmVuZAoKCi0tW1sKCiAufCcnJy58ICB8Jyd8fCcnfCAgLnwnJycufAogfHwuLiAgJyAgICAgfHwgICAgIHx8Li4gICcKICAnJ3x8fC4gICAgIHx8ICAgICAgJyd8fHwuCi4gICAgICd8fCAgICB8fCAgICAuICAgICAnfHwKfCcuLi4ufCcgICAgLnx8LiAgIHwnLi4uLnwnCgogICAgU2ltcGxlIFRhcmdldCBTZWxlY3RvciAoU1RTKSAtIFdoeSB1c2luZyB0aGUgcmVndWxhciBvbmUgd2hlbiB5b3UgY2FuIGhhdmUgaXQgZXZlbiBtb3JlIHNpbXBsZS4KCl1dCmNsYXNzICdTaW1wbGVUUycKCmZ1bmN0aW9uIFNUU19HRVRfUFJJT1JJVFkodGFyZ2V0KQogICAgaWYgbm90IFNUU19NRU5VIG9yIG5vdCBTVFNfTUVOVS5TVFNbdGFyZ2V0Lmhhc2hdIHRoZW4KICAgICAgICByZXR1cm4gMQogICAgZWxzZQogICAgICAgIHJldHVybiBTVFNfTUVOVS5TVFNbdGFyZ2V0Lmhhc2hdCiAgICBlbmQKZW5kCgpTVFNfTUVOVSA9IG5pbApTVFNfTkVBUk1PVVNFICAgICAgICAgICAgICAgICAgICAgPSB7aWQgPSAxLCBuYW1lID0gIk5lYXIgbW91c2UiLCBzb3J0ZnVuYyA9IGZ1bmN0aW9uKGEsIGIpIHJldHVybiBfR2V0RGlzdGFuY2VTcXIobW91c2VQb3MsIGEpIDwgX0dldERpc3RhbmNlU3FyKG1vdXNlUG9zLCBiKSBlbmR9ClNUU19MRVNTX0NBU1RfTUFHSUMgICAgICAgICAgICAgICA9IHtpZCA9IDIsIG5hbWUgPSAiTGVzcyBjYXN0IChtYWdpYykiLCBzb3J0ZnVuYyA9IGZ1bmN0aW9uKGEsIGIpIHJldHVybiAocGxheWVyOkNhbGNNYWdpY0RhbWFnZShhLCAxMDApIC8gYS5oZWFsdGgpID4gKHBsYXllcjpDYWxjTWFnaWNEYW1hZ2UoYiwgMTAwKSAvIGIuaGVhbHRoKSBlbmR9ClNUU19MRVNTX0NBU1RfUEhZU0lDQUwgICAgICAgICAgICA9IHtpZCA9IDMsIG5hbWUgPSAiTGVzcyBjYXN0IChwaHlzaWNhbCkiLCBzb3J0ZnVuYyA9IGZ1bmN0aW9uKGEsIGIpIHJldHVybiAocGxheWVyOkNhbGNEYW1hZ2UoYSwgMTAwKSAvIGEuaGVhbHRoKSA+IChwbGF5ZXI6Q2FsY0RhbWFnZShiLCAxMDApIC8gYi5oZWFsdGgpIGVuZH0KU1RTX1BSSU9SSVRZX0xFU1NfQ0FTVF9NQUdJQyAgICAgID0ge2lkID0gNCwgbmFtZSA9ICJMZXNzIGNhc3QgcHJpb3JpdHkgKG1hZ2ljKSIsIHNvcnRmdW5jID0gZnVuY3Rpb24oYSwgYikgcmV0dXJuIFNUU19HRVRfUFJJT1JJVFkoYSkgKiAocGxheWVyOkNhbGNNYWdpY0RhbWFnZShhLCAxMDApIC8gYS5oZWFsdGgpID4gU1RTX0dFVF9QUklPUklUWShiKSAqIChwbGF5ZXI6Q2FsY01hZ2ljRGFtYWdlKGIsIDEwMCkgLyBiLmhlYWx0aCkgZW5kfQpTVFNfUFJJT1JJVFlfTEVTU19DQVNUX1BIWVNJQ0FMICAgPSB7aWQgPSA1LCBuYW1lID0gIkxlc3MgY2FzdCBwcmlvcml0eSAocGh5c2ljYWwpIiwgc29ydGZ1bmMgPSBmdW5jdGlvbihhLCBiKSByZXR1cm4gU1RTX0dFVF9QUklPUklUWShhKSAqIChwbGF5ZXI6Q2FsY0RhbWFnZShhLCAxMDApIC8gYS5oZWFsdGgpID4gU1RTX0dFVF9QUklPUklUWShiKSAqIChwbGF5ZXI6Q2FsY0RhbWFnZShiLCAxMDApIC8gYi5oZWFsdGgpIGVuZH0KU1RTX0FWQUlMQUJMRV9NT0RFUyA9IHtTVFNfTkVBUk1PVVNFLCBTVFNfTEVTU19DQVNUX01BR0lDLCBTVFNfTEVTU19DQVNUX1BIWVNJQ0FMLCBTVFNfUFJJT1JJVFlfTEVTU19DQVNUX01BR0lDLCBTVFNfUFJJT1JJVFlfTEVTU19DQVNUX1BIWVNJQ0FMfQoKZnVuY3Rpb24gU2ltcGxlVFM6X19pbml0KG1vZGUpCiAgICBzZWxmLm1vZGUgPSBtb2RlIGFuZCBtb2RlIG9yIFNUU19MRVNTX0NBU1RfUEhZU0lDQUwKICAgIEFkZERyYXdDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6T25EcmF3KCkgZW5kKQogICAgQWRkTXNnQ2FsbGJhY2soZnVuY3Rpb24obXNnLCBrZXkpIHNlbGY6T25Nc2cobXNnLCBrZXkpIGVuZCkKZW5kCgpmdW5jdGlvbiBTaW1wbGVUUzpJc1ZhbGlkKHRhcmdldCwgcmFuZ2UsIHNlbGVjdGVkKQogICAgaWYgVmFsaWRUYXJnZXQodGFyZ2V0KSBhbmQgKF9HZXREaXN0YW5jZVNxcih0YXJnZXQpIDw9IHJhbmdlIG9yIChzZWxmLmhpdGJveG1vZGUgYW5kIChfR2V0RGlzdGFuY2VTcXIodGFyZ2V0KSA8PSAobWF0aC5zcXJ0KHJhbmdlKSArIHNlbGYuVlA6R2V0SGl0Qm94KG15SGVybykgKyBzZWxmLlZQOkdldEhpdEJveCh0YXJnZXQpKSBeIDIpKSkgdGhlbgogICAgICAgIGlmIHNlbGVjdGVkIG9yIChub3QgKEhhc0J1ZmYodGFyZ2V0LCAiVW5keWluZ1JhZ2UiKSBhbmQgKHRhcmdldC5oZWFsdGggPT0gMSkpIGFuZCBub3QgSGFzQnVmZih0YXJnZXQsICJKdWRpY2F0b3JJbnRlcnZlbnRpb24iKSkgdGhlbgogICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgIGVuZAogICAgZW5kCmVuZAoKZnVuY3Rpb24gU2ltcGxlVFM6QWRkVG9NZW51KG1lbnUpCiAgICBzZWxmLm1lbnUgPSBtZW51CiAgICBzZWxmLm1lbnU6YWRkU3ViTWVudSgiVGFyZ2V0IFByaW9yaXR5IiwgIlNUUyIpCiAgICBmb3IgaSwgdGFyZ2V0IGluIGlwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbwogICAgICAgICAgICBzZWxmLm1lbnUuU1RTOmFkZFBhcmFtKHRhcmdldC5oYXNoLCB0YXJnZXQuY2hhck5hbWUsIFNDUklQVF9QQVJBTV9TTElDRSwgMSwgMSwgNSwgMCkKICAgIGVuZAogICAgc2VsZi5tZW51LlNUUzphZGRQYXJhbSgiSW5mbyIsICJJbmZvIiwgU0NSSVBUX1BBUkFNX0lORk8sICI1IEhpZ2hlc3QgcHJpb3JpdHkiKQoKICAgIGxvY2FsIG1vZGVsaXN0ID0ge30KICAgIGZvciBpLCBtb2RlIGluIGlwYWlycyhTVFNfQVZBSUxBQkxFX01PREVTKSBkbwogICAgICAgIHRhYmxlLmluc2VydChtb2RlbGlzdCwgbW9kZS5uYW1lKQogICAgZW5kCgogICAgc2VsZi5tZW51OmFkZFBhcmFtKCJtb2RlIiwgIlRhcmdldHRpbmcgbW9kZTogIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIG1vZGVsaXN0KQogICAgc2VsZi5tZW51WyJtb2RlIl0gPSBzZWxmLm1vZGUuaWQKCiAgICBzZWxmLm1lbnU6YWRkUGFyYW0oIlNlbGVjdGVkIiwgIkZvY3VzIHNlbGVjdGVkIHRhcmdldCIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKCiAgICBTVFNfTUVOVSA9IHNlbGYubWVudQplbmQKCmZ1bmN0aW9uIFNpbXBsZVRTOk9uTXNnKG1zZywga2V5KQogICAgaWYgbXNnID09IFdNX0xCVVRUT05ET1dOIHRoZW4KICAgICAgICBsb2NhbCBNaW5pbXVtRGlzdGFuY2UgPSBtYXRoLmh1Z2UKICAgICAgICBsb2NhbCBTZWxlY3RlZFRhcmdldAogICAgICAgIGZvciBpLCBlbmVteSBpbiBpcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8KICAgICAgICAgICAgaWYgVmFsaWRUYXJnZXQoZW5lbXkpIHRoZW4KICAgICAgICAgICAgICAgIGlmIF9HZXREaXN0YW5jZVNxcihlbmVteSwgbW91c2VQb3MpIDw9IE1pbmltdW1EaXN0YW5jZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgTWluaW11bURpc3RhbmNlID0gX0dldERpc3RhbmNlU3FyKGVuZW15LCBtb3VzZVBvcykKICAgICAgICAgICAgICAgICAgICBTZWxlY3RlZFRhcmdldCA9IGVuZW15CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgaWYgU2VsZWN0ZWRUYXJnZXQgYW5kIE1pbmltdW1EaXN0YW5jZSA8IDE1MCAqIDE1MCB0aGVuCiAgICAgICAgICAgIHNlbGYuU1RhcmdldCA9IFNlbGVjdGVkVGFyZ2V0CiAgICAgICAgZWxzZQogICAgICAgICAgICBzZWxmLlNUYXJnZXQgPSBuaWwKICAgICAgICBlbmQKICAgIGVuZAplbmQKCmZ1bmN0aW9uIFNpbXBsZVRTOlNlbGVjdGVkVGFyZ2V0KCkKICAgIHJldHVybiBzZWxmLlNUYXJnZXQKZW5kCgpmdW5jdGlvbiBTaW1wbGVUUzpHZXRUYXJnZXQocmFuZ2UsIG4sIGZvcmNlbW9kZSkKICAgIGFzc2VydChyYW5nZSwgIlNpbXBsZVRTOiByYW5nZSBjYW4ndCBiZSBuaWwiKQogICAgcmFuZ2UgPSByYW5nZSAqIHJhbmdlCiAgICBsb2NhbCBQb3NpYmxlVGFyZ2V0cyA9IHt9CiAgICBsb2NhbCBzZWxlY3RlZCA9IHNlbGY6U2VsZWN0ZWRUYXJnZXQoKQoKICAgIGlmIHNlbGYubWVudSB0aGVuCiAgICAgICAgc2VsZi5tb2RlID0gU1RTX0FWQUlMQUJMRV9NT0RFU1tzZWxmLm1lbnUubW9kZV0KICAgICAgICBpZiBzZWxmLm1lbnUuU2VsZWN0ZWQgYW5kIHNlbGVjdGVkIGFuZCBzZWxlY3RlZC50eXBlID09IHBsYXllci50eXBlIGFuZCBzZWxmOklzVmFsaWQoc2VsZWN0ZWQsIHJhbmdlLCB0cnVlKSB0aGVuCiAgICAgICAgICAgIHJldHVybiBzZWxlY3RlZAogICAgICAgIGVuZAogICAgZW5kCgogICAgZm9yIGksIGVuZW15IGluIGlwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbwogICAgICAgIGlmIHNlbGY6SXNWYWxpZChlbmVteSwgcmFuZ2UpIHRoZW4KICAgICAgICAgICAgdGFibGUuaW5zZXJ0KFBvc2libGVUYXJnZXRzLCBlbmVteSkKICAgICAgICBlbmQKICAgIGVuZAogICAgdGFibGUuc29ydChQb3NpYmxlVGFyZ2V0cywgZm9yY2Vtb2RlIGFuZCBmb3JjZW1vZGUuc29ydGZ1bmMgb3Igc2VsZi5tb2RlLnNvcnRmdW5jKQoKICAgIHJldHVybiBQb3NpYmxlVGFyZ2V0c1tuIGFuZCBuIG9yIDFdCmVuZAoKZnVuY3Rpb24gU2ltcGxlVFM6T25EcmF3KCkKICAgIGxvY2FsIHNlbGVjdGVkID0gc2VsZjpTZWxlY3RlZFRhcmdldCgpCiAgICBpZiBzZWxmLm1lbnUgYW5kIHNlbGYubWVudS5TZWxlY3RlZCBhbmQgVmFsaWRUYXJnZXQoc2VsZWN0ZWQpIHRoZW4KICAgICAgICBEcmF3Q2lyY2xlM0Qoc2VsZWN0ZWQueCwgc2VsZWN0ZWQueSwgc2VsZWN0ZWQueiwgMTAwLCAyLCBBUkdCKDE3NSwgMCwgMjU1LCAwKSwgMjUpCiAgICBlbmQKZW5kCgoKLS1bWwoKJ3x8JyAgIC4gICAgICAgICAgICAgICAgICAgICAgJ3x8ICAgIHx8JwogfHwgIC58fC4gICAgLi4uLiAgLi4gLi4gLi4gICAgfHx8ICB8fHwgICAuLi4uICAgLi4gLi4uICAgIC4uLi4gICAgIC4uLiAuICAgLi4uLiAgLi4uIC4uCiB8fCAgIHx8ICAgLnwuLi58fCAgfHwgfHwgfHwgICB8J3wuLid8fCAgJycgLnx8ICAgfHwgIHx8ICAnJyAufHwgICB8fCB8fCAgLnwuLi58fCAgfHwnICcnCiB8fCAgIHx8ICAgfHwgICAgICAgfHwgfHwgfHwgICB8ICd8JyB8fCAgLnwnIHx8ICAgfHwgIHx8ICAufCcgfHwgICAgfCcnICAgfHwgICAgICAgfHwKLnx8LiAgJ3wuJyAgJ3wuLi4nIC58fCB8fCB8fC4gLnwuIHwgLnx8LiAnfC4uJ3wnIC58fC4gfHwuICd8Li4nfCcgICd8fHx8LiAgJ3wuLi4nIC58fC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnwuLi4uJwoKICAgIEl0ZW1NYW5hZ2VyIC0gQmV0dGVyIGhhbmRsZSB0aGVtIHByb3Blcmx5CgogICAgRnVuY3Rpb25zOgogICAgICAgIF9JdGVtTWFuYWdlcigpCgogICAgTWV0aG9kczoKICAgICAgICBfSXRlbU1hbmFnZXI6Q2FzdE9mZmVuc2l2ZUl0ZW1zKHRhcmdldCkKICAgICAgICBfSXRlbU1hbmFnZXI6R2V0SXRlbShuYW1lKQoKXV0KY2xhc3MgIl9JdGVtTWFuYWdlciIKCmZ1bmN0aW9uIF9JdGVtTWFuYWdlcjpfX2luaXQoKQogICAgc2VsZi5pdGVtcyA9IHsKICAgICAgICAgICAgWyJERkciXSA9IHtpZCA9IDMxMjgsIHJhbmdlID0gNjUwLCBjYW5jYXN0b25lbmVteSA9IHRydWV9LAogICAgICAgICAgICBbIkJPVFJLIl0gPSB7aWQgPSAzMTUzLCByYW5nZSA9IDQ1MCwgY2FuY2FzdG9uZW5lbXkgPSB0cnVlfQogICAgICAgIH0KCiAgICBzZWxmLnJlcXVlc3RlZGl0ZW1zID0ge30KZW5kCgotLVtbCiAgICBDYXN0cyBhbGwga25vd24gb2ZmZW5zaXZlIGl0ZW1zIG9uIHRoZSBnaXZlbiB0YXJnZXQKCiAgICBAcGFyYW0gdGFyZ2V0IHwgQ1VuaXQgfCBUYXJnZXQgdW5pdApdXQpmdW5jdGlvbiBfSXRlbU1hbmFnZXI6Q2FzdE9mZmVuc2l2ZUl0ZW1zKHRhcmdldCkKCiAgICBmb3IgbmFtZSwgaXRlbWRhdGEgaW4gcGFpcnMoc2VsZi5pdGVtcykgZG8KICAgICAgICBsb2NhbCBpdGVtID0gc2VsZjpHZXRJdGVtKG5hbWUpCiAgICAgICAgaWYgaXRlbTpJblJhbmdlKHRhcmdldCkgdGhlbgogICAgICAgICAgICBpdGVtOkNhc3QodGFyZ2V0KQogICAgICAgIGVuZAogICAgZW5kCgplbmQKCi0tW1sKICAgIEdldHMgdGhlIGl0ZW1zIGJ5IG5hbWUuCgogICAgQHBhcmFtIG5hbWUgICB8IHN0cmluZyB8IE5hbWUgb2YgdGhlIGl0ZW0gKG5vdCB0aGUgaW5nYW1lIG5hbWUsIHRoZSBuYW1lIHVzZWQgd2hlbiByZWdpc3RlcmluZywgbGlrZSBERkcpCiAgICBAcGFyYW0gcmV0dXJuIHwgY2xhc3MgIHwgSW5zdGFuY2Ugb2YgdGhlIGl0ZW0gdGhhdCB3YXMgcmVxdWVzdGVkIG9yIG5pbCBpZiBub3QgZm91bmQKXV0KZnVuY3Rpb24gX0l0ZW1NYW5hZ2VyOkdldEl0ZW0obmFtZSkKICAgIGFzc2VydChuYW1lIGFuZCBzZWxmLml0ZW1zW25hbWVdLCAiSXRlbU1hbmFnZXI6IEl0ZW0gbm90IGZvdW5kIikKICAgIGlmIG5vdCBzZWxmLnJlcXVlc3RlZGl0ZW1zW25hbWVdIHRoZW4KICAgICAgICBzZWxmLnJlcXVlc3RlZGl0ZW1zW25hbWVdID0gSXRlbShzZWxmLml0ZW1zW25hbWVdLmlkLCBzZWxmLml0ZW1zW25hbWVdLnJhbmdlKQogICAgZW5kCiAgICByZXR1cm4gc2VsZi5yZXF1ZXN0ZWRpdGVtc1tuYW1lXQplbmQKCi0tIE1ha2UgYSBnbG9iYWwgSXRlbU1hbmFnZXIgaW5zdGFuY2UuIFRoaXMgbWVhbnMgeW91IGRvbid0IG5lZWQgdG8gbWFrZSBhbiBpbnN0YW5jZSBmb3IgeW91cnNlbGYuCkl0ZW1NYW5hZ2VyID0gX0l0ZW1NYW5hZ2VyKCkKCgotLVtbCgonfHwnICAgLgogfHwgIC58fC4gICAgLi4uLiAgLi4gLi4gLi4KIHx8ICAgfHwgICAufC4uLnx8ICB8fCB8fCB8fAogfHwgICB8fCAgIHx8ICAgICAgIHx8IHx8IHx8Ci58fC4gICd8LicgICd8Li4uJyAufHwgfHwgfHwuCgogICAgSXRlbSAtIEJlc3QgdXNlZCBpbiBJdGVtTWFuYWdlcgoKICAgIEZ1bmN0aW9uczoKICAgICAgICBJdGVtKGlkLCByYW5nZSkKCiAgICBNZXRob2RzOgogICAgICAgIEl0ZW06R2V0SWQoKQogICAgICAgIEl0ZW06R2V0UmFuZ2Uoc3FyKQogICAgICAgIEl0ZW06R2V0U2xvdCgpCiAgICAgICAgSXRlbTpVcGRhdGVTbG90KCkKICAgICAgICBJdGVtOklzUmVhZHkoKQogICAgICAgIEl0ZW06SW5SYW5nZSh0YXJnZXQpCiAgICAgICAgSXRlbTpDYXN0KHBhcmFtMSwgcGFyYW0yKQoKXV0KY2xhc3MgIkl0ZW0iCgotLVtbCiAgICBDcmVhdGUgYSBuZXcgaW5zdGFuY2Ugb2YgSXRlbQoKICAgIEBwYXJhbSBpZCAgICB8IGludGVnZXIgfCBJdGVtIGlkCiAgICBAcGFyYW0gcmFuZ2UgfCBmbG9hdCAgIHwgKG9wdGlvbmFsKSBSYW5nZSBvZiB0aGUgaXRlbQpdXQpmdW5jdGlvbiBJdGVtOl9faW5pdChpZCwgcmFuZ2UpCgogICAgYXNzZXJ0KGlkIGFuZCB0eXBlKGlkKSA9PSAibnVtYmVyIiwgIkl0ZW06IGlkIGlzIGludmFsaWQhIikKICAgIGFzc2VydChub3QgcmFuZ2Ugb3IgcmFuZ2UgYW5kIHR5cGUocmFuZ2UpID09ICJudW1iZXIiLCAiSXRlbTogcmFuZ2UgaXMgaW52YWxpZCEiKQoKICAgIHNlbGYuaWQgPSBpZAogICAgc2VsZi5yYW5nZSA9IHJhbmdlCiAgICBzZWxmLnJhbmdlU3FyID0gcmFuZ2UgYW5kIHJhbmdlICogcmFuZ2UKICAgIHNlbGYuc2xvdCA9IEdldEludmVudG9yeVNsb3RJdGVtKGlkKQoKZW5kCgotLVtbCiAgICBSZXR1cm5zIHRoZSBpZCBvZiB0aGUgaXRlbQoKICAgIEByZXR1cm4gfCBpbnRlZ2VyIHwgSXRlbSBpZApdXQpmdW5jdGlvbiBJdGVtOkdldElkKCkKICAgIHJldHVybiBzZWxmLmlkCmVuZAoKLS1bWwogICAgUmV0dXJucyB0aGUgcmFuZ2Ugb2YgdGhlIGl0ZW0sIG9ubHkgd29ya2luZyB3aGVuIHRoZSBpdGVtIHdhcyBkZWZpbmVkIHdpdGggYSByYW5nZS4KCiAgICBAcGFyYW0gc3FyIHwgYm9vbGVhbiB8IFJhbmdlIHNxdWFyZWQgb3Igbm90CiAgICBAcmV0dXJuICAgIHwgZmxvYXQgICB8IFJhbmdlIG9mIHRoZSBpdGVtCl1dCmZ1bmN0aW9uIEl0ZW06R2V0UmFuZ2Uoc3FyKQogICAgcmV0dXJuIHNxciBhbmQgc2VsZi5yYW5nZVNxciBvciBzZWxmLnJhbmdlCmVuZAoKLS1bWwogICAgUmV0dXJuIHRoZSBzbG90IHRoZSBpdGVtIGlzIGluCgogICAgQHJldHVybiB8IGludGVnZXIgfCBTbG90IGl0Cl1dCmZ1bmN0aW9uIEl0ZW06R2V0U2xvdCgpCiAgICBzZWxmOlVwZGF0ZVNsb3QoKQogICAgcmV0dXJuIHNlbGYuc2xvdAplbmQKCi0tW1sKICAgIFVwZGF0ZXMgdGhlIGl0ZW0gc2xvdCB0byB0aGUgY3VycmVudCBvbmUgKGlmIGNoYW5nZWQpCl1dCmZ1bmN0aW9uIEl0ZW06VXBkYXRlU2xvdCgpCiAgICBzZWxmLnNsb3QgPSBHZXRJbnZlbnRvcnlTbG90SXRlbShzZWxmLmlkKQplbmQKCi0tW1sKICAgIFJldHVybnMgaWYgdGhlIGl0ZW0gaXMgcmVhZHkgdG8gYmUgY2FzdGVkIChvbmx5IHdvcmtpbmcgd2hlbiBpdCdzIGFuIGFjdGl2ZSBpdGVtKQoKICAgIEByZXR1cm4gfCBib29sZWFuIHwgU3RhdGUgb2YgdGhlIGl0ZW0KXV0KZnVuY3Rpb24gSXRlbTpJc1JlYWR5KCkKICAgIHNlbGY6VXBkYXRlU2xvdCgpCiAgICByZXR1cm4gc2VsZi5zbG90IGFuZCAocGxheWVyOkNhblVzZVNwZWxsKHNlbGYuc2xvdCkgPT0gUkVBRFkpCmVuZAoKLS1bWwogICAgUmV0dXJucyBpZiB0aGUgaXRlbSAoYWN0dWFsbHkgcGxheWVyKSBpcyBpbiByYW5nZSBvZiB0aGUgdGFyZ2V0CgogICAgQHBhcmFtIHRhcmdldCB8IENVbml0ICAgfCBUYXJnZXQgdW5pdAogICAgQHJldHVybiAgICAgICB8IGJvb2xlYW4gfCBJbiByYW5nZSBvciBub3QKXV0KZnVuY3Rpb24gSXRlbTpJblJhbmdlKHRhcmdldCkKICAgIHJldHVybiBfR2V0RGlzdGFuY2VTcXIodGFyZ2V0KSA8PSBzZWxmLnJhbmdlU3FyCmVuZAoKLS1bWwogICAgQ2FzdHMgdGhlIGl0ZW0KCiAgICBAcGFyYW0gcGFyYW0xIHwgQ1VuaXQvZmxvYXQgfCBFaXRoZXIgdGhlIHRhcmdldCB1bml0IGl0c2VsZiBvciBhcyBwYXJ0IG9mIHRoZSBwb3NpdGlvbiB0aGUgWCBjb29yZGluYXRlCiAgICBAcGFyYW0gcGFyYW0yIHwgZmxvYXQgICAgICAgfCAob25seSB1c2Ugd2hlbiBwYXJhbTEgaXMgZ2l2ZW4pIFRoZSBaIGNvb3JkaW5hdGUKICAgIEByZXR1cm4gICAgICAgfCBpbnRlZ2VyICAgICB8IFRoZSBzcGVsbCBzdGF0ZQpdXQpmdW5jdGlvbiBJdGVtOkNhc3QocGFyYW0xLCBwYXJhbTIpCgogICAgc2VsZjpVcGRhdGVTbG90KCkKICAgIGlmIHNlbGYuc2xvdCB0aGVuCiAgICAgICAgaWYgcGFyYW0xIH49IG5pbCBhbmQgcGFyYW0yIH49IG5pbCB0aGVuCiAgICAgICAgICAgIENhc3RTcGVsbChzZWxmLnNsb3QsIHBhcmFtMSwgcGFyYW0yKQogICAgICAgIGVsc2VpZiBwYXJhbTEgfj0gbmlsIHRoZW4KICAgICAgICAgICAgQ2FzdFNwZWxsKHNlbGYuc2xvdCwgcGFyYW0xKQogICAgICAgIGVsc2UKICAgICAgICAgICAgQ2FzdFNwZWxsKHNlbGYuc2xvdCkKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gU1BFTExTVEFURV9UUklHR0VSRUQKICAgIGVuZAoKZW5kCgoKLS1bWwoKJ3x8ICAgIHx8JyAgICAgICAgICAgICAgICAgICAgICAgICAgICd8fCAnfHwnICAnfCcKIHx8fCAgfHx8ICAgIC4uLi4gIC4uIC4uLiAgIC4uLiAuLi4gICAnfC4gJ3wuICAuJyAgLi4uIC4uICAgLi4uLiAgIC4uLiAuLi4gIC4uLiAuLi4gICAgLi4uLiAgLi4uIC4uCiB8J3wuLid8fCAgLnwuLi58fCAgfHwgIHx8ICAgfHwgIHx8ICAgIHx8ICB8fCAgfCAgICB8fCcgJycgJycgLnx8ICAgfHwnICB8fCAgfHwnICB8fCAufC4uLnx8ICB8fCcgJycKIHwgJ3wnIHx8ICB8fCAgICAgICB8fCAgfHwgICB8fCAgfHwgICAgIHx8fCB8fHwgICAgIHx8ICAgICAufCcgfHwgICB8fCAgICB8ICB8fCAgICB8IHx8ICAgICAgIHx8Ci58LiB8IC58fC4gICd8Li4uJyAufHwuIHx8LiAgJ3wuLid8LiAgICAgfCAgIHwgICAgIC58fC4gICAgJ3wuLid8JyAgfHwuLi4nICAgfHwuLi4nICAgJ3wuLi4nIC58fC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCAgICAgICB8fAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJycnJyAgICAgJycnJwoKICAgIE1lbnVXcmFwcGVyIC0gS2VlcCBpdCBzaW1wbGUhCgogICAgSW50cm9kdWN0aW9uOgogICAgICAgIElmIHlvdSB3YW50IHRvIHVzZSB0aGUgTWVudVdyYXBwZXIgeW91IG11c3QgY3JlYXRlIHlvdXIgbWVudSB3aXRoIGl0ISBZb3UgY2Fubm90IGFkZCB0aGlzIGNsYXNzIHRvCiAgICAgICAgYW4gZXhpc3RpbmcgbWVudS4gT25jZSB5b3UgaGF2ZSBjcmVhdGVkIGEgbmV3IGluc3RhbmNlLCBtYWtlIHN1cmUgeW91IHJlbWVtYmVyIHRoZSBmb2xsd2luZzoKICAgICAgICAgICAgLSBUYXJnZXQgc2VsZWN0b3Igc3ViLW1lbnUgbmFtZTogdHMKICAgICAgICAgICAgLSBPcmJ3YWxrZXIgc3ViLW1lbnUgbmFtZTogICAgICAgb3Jid2Fsa2VyCiAgICAgICAgICAgIC0gRHJhd2luZ3Mgc3ViLW1lbnUgbmFtZTogICAgICAgIGRyYXdpbmdzCiAgICAgICAgSWYgeW91IHdhbnQgdG8gdXNlIHRoZXNlIHN1YiBtZW51cywgc2ltcGx5IHVzZSBzb21ldGhpbmcgbGlrZSB0aGlzOgogICAgICAgICAgICBNZW51V3JhcHBlcjpHZXRIYW5kbGUoKS5kcmF3aW5nczphZGRQYXJhbSgiaW5mbyIsICJUaGlzIGhhcyBiZWVuIGNyZWF0ZWQgdXNpbmcgTWVudVdyYXBwZXIhIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKQogICAgICAgIFRoaXMgbWVhbnMgeW91IGNhbiBnZXQgdGhlIHNjcmlwdENvbmZpZyBpbnN0YW5jZSBvZiB0aGUgd3JhcHBlZCBtZW51IGJ5IHVzaW5nIHRoaXM6CiAgICAgICAgICAgIGxvY2FsIG15TWVudSA9IE1lbnVXcmFwcGVyOkdldEhhbmRsZSgpCgogICAgRnVuY3Rpb25zOgogICAgICAgIE1lbnVXcmFwcGVyKG1lbnVOYW1lLCBtZW51SWQpCgogICAgTWV0aG9kczoKICAgICAgICBNZW51V3JhcHBlcjpTZXRUYXJnZXRTZWxlY3Rvcih0YXJnZXRTZWxlY3RvcikKICAgICAgICBNZW51V3JhcHBlcjpTZXRPcmJ3YWxrZXIob3Jid2Fsa2VyKQogICAgICAgIE1lbnVXcmFwcGVyOkFkZENpcmNsZShjaXJjbGUsIGFkZENvbG9yLCBhZGRXaWR0aCwgYWRkUXVhbGl0eSkKICAgICAgICBNZW51V3JhcHBlcjpBZGRDaXJjbGVzKGNpcmNsZVRhYmxlLCBhZGRDb2xvciwgYWRkV2lkdGgsIGFkZFF1YWxpdHkpCiAgICAgICAgTWVudVdyYXBwZXI6R2V0SGFuZGxlKCkKCl1dCmNsYXNzICdNZW51V3JhcHBlcicKCi0tW1sKICAgIENyZWF0ZSBhIG5ldyBNZW51V3JhcHBlciBpbnN0YW5jZQoKICAgIEBwYXJhbSBtZW51TmFtZSB8IHN0cmluZyB8IERpc3BsYXkgbmFtZSBvZiB0aGUgbWVudQogICAgQHBhcmFtIG1lbnVJZCAgIHwgc3RyaW5nIHwgKG9wdGlvbmFsKSBJRCBvZiB0aGUgbWVudSAoZm9yIHNhdmluZyBwdXJwb3NlcykKXV0KZnVuY3Rpb24gTWVudVdyYXBwZXI6X19pbml0KG1lbnVOYW1lLCBtZW51SWQpCgogICAgYXNzZXJ0KG1lbnVOYW1lIGFuZCB0eXBlKG1lbnVOYW1lKSA9PSAic3RyaW5nIiwgIk1lbnVXcmFwcGVyOiBtZW51TmFtZSBpcyBpbnZhbGlkISIpCgogICAgc2VsZi5fX21lbnUgPSBzY3JpcHRDb25maWcobWVudU5hbWUsIG1lbnVJZCBvciBtZW51TmFtZSkKCmVuZAoKLS1bWwogICAgQWRkcyBhIFNpbXBsZVRTIGluc3RhbmNlIHRvIHRoZSBtZW51LgoKICAgIEBwYXJhbSB0YXJnZXRTZWxlY3RvciB8IGNsYXNzIHwgU2ltcGxlVFMgaW5zdGFuY2UKICAgIEByZXR1cm4gICAgICAgICAgICAgICB8IGNsYXNzIHwgc2NyaXB0Q29uZmlnIHRhcmdldCBzZWxlY3RvciBzdWItbWVudQpdXQpmdW5jdGlvbiBNZW51V3JhcHBlcjpTZXRUYXJnZXRTZWxlY3Rvcih0YXJnZXRTZWxlY3RvcikKCiAgICBhc3NlcnQodGFyZ2V0U2VsZWN0b3IsICJNZW51V3JhcHBlcjpTZXRUYXJnZXRTZWxlY3RvcigpOiB0YXJnZXRTZWxlY3RvciBpcyBub3QgYSB2YWxpZCBTaW1wbGVUUyBpbnN0YW5jZSEiKQogICAgYXNzZXJ0KHNlbGYuX190YXJnZXRTZWxlY3RvciA9PSBuaWwsICJNZW51V3JhcHBlcjpTZXRUYXJnZXRTZWxlY3RvcigpOiB0YXJnZXRTZWxlY3RvciB3YXMgYWxyZWFkeSBzZXQhIikKCiAgICBzZWxmLl9fdGFyZ2V0U2VsZWN0b3IgPSB0YXJnZXRTZWxlY3RvcgogICAgc2VsZi5fX21lbnU6YWRkU3ViTWVudSgiVGFyZ2V0IFNlbGVjdG9yIiwgInRzIikKICAgIHNlbGYuX190YXJnZXRTZWxlY3RvcjpBZGRUb01lbnUoc2VsZi5fX21lbnUudHMpCgogICAgcmV0dXJuIHNlbGYuX19tZW51LnRzCgplbmQKCi0tW1sKICAgIEFkZHMgYSBTT1cgaW5zdGFuY2UgdG8gdGhlIG1lbnUKCiAgICBAcGFyYW0gb3Jid2Fsa2VyIHwgY2xhc3MgfCBTT1cgaW5zdGFuY2UKICAgIEByZXR1cm4gICAgICAgICAgfCBjbGFzcyB8IHNjcml0cENvbmZpZyBvcmJ3YWxrZXIgc3ViLW1lbnUKXV0KZnVuY3Rpb24gTWVudVdyYXBwZXI6U2V0T3Jid2Fsa2VyKG9yYndhbGtlcikKCiAgICBhc3NlcnQob3Jid2Fsa2VyLCAiTWVudVdyYXBwZXI6U2V0T3Jid2Fsa2VyKCk6IG9yYndhbGtlciBpcyBub3QgYSB2YWxpZCBTT1cgaW5zdGFuY2UhIikKICAgIGFzc2VydChzZWxmLl9fb3Jid2Fsa2VyID09IG5pbCwgIk1lbnVXcmFwcGVyOlNldE9yYndhbGtlcigpOiBvcndhbGtlciB3YXMgYWxyZWFkeSBzZXQhIikKCiAgICBzZWxmLl9fb3Jid2Fsa2VyID0gb3Jid2Fsa2VyCiAgICBzZWxmLl9fbWVudTphZGRTdWJNZW51KCJPcmJ3YWxrZXIiLCAib3Jid2Fsa2VyIikKICAgIHNlbGYuX19vcmJ3YWxrZXI6TG9hZFRvTWVudShzZWxmLl9fbWVudS5vcmJ3YWxrZXIpCgogICAgcmV0dXJuIHNlbGYuX19tZW51Lm9yYndhbGtlcgoKZW5kCgotLVtbCiAgICBBZGRzIGEgY2lyY2xlIHRvIHRoZSBkcmF3aW5ncyBzdWItbWVudQoKICAgIEBwYXJhbSBjaXJjbGUgICAgICB8IGNsYXNzIHwgX0NpcmNsZSBpbnN0YW5jZQogICAgQHBhcmFtIGFkZENvbG9yICAgIHwgYm9vbCAgfCAob3B0aW9uYWwpIEFkZCBjb2xvciBvcHRpb24KICAgIEBwYXJhbSBhZGRXaWR0aCAgICB8IGJvb2wgIHwgKG9wdGlvbmFsKSBBZGQgd2lkdGggb3B0aW9uCiAgICBAcGFyYW0gYWRkUXVhbGl0eSAgfCBib29sICB8IChvcHRpb25hbCkgQWRkIHF1YWxpdHkgb3B0aW9uCiAgICBAcmV0dXJuICAgICAgICAgICAgfCBjbGFzcyB8IHNjcmlwdENvbmZpZyBkcmF3aW5ncyBzdWItbWVudQpdXQpmdW5jdGlvbiBNZW51V3JhcHBlcjpBZGRDaXJjbGUoY2lyY2xlLCBuYW1lLCBhZGRDb2xvciwgYWRkV2lkdGgsIGFkZFF1YWxpdHkpCiAgICByZXR1cm4gc2VsZjpBZGRDaXJjbGVzKHsgWzFdID0geyBjaXJjbGUgPSBjaXJjbGUsIG5hbWUgPSBuYW1lIH0gfSwgYWRkQ29sb3IsIGFkZFdpZHRoLCBhZGRRdWFsaXR5KQplbmQKCi0tW1sKICAgIEFkZHMgYSB0YWJsZSBvZiBjaXJjbGVzIHRvIHRoZSBkcmF3aW5ncyBzdWItbWVudQoKICAgIEBwYXJhbSBjaXJjbGVUYWJsZSB8IHRhYmxlIHwgVGFibGUgY29udGFpbmluZyBfQ2lyY2xlIGluc3RhbmNlcwogICAgQHBhcmFtIGFkZENvbG9yICAgIHwgYm9vbCAgfCAob3B0aW9uYWwpIEFkZCBjb2xvciBvcHRpb24KICAgIEBwYXJhbSBhZGRXaWR0aCAgICB8IGJvb2wgIHwgKG9wdGlvbmFsKSBBZGQgd2lkdGggb3B0aW9uCiAgICBAcGFyYW0gYWRkUXVhbGl0eSAgfCBib29sICB8IChvcHRpb25hbCkgQWRkIHF1YWxpdHkgb3B0aW9uCiAgICBAcmV0dXJuICAgICAgICAgICAgfCBjbGFzcyB8IHNjcmlwdENvbmZpZyBkcmF3aW5ncyBzdWItbWVudQpdXQpmdW5jdGlvbiBNZW51V3JhcHBlcjpBZGRDaXJjbGVzKGNpcmNsZVRhYmxlLCBhZGRDb2xvciwgYWRkV2lkdGgsIGFkZFF1YWxpdHkpCgogICAgYXNzZXJ0KGNpcmNsZVRhYmxlIGFuZCB0eXBlKGNpcmNsZVRhYmxlKSA9PSAidGFibGUiLCAiTWVudVdyYXBwZXI6QWRkQ2lyY2xlcygpOiBjaXJjbGVUYWJsZSBpcyBub3QgYSB2YWxpZCB0YWJsZSEiKQoKICAgIGZvciBfLCBlbnRyeSBpbiBpcGFpcnMoY2lyY2xlVGFibGUpIGRvCgogICAgICAgIGFzc2VydChlbnRyeS5jaXJjbGUsICJNZW51V3JhcHBlcjpBZGRDaXJjbGVzKCk6IGNpcmNsZSBpcyBub3QgYSB2YWxpZCBfQ2lyY2xlIGluc3RhbmNlISIpCiAgICAgICAgYXNzZXJ0KGVudHJ5Lm5hbWUsICJNZW51V2FycHBlcjpBZGRDaXJjbGVzKCk6IGNpcmNsZSBuYW1lIHdhcyBub3QgZ2l2ZW4hIikKICAgICAgICBhc3NlcnQoc2VsZi5fX2NpcmNsZXMgPT0gbmlsIG9yIG5vdCB0YWJsZS5jb250YWlucyhzZWxmLl9fY2lyY2xlcywgZW50cnkuY2lyY2xlKSwgIk1lbnVXcmFwcGVyOkFkZENpcmNsZXMoKTogVGhlIGNpcmNsZSB3YXMgYWxyZWFkeSBhZGRlZCEiKQoKICAgICAgICBpZiBub3Qgc2VsZi5fX2NpcmNsZXMgdGhlbgogICAgICAgICAgICBzZWxmLl9fY2lyY2xlcyA9IHt9CiAgICAgICAgZW5kCgogICAgICAgIGlmIG5vdCBzZWxmLl9fZHJhd2luZyB0aGVuCiAgICAgICAgICAgIHNlbGYuX19tZW51OmFkZFN1Yk1lbnUoIkRyYXdpbmdzIiwgImRyYXdpbmdzIikKICAgICAgICAgICAgc2VsZi5fX2RyYXdpbmcgPSBzZWxmLl9fbWVudS5kcmF3aW5ncwogICAgICAgIGVuZAoKICAgICAgICBlbnRyeS5jaXJjbGU6QWRkVG9NZW51KHNlbGYuX19kcmF3aW5nLCBlbnRyeS5uYW1lLCBhZGRDb2xvciwgYWRkV2lkdGgsIGFkZFF1YWxpdHkpCgogICAgICAgIHRhYmxlLmluc2VydChzZWxmLl9fY2lyY2xlcywgZW50cnkuY2lyY2xlKQoKICAgIGVuZAoKICAgIHJldHVybiBzZWxmLl9fZHJhd2luZwoKZW5kCgotLVtbCiAgICBSZXR1cm5zIHRoZSB3cmFwcGVkIHNjcmlwdENvbmZpZwoKICAgIEByZXR1cm4gfCBjbGFzcyB8IHNjcmlwdENvbmZpZyBpbnN0YW5jZQpdXQpmdW5jdGlvbiBNZW51V3JhcHBlcjpHZXRIYW5kbGUoKQogICAgcmV0dXJuIHNlbGYuX19tZW51CmVuZAoKCi0tW1sKCid8fCcgICAgICAgICAgICAuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuCiB8fCAgLi4gLi4uICAgLnx8LiAgICAuLi4uICAuLi4gLi4gIC4uLiAuLiAgLi4uIC4uLiAgLi4uIC4uLiAgLnx8LiAgICAuLi4uICAuLi4gLi4KIHx8ICAgfHwgIHx8ICAgfHwgICAufC4uLnx8ICB8fCcgJycgIHx8JyAnJyAgfHwgIHx8ICAgfHwnICB8fCAgfHwgICAufC4uLnx8ICB8fCcgJycKIHx8ICAgfHwgIHx8ICAgfHwgICB8fCAgICAgICB8fCAgICAgIHx8ICAgICAgfHwgIHx8ICAgfHwgICAgfCAgfHwgICB8fCAgICAgICB8fAoufHwuIC58fC4gfHwuICAnfC4nICAnfC4uLicgLnx8LiAgICAufHwuICAgICAnfC4uJ3wuICB8fC4uLicgICAnfC4nICAnfC4uLicgLnx8LgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcnJycKCiAgICBJbnRlcnJ1cHRlciAtIFRoZXkgd2lsbCBuZXZlciBjYXN0IQoKICAgIExpa2UgYWx3YXN5IHVuZG9jdW1lbnRlZCBieSBob25kYS4uLgpdXQpjbGFzcyAnSW50ZXJydXB0ZXInCgpsb2NhbCBfSU5URVJSVVBUSUJMRV9TUEVMTFMgPSB7CiAgICBbIkthdGFyaW5hUiJdICAgICAgICAgICAgICAgICAgICAgICAgICA9IHsgY2hhck5hbWUgPSAiS2F0YXJpbmEiLCAgICAgRGFuZ2VyTGV2ZWwgPSA1LCBNYXhEdXJhdGlvbiA9IDIuNSwgQ2FuTW92ZSA9IGZhbHNlIH0sCiAgICBbIk1lZGl0YXRlIl0gICAgICAgICAgICAgICAgICAgICAgICAgICA9IHsgY2hhck5hbWUgPSAiTWFzdGVyWWkiLCAgICAgRGFuZ2VyTGV2ZWwgPSAxLCBNYXhEdXJhdGlvbiA9IDIuNSwgQ2FuTW92ZSA9IGZhbHNlIH0sCiAgICBbIkRyYWluIl0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IHsgY2hhck5hbWUgPSAiRmlkZGxlU3RpY2tzIiwgRGFuZ2VyTGV2ZWwgPSAzLCBNYXhEdXJhdGlvbiA9IDIuNSwgQ2FuTW92ZSA9IGZhbHNlIH0sCiAgICBbIkNyb3dzdG9ybSJdICAgICAgICAgICAgICAgICAgICAgICAgICA9IHsgY2hhck5hbWUgPSAiRmlkZGxlU3RpY2tzIiwgRGFuZ2VyTGV2ZWwgPSA1LCBNYXhEdXJhdGlvbiA9IDIuNSwgQ2FuTW92ZSA9IGZhbHNlIH0sCiAgICBbIkdhbGlvSWRvbE9mRHVyYW5kIl0gICAgICAgICAgICAgICAgICA9IHsgY2hhck5hbWUgPSAiR2FsaW8iLCAgICAgICAgRGFuZ2VyTGV2ZWwgPSA1LCBNYXhEdXJhdGlvbiA9IDIuNSwgQ2FuTW92ZSA9IGZhbHNlIH0sCiAgICBbIk1pc3NGb3J0dW5lQnVsbGV0VGltZSJdICAgICAgICAgICAgICA9IHsgY2hhck5hbWUgPSAiTWlzc0ZvcnR1bmUiLCAgRGFuZ2VyTGV2ZWwgPSA1LCBNYXhEdXJhdGlvbiA9IDIuNSwgQ2FuTW92ZSA9IGZhbHNlIH0sCiAgICBbIlZlbGtvelIiXSAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IHsgY2hhck5hbWUgPSAiVmVsa296IiwgICAgICAgRGFuZ2VyTGV2ZWwgPSA1LCBNYXhEdXJhdGlvbiA9IDIuNSwgQ2FuTW92ZSA9IGZhbHNlIH0sCiAgICBbIkluZmluaXRlRHVyZXNzIl0gICAgICAgICAgICAgICAgICAgICA9IHsgY2hhck5hbWUgPSAiV2Fyd2ljayIsICAgICAgRGFuZ2VyTGV2ZWwgPSA1LCBNYXhEdXJhdGlvbiA9IDIuNSwgQ2FuTW92ZSA9IGZhbHNlIH0sCiAgICBbIkFic29sdXRlWmVybyJdICAgICAgICAgICAgICAgICAgICAgICA9IHsgY2hhck5hbWUgPSAiTnVudSIsICAgICAgICAgRGFuZ2VyTGV2ZWwgPSA0LCBNYXhEdXJhdGlvbiA9IDIuNSwgQ2FuTW92ZSA9IGZhbHNlIH0sCiAgICBbIlNoZW5TdGFuZFVuaXRlZCJdICAgICAgICAgICAgICAgICAgICA9IHsgY2hhck5hbWUgPSAiU2hlbiIsICAgICAgICAgRGFuZ2VyTGV2ZWwgPSAzLCBNYXhEdXJhdGlvbiA9IDIuNSwgQ2FuTW92ZSA9IGZhbHNlIH0sCiAgICBbIkZhbGxlbk9uZSJdICAgICAgICAgICAgICAgICAgICAgICAgICA9IHsgY2hhck5hbWUgPSAiS2FydGh1cyIsICAgICAgRGFuZ2VyTGV2ZWwgPSA1LCBNYXhEdXJhdGlvbiA9IDIuNSwgQ2FuTW92ZSA9IGZhbHNlIH0sCiAgICBbIkFsWmFoYXJOZXRoZXJHcmFzcCJdICAgICAgICAgICAgICAgICA9IHsgY2hhck5hbWUgPSAiTWFsemFoYXIiLCAgICAgRGFuZ2VyTGV2ZWwgPSA1LCBNYXhEdXJhdGlvbiA9IDIuNSwgQ2FuTW92ZSA9IGZhbHNlIH0sCiAgICBbIlBhbnRoZW9uX0dyYW5kU2t5ZmFsbF9KdW1wIl0gICAgICAgICA9IHsgY2hhck5hbWUgPSAiUGFudGhlb24iLCAgICAgRGFuZ2VyTGV2ZWwgPSA1LCBNYXhEdXJhdGlvbiA9IDIuNSwgQ2FuTW92ZSA9IGZhbHNlIH0sCgp9CgpmdW5jdGlvbiBJbnRlcnJ1cHRlcjpfX2luaXQobWVudSwgY2IpCgogICAgc2VsZi5jYWxsYmFja3MgPSB7fQogICAgc2VsZi5hY3RpdmVzcGVsbHMgPSB7fQogICAgQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpPblRpY2soKSBlbmQpCiAgICBBZGRQcm9jZXNzU3BlbGxDYWxsYmFjayhmdW5jdGlvbih1bml0LCBzcGVsbCkgc2VsZjpPblByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQogICAgaWYgbWVudSB0aGVuCiAgICAgICAgc2VsZjpBZGRUb01lbnUobWVudSkKICAgIGVuZAogICAgaWYgY2IgdGhlbgogICAgICAgIHNlbGY6QWRkQ2FsbGJhY2soY2IpCiAgICBlbmQKCmVuZAoKZnVuY3Rpb24gSW50ZXJydXB0ZXI6QWRkVG9NZW51KG1lbnUpCgogICAgYXNzZXJ0KG1lbnUsICJJbnRlcnJ1cHRlcjogbWVudSBjYW4ndCBiZSBuaWwhIikKICAgIGxvY2FsIFNwZWxsQWRkZWQgPSBmYWxzZQogICAgbG9jYWwgRW5lbXlDaGFtcGlvbmNoYXJOYW1lcyA9IHt9CiAgICBmb3IgaSwgZW5lbXkgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvCiAgICAgICAgdGFibGUuaW5zZXJ0KEVuZW15Q2hhbXBpb25jaGFyTmFtZXMsIGVuZW15LmNoYXJOYW1lKQogICAgZW5kCiAgICBtZW51OmFkZFBhcmFtKCJFbmFibGVkIiwgIkVuYWJsZWQiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCiAgICBmb3Igc3BlbGxOYW1lLCBkYXRhIGluIHBhaXJzKF9JTlRFUlJVUFRJQkxFX1NQRUxMUykgZG8KICAgICAgICBpZiB0YWJsZS5jb250YWlucyhFbmVteUNoYW1waW9uY2hhck5hbWVzLCBkYXRhLmNoYXJOYW1lKSB0aGVuCiAgICAgICAgICAgIG1lbnU6YWRkUGFyYW0oc3RyaW5nLmdzdWIoc3BlbGxOYW1lLCAiXyIsICIiKSwgZGF0YS5jaGFyTmFtZS4uIiAtICIuLnNwZWxsTmFtZSwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQogICAgICAgICAgICBTcGVsbEFkZGVkID0gdHJ1ZQogICAgICAgIGVuZAogICAgZW5kCiAgICBpZiBub3QgU3BlbGxBZGRlZCB0aGVuCiAgICAgICAgbWVudTphZGRQYXJhbSgiSW5mbyIsICJJbmZvIiwgU0NSSVBUX1BBUkFNX0lORk8sICJObyBzcGVsbCBhdmFpbGFibGUgdG8gaW50ZXJydXB0IikKICAgIGVuZAogICAgc2VsZi5NZW51ID0gbWVudQoKZW5kCgpmdW5jdGlvbiBJbnRlcnJ1cHRlcjpBZGRDYWxsYmFjayhjYikKCiAgICBhc3NlcnQoY2IgYW5kIHR5cGUoY2IpID09ICJmdW5jdGlvbiIsICJJbnRlcnJ1cHRlcjogY2FsbGJhY2sgaXMgaW52YWxpZCEiKQogICAgdGFibGUuaW5zZXJ0KHNlbGYuY2FsbGJhY2tzLCBjYikKCmVuZAoKZnVuY3Rpb24gSW50ZXJydXB0ZXI6VHJpZ2dlckNhbGxiYWNrcyh1bml0LCBzcGVsbCkKCiAgICBmb3IgaSwgY2FsbGJhY2sgaW4gaXBhaXJzKHNlbGYuY2FsbGJhY2tzKSBkbwogICAgICAgIGNhbGxiYWNrKHVuaXQsIHNwZWxsKQogICAgZW5kCgplbmQKCmZ1bmN0aW9uIEludGVycnVwdGVyOk9uUHJvY2Vzc1NwZWxsKHVuaXQsIHNwZWxsKQoKICAgIGlmIG5vdCBzZWxmLk1lbnUuRW5hYmxlZCB0aGVuIHJldHVybiBlbmQKICAgIGlmIHVuaXQudGVhbSB+PSBteUhlcm8udGVhbSB0aGVuCiAgICAgICAgaWYgX0lOVEVSUlVQVElCTEVfU1BFTExTW3NwZWxsLm5hbWVdIHRoZW4KICAgICAgICAgICAgbG9jYWwgU3BlbGxUb0ludGVycnVwdCA9IF9JTlRFUlJVUFRJQkxFX1NQRUxMU1tzcGVsbC5uYW1lXQogICAgICAgICAgICBpZiAoc2VsZi5NZW51IGFuZCBzZWxmLk1lbnVbc3RyaW5nLmdzdWIoc3BlbGwubmFtZSwgIl8iLCAiIildKSBvciBub3Qgc2VsZi5NZW51IHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGRhdGEgPSB7dW5pdCA9IHVuaXQsIERhbmdlckxldmVsID0gU3BlbGxUb0ludGVycnVwdC5EYW5nZXJMZXZlbCwgZW5kVCA9IG9zLmNsb2NrKCkgKyBTcGVsbFRvSW50ZXJydXB0Lk1heER1cmF0aW9uLCBDYW5Nb3ZlID0gU3BlbGxUb0ludGVycnVwdC5DYW5Nb3ZlfQogICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KHNlbGYuYWN0aXZlc3BlbGxzLCBkYXRhKQogICAgICAgICAgICAgICAgc2VsZjpUcmlnZ2VyQ2FsbGJhY2tzKGRhdGEudW5pdCwgZGF0YSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKCmVuZAoKZnVuY3Rpb24gSW50ZXJydXB0ZXI6T25UaWNrKCkKCiAgICBmb3IgaSA9ICNzZWxmLmFjdGl2ZXNwZWxscywgMSwgLTEgZG8KICAgICAgICBpZiBzZWxmLmFjdGl2ZXNwZWxsc1tpXS5lbmRUIC0gb3MuY2xvY2soKSA+IDAgdGhlbgogICAgICAgICAgICBzZWxmOlRyaWdnZXJDYWxsYmFja3Moc2VsZi5hY3RpdmVzcGVsbHNbaV0udW5pdCwgc2VsZi5hY3RpdmVzcGVsbHNbaV0pCiAgICAgICAgZWxzZQogICAgICAgICAgICB0YWJsZS5yZW1vdmUoc2VsZi5hY3RpdmVzcGVsbHMsIGkpCiAgICAgICAgZW5kCiAgICBlbmQKCmVuZAoKCi0tW1sKCiAgICB8ICAgICAgICAgICAgICAgIC4gICAgfHwgICAuLnwnJycufCAgICAgICAgICAgICAgICAgICAgICAgICAgICd8fAogICB8fHwgICAgLi4gLi4uICAgLnx8LiAgLi4uICAufCcgICAgICcgICAuLi4uICAgLi4uIC4uLiAgICAuLi4uICAgfHwgICAgLi4uICAgIC4uLi4gICAgLi4uLiAgLi4uIC4uCiAgfCAgfHwgICAgfHwgIHx8ICAgfHwgICAgfHwgIHx8ICAgIC4uLi4gJycgLnx8ICAgfHwnICB8fCAufCAgICcnICB8fCAgLnwgICd8LiB8fC4gJyAgLnwuLi58fCAgfHwnICcnCiAuJycnJ3wuICAgfHwgIHx8ICAgfHwgICAgfHwgICd8LiAgICB8fCAgLnwnIHx8ICAgfHwgICAgfCB8fCAgICAgICB8fCAgfHwgICB8fCAuICd8Li4gfHwgICAgICAgfHwKLnwuICAufHwuIC58fC4gfHwuICAnfC4nIC58fC4gICcnfC4uLid8ICAnfC4uJ3wnICB8fC4uLicgICAnfC4uLicgLnx8LiAgJ3wuLnwnIHwnLi58JyAgJ3wuLi4nIC58fC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJycnJwoKICAgIEFudGlHYXBjbG9zZXIgLSBTdGF5IGF3YXkgcGxlYXNlLCB0aGFua3MuCgogICAgQW5kIGFnYWluIHVuZG9jdW1lbnRlZCBieSBob25kYSAtLi0KXV0KY2xhc3MgJ0FudGlHYXBjbG9zZXInCgpsb2NhbCBfR0FQQ0xPU0VSX1RBUkdFVEVELCBfR0FQQ0xPU0VSX1NLSUxMU0hPVCA9IDEsIDIKLS1BZGQgb25seSB2ZXJ5IGZhc3Qgc2tpbGxzaG90cy90YXJnZXRlZCBzcGVsbHMgc2luY2UgdlByZWRpY3Rpb24gd2lsbCBoYW5kbGUgdGhlIHNsb3cgZGFzaGVzIHRoYXQgd2lsbCB0cmlnZ2VyIE9uRGFzaApsb2NhbCBfR0FQQ0xPU0VSX1NQRUxMUyA9IHsKICAgIFsiQWF0cm94USJdICAgICAgICAgICAgICA9ICJBYXRyb3giLAogICAgWyJBa2FsaVNoYWRvd0RhbmNlIl0gICAgID0gIkFrYWxpIiwKICAgIFsiSGVhZGJ1dHQiXSAgICAgICAgICAgICA9ICJBbGlzdGFyIiwKICAgIFsiRmlvcmFRIl0gICAgICAgICAgICAgICA9ICJGaW9yYSIsCiAgICBbIkRpYW5hVGVsZXBvcnQiXSAgICAgICAgPSAiRGlhbmEiLAogICAgWyJFbGlzZVNwaWRlclFDYXN0Il0gICAgID0gIkVsaXNlIiwKICAgIFsiRml6elBpZXJjaW5nU3RyaWtlIl0gICA9ICJGaXp6IiwKICAgIFsiR3JhZ2FzRSJdICAgICAgICAgICAgICA9ICJHcmFnYXMiLAogICAgWyJIZWNhcmltVWx0Il0gICAgICAgICAgID0gIkhlY2FyaW0iLAogICAgWyJKYXJ2YW5JVkRyYWdvblN0cmlrZSJdID0gIkphcnZhbklWIiwKICAgIFsiSXJlbGlhR2F0b3RzdSJdICAgICAgICA9ICJJcmVsaWEiLAogICAgWyJKYXhMZWFwU3RyaWtlIl0gICAgICAgID0gIkpheCIsCiAgICBbIktoYXppeEUiXSAgICAgICAgICAgICAgPSAiS2hheml4IiwKICAgIFsia2hheml4ZWxvbmciXSAgICAgICAgICA9ICJLaGF6aXgiLAogICAgWyJMZWJsYW5jU2xpZGUiXSAgICAgICAgID0gIkxlQmxhbmMiLAogICAgWyJMZWJsYW5jU2xpZGVNIl0gICAgICAgID0gIkxlQmxhbmMiLAogICAgWyJCbGluZE1vbmtRVHdvIl0gICAgICAgID0gIkxlZVNpbiIsCiAgICBbIkxlb25hWmVuaXRoQmxhZGUiXSAgICAgPSAiTGVvbmEiLAogICAgWyJVRlNsYXNoIl0gICAgICAgICAgICAgID0gIk1hbHBoaXRlIiwKICAgIFsiUGFudGhlb25fTGVhcEJhc2giXSAgICA9ICJQYW50aGVvbiIsCiAgICBbIlBvcHB5SGVyb2ljQ2hhcmdlIl0gICAgPSAiUG9wcHkiLAogICAgWyJSZW5la3RvblNsaWNlQW5kRGljZSJdID0gIlJlbmVrdG9uIiwKICAgIFsiUml2ZW5UcmlDbGVhdmUiXSAgICAgICA9ICJSaXZlbiIsCiAgICBbIlNlanVhbmlBcmN0aWNBc3NhdWx0Il0gPSAiU2VqdWFuaSIsCiAgICBbInNsYXNoQ2FzdCJdICAgICAgICAgICAgPSAiVHJ5bmRhbWVyZSIsCiAgICBbIlZpUSJdICAgICAgICAgICAgICAgICAgPSAiVmkiLAogICAgWyJNb25rZXlLaW5nTmltYnVzIl0gICAgID0gIk1vbmtleUtpbmciLAogICAgWyJYZW5aaGFvU3dlZXAiXSAgICAgICAgID0gIlhpblpoYW8iLAogICAgWyJZYXN1b0Rhc2hXcmFwcGVyIl0gICAgID0gIllhc3VvIgp9CgpmdW5jdGlvbiBBbnRpR2FwY2xvc2VyOl9faW5pdChtZW51LCBjYikKCiAgICBzZWxmLmNhbGxiYWNrcyA9IHt9CiAgICBzZWxmLmFjdGl2ZXNwZWxscyA9IHt9CiAgICBBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOk9uVGljaygpIGVuZCkKICAgIEFkZFByb2Nlc3NTcGVsbENhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIHNwZWxsKSBzZWxmOk9uUHJvY2Vzc1NwZWxsKHVuaXQsIHNwZWxsKSBlbmQpCiAgICBpZiBtZW51IHRoZW4KICAgICAgICBzZWxmOkFkZFRvTWVudShtZW51KQogICAgZW5kCiAgICBpZiBjYiB0aGVuCiAgICAgICAgc2VsZjpBZGRDYWxsYmFjayhjYikKICAgIGVuZAoKZW5kCgpmdW5jdGlvbiBBbnRpR2FwY2xvc2VyOkFkZFRvTWVudShtZW51KQoKICAgIGFzc2VydChtZW51LCAiQW50aUdhcGNsb3NlcjogbWVudSBjYW4ndCBiZSBuaWwhIikKICAgIGxvY2FsIFNwZWxsQWRkZWQgPSBmYWxzZQogICAgbG9jYWwgRW5lbXlDaGFtcGlvbmNoYXJOYW1lcyA9IHt9CiAgICBmb3IgaSwgZW5lbXkgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvCiAgICAgICAgdGFibGUuaW5zZXJ0KEVuZW15Q2hhbXBpb25jaGFyTmFtZXMsIGVuZW15LmNoYXJOYW1lKQogICAgZW5kCiAgICBtZW51OmFkZFBhcmFtKCJFbmFibGVkIiwgIkVuYWJsZWQiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCiAgICBmb3Igc3BlbGxOYW1lLCBjaGFyTmFtZSBpbiBwYWlycyhfR0FQQ0xPU0VSX1NQRUxMUykgZG8KICAgICAgICBpZiB0YWJsZS5jb250YWlucyhFbmVteUNoYW1waW9uY2hhck5hbWVzLCBjaGFyTmFtZSkgdGhlbgogICAgICAgICAgICBtZW51OmFkZFBhcmFtKHN0cmluZy5nc3ViKHNwZWxsTmFtZSwgIl8iLCAiIiksIGNoYXJOYW1lLi4iIC0gIi4uc3BlbGxOYW1lLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCiAgICAgICAgICAgIFNwZWxsQWRkZWQgPSB0cnVlCiAgICAgICAgZW5kCiAgICBlbmQKICAgIGlmIG5vdCBTcGVsbEFkZGVkIHRoZW4KICAgICAgICBtZW51OmFkZFBhcmFtKCJJbmZvIiwgIkluZm8iLCBTQ1JJUFRfUEFSQU1fSU5GTywgIk5vIHNwZWxsIGF2YWlsYWJsZSB0byBpbnRlcnJ1cHQiKQogICAgZW5kCiAgICBzZWxmLk1lbnUgPSBtZW51CgplbmQKCmZ1bmN0aW9uIEFudGlHYXBjbG9zZXI6QWRkQ2FsbGJhY2soY2IpCgogICAgYXNzZXJ0KGNiIGFuZCB0eXBlKGNiKSA9PSAiZnVuY3Rpb24iLCAiQW50aUdhcGNsb3NlcjogY2FsbGJhY2sgaXMgaW52YWxpZCEiKQogICAgdGFibGUuaW5zZXJ0KHNlbGYuY2FsbGJhY2tzLCBjYikKCmVuZAoKZnVuY3Rpb24gQW50aUdhcGNsb3NlcjpUcmlnZ2VyQ2FsbGJhY2tzKHVuaXQsIHNwZWxsKQoKICAgIGZvciBpLCBjYWxsYmFjayBpbiBpcGFpcnMoc2VsZi5jYWxsYmFja3MpIGRvCiAgICAgICAgY2FsbGJhY2sodW5pdCwgc3BlbGwpCiAgICBlbmQKCmVuZAoKZnVuY3Rpb24gQW50aUdhcGNsb3NlcjpPblByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkKCiAgICBpZiBub3Qgc2VsZi5NZW51LkVuYWJsZWQgdGhlbiByZXR1cm4gZW5kCiAgICBpZiB1bml0LnRlYW0gfj0gbXlIZXJvLnRlYW0gdGhlbgogICAgICAgIGlmIF9HQVBDTE9TRVJfU1BFTExTW3NwZWxsLm5hbWVdIHRoZW4KICAgICAgICAgICAgbG9jYWwgR2FwY2xvc2VyID0gX0dBUENMT1NFUl9TUEVMTFNbc3BlbGwubmFtZV0KICAgICAgICAgICAgaWYgKHNlbGYuTWVudSBhbmQgc2VsZi5NZW51W3N0cmluZy5nc3ViKHNwZWxsLm5hbWUsICJfIiwgIiIpXSkgb3Igbm90IHNlbGYuTWVudSB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCBhZGQgPSBmYWxzZQogICAgICAgICAgICAgICAgaWYgc3BlbGwudGFyZ2V0IGFuZCBzcGVsbC50YXJnZXQuaXNNZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgYWRkID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgIHN0YXJ0UG9zID0gVmVjdG9yKHVuaXQudmlzaW9uUG9zKQogICAgICAgICAgICAgICAgICAgIGVuZFBvcyA9IG15SGVybwogICAgICAgICAgICAgICAgZWxzZWlmIG5vdCBzcGVsbC50YXJnZXQgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGVuZFBvczEgPSBWZWN0b3IodW5pdC52aXNpb25Qb3MpICsgMzAwICogKFZlY3RvcihzcGVsbC5lbmRQb3MpIC0gVmVjdG9yKHVuaXQudmlzaW9uUG9zKSk6bm9ybWFsaXplZCgpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZW5kUG9zMiA9IFZlY3Rvcih1bml0LnZpc2lvblBvcykgKyAxMDAgKiAoVmVjdG9yKHNwZWxsLmVuZFBvcykgLSBWZWN0b3IodW5pdC52aXNpb25Qb3MpKTpub3JtYWxpemVkKCkKICAgICAgICAgICAgICAgICAgICAtLVRPRE8gY2hlY2sgYW5nbGVzIGV0YwogICAgICAgICAgICAgICAgICAgIGlmIChfR2V0RGlzdGFuY2VTcXIobXlIZXJvLnZpc2lvblBvcywgdW5pdC52aXNpb25Qb3MpID4gX0dldERpc3RhbmNlU3FyKG15SGVyby52aXNpb25Qb3MsIGVuZFBvczEpIG9yIF9HZXREaXN0YW5jZVNxcihteUhlcm8udmlzaW9uUG9zLCB1bml0LnZpc2lvblBvcykgPiBfR2V0RGlzdGFuY2VTcXIobXlIZXJvLnZpc2lvblBvcywgZW5kUG9zMikpICB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGFkZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGlmIGFkZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZGF0YSA9IHt1bml0ID0gdW5pdCwgc3BlbGwgPSBzcGVsbC5uYW1lLCBzdGFydFQgPSBvcy5jbG9jaygpLCBlbmRUID0gb3MuY2xvY2soKSArIDEsIHN0YXJ0UG9zID0gc3RhcnRQb3MsIGVuZFBvcyA9IGVuZFBvc30KICAgICAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQoc2VsZi5hY3RpdmVzcGVsbHMsIGRhdGEpCiAgICAgICAgICAgICAgICAgICAgc2VsZjpUcmlnZ2VyQ2FsbGJhY2tzKGRhdGEudW5pdCwgZGF0YSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAoKZW5kCgpmdW5jdGlvbiBBbnRpR2FwY2xvc2VyOk9uVGljaygpCgogICAgZm9yIGkgPSAjc2VsZi5hY3RpdmVzcGVsbHMsIDEsIC0xIGRvCiAgICAgICAgaWYgc2VsZi5hY3RpdmVzcGVsbHNbaV0uZW5kVCAtIG9zLmNsb2NrKCkgPiAwIHRoZW4KICAgICAgICAgICAgc2VsZjpUcmlnZ2VyQ2FsbGJhY2tzKHNlbGYuYWN0aXZlc3BlbGxzW2ldLnVuaXQsIHNlbGYuYWN0aXZlc3BlbGxzW2ldKQogICAgICAgIGVsc2UKICAgICAgICAgICAgdGFibGUucmVtb3ZlKHNlbGYuYWN0aXZlc3BlbGxzLCBpKQogICAgICAgIGVuZAogICAgZW5kCgplbmQKCgotLVtbCgp8Jyd8fCcnfCAgfHwgICAgICAgICAgJ3x8ICAgICAgJ3x8JyAgICAgICB8fCAgICAgICAgICAgICAgfHwgICAgLgogICB8fCAgICAuLi4gICAgLi4uLiAgIHx8ICAuLiAgIHx8ICAgICAgIC4uLiAgLi4gLi4gLi4gICAuLi4gIC58fC4gICAgLi4uLiAgLi4uIC4uCiAgIHx8ICAgICB8fCAgLnwgICAnJyAgfHwgLicgICAgfHwgICAgICAgIHx8ICAgfHwgfHwgfHwgICB8fCAgIHx8ICAgLnwuLi58fCAgfHwnICcnCiAgIHx8ICAgICB8fCAgfHwgICAgICAgfHwnfC4gICAgfHwgICAgICAgIHx8ICAgfHwgfHwgfHwgICB8fCAgIHx8ICAgfHwgICAgICAgfHwKICAufHwuICAgLnx8LiAgJ3wuLi4nIC58fC4gfHwuIC58fC4uLi4ufCAufHwuIC58fCB8fCB8fC4gLnx8LiAgJ3wuJyAgJ3wuLi4nIC58fC4KCiAgICBUaWNrTGltaXRlciAtIEJlY2F1c2UgcG90YXRvIGNvbXB1dGVycyBhbHNvIHVzZSBTb3VyY2VMaWIKCiAgICBGdW5jdGlvbnM6CiAgICAgICAgVGlja0xpbWl0ZXIoZnVuYywgZnJlcXVlbmN5KQoKXV0KY2xhc3MgJ1RpY2tMaW1pdGVyJwoKLS1bWwogICAgU3RhcnRzIFRpY2tMaW1pdGVyIGluc3RhbmNlCgogICAgQHBhcmFtIGZ1bmMgICAgICAgfCBmdW5jdGlvbiB8IFRoZSBmdW5jdGlvbiB0byBiZSBjYWxsZWQKICAgIEBwYXJhbSBmcmVxdWVuY3kgIHwgaW50ZWdlciAgfCBUaGUgdGltZXMgdGhlIGZ1bmN0aW9uIHdpbGwgY2FsbGVkIHBlciBzZWNvbmQuCl1dCmZ1bmN0aW9uIFRpY2tMaW1pdGVyOl9faW5pdChmdW5jLCBmcmVxdWVuY3kpCgogICAgYXNzZXJ0KGZyZXF1ZW5jeSBhbmQgZnJlcXVlbmN5ID4gMCwgIlRpY2tMaW1pdGVyOiBmcmVjdWVuY3kgaXMgaW52YWxpZCEiKQogICAgYXNzZXJ0KGZ1bmMgYW5kIHR5cGUoZnVuYykgPT0gImZ1bmN0aW9uIiwgIlRpY2tMaW1pdGVyOiBmdW5jIGlzIGludmFsaWQhIikKCiAgICBzZWxmLmxhc3R0aWNrID0gMAogICAgc2VsZi5pbnRlcnZhbCA9IDEgLyBmcmVxdWVuY3kKCiAgICBzZWxmLmZ1bmMgPSBmdW5jCiAgICBBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOk9uVGljaygpIGVuZCkKCmVuZAoKLS1bWwogICAgSW50ZXJuYWwgY2FsbGJhY2sKXV0KZnVuY3Rpb24gVGlja0xpbWl0ZXI6T25UaWNrKCkKCiAgICBpZiBvcy5jbG9jaygpIC0gc2VsZi5sYXN0dGljayA+PSBzZWxmLmludGVydmFsIHRoZW4KICAgICAgICBzZWxmLmZ1bmMoKQogICAgICAgIHNlbGYubGFzdHRpY2sgPSBvcy5jbG9jaygpCiAgICBlbmQKCmVuZAoKCi0tW1sKCid8fCcnfC4gICAgICAgICAgICAgICAgICAnfHwgICAgICAgICAgICAgICAgLiAgICd8fCcgICd8fCcgICAgICAgICAgICAgICAgICAgICAgICd8fCAgJ3x8CiB8fCAgIHx8ICAuLi4uICAgICAuLi4uICAgfHwgIC4uICAgIC4uLi4gIC58fC4gICB8fCAgICB8fCAgIC4uLi4gICAuLiAuLi4gICAgICAuLiB8fCAgIHx8ICAgIC4uLi4gIC4uLiAuLgogfHwuLi58JyAnJyAufHwgIC58ICAgJycgIHx8IC4nICAgLnwuLi58fCAgfHwgICAgfHwnJycnfHwgICcnIC58fCAgIHx8ICB8fCAgIC4nICAnfHwgICB8fCAgLnwuLi58fCAgfHwnICcnCiB8fCAgICAgIC58JyB8fCAgfHwgICAgICAgfHwnfC4gICB8fCAgICAgICB8fCAgICB8fCAgICB8fCAgLnwnIHx8ICAgfHwgIHx8ICAgfC4gICB8fCAgIHx8ICB8fCAgICAgICB8fAoufHwuICAgICAnfC4uJ3wnICAnfC4uLicgLnx8LiB8fC4gICd8Li4uJyAgJ3wuJyAufHwuICAufHwuICd8Li4nfCcgLnx8LiB8fC4gICd8Li4nfHwuIC58fC4gICd8Li4uJyAufHwuCgogICAgUGFja2V0SGFuZGxlciAtIEV2ZW4gdHJhY2sgYWxsIGRlbSBwYWNrZXRzLCBub3QganVzdCB0aGUgZWFzeSBvbmVzIQoKICAgIE1ldGhvZHM6CiAgICAgICAgUGFja2V0SGFuZGxlcjpIb29rSW5jb21pbmdQYWNrZXQoaGVhZGVyLCBjYWxsYmFjaykKICAgICAgICBQYWNrZXRIYW5kbGVyOkhvb2tPdXRnb2luZ1BhY2tldChoZWFkZXIsIGNhbGxiYWNrKQoKXV0KY2xhc3MgJ19QYWNrZXRIYW5kbGVyJwoKLS1bWwogICAgQ3JlYXRlIGEgbmV3IGluc3RhbmNlIG9mIF9QYWNrZXRIYW5kbGVyLiBQbGVhc2UgZG9uJ3QgY2FsbCB0aGlzLCB1c2UgdGhlIGdsb2JhbCBQYWNrZXRIYW5kbGVyIGluc3RlYWQuCl1dCmZ1bmN0aW9uIF9QYWNrZXRIYW5kbGVyOl9faW5pdCgpCgogICAgc2VsZi5fX2luY29taW5nQ2FsbGJhY2tzID0ge30KICAgIHNlbGYuX19vdXRnb2luZ0NhbGxiYWNrcyA9IHt9CgogICAgLS0gUmVnaXN0ZXIgY2FsbGJhY2tzCiAgICBBZGRTZW5kUGFja2V0Q2FsbGJhY2soZnVuY3Rpb24ocCkgc2VsZjpPblNlbmRQYWNrZXQocCkgZW5kKQogICAgQWRkUmVjdlBhY2tldENhbGxiYWNrKGZ1bmN0aW9uKHApIHNlbGY6T25SZWN2UGFja2V0KHApIGVuZCkKCiAgICAtLSBPbmx5IHJlcGxhY2UgdGhlIGZ1bmN0aW9uIG9uY2UKICAgIGlmIG5vdCBfRy5PbGRTZW5kUGFja2V0IHRoZW4KICAgICAgICAtLSBTYXZpbmcgdGhlIG9yaWdpbmFsIFNlbmRQYWNrZXQgZnVuY3Rpb24gZm9yIGxhdGVyIHVzYWdlCiAgICAgICAgX0cuT2xkU2VuZFBhY2tldCA9IF9HLlNlbmRQYWNrZXQKCiAgICAgICAgLS0gT3ZlcnJpZGVuIHBhY2tldCBzZW5kaW5nCiAgICAgICAgX0cuU2VuZFBhY2tldCA9IGZ1bmN0aW9uKHApCiAgICAgICAgICAgIGZvciBoZWFkZXIsIGNhbGxiYWNrVGFibGUgaW4gcGFpcnMoc2VsZi5fX291dGdvaW5nQ2FsbGJhY2tzKSBkbwogICAgICAgICAgICAgICAgaWYgaGVhZGVyID09IHAuaGVhZGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICBmb3IgXywgY2FsbGJhY2sgaW4gaXBhaXJzKGNhbGxiYWNrVGFibGUpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKHApCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIF9HLk9sZFNlbmRQYWNrZXQocCkKICAgICAgICBlbmQKICAgIGVuZAoKZW5kCgotLVtbCiAgICBIb29rIGludG8gYW4gaW5jb21pbmcgcGFja2V0LgoKICAgIEBwYXJhbSBoZWFkZXIgICB8IGludGVnZXIgIHwgSGVhZGVyIGlkIHRvIGhvb2sgaW50bwogICAgQHBhcmFtIGNhbGxiYWNrIHwgZnVuY3Rpb24gfCBGdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlIHBhY2tldCBpbiBiZWluZyByZWNlaXZlZApdXQpmdW5jdGlvbiBfUGFja2V0SGFuZGxlcjpIb29rSW5jb21pbmdQYWNrZXQoaGVhZGVyLCBjYWxsYmFjaykKCiAgICAtLSBQcmVjaGVjawogICAgaWYgbm90IHNlbGYuX19pbmNvbWluZ0NhbGxiYWNrc1toZWFkZXJdIHRoZW4KICAgICAgICBzZWxmLl9faW5jb21pbmdDYWxsYmFja3NbaGVhZGVyXSA9IHt9CiAgICBlbmQKCiAgICB0YWJsZS5pbnNlcnQoc2VsZi5fX2luY29taW5nQ2FsbGJhY2tzW2hlYWRlcl0sIGNhbGxiYWNrKQoKZW5kCgotLVtbCiAgICBIb29rIGludG8gYW4gb3V0Z29pbmcgcGFja2V0LgoKICAgIEBwYXJhbSBoZWFkZXIgICB8IGludGVnZXIgIHwgSGVhZGVyIGlkIHRvIGhvb2sgaW50bwogICAgQHBhcmFtIGNhbGxiYWNrIHwgZnVuY3Rpb24gfCBGdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlIHBhY2tldCBpbiBiZWluZyBzZW50Cl1dCmZ1bmN0aW9uIF9QYWNrZXRIYW5kbGVyOkhvb2tPdXRnb2luZ1BhY2tldChoZWFkZXIsIGNhbGxiYWNrKQoKICAgIC0tIFByZWNoZWNrCiAgICBpZiBub3Qgc2VsZi5fX291dGdvaW5nQ2FsbGJhY2tzW2hlYWRlcl0gdGhlbgogICAgICAgIHNlbGYuX19vdXRnb2luZ0NhbGxiYWNrc1toZWFkZXJdID0ge30KICAgIGVuZAoKICAgIHRhYmxlLmluc2VydChzZWxmLl9fb3V0Z29pbmdDYWxsYmFja3NbaGVhZGVyXSwgY2FsbGJhY2spCgplbmQKCi0tW1sKICAgIEludGVybmFsIGNhbGxiYWNrCl1dCmZ1bmN0aW9uIF9QYWNrZXRIYW5kbGVyOk9uUmVjdlBhY2tldChwKQogICAgZm9yIGhlYWRlciwgY2FsbGJhY2tUYWJsZSBpbiBwYWlycyhzZWxmLl9faW5jb21pbmdDYWxsYmFja3MpIGRvCiAgICAgICAgaWYgaGVhZGVyID09IHAuaGVhZGVyIHRoZW4KICAgICAgICAgICAgZm9yIF8sIGNhbGxiYWNrIGluIGlwYWlycyhjYWxsYmFja1RhYmxlKSBkbwogICAgICAgICAgICAgICAgY2FsbGJhY2socCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgotLVtbCiAgICBJbnRlcm5hbCBjYWxsYmFjawpdXQpmdW5jdGlvbiBfUGFja2V0SGFuZGxlcjpPblNlbmRQYWNrZXQocCkKICAgIGZvciBoZWFkZXIsIGNhbGxiYWNrVGFibGUgaW4gcGFpcnMoc2VsZi5fX291dGdvaW5nQ2FsbGJhY2tzKSBkbwogICAgICAgIGlmIGhlYWRlciA9PSBwLmhlYWRlciB0aGVuCiAgICAgICAgICAgIGZvciBfLCBjYWxsYmFjayBpbiBpcGFpcnMoY2FsbGJhY2tUYWJsZSkgZG8KICAgICAgICAgICAgICAgIGNhbGxiYWNrKHApCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCmVuZAoKLS0gQ3JlYXRlIGEgZ2xvYmFsIGluc3RzYW5jZSBvZiBQYWNrZXRIYW5kbGVyClBhY2tldEhhbmRsZXIgPSBfUGFja2V0SGFuZGxlcigpCgoKLS1bWwoKIC4ufCcnJy58ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnfHwnICAnfHwnICAgICAgICAgICAgICAgICAgICAgICAnfHwgICd8fAoufCcgICAgICcgICAuLi4uICAgLi4gLi4gLi4gICAgIC4uLi4gICB8fCAgICB8fCAgIC4uLi4gICAuLiAuLi4gICAgICAuLiB8fCAgIHx8ICAgIC4uLi4gIC4uLiAuLgp8fCAgICAuLi4uICcnIC58fCAgIHx8IHx8IHx8ICAufC4uLnx8ICB8fCcnJyd8fCAgJycgLnx8ICAgfHwgIHx8ICAgLicgICd8fCAgIHx8ICAufC4uLnx8ICB8fCcgJycKJ3wuICAgIHx8ICAufCcgfHwgICB8fCB8fCB8fCAgfHwgICAgICAgfHwgICAgfHwgIC58JyB8fCAgIHx8ICB8fCAgIHwuICAgfHwgICB8fCAgfHwgICAgICAgfHwKICcnfC4uLid8ICAnfC4uJ3wnIC58fCB8fCB8fC4gICd8Li4uJyAufHwuICAufHwuICd8Li4nfCcgLnx8LiB8fC4gICd8Li4nfHwuIC58fC4gICd8Li4uJyAufHwuCgogICAgR2FtZUhhbmRsZXIgLSBIb29rcyBmb3IgZXZlcnl0aGluZyBhbmQgc29tZSBuaWNlIGV4dHJhIHN0dWZmIGFzd2VsbAoKXV0KY2xhc3MgJ19HYW1lSGFuZGxlcicKCmZ1bmN0aW9uIF9HYW1lSGFuZGxlcjpfX2luaXQoKQplbmQKCmxvY2FsIGdyaWRTaXplID0gNTAKZnVuY3Rpb24gX0dhbWVIYW5kbGVyOkdldEdyaWRDb29yZGluYXRlcyh1bml0KQoKICAgIGFzc2VydCh1bml0IGFuZCB1bml0LnggYW5kIHVuaXQueSBhbmQgdW5pdC56LCAiR2FtZUhhbmRsZXI6R2V0R3JpZENvb3JkaW5hdGVzKCk6IHVuaXQgaXMgaW52YWxpZCEiKQogICAgcmV0dXJuIFZlY3RvcihtYXRoLmNlaWwodW5pdC54IC8gZ3JpZFNpemUpLCBtYXRoLmNlaWwodW5pdC55IC8gZ3JpZFNpemUpLCBtYXRoLmNlaWwodW5pdC56IC8gZ3JpZFNpemUpKQoKZW5kCgpmdW5jdGlvbiBfR2FtZUhhbmRsZXI6R2V0R2FtZUNvb3JkaW5hdGVzKGdyaWQpCgogICAgYXNzZXJ0KGdyaWQgYW5kIGdyaWQueCBhbmQgZ3JpZC55IGFuZCBncmlkLnosICJHYW1lSGFuZGxlcjpHZXRHYW1lQ29vcmRpbmF0ZXMoKTogZ3JpZCBpcyBpbnZhbGlkIikKICAgIHJldHVybiBWZWN0b3IoZ3JpZC54ICogZ3JpZFNpemUsIGdyaWQueSAqIGdyaWRTaXplLCBncmlkLnogKiBncmlkU2l6ZSkKCmVuZAoKZnVuY3Rpb24gX0dhbWVIYW5kbGVyOkdldEdyaWRHYW1lQ29vcmRpbmF0ZXModW5pdCkKCiAgICBhc3NlcnQodW5pdCBhbmQgdW5pdC54IGFuZCB1bml0LnkgYW5kIHVuaXQueiwgIkdhbWVIYW5kbGVyOkdldEdyaWRHYW1lQ29vcmRpbmF0ZXMoKTogdW5pdCBpcyBpbnZhbGlkISIpCiAgICByZXR1cm4gc2VsZjpHZXRHYW1lQ29vcmRpbmF0ZXMoc2VsZjpHZXRHcmlkQ29vcmRpbmF0ZXModW5pdCkpCgplbmQKCi0tIENyZWF0ZSBhIGdsb2JhbCBpbnN0YW5jZSBvZiBHYW1lSGFuZGxlcgpHYW1lSGFuZGxlciA9IF9HYW1lSGFuZGxlcigpCgoKLS1bWwoKJ3x8JyAgJ3wnICAgLiAgICB8fCAgJ3x8CiB8fCAgICB8ICAufHwuICAuLi4gICB8fAogfHwgICAgfCAgIHx8ICAgIHx8ICAgfHwKIHx8ICAgIHwgICB8fCAgICB8fCAgIHx8CiAgJ3wuLicgICAgJ3wuJyAufHwuIC58fC4KCiAgICBVdGlsIC0gSnVzdCB1dGlscy4KXV0KCmZ1bmN0aW9uIFByb3RlY3RUYWJsZSh0KQoKICAgIGxvY2FsIHByb3h5ID0ge30KICAgIGxvY2FsIG10ID0gewogICAgX19pbmRleCA9IHQsCiAgICBfX25ld2luZGV4ID0gZnVuY3Rpb24gKHQsayx2KQogICAgICAgIGVycm9yKCdhdHRlbXB0IHRvIHVwZGF0ZSBhIHJlYWQtb25seSB0YWJsZScsIDIpCiAgICAgICAgZW5kCiAgICB9CiAgICBzZXRtZXRhdGFibGUocHJveHksIG10KQogICAgcmV0dXJuIHByb3h5CgplbmQKCmZ1bmN0aW9uIF9HZXREaXN0YW5jZVNxcihwMSwgcDIpCgogICAgcDIgPSBwMiBvciBwbGF5ZXIKICAgIGlmIHAxIGFuZCBwMS5uZXR3b3JrSUQgYW5kIChwMS5uZXR3b3JrSUQgfj0gMCkgYW5kIHAxLnZpc2lvblBvcyB0aGVuIHAxID0gcDEudmlzaW9uUG9zIGVuZAogICAgaWYgcDIgYW5kIHAyLm5ldHdvcmtJRCBhbmQgKHAyLm5ldHdvcmtJRCB+PSAwKSBhbmQgcDIudmlzaW9uUG9zIHRoZW4gcDIgPSBwMi52aXNpb25Qb3MgZW5kCiAgICByZXR1cm4gR2V0RGlzdGFuY2VTcXIocDEsIHAyKQoKZW5kCgpmdW5jdGlvbiBHZXRPYmplY3RzQXJvdW5kKHJhZGl1cywgcG9zaXRpb24sIGNvbmRpdGlvbikKCiAgICByYWRpdXMgPSBtYXRoLnBvdyhyYWRpdXMsIDIpCiAgICBwb3NpdGlvbiA9IHBvc2l0aW9uIG9yIHBsYXllcgogICAgbG9jYWwgb2JqZWN0c0Fyb3VuZCA9IHt9CiAgICBmb3IgaSA9IDEsIG9iak1hbmFnZXIubWF4T2JqZWN0cyBkbwogICAgICAgIGxvY2FsIG9iamVjdCA9IG9iak1hbmFnZXI6Z2V0T2JqZWN0KGkpCiAgICAgICAgaWYgb2JqZWN0IGFuZCBvYmplY3QudmFsaWQgYW5kIChjb25kaXRpb24gYW5kIGNvbmRpdGlvbihvYmplY3QpID09IHRydWUgb3Igbm90IGNvbmRpdGlvbikgYW5kIF9HZXREaXN0YW5jZVNxcihwb3NpdGlvbiwgb2JqZWN0KSA8PSByYWRpdXMgdGhlbgogICAgICAgICAgICB0YWJsZS5pbnNlcnQob2JqZWN0c0Fyb3VuZCwgb2JqZWN0KQogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gb2JqZWN0c0Fyb3VuZAoKZW5kCgpmdW5jdGlvbiBIYXNCdWZmKHVuaXQsIGJ1ZmZuYW1lKQoKICAgIGZvciBpID0gMSwgdW5pdC5idWZmQ291bnQgZG8KICAgICAgICBsb2NhbCB0QnVmZiA9IHVuaXQ6Z2V0QnVmZihpKQogICAgICAgIGlmIHRCdWZmLnZhbGlkIGFuZCBCdWZmSXNWYWxpZCh0QnVmZikgYW5kIHRCdWZmLm5hbWUgPT0gYnVmZm5hbWUgdGhlbgogICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gZmFsc2UKCmVuZAoKZnVuY3Rpb24gR2V0U3VtbW9uZXJTbG90KG5hbWUsIHVuaXQpCgogICAgdW5pdCA9IHVuaXQgb3IgcGxheWVyCiAgICBpZiB1bml0OkdldFNwZWxsRGF0YShTVU1NT05FUl8xKS5uYW1lID09IG5hbWUgdGhlbiByZXR1cm4gU1VNTU9ORVJfMSBlbmQKICAgIGlmIHVuaXQ6R2V0U3BlbGxEYXRhKFNVTU1PTkVSXzIpLm5hbWUgPT0gbmFtZSB0aGVuIHJldHVybiBTVU1NT05FUl8yIGVuZAoKZW5kCgpmdW5jdGlvbiBHZXRFbmVteUhQQmFyUG9zKGVuZW15KQoKICAgIC0tIFByZXZlbnQgZXJyb3Igc3BhbW1pbmcKICAgIGlmIG5vdCBlbmVteS5iYXJEYXRhIHRoZW4KICAgICAgICBpZiBub3QgX0cuX19zb3VyY2VMaWJfYmFyRGF0YUluZm9ybWVkIHRoZW4KICAgICAgICAgICAgcHJpbnQoIlNvdXJjZUxpYjogYmFyRGF0YSB3YXMgbm90IGZvdW5kLCBzcHVkZ3kgcGxlYXNlLi4uIikKICAgICAgICAgICAgX0cuX19zb3VyY2VMaWJfYmFyRGF0YUluZm9ybWVkID0gdHJ1ZQogICAgICAgIGVuZAogICAgICAgIHJldHVybgogICAgZW5kCgogICAgbG9jYWwgYmFyUG9zID0gR2V0VW5pdEhQQmFyUG9zKGVuZW15KQogICAgbG9jYWwgYmFyUG9zT2Zmc2V0ID0gR2V0VW5pdEhQQmFyT2Zmc2V0KGVuZW15KQogICAgbG9jYWwgYmFyT2Zmc2V0ID0gUG9pbnQoZW5lbXkuYmFyRGF0YS5QZXJjZW50YWdlT2Zmc2V0LngsIGVuZW15LmJhckRhdGEuUGVyY2VudGFnZU9mZnNldC55KQogICAgbG9jYWwgYmFyUG9zUGVyY2VudGFnZU9mZnNldCA9IFBvaW50KGVuZW15LmJhckRhdGEuUGVyY2VudGFnZU9mZnNldC54LCBlbmVteS5iYXJEYXRhLlBlcmNlbnRhZ2VPZmZzZXQueSkKCiAgICBsb2NhbCBCYXJQb3NPZmZzZXRYID0gMTY5CiAgICBsb2NhbCBCYXJQb3NPZmZzZXRZID0gNDcKICAgIGxvY2FsIENvcnJlY3Rpb25YID0gMTYKICAgIGxvY2FsIENvcnJlY3Rpb25ZID0gNAoKICAgIGJhclBvcy54ID0gYmFyUG9zLnggKyAoYmFyUG9zT2Zmc2V0LnggLSAwLjUgKyBiYXJQb3NQZXJjZW50YWdlT2Zmc2V0LngpICogQmFyUG9zT2Zmc2V0WCArIENvcnJlY3Rpb25YCiAgICBiYXJQb3MueSA9IGJhclBvcy55ICsgKGJhclBvc09mZnNldC55IC0gMC41ICsgYmFyUG9zUGVyY2VudGFnZU9mZnNldC55KSAqIEJhclBvc09mZnNldFkgKyBDb3JyZWN0aW9uWQoKICAgIGxvY2FsIFN0YXJ0UG9zID0gUG9pbnQoYmFyUG9zLngsIGJhclBvcy55KQogICAgbG9jYWwgRW5kUG9zID0gUG9pbnQoYmFyUG9zLnggKyAxMDMsIGJhclBvcy55KQoKICAgIHJldHVybiBQb2ludChTdGFydFBvcy54LCBTdGFydFBvcy55KSwgUG9pbnQoRW5kUG9zLngsIEVuZFBvcy55KQoKZW5kCgpmdW5jdGlvbiBDb3VudE9iamVjdHNOZWFyUG9zKHBvcywgcmFuZ2UsIHJhZGl1cywgb2JqZWN0cykKCiAgICBsb2NhbCBuID0gMAogICAgZm9yIGksIG9iamVjdCBpbiBpcGFpcnMob2JqZWN0cykgZG8KICAgICAgICBpZiBfR2V0RGlzdGFuY2VTcXIocG9zLCBvYmplY3QpIDw9IHJhZGl1cyAqIHJhZGl1cyB0aGVuCiAgICAgICAgICAgIG4gPSBuICsgMQogICAgICAgIGVuZAogICAgZW5kCgogICAgcmV0dXJuIG4KCmVuZAoKZnVuY3Rpb24gR2V0QmVzdENpcmN1bGFyRmFybVBvc2l0aW9uKHJhbmdlLCByYWRpdXMsIG9iamVjdHMpCgogICAgbG9jYWwgQmVzdFBvcwogICAgbG9jYWwgQmVzdEhpdCA9IDAKICAgIGZvciBpLCBvYmplY3QgaW4gaXBhaXJzKG9iamVjdHMpIGRvCiAgICAgICAgbG9jYWwgaGl0ID0gQ291bnRPYmplY3RzTmVhclBvcyhvYmplY3QudmlzaW9uUG9zIG9yIG9iamVjdCwgcmFuZ2UsIHJhZGl1cywgb2JqZWN0cykKICAgICAgICBpZiBoaXQgPiBCZXN0SGl0IHRoZW4KICAgICAgICAgICAgQmVzdEhpdCA9IGhpdAogICAgICAgICAgICBCZXN0UG9zID0gVmVjdG9yKG9iamVjdCkKICAgICAgICAgICAgaWYgQmVzdEhpdCA9PSAjb2JqZWN0cyB0aGVuCiAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVuZAogICAgICAgICBlbmQKICAgIGVuZAoKICAgIHJldHVybiBCZXN0UG9zLCBCZXN0SGl0CgplbmQKCmZ1bmN0aW9uIENvdW50T2JqZWN0c09uTGluZVNlZ21lbnQoU3RhcnRQb3MsIEVuZFBvcywgd2lkdGgsIG9iamVjdHMpCgogICAgbG9jYWwgbiA9IDAKICAgIGZvciBpLCBvYmplY3QgaW4gaXBhaXJzKG9iamVjdHMpIGRvCiAgICAgICAgbG9jYWwgcG9pbnRTZWdtZW50LCBwb2ludExpbmUsIGlzT25TZWdtZW50ID0gVmVjdG9yUG9pbnRQcm9qZWN0aW9uT25MaW5lU2VnbWVudChTdGFydFBvcywgRW5kUG9zLCBvYmplY3QpCiAgICAgICAgaWYgaXNPblNlZ21lbnQgYW5kIEdldERpc3RhbmNlU3FyKHBvaW50U2VnbWVudCwgb2JqZWN0KSA8IHdpZHRoICogd2lkdGggdGhlbgogICAgICAgICAgICBuID0gbiArIDEKICAgICAgICBlbmQKICAgIGVuZAoKICAgIHJldHVybiBuCgplbmQKCmZ1bmN0aW9uIEdldEJlc3RMaW5lRmFybVBvc2l0aW9uKHJhbmdlLCB3aWR0aCwgb2JqZWN0cykKCiAgICBsb2NhbCBCZXN0UG9zCiAgICBsb2NhbCBCZXN0SGl0ID0gMAogICAgZm9yIGksIG9iamVjdCBpbiBpcGFpcnMob2JqZWN0cykgZG8KICAgICAgICBsb2NhbCBFbmRQb3MgPSBWZWN0b3IobXlIZXJvLnZpc2lvblBvcykgKyByYW5nZSAqIChWZWN0b3Iob2JqZWN0KSAtIFZlY3RvcihteUhlcm8udmlzaW9uUG9zKSk6bm9ybWFsaXplZCgpCiAgICAgICAgbG9jYWwgaGl0ID0gQ291bnRPYmplY3RzT25MaW5lU2VnbWVudChteUhlcm8udmlzaW9uUG9zLCBFbmRQb3MsIHdpZHRoLCBvYmplY3RzKQogICAgICAgIGlmIGhpdCA+IEJlc3RIaXQgdGhlbgogICAgICAgICAgICBCZXN0SGl0ID0gaGl0CiAgICAgICAgICAgIEJlc3RQb3MgPSBWZWN0b3Iob2JqZWN0KQogICAgICAgICAgICBpZiBCZXN0SGl0ID09ICNvYmplY3RzIHRoZW4KICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZW5kCiAgICAgICAgIGVuZAogICAgZW5kCgogICAgcmV0dXJuIEJlc3RQb3MsIEJlc3RIaXQKCmVuZAoKZnVuY3Rpb24gR2V0UHJlZGljdGVkUG9zaXRpb25zVGFibGUoVlAsIHQsIGRlbGF5LCB3aWR0aCwgcmFuZ2UsIHNwZWVkLCBzb3VyY2UsIGNvbGxpc2lvbikKCiAgICBsb2NhbCByZXN1bHQgPSB7fQogICAgZm9yIGksIHRhcmdldCBpbiBpcGFpcnModCkgZG8KICAgICAgICBsb2NhbCBDYXN0UG9zaXRpb24sIEhpdGNoYW5jZSwgUG9zaXRpb24gPSBWUDpHZXRDaXJjdWxhckNhc3RQb3NpdGlvbih0YXJnZXQsIGRlbGF5LCB3aWR0aCwgcmFuZ2UsIHNwZWVkLCBzb3VyY2UsIGNvbGxpc2lvbikKICAgICAgICB0YWJsZS5pbnNlcnQocmVzdWx0LCBQb3NpdGlvbikKICAgIGVuZAogICAgcmV0dXJuIHJlc3VsdAoKZW5kCgpmdW5jdGlvbiBNZXJnZVRhYmxlcyh0MSwgdDIpCgogICAgZm9yIGkgPSAxLCAjdDIgZG8KICAgICAgICB0MVsjdDEgKyAxXSA9IHQyW2ldCiAgICBlbmQKICAgIHJldHVybiB0MQoKZW5kCgpmdW5jdGlvbiBTZWxlY3RVbml0cyh1bml0cywgY29uZGl0aW9uKQoKICAgIGxvY2FsIHJlc3VsdCA9IHt9CiAgICBmb3IgaSwgdW5pdCBpbiBpcGFpcnModW5pdHMpIGRvCiAgICAgICAgaWYgY29uZGl0aW9uKHVuaXQpIHRoZW4KICAgICAgICAgICAgdGFibGUuaW5zZXJ0KHJlc3VsdCwgdW5pdCkKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIHJlc3VsdAoKZW5kCgpmdW5jdGlvbiBTcGVsbFRvU3RyaW5nKGlkKQoKICAgIGlmIGlkID09IF9RIHRoZW4gcmV0dXJuICJRIiBlbmQKICAgIGlmIGlkID09IF9XIHRoZW4gcmV0dXJuICJXIiBlbmQKICAgIGlmIGlkID09IF9FIHRoZW4gcmV0dXJuICJFIiBlbmQKICAgIGlmIGlkID09IF9SIHRoZW4gcmV0dXJuICJSIiBlbmQKCmVuZAoKZnVuY3Rpb24gVEFSR0IoY29sb3JUYWJsZSkKCiAgICBhc3NlcnQoY29sb3JUYWJsZSBhbmQgdHlwZShjb2xvclRhYmxlKSA9PSAidGFibGUiIGFuZCAjY29sb3JUYWJsZSA9PSA0LCAiVEFSR0I6IGNvbG9yVGFibGUgaXMgaW52YWxpZCEiKQogICAgcmV0dXJuIEFSR0IoY29sb3JUYWJsZVsxXSwgY29sb3JUYWJsZVsyXSwgY29sb3JUYWJsZVszXSwgY29sb3JUYWJsZVs0XSkKCmVuZAoKZnVuY3Rpb24gUGluZ0NsaWVudCh4LCB5LCBwaW5nVHlwZSkKICAgIFBhY2tldCgiUl9QSU5HIiwge3ggPSB5LCB5ID0geSwgdHlwZSA9IHBpbmdUeXBlIGFuZCBwaW5nVHlwZSBvciBQSU5HX0ZBTExCQUNLfSk6cmVjZWl2ZSgpCmVuZAoKbG9jYWwgX191dGlsX2F1dG9BdHRhY2sgICA9IHsgImZyb3N0YXJyb3ciIH0KbG9jYWwgX191dGlsX25vQXV0b0F0dGFjayA9IHsgInNoeXZhbmFkb3VibGVhdHRhY2tkcmFnb24iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2h5dmFuYWRvdWJsZWF0dGFjayIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtb25rZXlraW5nZG91YmxlYXR0YWNrIiB9CmZ1bmN0aW9uIElzQUFTcGVsbChzcGVsbCkKCiAgICBpZiBub3Qgc3BlbGwgb3Igbm90IHNwZWxsLm5hbWUgdGhlbiByZXR1cm4gZW5kCgogICAgZm9yIF8sIHNwZWxsTmFtZSBpbiBpcGFpcnMoX191dGlsX2F1dG9BdHRhY2spIGRvCiAgICAgICAgaWYgc3BlbGxOYW1lID09IHNwZWxsLm5hbWU6bG93ZXIoKSB0aGVuCiAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBmb3IgXywgc3BlbGxOYW1lIGluIGlwYWlycyhfX3V0aWxfbm9BdXRvQXR0YWNrKSBkbwogICAgICAgIGlmIHNwZWxsTmFtZSA9PSBzcGVsbC5uYW1lOmxvd2VyKCkgdGhlbgogICAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGlmIHNwZWxsLm5hbWU6bG93ZXIoKTpmaW5kKCJhdHRhY2siKSB0aGVuCiAgICAgICAgcmV0dXJuIHRydWUKICAgIGVuZAoKICAgIHJldHVybiBmYWxzZQoKZW5kCgotLSBTb3VyY2U6IGh0dHA6Ly9sdWEtdXNlcnMub3JnL3dpa2kvQ29weVRhYmxlCmZ1bmN0aW9uIFRhYmxlRGVlcENvcHkob3JpZykKCiAgICBsb2NhbCBvcmlnX3R5cGUgPSB0eXBlKG9yaWcpCiAgICBsb2NhbCBjb3B5CiAgICBpZiBvcmlnX3R5cGUgPT0gJ3RhYmxlJyB0aGVuCiAgICAgICAgY29weSA9IHt9CiAgICAgICAgZm9yIG9yaWdfa2V5LCBvcmlnX3ZhbHVlIGluIG5leHQsIG9yaWcsIG5pbCBkbwogICAgICAgICAgICBjb3B5W2RlZXBjb3B5KG9yaWdfa2V5KV0gPSBkZWVwY29weShvcmlnX3ZhbHVlKQogICAgICAgIGVuZAogICAgICAgIHNldG1ldGF0YWJsZShjb3B5LCBkZWVwY29weShnZXRtZXRhdGFibGUob3JpZykpKQogICAgZWxzZSAtLSBudW1iZXIsIHN0cmluZywgYm9vbGVhbiwgZXRjCiAgICAgICAgY29weSA9IG9yaWcKICAgIGVuZAogICAgcmV0dXJuIGNvcHkKCmVuZAoKCi0tW1sKCid8fCcgICAgICAgICAgIHx8ICAgIC4gICAgfHwgICAgICAgICAgJ3x8ICAgfHwgICAgICAgICAgICAgICAgICAgIC4gICAgfHwKIHx8ICAuLiAuLi4gICAuLi4gIC58fC4gIC4uLiAgIC4uLi4gICAgfHwgIC4uLiAgLi4uLi4uICAgLi4uLiAgIC58fC4gIC4uLiAgICAuLi4gICAuLiAuLi4KIHx8ICAgfHwgIHx8ICAgfHwgICB8fCAgICB8fCAgJycgLnx8ICAgfHwgICB8fCAgJyAgLnwnICAnJyAufHwgICB8fCAgICB8fCAgLnwgICd8LiAgfHwgIHx8CiB8fCAgIHx8ICB8fCAgIHx8ICAgfHwgICAgfHwgIC58JyB8fCAgIHx8ICAgfHwgICAufCcgICAgLnwnIHx8ICAgfHwgICAgfHwgIHx8ICAgfHwgIHx8ICB8fAoufHwuIC58fC4gfHwuIC58fC4gICd8LicgLnx8LiAnfC4uJ3wnIC58fC4gLnx8LiB8fC4uLi58ICd8Li4nfCcgICd8LicgLnx8LiAgJ3wuLnwnIC58fC4gfHwuCgpdXQoKLS0gV2UgYXJlIGN1cnJlbnRseSBtb3ZpbmcgdG8gR2l0SHViLCBnaW1tZSBhIHNlYyB0byBjcmVhdGUgYSByZXBvIG92ZXIgdGhlcmUgOykKCi0tIFVwZGF0ZSBzY3JpcHQKaWYgYXV0b1VwZGF0ZSB0aGVuCiAgICBTb3VyY2VVcGRhdGVyKCJTb3VyY2VMaWIiLCB2ZXJzaW9uLCAicmF3LmdpdGh1Yi5jb20iLCAiL1RoZVJlYWxTb3VyY2UvcHVibGljL21hc3Rlci9jb21tb24vU291cmNlTGliLmx1YSIsIExJQl9QQVRIIC4uICJTb3VyY2VMaWIubHVhIiwgIi9UaGVSZWFsU291cmNlL3B1YmxpYy9tYXN0ZXIvY29tbW9uL1NvdXJjZUxpYi52ZXJzaW9uIik6U2V0U2lsZW50KHNpbGVudFVwZGF0ZSk6Q2hlY2tVcGRhdGUoKQplbmQKCi0tIFNldCBlbmVteSBiYXIgZGF0YQpmb3IgaSwgZW5lbXkgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvCiAgICBlbmVteS5iYXJEYXRhID0ge1BlcmNlbnRhZ2VPZmZzZXQgPSB7eCA9IDAsIHkgPSAwfSB9LS1HZXRFbmVteUJhckRhdGEoKS0tc3BhZGdlIHBscwplbmQKCi0tU3VtbW9uZXIgc3BlbGxzCl9JR05JVEUgID0gR2V0U3VtbW9uZXJTbG90KCJTdW1tb25lckRvdCIpCl9GTEFTSCAgID0gR2V0U3VtbW9uZXJTbG90KCJTdW1tb25lckZsYXNoIikKX0VYSEFVU1QgPSBHZXRTdW1tb25lclNsb3QoIlN1bW1vbmVyRXhoYXVzdCIpCgotLU90aGVycwpfQUEgPSAxMDAwMApfUEFTSVZFID0gMTAwMDEK"
				NewSourceLibFile = io.open(LIB_PATH.."/SourceLib.lua", "w+")
				NewSourceLibFile:write(StringDecrypt(NewSourceLibString))
				NewSourceLibFile:close()
				_PrintScriptMsg("Incorrect Version of SourceLib detected.")
				_PrintScriptMsg("Updated SourceLib to Version ".. 1.058)
				require "SourceLib"
				UpdateDone_SourceLib = true
			else
				_PrintScriptMsg("SourceLib loaded, Version: ".. 1.058)
				require "SourceLib"
				UpdateDone_SourceLib = true
			end
		end
	end
end

function _CheckUpdate_VPrediction()
	if not UpdateDone_VPrediction then
		--~ Get Local Version
		if LocalVersion_VPrediction == nil then
			if FileExist(LIB_PATH.."/VPrediction.lua") then
				LocalVersionFile = io.open(LIB_PATH.."/VPrediction.lua", "r")
				LocalVersionString = LocalVersionFile:read("*a")
				LocalVersionPos, Dummy = string.find(LocalVersionString, "local version =")
				if string.find(LocalVersionString, "local AUTOUPDATE = true") then
					LocalVersion_VPrediction = 1.000
				else
					LocalVersion_VPrediction = tonumber(string.sub(LocalVersionString, LocalVersionPos+17, LocalVersionPos+20))
				end
			else
				LocalVersion_VPrediction = 1.000
			end
		end

		--~ Overwrite if needed
		if LocalVersion_VPrediction ~= nil then
			if LocalVersion_VPrediction ~= 2.51 then
				NewVPredictionString = "bG9jYWwgdmVyc2lvbiA9ICIyLjUxIgpsb2NhbCBURVNUVkVSU0lPTiA9IGZhbHNlCmxvY2FsIEFVVE9VUERBVEUgPSBmYWxzZQpsb2NhbCBVUERBVEVfSE9TVCA9ICJyYXcuZ2l0aHViLmNvbSIKbG9jYWwgVVBEQVRFX1BBVEggPSAiL2hvbmRhNy9Cb0wvbWFzdGVyL0NvbW1vbi9WUHJlZGljdGlvbi5sdWEiLi4iP3JhbmQ9Ii4ubWF0aC5yYW5kb20oMSwxMDAwMCkKbG9jYWwgVVBEQVRFX0ZJTEVfUEFUSCA9IExJQl9QQVRILi4idlByZWRpY3Rpb24ubHVhIgpsb2NhbCBVUERBVEVfVVJMID0gImh0dHBzOi8vIi4uVVBEQVRFX0hPU1QuLlVQREFURV9QQVRICgpmdW5jdGlvbiBBdXRvdXBkYXRlck1zZyhtc2cpIHByaW50KCI8Zm9udCBjb2xvcj1cIiM2Njk5ZmZcIj48Yj5WUHJlZGljdGlvbjo8L2I+PC9mb250PiA8Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4iLi5tc2cuLiIuPC9mb250PiIpIGVuZAppZiBBVVRPVVBEQVRFIHRoZW4KCWxvY2FsIFNlcnZlckRhdGEgPSBHZXRXZWJSZXN1bHQoVVBEQVRFX0hPU1QsICIvaG9uZGE3L0JvTC9tYXN0ZXIvVmVyc2lvbkZpbGVzL3ZQcmVkaWN0aW9uLnZlcnNpb24iKQoJaWYgU2VydmVyRGF0YSB0aGVuCgkJU2VydmVyVmVyc2lvbiA9IHR5cGUodG9udW1iZXIoU2VydmVyRGF0YSkpID09ICJudW1iZXIiIGFuZCB0b251bWJlcihTZXJ2ZXJEYXRhKSBvciBuaWwKCQlpZiBTZXJ2ZXJWZXJzaW9uIHRoZW4KCQkJaWYgdG9udW1iZXIodmVyc2lvbikgPCBTZXJ2ZXJWZXJzaW9uIHRoZW4KCQkJCUF1dG91cGRhdGVyTXNnKCJOZXcgdmVyc2lvbiBhdmFpbGFibGUiLi5TZXJ2ZXJWZXJzaW9uKQoJCQkJQXV0b3VwZGF0ZXJNc2coIlVwZGF0aW5nLCBwbGVhc2UgZG9uJ3QgcHJlc3MgRjkiKQoJCQkJRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBEb3dubG9hZEZpbGUoVVBEQVRFX1VSTCwgVVBEQVRFX0ZJTEVfUEFUSCwgZnVuY3Rpb24gKCkgQXV0b3VwZGF0ZXJNc2coIlN1Y2Nlc3NmdWxseSB1cGRhdGVkLiAoIi4udmVyc2lvbi4uIiA9PiAiLi5TZXJ2ZXJWZXJzaW9uLi4iKSwgcHJlc3MgRjkgdHdpY2UgdG8gbG9hZCB0aGUgdXBkYXRlZCB2ZXJzaW9uLiIpIGVuZCkgZW5kLCAzKQoJCQllbHNlCgkJCQlBdXRvdXBkYXRlck1zZygiWW91IGhhdmUgZ290IHRoZSBsYXRlc3QgdmVyc2lvbiAoIi4uU2VydmVyVmVyc2lvbi4uIikiKQoJCQllbmQKCQllbmQKCWVsc2UKCQlBdXRvdXBkYXRlck1zZygiRXJyb3IgZG93bmxvYWRpbmcgdmVyc2lvbiBpbmZvIikKCWVuZAplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpsb2NhbCBfRkFTVCwgX01FRElVTSwgX1NMT1cgPSAxLCAyLCAzCmNsYXNzICdWUHJlZGljdGlvbicgLS17CmZ1bmN0aW9uIFZQcmVkaWN0aW9uOl9faW5pdCgpCglzZWxmLnZlcnNpb24gPSB0b251bWJlcih2ZXJzaW9uKQoJc2VsZi5zaG93ZGV2bW9kZSA9IGZhbHNlCglzZWxmLmhpdGJveGVzID0ge1snUmVjSXRlbXNDTEFTU0lDJ10gPSA2NSwgWydUZWVtb011c2hyb29tJ10gPSA1MC4wLCBbJ1Rlc3RDdWJlUmVuZGVyJ10gPSA2NSwgWydYZXJhdGgnXSA9IDY1LCBbJ0thc3NhZGluJ10gPSA2NSwgWydSZW5nYXInXSA9IDY1LCBbJ1RocmVzaCddID0gNTUuMCwgWydSZWNJdGVtc1RVVE9SSUFMJ10gPSA2NSwgWydaaWdncyddID0gNTUuMCwgWydaeXJhUGFzc2l2ZSddID0gMjAuMCwgWydaeXJhVGhvcm5QbGFudCddID0gMjAuMCwgWydLb2dNYXcnXSA9IDY1LCBbJ0hlaW1lclRCbHVlJ10gPSAzNS4wLCBbJ0VsaXNlU3BpZGVyJ10gPSA2NSwgWydTa2FybmVyJ10gPSA4MC4wLCBbJ0NoYW9zTmV4dXMnXSA9IDY1LCBbJ0thdGFyaW5hJ10gPSA2NSwgWydSaXZlbiddID0gNjUsIFsnU2lnaHRXYXJkJ10gPSAxLCBbJ0hlaW1lclRZZWxsb3cnXSA9IDM1LjAsIFsnQXNoZSddID0gNjUsIFsnVmlzaW9uV2FyZCddID0gMSwgWydUVF9OR29sZW0yJ10gPSA4MC4wLCBbJ1RocmVzaExhbnRlcm4nXSA9IDY1LCBbJ1JlY0l0ZW1zQ0xBU1NJQ01hcDEwJ10gPSA2NSwgWydSZWNJdGVtc09ESU4nXSA9IDY1LCBbJ1RUX1NwaWRlcmJvc3MnXSA9IDIwMC4wLCBbJ1JlY0l0ZW1zQVJBTSddID0gNjUsIFsnT3JkZXJOZXh1cyddID0gNjUsIFsnU29yYWthJ10gPSA2NSwgWydKaW54J10gPSA2NSwgWydUZXN0Q3ViZVJlbmRlcndDb2xsaXNpb24nXSA9IDY1LCBbJ1JlZF9NaW5pb25fV2l6YXJkJ10gPSA0OC4wLCBbJ0phcnZhbklWJ10gPSA2NSwgWydCbHVlX01pbmlvbl9XaXphcmQnXSA9IDQ4LjAsIFsnVFRfQ2hhb3NUdXJyZXQyJ10gPSA4OC40LCBbJ1RUX0NoYW9zVHVycmV0MyddID0gODguNCwgWydUVF9DaGFvc1R1cnJldDEnXSA9IDg4LjQsIFsnQ2hhb3NUdXJyZXRHaWFudCddID0gODguNCwgWydEcmFnb24nXSA9IDEwMC4wLCBbJ0x1bHVTbm93bWFuJ10gPSA1MC4wLCBbJ1dvcm0nXSA9IDEwMC4wLCBbJ0NoYW9zVHVycmV0V29ybSddID0gODguNCwgWydUVF9DaGFvc0luaGliaXRvciddID0gNjUsIFsnQ2hhb3NUdXJyZXROb3JtYWwnXSA9IDg4LjQsIFsnQW5jaWVudEdvbGVtJ10gPSAxMDAuMCwgWydaeXJhR3Jhc3BpbmdQbGFudCddID0gMjAuMCwgWydIQV9BUF9PcmRlclR1cnJldDMnXSA9IDg4LjQsIFsnSEFfQVBfT3JkZXJUdXJyZXQyJ10gPSA4OC40LCBbJ1RyeW5kYW1lcmUnXSA9IDY1LCBbJ09yZGVyVHVycmV0Tm9ybWFsMiddID0gODguNCwgWydTaW5nZWQnXSA9IDY1LCBbJ09yZGVySW5oaWJpdG9yJ10gPSA2NSwgWydEaWFuYSddID0gNjUsIFsnSEFfRkJfSGVhbHRoUmVsaWMnXSA9IDY1LCBbJ1RUX09yZGVySW5oaWJpdG9yJ10gPSA2NSwgWydHcmVhdFdyYWl0aCddID0gODAuMCwgWydZYXN1byddID0gNjUsIFsnT3JkZXJUdXJyZXREcmFnb24nXSA9IDg4LjQsIFsnT3JkZXJUdXJyZXROb3JtYWwnXSA9IDg4LjQsIFsnTGl6YXJkRWxkZXInXSA9IDY1LjAsIFsnSEFfQVBfQ2hhb3NUdXJyZXQnXSA9IDg4LjQsIFsnQWhyaSddID0gNjUsIFsnTHVsdSddID0gNjUsIFsnQ2hhb3NJbmhpYml0b3InXSA9IDY1LCBbJ0hBX0FQX0NoYW9zVHVycmV0MyddID0gODguNCwgWydIQV9BUF9DaGFvc1R1cnJldDInXSA9IDg4LjQsIFsnQ2hhb3NUdXJyZXRXb3JtMiddID0gODguNCwgWydUVF9PcmRlclR1cnJldDEnXSA9IDg4LjQsIFsnVFRfT3JkZXJUdXJyZXQyJ10gPSA4OC40LCBbJ1RUX09yZGVyVHVycmV0MyddID0gODguNCwgWydMdWx1RmFlcmllJ10gPSA2NSwgWydIQV9BUF9PcmRlclR1cnJldCddID0gODguNCwgWydPcmRlclR1cnJldEFuZ2VsJ10gPSA4OC40LCBbJ1llbGxvd1RyaW5rZXRVcGdyYWRlJ10gPSAxLCBbJ01hc3RlcllpJ10gPSA2NSwgWydMaXNzYW5kcmEnXSA9IDY1LCBbJ0FSQU1PcmRlclR1cnJldE5leHVzJ10gPSA4OC40LCBbJ0RyYXZlbiddID0gNjUsIFsnRmlkZGxlU3RpY2tzJ10gPSA2NSwgWydTbWFsbEdvbGVtJ10gPSA4MC4wLCBbJ0FSQU1PcmRlclR1cnJldEZyb250J10gPSA4OC40LCBbJ0NoYW9zVHVycmV0VHV0b3JpYWwnXSA9IDg4LjQsIFsnTmFzdXNVbHQnXSA9IDgwLjAsIFsnTWFva2FpJ10gPSA4MC4wLCBbJ1dyYWl0aCddID0gNTAuMCwgWydXb2xmJ10gPSA1MC4wLCBbJ1NpdmlyJ10gPSA2NSwgWydDb3JraSddID0gNjUsIFsnSmFubmEnXSA9IDY1LCBbJ05hc3VzJ10gPSA4MC4wLCBbJ0dvbGVtJ10gPSA4MC4wLCBbJ0FSQU1DaGFvc1R1cnJldEZyb250J10gPSA4OC40LCBbJ0FSQU1PcmRlclR1cnJldEluaGliJ10gPSA4OC40LCBbJ0xlZVNpbiddID0gNjUsIFsnSEFfQVBfQ2hhb3NUdXJyZXRUdXRvcmlhbCddID0gODguNCwgWydHaWFudFdvbGYnXSA9IDY1LjAsIFsnSEFfQVBfT3JkZXJUdXJyZXRUdXRvcmlhbCddID0gODguNCwgWydZb3VuZ0xpemFyZCddID0gNTAuMCwgWydKYXgnXSA9IDY1LCBbJ0xlc3NlcldyYWl0aCddID0gNTAuMCwgWydCbGl0emNyYW5rJ10gPSA4MC4wLCBbJ2JydXNoX0RfU1InXSA9IDY1LCBbJ2JydXNoX0VfU1InXSA9IDY1LCBbJ2JydXNoX0ZfU1InXSA9IDY1LCBbJ2JydXNoX0NfU1InXSA9IDY1LCBbJ2JydXNoX0FfU1InXSA9IDY1LCBbJ2JydXNoX0JfU1InXSA9IDY1LCBbJ0FSQU1DaGFvc1R1cnJldEluaGliJ10gPSA4OC40LCBbJ1NoZW4nXSA9IDY1LCBbJ05vY3R1cm5lJ10gPSA2NSwgWydTb25hJ10gPSA2NSwgWydBUkFNQ2hhb3NUdXJyZXROZXh1cyddID0gODguNCwgWydZZWxsb3dUcmlua2V0J10gPSAxLCBbJ09yZGVyVHVycmV0VHV0b3JpYWwnXSA9IDg4LjQsIFsnQ2FpdGx5biddID0gNjUsIFsnVHJ1bmRsZSddID0gNjUsIFsnTWFscGhpdGUnXSA9IDgwLjAsIFsnTW9yZGVrYWlzZXInXSA9IDgwLjAsIFsnWnlyYVNlZWQnXSA9IDY1LCBbJ1ZpJ10gPSA1MCwgWydUdXRvcmlhbF9SZWRfTWluaW9uX1dpemFyZCddID0gNDguMCwgWydSZW5la3RvbiddID0gODAuMCwgWydBbml2aWEnXSA9IDY1LCBbJ0ZpenonXSA9IDY1LCBbJ0hlaW1lcmRpbmdlciddID0gNTUuMCwgWydFdmVseW5uJ10gPSA2NSwgWydSdW1ibGUnXSA9IDgwLjAsIFsnTGVibGFuYyddID0gNjUsIFsnRGFyaXVzJ10gPSA4MC4wLCBbJ09sYWZBeGUnXSA9IDUwLjAsIFsnVmlrdG9yJ10gPSA2NSwgWydYaW5aaGFvJ10gPSA2NSwgWydPcmlhbm5hJ10gPSA2NSwgWydWbGFkaW1pciddID0gNjUsIFsnTmlkYWxlZSddID0gNjUsIFsnVHV0b3JpYWxfUmVkX01pbmlvbl9CYXNpYyddID0gNDguMCwgWydaZWRTaGFkb3cnXSA9IDY1LCBbJ1N5bmRyYSddID0gNjUsIFsnWmFjJ10gPSA4MC4wLCBbJ09sYWYnXSA9IDY1LCBbJ1ZlaWdhciddID0gNTUuMCwgWydUd2l0Y2gnXSA9IDY1LCBbJ0FsaXN0YXInXSA9IDgwLjAsIFsnQWthbGknXSA9IDY1LCBbJ1VyZ290J10gPSA4MC4wLCBbJ0xlb25hJ10gPSA2NSwgWydUYWxvbiddID0gNjUsIFsnS2FybWEnXSA9IDY1LCBbJ0pheWNlJ10gPSA2NSwgWydHYWxpbyddID0gODAuMCwgWydTaGFjbyddID0gNjUsIFsnVGFyaWMnXSA9IDY1LCBbJ1R3aXN0ZWRGYXRlJ10gPSA2NSwgWydWYXJ1cyddID0gNjUsIFsnR2FyZW4nXSA9IDY1LCBbJ1N3YWluJ10gPSA2NSwgWydWYXluZSddID0gNjUsIFsnRmlvcmEnXSA9IDY1LCBbJ1F1aW5uJ10gPSA2NSwgWydLYXlsZSddID0gNjUsIFsnQmx1ZV9NaW5pb25fQmFzaWMnXSA9IDQ4LjAsIFsnQnJhbmQnXSA9IDY1LCBbJ1RlZW1vJ10gPSA1NS4wLCBbJ0FtdW11J10gPSA1NS4wLCBbJ0FubmllJ10gPSA1NS4wLCBbJ09kaW5fQmx1ZV9NaW5pb25fY2FzdGVyJ10gPSA0OC4wLCBbJ0VsaXNlJ10gPSA2NSwgWydOYW1pJ10gPSA2NSwgWydQb3BweSddID0gNTUuMCwgWydBbml2aWFFZ2cnXSA9IDY1LCBbJ1RyaXN0YW5hJ10gPSA1NS4wLCBbJ0dyYXZlcyddID0gNjUsIFsnTW9yZ2FuYSddID0gNjUsIFsnR3JhZ2FzJ10gPSA4MC4wLCBbJ01pc3NGb3J0dW5lJ10gPSA2NSwgWydXYXJ3aWNrJ10gPSA2NSwgWydDYXNzaW9wZWlhJ10gPSA2NSwgWydUdXRvcmlhbF9CbHVlX01pbmlvbl9XaXphcmQnXSA9IDQ4LjAsIFsnRHJNdW5kbyddID0gODAuMCwgWydWb2xpYmVhciddID0gODAuMCwgWydJcmVsaWEnXSA9IDY1LCBbJ09kaW5fUmVkX01pbmlvbl9DYXN0ZXInXSA9IDQ4LjAsIFsnTHVjaWFuJ10gPSA2NSwgWydZb3JpY2snXSA9IDgwLjAsIFsnUmFtbXVzUEInXSA9IDY1LCBbJ1JlZF9NaW5pb25fQmFzaWMnXSA9IDQ4LjAsIFsnVWR5ciddID0gNjUsIFsnTW9ua2V5S2luZyddID0gNjUsIFsnVHV0b3JpYWxfQmx1ZV9NaW5pb25fQmFzaWMnXSA9IDQ4LjAsIFsnS2VubmVuJ10gPSA1NS4wLCBbJ051bnUnXSA9IDY1LCBbJ1J5emUnXSA9IDY1LCBbJ1plZCddID0gNjUsIFsnTmF1dGlsdXMnXSA9IDgwLjAsIFsnR2FuZ3BsYW5rJ10gPSA2NSwgWydzaG9wZXZvJ10gPSA2NSwgWydMdXgnXSA9IDY1LCBbJ1NlanVhbmknXSA9IDgwLjAsIFsnRXpyZWFsJ10gPSA2NSwgWydPZGluTmV1dHJhbEd1YXJkaWFuJ10gPSA2NSwgWydLaGF6aXgnXSA9IDY1LCBbJ1Npb24nXSA9IDgwLjAsIFsnQWF0cm94J10gPSA2NSwgWydIZWNhcmltJ10gPSA4MC4wLCBbJ1BhbnRoZW9uJ10gPSA2NSwgWydTaHl2YW5hJ10gPSA1MC4wLCBbJ1p5cmEnXSA9IDY1LCBbJ0thcnRodXMnXSA9IDY1LCBbJ1JhbW11cyddID0gNjUsIFsnWmlsZWFuJ10gPSA2NSwgWydDaG9nYXRoJ10gPSA4MC4wLCBbJ01hbHphaGFyJ10gPSA2NSwgWydZb3JpY2tSYXZlbm91c0dob3VsJ10gPSAxLjAsIFsnWW9yaWNrU3BlY3RyYWxHaG91bCddID0gMS4wLCBbJ0ppbnhNaW5lJ10gPSA2NSwgWydZb3JpY2tEZWNheWVkR2hvdWwnXSA9IDEuMCwgWydYZXJhdGhBcmNhbmVCYXJyYWdlTGF1bmNoZXInXSA9IDY1LCBbJ09kaW5fU09HX09yZGVyX0NyeXN0YWwnXSA9IDY1LCBbJ1Rlc3RDdWJlJ10gPSA2NSwgWydTaHl2YW5hRHJhZ29uJ10gPSA4MC4wLCBbJ0ZpenpCYWl0J10gPSA2NSwgWydTaG9wS2VlcGVyJ10gPSA2NSwgWydCbHVlX01pbmlvbl9NZWNoTWVsZWUnXSA9IDY1LjAsIFsnT2RpblF1ZXN0QnVmZiddID0gNjUsIFsnVFRfQnVmZnBsYXRfTCddID0gNjUsIFsnVFRfQnVmZnBsYXRfUiddID0gNjUsIFsnS29nTWF3RGVhZCddID0gNjUsIFsnVGVtcE1vdmFibGVDaGFyJ10gPSA0OC4wLCBbJ0xpemFyZCddID0gNTAuMCwgWydHb2xlbU9kaW4nXSA9IDgwLjAsIFsnT2Rpbk9wZW5pbmdCYXJyaWVyJ10gPSA2NSwgWydUVF9DaGFvc1R1cnJldDQnXSA9IDg4LjQsIFsnVFRfRmx5dHJhcF9BJ10gPSA2NSwgWydUVF9DaGFpbnNfT3JkZXJfUGVyaXBoJ10gPSA2NSwgWydUVF9OV29sZiddID0gNjUuMCwgWydTaG9wTWFsZSddID0gNjUsIFsnT2RpblNoaWVsZFJlbGljJ10gPSA2NSwgWydUVF9DaGFpbnNfWGFvc19CYXNlJ10gPSA2NSwgWydMdWx1U3F1aWxsJ10gPSA1MC4wLCBbJ1RUX1Nob3BrZWVwZXInXSA9IDY1LCBbJ3JlZERyYWdvbiddID0gMTAwLjAsIFsnTW9ua2V5S2luZ0Nsb25lJ10gPSA2NSwgWydPZGluX3NrZWxldG9uJ10gPSA2NSwgWydPZGluQ2hhb3NUdXJyZXRTaHJpbmUnXSA9IDg4LjQsIFsnQ2Fzc2lvcGVpYV9EZWF0aCddID0gNjUsIFsnT2RpbkNlbnRlclJlbGljJ10gPSA0OC4wLCBbJ0V6cmVhbF9jeWJlcl8xJ10gPSA2NSwgWydFenJlYWxfY3liZXJfMyddID0gNjUsIFsnRXpyZWFsX2N5YmVyXzInXSA9IDY1LCBbJ09kaW5SZWRTdXBlcm1pbmlvbiddID0gNTUuMCwgWydUVF9TcGVlZHNocmluZV9HZWFycyddID0gNjUsIFsnSmFydmFuSVZXYWxsJ10gPSA2NSwgWydEZXN0cm95ZWROZXh1cyddID0gNjUsIFsnQVJBTU9yZGVyTmV4dXMnXSA9IDY1LCBbJ1JlZF9NaW5pb25fTWVjaENhbm5vbiddID0gNjUuMCwgWydPZGluQmx1ZVN1cGVybWluaW9uJ10gPSA1NS4wLCBbJ1N5bmRyYU9yYnMnXSA9IDY1LCBbJ0x1bHVLaXR0eSddID0gNTAuMCwgWydTd2Fpbk5vQmlyZCddID0gNjUsIFsnTHVsdUxhZHlidWcnXSA9IDUwLjAsIFsnQ2FpdGx5blRyYXAnXSA9IDY1LCBbJ1RUX1Nocm9vbV9BJ10gPSA2NSwgWydBUkFNQ2hhb3NUdXJyZXRTaHJpbmUnXSA9IDg4LjQsIFsnT2Rpbl9XaW5kbWlsbF9Qcm9wZWxsZXJzJ10gPSA2NSwgWydEZXN0cm95ZWRJbmhpYml0b3InXSA9IDY1LCBbJ1RUX05Xb2xmMiddID0gNTAuMCwgWydPZGluTWluaW9uR3JhdmV5YXJkUG9ydGFsJ10gPSAxLjAsIFsnU3dhaW5CZWFtJ10gPSA2NSwgWydTdW1tb25lcl9SaWRlcl9PcmRlciddID0gNjUuMCwgWydUVF9SZWxpYyddID0gNjUsIFsnb2Rpbl9saWZ0c19jcnlzdGFsJ10gPSA2NSwgWydPZGluT3JkZXJUdXJyZXRTaHJpbmUnXSA9IDg4LjQsIFsnU3BlbGxCb29rMSddID0gNjUsIFsnQmx1ZV9NaW5pb25fTWVjaENhbm5vbiddID0gNjUuMCwgWydUVF9DaGFvc0luaGliaXRvcl9EJ10gPSA2NSwgWydPZGluX1NvR19DaGFvcyddID0gNjUsIFsnVHJ1bmRsZVdhbGwnXSA9IDY1LCBbJ0hBX0FQX0hlYWx0aFJlbGljJ10gPSA2NSwgWydPcmRlclR1cnJldFNocmluZSddID0gODguNCwgWydPcmlhbm5hQmFsbCddID0gNDguMCwgWydDaGFvc1R1cnJldFNocmluZSddID0gODguNCwgWydMdWx1Q3VwY2FrZSddID0gNTAuMCwgWydIQV9BUF9DaGFvc1R1cnJldFNocmluZSddID0gODguNCwgWydUVF9DaGFpbnNfQm90X0xhbmUnXSA9IDY1LCBbJ1RUX05XcmFpdGgyJ10gPSA1MC4wLCBbJ1RUX1RyZWVfQSddID0gNjUsIFsnU3VtbW9uZXJCZWFjb24nXSA9IDY1LCBbJ09kaW5fRHJpbGwnXSA9IDY1LCBbJ1RUX05Hb2xlbSddID0gODAuMCwgWydTaG9wJ10gPSA2NSwgWydBcmFtU3BlZWRTaHJpbmUnXSA9IDY1LCBbJ0Rlc3Ryb3llZFRvd2VyJ10gPSA2NSwgWydPcmlhbm5hTm9CYWxsJ10gPSA2NSwgWydPZGluX01pbmVjYXJ0J10gPSA2NSwgWydTdW1tb25lcl9SaWRlcl9DaGFvcyddID0gNjUuMCwgWydPZGluU3BlZWRTaHJpbmUnXSA9IDY1LCBbJ1RUX0JyYXppZXInXSA9IDY1LCBbJ1RUX1NwZWVkU2hyaW5lJ10gPSA2NSwgWydvZGluX2xpZnRzX2J1Y2tldHMnXSA9IDY1LCBbJ09kaW5Sb2NrU2F3J10gPSA2NSwgWydPZGluTWluaW9uU3Bhd25Qb3J0YWwnXSA9IDEuMCwgWydTeW5kcmFTcGhlcmUnXSA9IDQ4LjAsIFsnVFRfTmV4dXNfR2VhcnMnXSA9IDY1LCBbJ1JlZF9NaW5pb25fTWVjaE1lbGVlJ10gPSA2NS4wLCBbJ1N3YWluUmF2ZW4nXSA9IDY1LCBbJ2NyeXN0YWxfcGxhdGZvcm0nXSA9IDY1LCBbJ01hb2thaVNwcm91dGxpbmcnXSA9IDQ4LjAsIFsnVXJmJ10gPSA2NSwgWydUZXN0Q3ViZVJlbmRlcjEwVmlzaW9uJ10gPSA2NSwgWydNYWx6YWhhclZvaWRsaW5nJ10gPSAxMC4wLCBbJ0dob3N0V2FyZCddID0gMSwgWydNb25rZXlLaW5nRmx5aW5nJ10gPSA2NSwgWydMdWx1UGlnJ10gPSA1MC4wLCBbJ0FuaXZpYUljZUJsb2NrJ10gPSA2NSwgWydUVF9PcmRlckluaGliaXRvcl9EJ10gPSA2NSwgWyd5b25rZXknXSA9IDY1LCBbJ09kaW5fU29HX09yZGVyJ10gPSA2NSwgWydSYW1tdXNEQkMnXSA9IDY1LCBbJ0ZpenpTaGFyayddID0gNjUsIFsnTHVsdURyYWdvbiddID0gNTAuMCwgWydPZGluVGVzdEN1YmVSZW5kZXInXSA9IDY1LCBbJ09kaW5DcmFuZSddID0gNjUsIFsnVFRfVHJlZTEnXSA9IDY1LCBbJ0FSQU1PcmRlclR1cnJldFNocmluZSddID0gODguNCwgWydUVF9DaGFpbnNfT3JkZXJfQmFzZSddID0gNjUsIFsnT2Rpbl9XaW5kbWlsbF9HZWFycyddID0gNjUsIFsnQVJBTUNoYW9zTmV4dXMnXSA9IDY1LCBbJ1RUX05XcmFpdGgnXSA9IDUwLjAsIFsnVFRfT3JkZXJUdXJyZXQ0J10gPSA4OC40LCBbJ09kaW5fU09HX0NoYW9zX0NyeXN0YWwnXSA9IDY1LCBbJ1RUX1NwaWRlckxheWVyX1dlYiddID0gNjUsIFsnT2RpblF1ZXN0SW5kaWNhdG9yJ10gPSAxLjAsIFsnSmFydmFuSVZTdGFuZGFyZCddID0gNjUsIFsnVFRfRHVtbXlQdXNoZXInXSA9IDY1LCBbJ09kaW5DbGF3J10gPSA2NSwgWydFbGlzZVNwaWRlcmxpbmcnXSA9IDEuMCwgWydRdWlublZhbG9yJ10gPSA2NSwgWydVZHlyVGlnZXJVbHQnXSA9IDY1LCBbJ1VkeXJUdXJ0bGVVbHQnXSA9IDY1LCBbJ1VkeXJVbHQnXSA9IDY1LCBbJ1VkeXJQaG9lbml4VWx0J10gPSA2NSwgWydTaGFjb0JveCddID0gMTAsIFsnSEFfQVBfUG9ybyddID0gNjUsIFsnQW5uaWVUaWJiZXJzJ10gPSA4MC4wLCBbJ1VkeXJQaG9lbml4J10gPSA2NSwgWydVZHlyVHVydGxlJ10gPSA2NSwgWydVZHlyVGlnZXInXSA9IDY1LCBbJ0hBX0FQX09yZGVyU2hyaW5lVHVycmV0J10gPSA4OC40LCBbJ0hBX0FQX09yZGVyVHVycmV0UnViYmxlJ10gPSA2NSwgWydIQV9BUF9DaGFpbnNfTG9uZyddID0gNjUsIFsnSEFfQVBfT3JkZXJDbG90aCddID0gNjUsIFsnSEFfQVBfUGVyaXBoQnJpZGdlJ10gPSA2NSwgWydIQV9BUF9CcmlkZ2VMYW5lU3RhdHVlJ10gPSA2NSwgWydIQV9BUF9DaGFvc1R1cnJldFJ1YmJsZSddID0gODguNCwgWydIQV9BUF9CYW5uZXJNaWRCcmlkZ2UnXSA9IDY1LCBbJ0hBX0FQX1Bvcm9TcGF3bmVyJ10gPSA1MC4wLCBbJ0hBX0FQX0N1dGF3YXknXSA9IDY1LCBbJ0hBX0FQX0NoYWlucyddID0gNjUsIFsnSEFfQVBfU2hwU291dGgnXSA9IDY1LCBbJ0hBX0FQX0hlcm9Ub3dlciddID0gNjUsIFsnSEFfQVBfU2hwTm9ydGgnXSA9IDY1LCBbJ0NoYW9zSW5oaWJpdG9yX0QnXSA9IDY1LCBbJ1phY1JlYmlydGhCbG9ibGV0J10gPSA2NSwgWydPcmRlckluaGliaXRvcl9EJ10gPSA2NSwgWydOaWRhbGVlX1NwZWFyJ10gPSA2NSwgWydOaWRhbGVlX0NvdWdhciddID0gNjUsIFsnVFRfQnVmZnBsYXRfQ2hhaW4nXSA9IDY1LCBbJ1dyaWdnbGVMYW50ZXJuJ10gPSAxLCBbJ1R3aXN0ZWRMaXphcmRFbGRlciddID0gNjUuMCwgWydSYWJpZFdvbGYnXSA9IDY1LjAsIFsnSGVpbWVyVEdyZWVuJ10gPSA1MC4wLCBbJ0hlaW1lclRSZWQnXSA9IDUwLjAsIFsnVmlrdG9yRkYnXSA9IDY1LCBbJ1R3aXN0ZWRHb2xlbSddID0gODAuMCwgWydUd2lzdGVkU21hbGxXb2xmJ10gPSA1MC4wLCBbJ1R3aXN0ZWRHaWFudFdvbGYnXSA9IDY1LjAsIFsnVHdpc3RlZFRpbnlXcmFpdGgnXSA9IDUwLjAsIFsnVHdpc3RlZEJsdWVXcmFpdGgnXSA9IDUwLjAsIFsnVHdpc3RlZFlvdW5nTGl6YXJkJ10gPSA1MC4wLCBbJ1JlZF9NaW5pb25fTWVsZWUnXSA9IDQ4LjAsIFsnQmx1ZV9NaW5pb25fTWVsZWUnXSA9IDQ4LjAsIFsnQmx1ZV9NaW5pb25fSGVhbGVyJ10gPSA0OC4wLCBbJ0doYXN0J10gPSA2MC4wLCBbJ2JsdWVEcmFnb24nXSA9IDEwMC4wLCBbJ1JlZF9NaW5pb25fTWVjaFJhbmdlJ10gPSA2NS4wLCBbJ1Rlc3RfQ3ViZVNwaGVyZSddID0gNjUsfQoJc2VsZi5wcm9qZWN0aWxlc3BlZWRzID0ge1siVmVsa296Il09IDIwMDAsWyJUZWVtb011c2hyb29tIl0gPSBtYXRoLmh1Z2UsWyJUZXN0Q3ViZVJlbmRlciJdID0gbWF0aC5odWdlICxbIlhlcmF0aCJdID0gMjAwMC4wMDAwICxbIkthc3NhZGluIl0gPSBtYXRoLmh1Z2UgLFsiUmVuZ2FyIl0gPSBtYXRoLmh1Z2UgLFsiVGhyZXNoIl0gPSAxMDAwLjAwMDAgLFsiWmlnZ3MiXSA9IDE1MDAuMDAwMCAsWyJaeXJhUGFzc2l2ZSJdID0gMTUwMC4wMDAwICxbIlp5cmFUaG9yblBsYW50Il0gPSAxNTAwLjAwMDAgLFsiS29nTWF3Il0gPSAxODAwLjAwMDAgLFsiSGVpbWVyVEJsdWUiXSA9IDE1OTkuMzk5OSAsWyJFbGlzZVNwaWRlciJdID0gNTAwLjAwMDAgLFsiU2thcm5lciJdID0gNTAwLjAwMDAgLFsiQ2hhb3NOZXh1cyJdID0gNTAwLjAwMDAgLFsiS2F0YXJpbmEiXSA9IDQ2Ny4wMDAwICxbIlJpdmVuIl0gPSAzNDcuNzk5OTkgLFsiU2lnaHRXYXJkIl0gPSAzNDcuNzk5OTkgLFsiSGVpbWVyVFllbGxvdyJdID0gMTU5OS4zOTk5ICxbIkFzaGUiXSA9IDIwMDAuMDAwMCAsWyJWaXNpb25XYXJkIl0gPSAyMDAwLjAwMDAgLFsiVFRfTkdvbGVtMiJdID0gbWF0aC5odWdlICxbIlRocmVzaExhbnRlcm4iXSA9IG1hdGguaHVnZSAsWyJUVF9TcGlkZXJib3NzIl0gPSBtYXRoLmh1Z2UgLFsiT3JkZXJOZXh1cyJdID0gbWF0aC5odWdlICxbIlNvcmFrYSJdID0gMTAwMC4wMDAwICxbIkppbngiXSA9IDI3NTAuMDAwMCAsWyJUZXN0Q3ViZVJlbmRlcndDb2xsaXNpb24iXSA9IDI3NTAuMDAwMCAsWyJSZWRfTWluaW9uX1dpemFyZCJdID0gNjUwLjAwMDAgLFsiSmFydmFuSVYiXSA9IDIwLjAwMDAgLFsiQmx1ZV9NaW5pb25fV2l6YXJkIl0gPSA2NTAuMDAwMCAsWyJUVF9DaGFvc1R1cnJldDIiXSA9IDEyMDAuMDAwMCAsWyJUVF9DaGFvc1R1cnJldDMiXSA9IDEyMDAuMDAwMCAsWyJUVF9DaGFvc1R1cnJldDEiXSA9IDEyMDAuMDAwMCAsWyJDaGFvc1R1cnJldEdpYW50Il0gPSAxMjAwLjAwMDAgLFsiRHJhZ29uIl0gPSAxMjAwLjAwMDAgLFsiTHVsdVNub3dtYW4iXSA9IDEyMDAuMDAwMCAsWyJXb3JtIl0gPSAxMjAwLjAwMDAgLFsiQ2hhb3NUdXJyZXRXb3JtIl0gPSAxMjAwLjAwMDAgLFsiVFRfQ2hhb3NJbmhpYml0b3IiXSA9IDEyMDAuMDAwMCAsWyJDaGFvc1R1cnJldE5vcm1hbCJdID0gMTIwMC4wMDAwICxbIkFuY2llbnRHb2xlbSJdID0gNTAwLjAwMDAgLFsiWnlyYUdyYXNwaW5nUGxhbnQiXSA9IDUwMC4wMDAwICxbIkhBX0FQX09yZGVyVHVycmV0MyJdID0gMTIwMC4wMDAwICxbIkhBX0FQX09yZGVyVHVycmV0MiJdID0gMTIwMC4wMDAwICxbIlRyeW5kYW1lcmUiXSA9IDM0Ny43OTk5OSAsWyJPcmRlclR1cnJldE5vcm1hbDIiXSA9IDEyMDAuMDAwMCAsWyJTaW5nZWQiXSA9IDcwMC4wMDAwICxbIk9yZGVySW5oaWJpdG9yIl0gPSA3MDAuMDAwMCAsWyJEaWFuYSJdID0gMzQ3Ljc5OTk5ICxbIkhBX0ZCX0hlYWx0aFJlbGljIl0gPSAzNDcuNzk5OTkgLFsiVFRfT3JkZXJJbmhpYml0b3IiXSA9IDM0Ny43OTk5OSAsWyJHcmVhdFdyYWl0aCJdID0gNzUwLjAwMDAgLFsiWWFzdW8iXSA9IDM0Ny43OTk5OSAsWyJPcmRlclR1cnJldERyYWdvbiJdID0gMTIwMC4wMDAwICxbIk9yZGVyVHVycmV0Tm9ybWFsIl0gPSAxMjAwLjAwMDAgLFsiTGl6YXJkRWxkZXIiXSA9IDUwMC4wMDAwICxbIkhBX0FQX0NoYW9zVHVycmV0Il0gPSAxMjAwLjAwMDAgLFsiQWhyaSJdID0gMTc1MC4wMDAwICxbIkx1bHUiXSA9IDE0NTAuMDAwMCAsWyJDaGFvc0luaGliaXRvciJdID0gMTQ1MC4wMDAwICxbIkhBX0FQX0NoYW9zVHVycmV0MyJdID0gMTIwMC4wMDAwICxbIkhBX0FQX0NoYW9zVHVycmV0MiJdID0gMTIwMC4wMDAwICxbIkNoYW9zVHVycmV0V29ybTIiXSA9IDEyMDAuMDAwMCAsWyJUVF9PcmRlclR1cnJldDEiXSA9IDEyMDAuMDAwMCAsWyJUVF9PcmRlclR1cnJldDIiXSA9IDEyMDAuMDAwMCAsWyJUVF9PcmRlclR1cnJldDMiXSA9IDEyMDAuMDAwMCAsWyJMdWx1RmFlcmllIl0gPSAxMjAwLjAwMDAgLFsiSEFfQVBfT3JkZXJUdXJyZXQiXSA9IDEyMDAuMDAwMCAsWyJPcmRlclR1cnJldEFuZ2VsIl0gPSAxMjAwLjAwMDAgLFsiWWVsbG93VHJpbmtldFVwZ3JhZGUiXSA9IDEyMDAuMDAwMCAsWyJNYXN0ZXJZaSJdID0gbWF0aC5odWdlICxbIkxpc3NhbmRyYSJdID0gMjAwMC4wMDAwICxbIkFSQU1PcmRlclR1cnJldE5leHVzIl0gPSAxMjAwLjAwMDAgLFsiRHJhdmVuIl0gPSAxNzAwLjAwMDAgLFsiRmlkZGxlU3RpY2tzIl0gPSAxNzUwLjAwMDAgLFsiU21hbGxHb2xlbSJdID0gbWF0aC5odWdlICxbIkFSQU1PcmRlclR1cnJldEZyb250Il0gPSAxMjAwLjAwMDAgLFsiQ2hhb3NUdXJyZXRUdXRvcmlhbCJdID0gMTIwMC4wMDAwICxbIk5hc3VzVWx0Il0gPSAxMjAwLjAwMDAgLFsiTWFva2FpIl0gPSBtYXRoLmh1Z2UgLFsiV3JhaXRoIl0gPSA3NTAuMDAwMCAsWyJXb2xmIl0gPSBtYXRoLmh1Z2UgLFsiU2l2aXIiXSA9IDE3NTAuMDAwMCAsWyJDb3JraSJdID0gMjAwMC4wMDAwICxbIkphbm5hIl0gPSAxMjAwLjAwMDAgLFsiTmFzdXMiXSA9IG1hdGguaHVnZSAsWyJHb2xlbSJdID0gbWF0aC5odWdlICxbIkFSQU1DaGFvc1R1cnJldEZyb250Il0gPSAxMjAwLjAwMDAgLFsiQVJBTU9yZGVyVHVycmV0SW5oaWIiXSA9IDEyMDAuMDAwMCAsWyJMZWVTaW4iXSA9IG1hdGguaHVnZSAsWyJIQV9BUF9DaGFvc1R1cnJldFR1dG9yaWFsIl0gPSAxMjAwLjAwMDAgLFsiR2lhbnRXb2xmIl0gPSBtYXRoLmh1Z2UgLFsiSEFfQVBfT3JkZXJUdXJyZXRUdXRvcmlhbCJdID0gMTIwMC4wMDAwICxbIllvdW5nTGl6YXJkIl0gPSA3NTAuMDAwMCAsWyJKYXgiXSA9IDQwMC4wMDAwICxbIkxlc3NlcldyYWl0aCJdID0gbWF0aC5odWdlICxbIkJsaXR6Y3JhbmsiXSA9IG1hdGguaHVnZSAsWyJBUkFNQ2hhb3NUdXJyZXRJbmhpYiJdID0gMTIwMC4wMDAwICxbIlNoZW4iXSA9IDQwMC4wMDAwICxbIk5vY3R1cm5lIl0gPSBtYXRoLmh1Z2UgLFsiU29uYSJdID0gMTUwMC4wMDAwICxbIkFSQU1DaGFvc1R1cnJldE5leHVzIl0gPSAxMjAwLjAwMDAgLFsiWWVsbG93VHJpbmtldCJdID0gMTIwMC4wMDAwICxbIk9yZGVyVHVycmV0VHV0b3JpYWwiXSA9IDEyMDAuMDAwMCAsWyJDYWl0bHluIl0gPSAyNTAwLjAwMDAgLFsiVHJ1bmRsZSJdID0gMzQ3Ljc5OTk5ICxbIk1hbHBoaXRlIl0gPSAxMDAwLjAwMDAgLFsiTW9yZGVrYWlzZXIiXSA9IG1hdGguaHVnZSAsWyJaeXJhU2VlZCJdID0gbWF0aC5odWdlICxbIlZpIl0gPSAxMDAwLjAwMDAgLFsiVHV0b3JpYWxfUmVkX01pbmlvbl9XaXphcmQiXSA9IDY1MC4wMDAwICxbIlJlbmVrdG9uIl0gPSBtYXRoLmh1Z2UgLFsiQW5pdmlhIl0gPSAxNDAwLjAwMDAgLFsiRml6eiJdID0gbWF0aC5odWdlICxbIkhlaW1lcmRpbmdlciJdID0gMTUwMC4wMDAwICxbIkV2ZWx5bm4iXSA9IDQ2Ny4wMDAwICxbIlJ1bWJsZSJdID0gMzQ3Ljc5OTk5ICxbIkxlYmxhbmMiXSA9IDE3MDAuMDAwMCAsWyJEYXJpdXMiXSA9IG1hdGguaHVnZSAsWyJPbGFmQXhlIl0gPSBtYXRoLmh1Z2UgLFsiVmlrdG9yIl0gPSAyMzAwLjAwMDAgLFsiWGluWmhhbyJdID0gMjAuMDAwMCAsWyJPcmlhbm5hIl0gPSAxNDUwLjAwMDAgLFsiVmxhZGltaXIiXSA9IDE0MDAuMDAwMCAsWyJOaWRhbGVlIl0gPSAxNzUwLjAwMDAgLFsiVHV0b3JpYWxfUmVkX01pbmlvbl9CYXNpYyJdID0gbWF0aC5odWdlICxbIlplZFNoYWRvdyJdID0gNDY3LjAwMDAgLFsiU3luZHJhIl0gPSAxODAwLjAwMDAgLFsiWmFjIl0gPSAxMDAwLjAwMDAgLFsiT2xhZiJdID0gMzQ3Ljc5OTk5ICxbIlZlaWdhciJdID0gMTEwMC4wMDAwICxbIlR3aXRjaCJdID0gMjUwMC4wMDAwICxbIkFsaXN0YXIiXSA9IG1hdGguaHVnZSAsWyJBa2FsaSJdID0gNDY3LjAwMDAgLFsiVXJnb3QiXSA9IDEzMDAuMDAwMCAsWyJMZW9uYSJdID0gMzQ3Ljc5OTk5ICxbIlRhbG9uIl0gPSBtYXRoLmh1Z2UgLFsiS2FybWEiXSA9IDE1MDAuMDAwMCAsWyJKYXljZSJdID0gMzQ3Ljc5OTk5ICxbIkdhbGlvIl0gPSAxMDAwLjAwMDAgLFsiU2hhY28iXSA9IG1hdGguaHVnZSAsWyJUYXJpYyJdID0gbWF0aC5odWdlICxbIlR3aXN0ZWRGYXRlIl0gPSAxNTAwLjAwMDAgLFsiVmFydXMiXSA9IDIwMDAuMDAwMCAsWyJHYXJlbiJdID0gMzQ3Ljc5OTk5ICxbIlN3YWluIl0gPSAxNjAwLjAwMDAgLFsiVmF5bmUiXSA9IDIwMDAuMDAwMCAsWyJGaW9yYSJdID0gNDY3LjAwMDAgLFsiUXVpbm4iXSA9IDIwMDAuMDAwMCAsWyJLYXlsZSJdID0gbWF0aC5odWdlICxbIkJsdWVfTWluaW9uX0Jhc2ljIl0gPSBtYXRoLmh1Z2UgLFsiQnJhbmQiXSA9IDIwMDAuMDAwMCAsWyJUZWVtbyJdID0gMTMwMC4wMDAwICxbIkFtdW11Il0gPSA1MDAuMDAwMCAsWyJBbm5pZSJdID0gMTIwMC4wMDAwICxbIk9kaW5fQmx1ZV9NaW5pb25fY2FzdGVyIl0gPSAxMjAwLjAwMDAgLFsiRWxpc2UiXSA9IDE2MDAuMDAwMCAsWyJOYW1pIl0gPSAxNTAwLjAwMDAgLFsiUG9wcHkiXSA9IDUwMC4wMDAwICxbIkFuaXZpYUVnZyJdID0gNTAwLjAwMDAgLFsiVHJpc3RhbmEiXSA9IDIyNTAuMDAwMCAsWyJHcmF2ZXMiXSA9IDMwMDAuMDAwMCAsWyJNb3JnYW5hIl0gPSAxNjAwLjAwMDAgLFsiR3JhZ2FzIl0gPSBtYXRoLmh1Z2UgLFsiTWlzc0ZvcnR1bmUiXSA9IDIwMDAuMDAwMCAsWyJXYXJ3aWNrIl0gPSBtYXRoLmh1Z2UgLFsiQ2Fzc2lvcGVpYSJdID0gMTIwMC4wMDAwICxbIlR1dG9yaWFsX0JsdWVfTWluaW9uX1dpemFyZCJdID0gNjUwLjAwMDAgLFsiRHJNdW5kbyJdID0gbWF0aC5odWdlICxbIlZvbGliZWFyIl0gPSA0NjcuMDAwMCAsWyJJcmVsaWEiXSA9IDQ2Ny4wMDAwICxbIk9kaW5fUmVkX01pbmlvbl9DYXN0ZXIiXSA9IDY1MC4wMDAwICxbIkx1Y2lhbiJdID0gMjgwMC4wMDAwICxbIllvcmljayJdID0gbWF0aC5odWdlICxbIlJhbW11c1BCIl0gPSBtYXRoLmh1Z2UgLFsiUmVkX01pbmlvbl9CYXNpYyJdID0gbWF0aC5odWdlICxbIlVkeXIiXSA9IDQ2Ny4wMDAwICxbIk1vbmtleUtpbmciXSA9IDIwLjAwMDAgLFsiVHV0b3JpYWxfQmx1ZV9NaW5pb25fQmFzaWMiXSA9IG1hdGguaHVnZSAsWyJLZW5uZW4iXSA9IDE2MDAuMDAwMCAsWyJOdW51Il0gPSA1MDAuMDAwMCAsWyJSeXplIl0gPSAyNDAwLjAwMDAgLFsiWmVkIl0gPSA0NjcuMDAwMCAsWyJOYXV0aWx1cyJdID0gMTAwMC4wMDAwICxbIkdhbmdwbGFuayJdID0gMTAwMC4wMDAwICxbIkx1eCJdID0gMTYwMC4wMDAwICxbIlNlanVhbmkiXSA9IDUwMC4wMDAwICxbIkV6cmVhbCJdID0gMjAwMC4wMDAwICxbIk9kaW5OZXV0cmFsR3VhcmRpYW4iXSA9IDE4MDAuMDAwMCAsWyJLaGF6aXgiXSA9IDUwMC4wMDAwICxbIlNpb24iXSA9IG1hdGguaHVnZSAsWyJBYXRyb3giXSA9IDM0Ny43OTk5OSAsWyJIZWNhcmltIl0gPSA1MDAuMDAwMCAsWyJQYW50aGVvbiJdID0gMjAuMDAwMCAsWyJTaHl2YW5hIl0gPSA0NjcuMDAwMCAsWyJaeXJhIl0gPSAxNzAwLjAwMDAgLFsiS2FydGh1cyJdID0gMTIwMC4wMDAwICxbIlJhbW11cyJdID0gbWF0aC5odWdlICxbIlppbGVhbiJdID0gMTIwMC4wMDAwICxbIkNob2dhdGgiXSA9IDUwMC4wMDAwICxbIk1hbHphaGFyIl0gPSAyMDAwLjAwMDAgLFsiWW9yaWNrUmF2ZW5vdXNHaG91bCJdID0gMzQ3Ljc5OTk5ICxbIllvcmlja1NwZWN0cmFsR2hvdWwiXSA9IDM0Ny43OTk5OSAsWyJKaW54TWluZSJdID0gMzQ3Ljc5OTk5ICxbIllvcmlja0RlY2F5ZWRHaG91bCJdID0gMzQ3Ljc5OTk5ICxbIlhlcmF0aEFyY2FuZUJhcnJhZ2VMYXVuY2hlciJdID0gMzQ3Ljc5OTk5ICxbIk9kaW5fU09HX09yZGVyX0NyeXN0YWwiXSA9IDM0Ny43OTk5OSAsWyJUZXN0Q3ViZSJdID0gMzQ3Ljc5OTk5ICxbIlNoeXZhbmFEcmFnb24iXSA9IG1hdGguaHVnZSAsWyJGaXp6QmFpdCJdID0gbWF0aC5odWdlICxbIkJsdWVfTWluaW9uX01lY2hNZWxlZSJdID0gbWF0aC5odWdlICxbIk9kaW5RdWVzdEJ1ZmYiXSA9IG1hdGguaHVnZSAsWyJUVF9CdWZmcGxhdF9MIl0gPSBtYXRoLmh1Z2UgLFsiVFRfQnVmZnBsYXRfUiJdID0gbWF0aC5odWdlICxbIktvZ01hd0RlYWQiXSA9IG1hdGguaHVnZSAsWyJUZW1wTW92YWJsZUNoYXIiXSA9IG1hdGguaHVnZSAsWyJMaXphcmQiXSA9IDUwMC4wMDAwICxbIkdvbGVtT2RpbiJdID0gbWF0aC5odWdlICxbIk9kaW5PcGVuaW5nQmFycmllciJdID0gbWF0aC5odWdlICxbIlRUX0NoYW9zVHVycmV0NCJdID0gNTAwLjAwMDAgLFsiVFRfRmx5dHJhcF9BIl0gPSA1MDAuMDAwMCAsWyJUVF9OV29sZiJdID0gbWF0aC5odWdlICxbIk9kaW5TaGllbGRSZWxpYyJdID0gbWF0aC5odWdlICxbIkx1bHVTcXVpbGwiXSA9IG1hdGguaHVnZSAsWyJyZWREcmFnb24iXSA9IG1hdGguaHVnZSAsWyJNb25rZXlLaW5nQ2xvbmUiXSA9IG1hdGguaHVnZSAsWyJPZGluX3NrZWxldG9uIl0gPSBtYXRoLmh1Z2UgLFsiT2RpbkNoYW9zVHVycmV0U2hyaW5lIl0gPSA1MDAuMDAwMCAsWyJDYXNzaW9wZWlhX0RlYXRoIl0gPSA1MDAuMDAwMCAsWyJPZGluQ2VudGVyUmVsaWMiXSA9IDUwMC4wMDAwICxbIk9kaW5SZWRTdXBlcm1pbmlvbiJdID0gbWF0aC5odWdlICxbIkphcnZhbklWV2FsbCJdID0gbWF0aC5odWdlICxbIkFSQU1PcmRlck5leHVzIl0gPSBtYXRoLmh1Z2UgLFsiUmVkX01pbmlvbl9NZWNoQ2Fubm9uIl0gPSAxMjAwLjAwMDAgLFsiT2RpbkJsdWVTdXBlcm1pbmlvbiJdID0gbWF0aC5odWdlICxbIlN5bmRyYU9yYnMiXSA9IG1hdGguaHVnZSAsWyJMdWx1S2l0dHkiXSA9IG1hdGguaHVnZSAsWyJTd2Fpbk5vQmlyZCJdID0gbWF0aC5odWdlICxbIkx1bHVMYWR5YnVnIl0gPSBtYXRoLmh1Z2UgLFsiQ2FpdGx5blRyYXAiXSA9IG1hdGguaHVnZSAsWyJUVF9TaHJvb21fQSJdID0gbWF0aC5odWdlICxbIkFSQU1DaGFvc1R1cnJldFNocmluZSJdID0gNTAwLjAwMDAgLFsiT2Rpbl9XaW5kbWlsbF9Qcm9wZWxsZXJzIl0gPSA1MDAuMDAwMCAsWyJUVF9OV29sZjIiXSA9IG1hdGguaHVnZSAsWyJPZGluTWluaW9uR3JhdmV5YXJkUG9ydGFsIl0gPSBtYXRoLmh1Z2UgLFsiU3dhaW5CZWFtIl0gPSBtYXRoLmh1Z2UgLFsiU3VtbW9uZXJfUmlkZXJfT3JkZXIiXSA9IG1hdGguaHVnZSAsWyJUVF9SZWxpYyJdID0gbWF0aC5odWdlICxbIm9kaW5fbGlmdHNfY3J5c3RhbCJdID0gbWF0aC5odWdlICxbIk9kaW5PcmRlclR1cnJldFNocmluZSJdID0gNTAwLjAwMDAgLFsiU3BlbGxCb29rMSJdID0gNTAwLjAwMDAgLFsiQmx1ZV9NaW5pb25fTWVjaENhbm5vbiJdID0gMTIwMC4wMDAwICxbIlRUX0NoYW9zSW5oaWJpdG9yX0QiXSA9IDEyMDAuMDAwMCAsWyJPZGluX1NvR19DaGFvcyJdID0gMTIwMC4wMDAwICxbIlRydW5kbGVXYWxsIl0gPSAxMjAwLjAwMDAgLFsiSEFfQVBfSGVhbHRoUmVsaWMiXSA9IDEyMDAuMDAwMCAsWyJPcmRlclR1cnJldFNocmluZSJdID0gNTAwLjAwMDAgLFsiT3JpYW5uYUJhbGwiXSA9IDUwMC4wMDAwICxbIkNoYW9zVHVycmV0U2hyaW5lIl0gPSA1MDAuMDAwMCAsWyJMdWx1Q3VwY2FrZSJdID0gNTAwLjAwMDAgLFsiSEFfQVBfQ2hhb3NUdXJyZXRTaHJpbmUiXSA9IDUwMC4wMDAwICxbIlRUX05XcmFpdGgyIl0gPSA3NTAuMDAwMCAsWyJUVF9UcmVlX0EiXSA9IDc1MC4wMDAwICxbIlN1bW1vbmVyQmVhY29uIl0gPSA3NTAuMDAwMCAsWyJPZGluX0RyaWxsIl0gPSA3NTAuMDAwMCAsWyJUVF9OR29sZW0iXSA9IG1hdGguaHVnZSAsWyJBcmFtU3BlZWRTaHJpbmUiXSA9IG1hdGguaHVnZSAsWyJPcmlhbm5hTm9CYWxsIl0gPSBtYXRoLmh1Z2UgLFsiT2Rpbl9NaW5lY2FydCJdID0gbWF0aC5odWdlICxbIlN1bW1vbmVyX1JpZGVyX0NoYW9zIl0gPSBtYXRoLmh1Z2UgLFsiT2RpblNwZWVkU2hyaW5lIl0gPSBtYXRoLmh1Z2UgLFsiVFRfU3BlZWRTaHJpbmUiXSA9IG1hdGguaHVnZSAsWyJvZGluX2xpZnRzX2J1Y2tldHMiXSA9IG1hdGguaHVnZSAsWyJPZGluUm9ja1NhdyJdID0gbWF0aC5odWdlICxbIk9kaW5NaW5pb25TcGF3blBvcnRhbCJdID0gbWF0aC5odWdlICxbIlN5bmRyYVNwaGVyZSJdID0gbWF0aC5odWdlICxbIlJlZF9NaW5pb25fTWVjaE1lbGVlIl0gPSBtYXRoLmh1Z2UgLFsiU3dhaW5SYXZlbiJdID0gbWF0aC5odWdlICxbImNyeXN0YWxfcGxhdGZvcm0iXSA9IG1hdGguaHVnZSAsWyJNYW9rYWlTcHJvdXRsaW5nIl0gPSBtYXRoLmh1Z2UgLFsiVXJmIl0gPSBtYXRoLmh1Z2UgLFsiVGVzdEN1YmVSZW5kZXIxMFZpc2lvbiJdID0gbWF0aC5odWdlICxbIk1hbHphaGFyVm9pZGxpbmciXSA9IDUwMC4wMDAwICxbIkdob3N0V2FyZCJdID0gNTAwLjAwMDAgLFsiTW9ua2V5S2luZ0ZseWluZyJdID0gNTAwLjAwMDAgLFsiTHVsdVBpZyJdID0gNTAwLjAwMDAgLFsiQW5pdmlhSWNlQmxvY2siXSA9IDUwMC4wMDAwICxbIlRUX09yZGVySW5oaWJpdG9yX0QiXSA9IDUwMC4wMDAwICxbIk9kaW5fU29HX09yZGVyIl0gPSA1MDAuMDAwMCAsWyJSYW1tdXNEQkMiXSA9IDUwMC4wMDAwICxbIkZpenpTaGFyayJdID0gNTAwLjAwMDAgLFsiTHVsdURyYWdvbiJdID0gNTAwLjAwMDAgLFsiT2RpblRlc3RDdWJlUmVuZGVyIl0gPSA1MDAuMDAwMCAsWyJUVF9UcmVlMSJdID0gNTAwLjAwMDAgLFsiQVJBTU9yZGVyVHVycmV0U2hyaW5lIl0gPSA1MDAuMDAwMCAsWyJPZGluX1dpbmRtaWxsX0dlYXJzIl0gPSA1MDAuMDAwMCAsWyJBUkFNQ2hhb3NOZXh1cyJdID0gNTAwLjAwMDAgLFsiVFRfTldyYWl0aCJdID0gNzUwLjAwMDAgLFsiVFRfT3JkZXJUdXJyZXQ0Il0gPSA1MDAuMDAwMCAsWyJPZGluX1NPR19DaGFvc19DcnlzdGFsIl0gPSA1MDAuMDAwMCAsWyJPZGluUXVlc3RJbmRpY2F0b3IiXSA9IDUwMC4wMDAwICxbIkphcnZhbklWU3RhbmRhcmQiXSA9IDUwMC4wMDAwICxbIlRUX0R1bW15UHVzaGVyIl0gPSA1MDAuMDAwMCAsWyJPZGluQ2xhdyJdID0gNTAwLjAwMDAgLFsiRWxpc2VTcGlkZXJsaW5nIl0gPSAyMDAwLjAwMDAgLFsiUXVpbm5WYWxvciJdID0gbWF0aC5odWdlICxbIlVkeXJUaWdlclVsdCJdID0gbWF0aC5odWdlICxbIlVkeXJUdXJ0bGVVbHQiXSA9IG1hdGguaHVnZSAsWyJVZHlyVWx0Il0gPSBtYXRoLmh1Z2UgLFsiVWR5clBob2VuaXhVbHQiXSA9IG1hdGguaHVnZSAsWyJTaGFjb0JveCJdID0gMTUwMC4wMDAwICxbIkhBX0FQX1Bvcm8iXSA9IDE1MDAuMDAwMCAsWyJBbm5pZVRpYmJlcnMiXSA9IG1hdGguaHVnZSAsWyJVZHlyUGhvZW5peCJdID0gbWF0aC5odWdlICxbIlVkeXJUdXJ0bGUiXSA9IG1hdGguaHVnZSAsWyJVZHlyVGlnZXIiXSA9IG1hdGguaHVnZSAsWyJIQV9BUF9PcmRlclNocmluZVR1cnJldCJdID0gNTAwLjAwMDAgLFsiSEFfQVBfQ2hhaW5zX0xvbmciXSA9IDUwMC4wMDAwICxbIkhBX0FQX0JyaWRnZUxhbmVTdGF0dWUiXSA9IDUwMC4wMDAwICxbIkhBX0FQX0NoYW9zVHVycmV0UnViYmxlIl0gPSA1MDAuMDAwMCAsWyJIQV9BUF9Qb3JvU3Bhd25lciJdID0gNTAwLjAwMDAgLFsiSEFfQVBfQ3V0YXdheSJdID0gNTAwLjAwMDAgLFsiSEFfQVBfQ2hhaW5zIl0gPSA1MDAuMDAwMCAsWyJDaGFvc0luaGliaXRvcl9EIl0gPSA1MDAuMDAwMCAsWyJaYWNSZWJpcnRoQmxvYmxldCJdID0gNTAwLjAwMDAgLFsiT3JkZXJJbmhpYml0b3JfRCJdID0gNTAwLjAwMDAgLFsiTmlkYWxlZV9TcGVhciJdID0gNTAwLjAwMDAgLFsiTmlkYWxlZV9Db3VnYXIiXSA9IDUwMC4wMDAwICxbIlRUX0J1ZmZwbGF0X0NoYWluIl0gPSA1MDAuMDAwMCAsWyJXcmlnZ2xlTGFudGVybiJdID0gNTAwLjAwMDAgLFsiVHdpc3RlZExpemFyZEVsZGVyIl0gPSA1MDAuMDAwMCAsWyJSYWJpZFdvbGYiXSA9IG1hdGguaHVnZSAsWyJIZWltZXJUR3JlZW4iXSA9IDE1OTkuMzk5OSAsWyJIZWltZXJUUmVkIl0gPSAxNTk5LjM5OTkgLFsiVmlrdG9yRkYiXSA9IDE1OTkuMzk5OSAsWyJUd2lzdGVkR29sZW0iXSA9IG1hdGguaHVnZSAsWyJUd2lzdGVkU21hbGxXb2xmIl0gPSBtYXRoLmh1Z2UgLFsiVHdpc3RlZEdpYW50V29sZiJdID0gbWF0aC5odWdlICxbIlR3aXN0ZWRUaW55V3JhaXRoIl0gPSA3NTAuMDAwMCAsWyJUd2lzdGVkQmx1ZVdyYWl0aCJdID0gNzUwLjAwMDAgLFsiVHdpc3RlZFlvdW5nTGl6YXJkIl0gPSA3NTAuMDAwMCAsWyJSZWRfTWluaW9uX01lbGVlIl0gPSBtYXRoLmh1Z2UgLFsiQmx1ZV9NaW5pb25fTWVsZWUiXSA9IG1hdGguaHVnZSAsWyJCbHVlX01pbmlvbl9IZWFsZXIiXSA9IDEwMDAuMDAwMCAsWyJHaGFzdCJdID0gNzUwLjAwMDAgLFsiYmx1ZURyYWdvbiJdID0gODAwLjAwMDAgLFsiUmVkX01pbmlvbl9NZWNoUmFuZ2UiXSA9IDMwMDAuMDAwMCx9CglzZWxmLkFjdGl2ZUF0dGFja3MgPSB7fQoJc2VsZi5NaW5pb25zQXR0YWNrcyA9IHt9CgoKCWlmIG5vdCBfRy5WUHJlZGljdGlvbk1lbnUgdGhlbgoJCV9HLlZQcmVkaWN0aW9uTWVudSA9IHNjcmlwdENvbmZpZygiVlByZWRpY3Rpb24iLCAiVlByZWRpY3Rpb24iKQoKCQkJX0cuVlByZWRpY3Rpb25NZW51OmFkZFBhcmFtKCJNb2RlIiwgIkNhc3QgTW9kZSIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7IkZhc3QiLCAiTWVkaXVtIiwgIlNsb3ciIH0pCgoJCQktLVtbQ29sbGlzaW9uXV0KCQkJX0cuVlByZWRpY3Rpb25NZW51OmFkZFN1Yk1lbnUoIkNvbGxpc2lvbiIsICJDb2xsaXNpb24iKQoJCQkJX0cuVlByZWRpY3Rpb25NZW51LkNvbGxpc2lvbjphZGRQYXJhbSgiQnVmZmVyIiwgIkNvbGxpc2lvbiBidWZmZXIiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDIwLCAwLCAxMDApCgkJCQlfRy5WUHJlZGljdGlvbk1lbnUuQ29sbGlzaW9uOmFkZFBhcmFtKCJNaW5pb25zIiwgIk5vcm1hbCBtaW5pb25zIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQoJCQkJX0cuVlByZWRpY3Rpb25NZW51LkNvbGxpc2lvbjphZGRQYXJhbSgiTW9icyIsICJKdW5nbGUgbWluaW9ucyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKCQkJCV9HLlZQcmVkaWN0aW9uTWVudS5Db2xsaXNpb246YWRkUGFyYW0oIk90aGVycyIsICJPdGhlcnMiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCgkJCQlfRy5WUHJlZGljdGlvbk1lbnUuQ29sbGlzaW9uOmFkZFBhcmFtKCJDSGVhbHRoIiwgIkNoZWNrIGlmIG1pbmlvbnMgYXJlIGFib3V0IHRvIGRpZSAoQkVUQSkiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQoJCQkJX0cuVlByZWRpY3Rpb25NZW51LkNvbGxpc2lvbjphZGRQYXJhbSgiaW5mbyIsICItIiwgU0NSSVBUX1BBUkFNX0lORk8sICJeIENhbiBjYXVzZSBmcHMgZHJvcHMiKQoKCQkJCV9HLlZQcmVkaWN0aW9uTWVudS5Db2xsaXNpb246YWRkUGFyYW0oIlVuaXRQb3MiLCAiQ2hlY2sgY29sbGlzaW9uIGF0IHRoZSB1bml0IHBvcyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKCQkJCV9HLlZQcmVkaWN0aW9uTWVudS5Db2xsaXNpb246YWRkUGFyYW0oIkNhc3RQb3MiLCAiQ2hlY2sgY29sbGlzaW9uIGF0IHRoZSBjYXN0IHBvcyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKCQkJCV9HLlZQcmVkaWN0aW9uTWVudS5Db2xsaXNpb246YWRkUGFyYW0oIlByZWRpY3RQb3MiLCAiQ2hlY2sgY29sbGlzaW9uIGF0IHRoZSBwcmVkaWN0ZWQgcG9zIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkKCgkJCWlmIHNlbGYuc2hvd2Rldm1vZGUgdGhlbgoJCQlfRy5WUHJlZGljdGlvbk1lbnU6YWRkU3ViTWVudSgiRGV2ZWxvcGVycyIsICJEZXZlbG9wZXJzIikKCQkJCV9HLlZQcmVkaWN0aW9uTWVudS5EZXZlbG9wZXJzOmFkZFBhcmFtKCJEZWJ1ZyIsICJFbmFibGUgZGVidWciLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQoJCQkJX0cuVlByZWRpY3Rpb25NZW51LkRldmVsb3BlcnM6YWRkUGFyYW0oIlNDIiwgIlNob3cgY29sbGlzaW9uIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkKCQkJZW5kCgkJCV9HLlZQcmVkaWN0aW9uTWVudTphZGRQYXJhbSgiVmVyc2lvbiIsICJWZXJzaW9uIiwgU0NSSVBUX1BBUkFNX0lORk8sIHRvc3RyaW5nKHNlbGYudmVyc2lvbikpCgllbmQKCgktLVtbVXNlIHdheXBvaW50cyBmcm9tIHRoZSBsYXN0IDEwIHNlY29uZHNdXQoJc2VsZi5XYXlwb2ludHNUaW1lID0gMTAKCglzZWxmLkVuZW15TWluaW9ucyA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0VORU1ZLCAyMDAwLCBteUhlcm8udmlzaW9uUG9zLCBNSU5JT05fU09SVF9IRUFMVEhfQVNDKQoJc2VsZi5KdW5nbGVNaW5pb25zID0gbWluaW9uTWFuYWdlcihNSU5JT05fSlVOR0xFLCAyMDAwLCBteUhlcm8udmlzaW9uUG9zLCBNSU5JT05fU09SVF9IRUFMVEhfQVNDKQoJc2VsZi5PdGhlck1pbmlvbnMgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9PVEhFUiwgMjAwMCwgbXlIZXJvLnZpc2lvblBvcywgTUlOSU9OX1NPUlRfSEVBTFRIX0FTQykKCglzZWxmLlRhcmdldHNWaXNpYmxlID0ge30KCXNlbGYuVGFyZ2V0c1dheXBvaW50cyA9IHt9CglzZWxmLlRhcmdldHNJbW1vYmlsZSA9IHt9CglzZWxmLlRhcmdldHNEYXNoaW5nID0ge30KCXNlbGYuVGFyZ2V0c1Nsb3dlZCA9IHt9CglzZWxmLkRvbnRTaG9vdCA9IHt9CglzZWxmLkRvbnRTaG9vdDIgPSB7fQoJc2VsZi5Eb250U2hvb3RVbnRpbE5ld1dheXBvaW50cyA9IHt9CgoJaWYgVklQX1VTRVIgdGhlbgoJCVdheVBvaW50TWFuYWdlci5BZGRDYWxsYmFjayhmdW5jdGlvbihOZXR3b3JrSUQpIHNlbGY6T25OZXdXYXlQb2ludHMoTmV0d29ya0lEKSBlbmQpCgkJQWR2YW5jZWRDYWxsYmFjazpiaW5kKCJPbkdhaW5WaXNpb24iLCBmdW5jdGlvbih1bml0KSBzZWxmOk9uR2FpblZpc2lvbih1bml0KSBlbmQpCgkJQWR2YW5jZWRDYWxsYmFjazpiaW5kKCJPbkdhaW5CdWZmIiwgZnVuY3Rpb24odW5pdCwgYnVmZikgc2VsZjpPbkdhaW5CdWZmKHVuaXQsIGJ1ZmYpIGVuZCkKCQlBZHZhbmNlZENhbGxiYWNrOmJpbmQoIk9uRGFzaCIsIGZ1bmN0aW9uKHVuaXQsIGRhc2gpIHNlbGY6T25EYXNoKHVuaXQsIGRhc2gpIGVuZCkKCWVuZAoKCUFkZFByb2Nlc3NTcGVsbENhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIHNwZWxsKSBzZWxmOk9uUHJvY2Vzc1NwZWxsKHVuaXQsIHNwZWxsKSBlbmQpCglBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOk9uVGljaygpIGVuZCkKCUFkZERyYXdDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6T25EcmF3KCkgZW5kKQoJQWRkUHJvY2Vzc1NwZWxsQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgc3BlbGwpIHNlbGY6Q29sbGlzaW9uUHJvY2Vzc1NwZWxsKHVuaXQsIHNwZWxsKSBlbmQpCglzZWxmLkJsYWNrTGlzdCA9Cgl7CgkJe25hbWUgPSAiYWF0cm94cSIsIGR1cmF0aW9uID0gMC43NX0sIC0tW1s0IERhc2hlcywgT25EYXNoIGZhaWxzXV0KCX0KCgktLVtbU3BlbGxzIHRoYXQgd2lsbCBjYXVzZSBPbkRhc2ggdG8gZmlyZSwgZG9udCBzaG9vdCBhbmQgd2FpdCB0byBPbkRhc2hdXQoJc2VsZi5kYXNoQWJvdXRUb0hhcHBlbmQgPQoJewoJCXtuYW1lID0gImFocml0dW1ibGUiLCBkdXJhdGlvbiA9IDAuMjV9LC0tYWhyaSdzIHIKCQl7bmFtZSA9ICJha2FsaXNoYWRvd2RhbmNlIiwgZHVyYXRpb24gPSAwLjI1fSwtLWFrYWxpIHIKCQl7bmFtZSA9ICJoZWFkYnV0dCIsIGR1cmF0aW9uID0gMC4yNX0sLS1hbGlzdGFyIHcKCQl7bmFtZSA9ICJjYWl0bHluZW50cmFwbWVudCIsIGR1cmF0aW9uID0gMC4yNX0sLS1jYWl0bHluIGUKCQl7bmFtZSA9ICJjYXJwZXRib21iIiwgZHVyYXRpb24gPSAwLjI1fSwtLWNvcmtpIHcKCQl7bmFtZSA9ICJkaWFuYXRlbGVwb3J0IiwgZHVyYXRpb24gPSAwLjI1fSwtLWRpYW5hIHIKCQl7bmFtZSA9ICJmaXp6cGllcmNpbmdzdHJpa2UiLCBkdXJhdGlvbiA9IDAuMjV9LC0tZml6eiBxCgkJe25hbWUgPSAiZml6emp1bXAiLCBkdXJhdGlvbiA9IDAuMjV9LC0tZml6eiBlCgkJe25hbWUgPSAiZ3JhZ2FzYm9keXNsYW0iLCBkdXJhdGlvbiA9IDAuMjV9LC0tZ3JhZ2FzIGUKCQl7bmFtZSA9ICJncmF2ZXNtb3ZlIiwgZHVyYXRpb24gPSAwLjI1fSwtLWdyYXZlcyBlCgkJe25hbWUgPSAiaXJlbGlhZ2F0b3RzdSIsIGR1cmF0aW9uID0gMC4yNX0sLS1pcmVsaWEgcQoJCXtuYW1lID0gImphcnZhbml2ZHJhZ29uc3RyaWtlIiwgZHVyYXRpb24gPSAwLjI1fSwtLWphcnZhbiBxCgkJe25hbWUgPSAiamF4bGVhcHN0cmlrZSIsIGR1cmF0aW9uID0gMC4yNX0sLS1qYXggcQoJCXtuYW1lID0gImtoYXppeGUiLCBkdXJhdGlvbiA9IDAuMjV9LC0ta2hheml4IGUgYW5kIGUgZXZvbHZlZAoJCXtuYW1lID0gImxlYmxhbmNzbGlkZSIsIGR1cmF0aW9uID0gMC4yNX0sLS1sZWJsYW5jIHcKCQl7bmFtZSA9ICJsZWJsYW5jc2xpZGVtIiwgZHVyYXRpb24gPSAwLjI1fSwtLWxlYmxhbmMgdyAocikKCQl7bmFtZSA9ICJibGluZG1vbmtxdHdvIiwgZHVyYXRpb24gPSAwLjI1fSwtLWxlZSBzaW4gcQoJCXtuYW1lID0gImJsaW5kbW9ua3dvbmUiLCBkdXJhdGlvbiA9IDAuMjV9LC0tbGVlIHNpbiB3CgkJe25hbWUgPSAibHVjaWFuZSIsIGR1cmF0aW9uID0gMC4yNX0sLS1sdWNpYW4gZQoJCXtuYW1lID0gIm1hb2thaXVuc3RhYmxlZ3Jvd3RoIiwgZHVyYXRpb24gPSAwLjI1fSwtLW1hb2thaSB3CgkJe25hbWUgPSAibm9jdHVybmVwYXJhbm9pYTIiLCBkdXJhdGlvbiA9IDAuMjV9LC0tbm9jdHVybmUgcgoJCXtuYW1lID0gInBhbnRoZW9uX2xlYXBiYXNoIiwgZHVyYXRpb24gPSAwLjI1fSwtLXBhbnRoZW9uIGU/CgkJe25hbWUgPSAicmVuZWt0b25zbGljZWFuZGRpY2UiLCBkdXJhdGlvbiA9IDAuMjV9LC0tcmVuZWt0b24gZQoJCXtuYW1lID0gInJpdmVudHJpY2xlYXZlIiwgZHVyYXRpb24gPSAwLjI1fSwtLXJpdmVuIHEKCQl7bmFtZSA9ICJyaXZlbmZlaW50IiwgZHVyYXRpb24gPSAwLjI1fSwtLXJpdmVuIGUKCQl7bmFtZSA9ICJzZWp1YW5pYXJjdGljYXNzYXVsdCIsIGR1cmF0aW9uID0gMC4yNX0sLS1zZWp1YW5pIHEKCQl7bmFtZSA9ICJzaGVuc2hhZG93ZGFzaCIsIGR1cmF0aW9uID0gMC4yNX0sLS1zaGVuIGUKCQl7bmFtZSA9ICJzaHl2YW5hdHJhbnNmb3JtY2FzdCIsIGR1cmF0aW9uID0gMC4yNX0sLS1zaHl2YW5hIHIKCQl7bmFtZSA9ICJyb2NrZXRqdW1wIiwgZHVyYXRpb24gPSAwLjI1fSwtLXRyaXN0YW5hIHcKCQl7bmFtZSA9ICJzbGFzaGNhc3QiLCBkdXJhdGlvbiA9IDAuMjV9LC0tdHJ5bmRhbWVyZSBlCgkJe25hbWUgPSAidmF5bmV0dW1ibGUiLCBkdXJhdGlvbiA9IDAuMjV9LC0tdmF5bmUgcQoJCXtuYW1lID0gInZpcSIsIGR1cmF0aW9uID0gMC4yNX0sLS12aSBxCgkJe25hbWUgPSAibW9ua2V5a2luZ25pbWJ1cyIsIGR1cmF0aW9uID0gMC4yNX0sLS13dWtvbmcgcQoJCXtuYW1lID0gInhlbnpoYW9zd2VlcCIsIGR1cmF0aW9uID0gMC4yNX0sLS14aW4geGhhbyBxCgkJe25hbWUgPSAieWFzdW9kYXNod3JhcHBlciIsIGR1cmF0aW9uID0gMC4yNX0sLS15YXN1byBlCgoJfQoJLS1bW1NwZWxscyB0aGF0IGRvbid0IGFsbG93IG1vdmVtZW50IChkdXJhdGlvbnMgYXBwcm94KV1dCglzZWxmLnNwZWxscyA9IHsKCQl7bmFtZSA9ICJrYXRhcmluYXIiLCBkdXJhdGlvbiA9IDF9LCAtLUthdGFyaW5hcyBSCgkJe25hbWUgPSAiZHJhaW4iLCBkdXJhdGlvbiA9IDF9LCAtLUZpZGRsZSBXCgkJe25hbWUgPSAiY3Jvd3N0b3JtIiwgZHVyYXRpb24gPSAxfSwgLS1GaWRkbGUgUgoJCXtuYW1lID0gImNvbnN1bWUiLCBkdXJhdGlvbiA9IDAuNX0sIC0tTnVudSBRCgkJe25hbWUgPSAiYWJzb2x1dGV6ZXJvIiwgZHVyYXRpb24gPSAxfSwgLS1OdW51IFIKCQl7bmFtZSA9ICJyb2NrZXRncmFiIiwgZHVyYXRpb24gPSAwLjV9LCAtLUJsaXR6Y3JhbmsgUQoJCXtuYW1lID0gInN0YXRpY2ZpZWxkIiwgZHVyYXRpb24gPSAwLjV9LCAtLUJsaXR6Y3JhbmsgUgoJCXtuYW1lID0gImNhc3Npb3BlaWFwZXRyaWZ5aW5nZ2F6ZSIsIGR1cmF0aW9uID0gMC41fSwgLS1DYXNzaW8ncyBSCgkJe25hbWUgPSAiZXpyZWFsdHJ1ZXNob3RiYXJyYWdlIiwgZHVyYXRpb24gPSAxfSwgLS1FenJlYWwncyBSCgkJe25hbWUgPSAiZ2FsaW9pZG9sb2ZkdXJhbmQiLCBkdXJhdGlvbiA9IDF9LCAtLUV6cmVhbCdzIFIKCQl7bmFtZSA9ICJncmFnYXNkcnVua2VucmFnZSIsIGR1cmF0aW9uID0gMX0sIC0tIiJHcmFnYXMgVwoJCXtuYW1lID0gImx1eG1hbGljZWNhbm5vbiIsIGR1cmF0aW9uID0gMX0sIC0tTHV4IFIKCQl7bmFtZSA9ICJyZWFwdGhld2hpcmx3aW5kIiwgZHVyYXRpb24gPSAxfSwgLS1KYW5uYXMgUgoJCXtuYW1lID0gImppbnh3IiwgZHVyYXRpb24gPSAwLjZ9LCAtLWppbnhXCgkJe25hbWUgPSAiamlueHIiLCBkdXJhdGlvbiA9IDAuNn0sIC0tamlueFIKCQl7bmFtZSA9ICJtaXNzZm9ydHVuZWJ1bGxldHRpbWUiLCBkdXJhdGlvbiA9IDF9LCAtLU1pc3NGb3J0dW5lUgoJCXtuYW1lID0gInNoZW5zdGFuZHVuaXRlZCIsIGR1cmF0aW9uID0gMX0sIC0tU2hlblIKCQl7bmFtZSA9ICJ0aHJlc2hlIiwgZHVyYXRpb24gPSAwLjR9LCAtLVRocmVzaEUKCQl7bmFtZSA9ICJ0aHJlc2hycGVudGEiLCBkdXJhdGlvbiA9IDAuNzV9LCAtLVRocmVzaFIKCQl7bmFtZSA9ICJpbmZpbml0ZWR1cmVzcyIsIGR1cmF0aW9uID0gMX0sIC0tV2Fyd2ljayBSCgkJe25hbWUgPSAibWVkaXRhdGUiLCBkdXJhdGlvbiA9IDF9IC0teWkgVwoJfQoKCXNlbGYuYmxpbmtzID0gewoJCXtuYW1lID0gImV6cmVhbGFyY2FuZXNoaWZ0IiwgcmFuZ2UgPSA0NzUsIGRlbGF5ID0gMC4yNSwgZGVsYXkyPTAuOH0sLS1FenJlYWxzIEUKCQl7bmFtZSA9ICJkZWNlaXZlIiwgcmFuZ2UgPSA0MDAsIGRlbGF5ID0gMC4yNSwgZGVsYXkyPTAuOH0sIC0tU2hhY29zIFEKCQl7bmFtZSA9ICJyaWZ0d2FsayIsIHJhbmdlID0gNzAwLCBkZWxheSA9IDAuMjUsIGRlbGF5Mj0wLjh9LC0tS2Fzc2FkaW5SCgkJe25hbWUgPSAiZ2F0ZSIsIHJhbmdlID0gNTUwMCwgZGVsYXkgPSAxLjUsIGRlbGF5Mj0xLjV9LC0tVHdpc3RlZCBmYXRlIFIKCQl7bmFtZSA9ICJrYXRhcmluYWUiLCByYW5nZSA9IG1hdGguaHVnZSwgZGVsYXkgPSAwLjI1LCBkZWxheTI9MC44fSwtLUthdGFyaW5hcyBFCgkJe25hbWUgPSAiZWxpc2VzcGlkZXJlZGVzY2VudCIsIHJhbmdlID0gbWF0aC5odWdlLCBkZWxheSA9IDAuMjUsIGRlbGF5Mj0wLjh9LC0tRWxpc2UgRQoJCXtuYW1lID0gImVsaXNlc3BpZGVyZSIsIHJhbmdlID0gbWF0aC5odWdlLCBkZWxheSA9IDAuMjUsIGRlbGF5Mj0wLjh9LC0tRWxpc2UgaW5zdGEgRQoJfQoKCXJldHVybiBzZWxmCmVuZAoKLS1SX1dBWVBPSU5UIG5ldyBkZWZpbml0aW9uCmlmIFZJUF9VU0VSIHRoZW4KCWxvYWQoQmFzZTY0RGVjb2RlKCJHMHgxWVZJQUFRUUVCQWdBR1pNTkNob0tBQUFBQUFBQUFBQUFBUU1NQUFBQUJnQkFBQWRBUUFBSGdFQUFTOEFBQUtVQUFBQktnQUNDcFVBQUFFcUFnSUtsZ0FBQVNvQUFnd3BBZ0lFZkFJQUFCd0FBQUFRREFBQUFYMGNBQkFjQUFBQlFZV05yWlhRQUJBc0FBQUJrWldacGJtbDBhVzl1QUFRTEFBQUFVbDlYUVZsUVQwbE9WQUFFQlFBQUFHbHVhWFFBQkFjQUFBQmtaV052WkdVQUJBY0FBQUJsYm1OdlpHVUFBd0FBQUFJQUFBQUpBQUFBQUFBSUVBQUFBQXNBQVFCTEFBQURnVUFBQU1GQUFBQUJRUUFBUVVFQUFJRkJBQURCUVFBQVpFQUFBd3BBQUlBS1FFQ0JDa0RBZ1VzQUFBQUtRQUNDSHdBQUFSOEFnQUFGQUFBQUJBOEFBQUJoWkdScGRHbHZibUZzU1c1bWJ3QURBQUFBQUFBQUFBQUVEd0FBQUhObGNYVmxibU5sVG5WdFltVnlBQVFLQUFBQWJtVjBkMjl5YTBsa0FBUUtBQUFBZDJGNVVHOXBiblJ6QUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQXNBQUFBbEFBQUFBUUFLUGdBQUFBcEFRSUJMd0FBQWl3QUFBRXFBQUlHTUFFRUFuWUFBQVVxQWdJR0xBQUFBU29DQWdvY0FRQUNOZ0VFQnpNQkJBTjJBQUFHTndBQUJDb0FBZ0l3QVFRQ2RnQUFCU29BQWhJeEFRZ0NkZ0FBQkdJQkNBUmZBQUlDSEFFQUFqY0JDQVp0QUFBQVhRQUNBaHdCQUFJMEFRd0VLZ0FDQWgwQkRBTWNBUUFBQmdRTUFvVUFHZ0FwQUFZQ01BVUVBbllFQUFjZkJ3QUFZd0FFREY4QUVnSWNCUUFET3dVTURDc0FCZ014QlJBRGRnUUFCU3NBQmlNeEJRZ0RkZ1FBQjBNSEVBMHJBQVluSEFVQUF6UUhGQXdyQUFZREdRVVVBeDRIRkF3QUNBQUJIZ3NRQTNZR0FBVXJBZ1lJWEFBQ0FvQUQ1ZjE4QUFBRWZBSUFBRndBQUFBUUVBQUFBY0c5ekFBTUFBQUFBQUFEd1B3UVBBQUFBWVdSa2FYUnBiMjVoYkVsdVptOEFCQW9BQUFCdVpYUjNiM0pyU1dRQUJBZ0FBQUJFWldOdlpHVkdBQVFLQUFBQWQyRjVVRzlwYm5SekFBTUFBQUFBQUFBWVFBUUlBQUFBUkdWamIyUmxNZ0FFRkFBQUFHRmtaR2wwYVc5dVlXeE9aWFIzYjNKclNXUUFCQWdBQUFCRVpXTnZaR1V4QUFNQUFBQUFBQUFBQUFNQUFBQUFBQUFzUUFNQUFBQUFBQUFvUUFRRkFBQUFjMmw2WlFBREFBQUFBQUFBOEw4REFBQUFBQUFBSWtBRUR3QUFBSE5sY1hWbGJtTmxUblZ0WW1WeUFBUUlBQUFBUkdWamIyUmxOQUFFRGdBQUFIZGhlWEJ2YVc1MFEyOTFiblFBQXdBQUFBQUFBQUJBQXdBQUFBQUFBQkJBQkFjQUFBQlFZV05yWlhRQUJCQUFBQUJrWldOdlpHVlhZWGxRYjJsdWRITUFBQUFBQUFFQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQW5BQUFBT1FBQUFBRUFDVVVBQUFCR1FFQUFob0JBQUlmQVFBR0hBRUVCWFlBQUFRaEFBSUJHQUVBQVRFREJBTWVBUVFESHdNRUJYVUNBQVVZQVFBQk1BTUlBeDRCQkFNZEF3Z0hWQUlBQnpvRENBVjFBZ0FGR3dFSUFoNEJCQUlkQVFnRmRBQUVCRjhBQWdJWUJRQUNNQVVNREFBS0FBcDFCZ0FGaWdBQUE0MEQrZjBZQVFBQk1BTU1Bd1VBREFGMUFnQUZHQUVBQVRJRERBTWVBUVFESHdNTUJYVUNBQVVZQVFBQk1RTUVBeDRCQkFNY0F4QUhIUU1RQng0REVBVjFBZ0FGR0FFQUFURURCQU1lQVFRREhBTVFCeDBERUFjZkF4QUZkUUlBQlJnQkFBRXhBd1FESGdFRUF4d0RFQWNjQXhRSEhnTVFCWFVDQUFVWUFRQUJNUU1FQXg0QkJBTWNBeEFISEFNVUJ4OERFQVYxQWdBRkdBRUFBWHdBQUFSOEFnQUFWQUFBQUJBSUFBQUJ3QUFRTEFBQUFRMHh2VEZCaFkydGxkQUFFQndBQUFGQmhZMnRsZEFBRUNBQUFBR2hsWVdSbGNuTUFCQXNBQUFCU1gxZEJXVkJQU1U1VUFBUUlBQUFBUlc1amIyUmxSZ0FFQndBQUFIWmhiSFZsY3dBRUNnQUFBRzVsZEhkdmNtdEpaQUFFQ0FBQUFFVnVZMjlrWlRJQUJBOEFBQUJoWkdScGRHbHZibUZzU1c1bWJ3QURBQUFBQUFBQUdFQUVCd0FBQUdsd1lXbHljd0FFQ0FBQUFFVnVZMjlrWlRFQUF3QUFBQUFBQUFoQUJBZ0FBQUJGYm1OdlpHVTBBQVFQQUFBQWMyVnhkV1Z1WTJWT2RXMWlaWElBQkFvQUFBQjNZWGxRYjJsdWRITUFBd0FBQUFBQUFQQS9CQUlBQUFCNEFBUUNBQUFBZVFBREFBQUFBQUFBQUVBQUFBQUFBUUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFFQUFBQUJBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQT0iKSkoKQplbmQKLS0KCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkdldFRpbWUoKQoJcmV0dXJuIG9zLmNsb2NrKCkKZW5kCgotLVtbVHJhY2sgd2hlbiB3ZSBsb3NlIG9yIGdhaW4gdmlzaW9uIG92ZXIgYW4gZW5lbXldXQpmdW5jdGlvbiBWUHJlZGljdGlvbjpPbkdhaW5WaXNpb24odW5pdCkKCWlmIHVuaXQudHlwZSA9PSBteUhlcm8udHlwZSB0aGVuCgkJc2VsZi5UYXJnZXRzVmlzaWJsZVt1bml0Lm5ldHdvcmtJRF0gPSBzZWxmOkdldFRpbWUoKQoJZW5kCmVuZAoKLS1bW1RyYWNrIHdoZW4gd2UgbG9zZSBvciBnYWluIHZpc2lvbiBvdmVyIGFuIGVuZW15XV0KZnVuY3Rpb24gVlByZWRpY3Rpb246T25Mb3NlVmlzaW9uKHVuaXQpCglpZiB1bml0LnR5cGUgPT0gbXlIZXJvLnR5cGUgdGhlbgoJCXNlbGYuVGFyZ2V0c1Zpc2libGVbdW5pdC5uZXR3b3JrSURdID0gbWF0aC5odWdlCgllbmQKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpPbkdhaW5CdWZmKHVuaXQsIGJ1ZmYpCglpZiB1bml0LnR5cGUgPT0gbXlIZXJvLnR5cGUgYW5kIChidWZmLnR5cGUgPT0gQlVGRl9TVFVOIG9yIGJ1ZmYudHlwZSA9PSBCVUZGX1JPT1Qgb3IgYnVmZi50eXBlID09IEJVRkZfS05PQ0tVUCBvciBidWZmLnR5cGUgPT0gQlVGRl9TVVBQUkVTUykgdGhlbgoJCXNlbGYuVGFyZ2V0c0ltbW9iaWxlW3VuaXQubmV0d29ya0lEXSA9IHNlbGY6R2V0VGltZSgpICsgYnVmZi5kdXJhdGlvbgoJZWxzZWlmIHVuaXQudHlwZSA9PSBteUhlcm8udHlwZSBhbmQgKGJ1ZmYudHlwZSA9PSBCVUZGX1NMT1cgb3IgYnVmZi50eXBlID09IEJVRkZfQ0hBUk0gb3IgYnVmZi50eXBlID09IEJVRkZfRkVBUiBvciBidWZmLnR5cGUgPT0gQlVGRl9UQVVOVCkgdGhlbgoJCXNlbGYuVGFyZ2V0c1Nsb3dlZFt1bml0Lm5ldHdvcmtJRF0gPSBzZWxmOkdldFRpbWUoKSArIGJ1ZmYuZHVyYXRpb24KCWVuZAoKCWlmIHVuaXQudHlwZSA9PSBteUhlcm8udHlwZSBhbmQgKGJ1ZmYudHlwZSA9PSBCVUZGX0tOT0NLQkFDSykgdGhlbgoJCXNlbGYuRG9udFNob290W3VuaXQubmV0d29ya0lEXSA9IHNlbGY6R2V0VGltZSgpICsgMQoJZW5kCmVuZAoKZnVuY3Rpb24gVlByZWRpY3Rpb246T25EYXNoKHVuaXQsIGRhc2gpCglpZiB1bml0LnR5cGUgPT0gbXlIZXJvLnR5cGUgdGhlbgoJCWRhc2guZW5kUG9zID0gZGFzaC50YXJnZXQgYW5kIGRhc2gudGFyZ2V0IG9yIGRhc2guZW5kUG9zCgkJZGFzaC5zdGFydFQgPSBzZWxmOkdldFRpbWUoKSAtIEdldExhdGVuY3koKS8yMDAwCgkJZGFzaC5lbmRUID0gZGFzaC5zdGFydFQgKyBkYXNoLmR1cmF0aW9uCgkJc2VsZi5UYXJnZXRzRGFzaGluZ1t1bml0Lm5ldHdvcmtJRF0gPSBkYXNoCgkJc2VsZi5Eb250U2hvb3RVbnRpbE5ld1dheXBvaW50c1t1bml0Lm5ldHdvcmtJRF0gPSB0cnVlCgllbmQKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpPblByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkKCWlmIHVuaXQgYW5kIHVuaXQudHlwZSA9PSBteUhlcm8udHlwZSB0aGVuCgkJZm9yIGksIHMgaW4gaXBhaXJzKHNlbGYuc3BlbGxzKSBkbwoJCQlpZiBzcGVsbC5uYW1lOmxvd2VyKCkgPT0gcy5uYW1lIHRoZW4KCQkJCXNlbGYuVGFyZ2V0c0ltbW9iaWxlW3VuaXQubmV0d29ya0lEXSA9IHNlbGY6R2V0VGltZSgpICsgcy5kdXJhdGlvbgoJCQkJcmV0dXJuCgkJCWVuZAoJCWVuZAoKCQlmb3IgaSwgcyBpbiBpcGFpcnMoc2VsZi5ibGlua3MpIGRvCgkJCWxvY2FsIExhbmRpbmdQb3MgPSBHZXREaXN0YW5jZSh1bml0LnZpc2lvblBvcywgVmVjdG9yKHNwZWxsLmVuZFBvcykpIDwgcy5yYW5nZSBhbmQgVmVjdG9yKHNwZWxsLmVuZFBvcykgb3IgVmVjdG9yKHVuaXQudmlzaW9uUG9zKSArIHMucmFuZ2UgKiAoVmVjdG9yKHNwZWxsLmVuZFBvcykgLSBWZWN0b3IodW5pdC52aXNpb25Qb3MpKTpub3JtYWxpemVkKCkKCQkJaWYgc3BlbGwubmFtZTpsb3dlcigpID09IHMubmFtZSBhbmQgbm90IElzV2FsbChEM0RYVkVDVE9SMyhzcGVsbC5lbmRQb3MueCwgc3BlbGwuZW5kUG9zLnksIHNwZWxsLmVuZFBvcy56KSkgdGhlbgoJCQkJc2VsZi5UYXJnZXRzRGFzaGluZ1t1bml0Lm5ldHdvcmtJRF0gPSB7aXNibGluayA9IHRydWUsIGR1cmF0aW9uID0gcy5kZWxheSwgZW5kVCA9IHNlbGY6R2V0VGltZSgpICsgcy5kZWxheSwgZW5kVDIgPSBzZWxmOkdldFRpbWUoKSArIHMuZGVsYXkyLCBzdGFydFBvcyA9IFZlY3Rvcih1bml0LnZpc2lvblBvcyksIGVuZFBvcyA9IExhbmRpbmdQb3N9CgkJCQlyZXR1cm4KCQkJZW5kCgkJZW5kCgoJCWZvciBpLCBzIGluIGlwYWlycyhzZWxmLkJsYWNrTGlzdCkgZG8KCQkJaWYgc3BlbGwubmFtZTpsb3dlcigpID09IHMubmFtZSB0aGVuCgkJCQlzZWxmLkRvbnRTaG9vdFt1bml0Lm5ldHdvcmtJRF0gPSBzZWxmOkdldFRpbWUoKSArIHMuZHVyYXRpb24KCQkJCXJldHVybgoJCQllbmQKCQllbmQKCgkJZm9yIGksIHMgaW4gaXBhaXJzKHNlbGYuZGFzaEFib3V0VG9IYXBwZW5kKSBkbwoJCQlpZiBzcGVsbC5uYW1lOmxvd2VyKCkgPT0gcy5uYW1lIHRoZW4KCQkJCXNlbGYuRG9udFNob290Mlt1bml0Lm5ldHdvcmtJRF0gPSBzZWxmOkdldFRpbWUoKSArIHMuZHVyYXRpb24KCQkJCXJldHVybgoJCQllbmQKCQllbmQKCWVuZAplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOk9uTmV3V2F5UG9pbnRzKE5ldHdvcmtJRCkKCWxvY2FsIG9iamVjdCA9IG9iak1hbmFnZXI6R2V0T2JqZWN0QnlOZXR3b3JrSWQoTmV0d29ya0lEKQoJaWYgb2JqZWN0IGFuZCBvYmplY3QudmFsaWQgYW5kIG9iamVjdC5uZXR3b3JrSUQgYW5kIG9iamVjdC50eXBlID09IG15SGVyby50eXBlIHRoZW4KCQlzZWxmLkRvbnRTaG9vdFVudGlsTmV3V2F5cG9pbnRzW05ldHdvcmtJRF0gPSBmYWxzZQoJCWlmIHNlbGYuVGFyZ2V0c1dheXBvaW50c1tOZXR3b3JrSURdID09IG5pbCB0aGVuCgkJCXNlbGYuVGFyZ2V0c1dheXBvaW50c1tOZXR3b3JrSURdID0ge30KCQllbmQKCQlsb2NhbCBXYXlwb2ludHNUb0FkZCA9IFdheVBvaW50TWFuYWdlcjpHZXRXYXlQb2ludHMob2JqZWN0KQoJCWlmIFdheXBvaW50c1RvQWRkIGFuZCAjV2F5cG9pbnRzVG9BZGQgPj0gMSB0aGVuCgkJCS0tW1tTYXZlIG9ubHkgdGhlIGxhc3Qgd2F5cG9pbnQgKHdoZXJlIHRoZSBwbGF5ZXIgY2xpY2tlZCldXQoJCQl0YWJsZS5pbnNlcnQoc2VsZi5UYXJnZXRzV2F5cG9pbnRzW05ldHdvcmtJRF0sIHt1bml0cG9zID0gVmVjdG9yKG9iamVjdC52aXNpb25Qb3MpICwgd2F5cG9pbnQgPSBXYXlwb2ludHNUb0FkZFsjV2F5cG9pbnRzVG9BZGRdLCB0aW1lID0gc2VsZjpHZXRUaW1lKCksIG4gPSAjV2F5cG9pbnRzVG9BZGR9KQoJCWVuZAoJZWxzZWlmIG9iamVjdCBhbmQgb2JqZWN0LnZhbGlkIGFuZCBvYmplY3QudHlwZSB+PSBteUhlcm8udHlwZSB0aGVuCgkJbG9jYWwgaSA9IDEKCQl3aGlsZSBpIDw9ICNzZWxmLkFjdGl2ZUF0dGFja3MgZG8KCQkJaWYgKHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5BdHRhY2tlciBhbmQgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLkF0dGFja2VyLnZhbGlkIGFuZCBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uQXR0YWNrZXIubmV0d29ya0lEID09IE5ldHdvcmtJRCBhbmQgKHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5zdGFydHRpbWUgKyBzZWxmLkFjdGl2ZUF0dGFja3NbaV0ud2luZFVwVGltZSAtIEdldExhdGVuY3koKS8yMDAwKSA+IHNlbGY6R2V0VGltZSgpKSB0aGVuCgkJCQlsb2NhbCB3cHRzID0gV2F5UG9pbnRNYW5hZ2VyOkdldFdheVBvaW50cyhvYmplY3QpCgkJCQlpZiAjd3B0cyA+IDEgdGhlbgoJCQkJCXRhYmxlLnJlbW92ZShzZWxmLkFjdGl2ZUF0dGFja3MsIGkpCgkJCQllbHNlCgkJCQkJaSA9IGkgKyAxCgkJCQllbmQKCQkJZWxzZQoJCQkJaSA9IGkgKyAxCgkJCWVuZAoJCWVuZAoJZW5kCmVuZAoKZnVuY3Rpb24gVlByZWRpY3Rpb246SXNJbW1vYmlsZSh1bml0LCBkZWxheSwgcmFkaXVzLCBzcGVlZCwgZnJvbSwgc3BlbGx0eXBlKQoJaWYgc2VsZi5UYXJnZXRzSW1tb2JpbGVbdW5pdC5uZXR3b3JrSURdIHRoZW4KCQlsb2NhbCBFeHRyYURlbGF5ID0gc3BlZWQgPT0gbWF0aC5odWdlIGFuZCAgMCBvciAoR2V0RGlzdGFuY2UoZnJvbSwgdW5pdCkgLyBzcGVlZCkKCQlpZiAoc2VsZi5UYXJnZXRzSW1tb2JpbGVbdW5pdC5uZXR3b3JrSURdID4gKHNlbGY6R2V0VGltZSgpICsgZGVsYXkgKyBFeHRyYURlbGF5KSBhbmQgc3BlbGx0eXBlID09ICJjaXJjdWxhciIpIHRoZW4KCQkJcmV0dXJuIHRydWUsIFZlY3Rvcih1bml0LnZpc2lvblBvcyksIFZlY3Rvcih1bml0LnZpc2lvblBvcykgKyAocmFkaXVzLzMpICogKFZlY3Rvcihmcm9tKSAtIFZlY3Rvcih1bml0LnZpc2lvblBvcykpOm5vcm1hbGl6ZWQoKQoJCWVsc2VpZiAoc2VsZi5UYXJnZXRzSW1tb2JpbGVbdW5pdC5uZXR3b3JrSURdICsgKHJhZGl1cyAvIHVuaXQubXMpKSA+IChzZWxmOkdldFRpbWUoKSArIGRlbGF5ICsgRXh0cmFEZWxheSkgdGhlbgoJCQlyZXR1cm4gdHJ1ZSwgVmVjdG9yKHVuaXQudmlzaW9uUG9zKSwgVmVjdG9yKHVuaXQudmlzaW9uUG9zKQoJCWVuZAoJZW5kCglyZXR1cm4gZmFsc2UsIFZlY3Rvcih1bml0LnZpc2lvblBvcyksIFZlY3Rvcih1bml0LnZpc2lvblBvcykKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjppc1Nsb3dlZCh1bml0LCBkZWxheSwgc3BlZWQsIGZyb20pCglpZiBzZWxmLlRhcmdldHNTbG93ZWRbdW5pdC5uZXR3b3JrSURdIHRoZW4KCQlpZiBzZWxmLlRhcmdldHNTbG93ZWRbdW5pdC5uZXR3b3JrSURdID4gKHNlbGY6R2V0VGltZSgpICsgZGVsYXkgKyBHZXREaXN0YW5jZSh1bml0LCBmcm9tKSAvIHNwZWVkKSB0aGVuCgkJCXJldHVybiB0cnVlCgkJZW5kCgllbmQKCXJldHVybiBmYWxzZQplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOklzRGFzaGluZyh1bml0LCBkZWxheSwgcmFkaXVzLCBzcGVlZCwgZnJvbSkKCWxvY2FsIFRhcmdldERhc2hpbmcgPSBmYWxzZQoJbG9jYWwgQ2FuSGl0ID0gZmFsc2UKCWxvY2FsIFBvc2l0aW9uCgoJaWYgc2VsZi5UYXJnZXRzRGFzaGluZ1t1bml0Lm5ldHdvcmtJRF0gdGhlbgoJCWxvY2FsIGRhc2ggPSBzZWxmLlRhcmdldHNEYXNoaW5nW3VuaXQubmV0d29ya0lEXQoJCWlmIGRhc2guZW5kVCA+PSBzZWxmOkdldFRpbWUoKSB0aGVuCgkJCVRhcmdldERhc2hpbmcgPSB0cnVlCgkJCWlmIGRhc2guaXNibGluayB0aGVuCgkJCQlpZiAoZGFzaC5lbmRUIC0gc2VsZjpHZXRUaW1lKCkpIDw9IChkZWxheSArIEdldERpc3RhbmNlKGZyb20sIGRhc2guZW5kUG9zKS9zcGVlZCkgdGhlbgoJCQkJCVBvc2l0aW9uID0gVmVjdG9yKGRhc2guZW5kUG9zLngsIDAsIGRhc2guZW5kUG9zLnopCgkJCQkJQ2FuSGl0ID0gKHVuaXQubXMgKiAoZGVsYXkgKyBHZXREaXN0YW5jZShmcm9tLCBkYXNoLmVuZFBvcykvc3BlZWQgLSAoZGFzaC5lbmRUMiAtIHNlbGY6R2V0VGltZSgpKSkpIDwgcmFkaXVzCgkJCQllbmQKCgkJCQlpZiAoKGRhc2guZW5kVCAtIHNlbGY6R2V0VGltZSgpKSA+PSAoZGVsYXkgKyBHZXREaXN0YW5jZShmcm9tLCBkYXNoLnN0YXJ0UG9zKS9zcGVlZCkpIGFuZCBub3QgQ2FuSGl0IHRoZW4KCQkJCQlQb3NpdGlvbiA9IFZlY3RvcihkYXNoLnN0YXJ0UG9zLngsIDAsIGRhc2guc3RhcnRQb3MueikKCQkJCQlDYW5IaXQgPSB0cnVlCgkJCQllbmQKCgkJCWVsc2UKCQkJCWxvY2FsIHQxLCBwMSwgdDIsIHAyLCBkaXN0ID0gVmVjdG9yTW92ZW1lbnRDb2xsaXNpb24oZGFzaC5zdGFydFBvcywgZGFzaC5lbmRQb3MsIGRhc2guc3BlZWQsIGZyb20sIHNwZWVkLCAoc2VsZjpHZXRUaW1lKCkgLSBkYXNoLnN0YXJ0VCkgKyBkZWxheSkKCQkJCXQxLCB0MiA9ICh0MSBhbmQgMCA8PSB0MSBhbmQgdDEgPD0gKGRhc2guZW5kVCAtIHNlbGY6R2V0VGltZSgpIC0gZGVsYXkpKSBhbmQgdDEgb3IgbmlsLCAodDIgYW5kIDAgPD0gdDIgYW5kIHQyIDw9ICAoZGFzaC5lbmRUIC0gc2VsZjpHZXRUaW1lKCkgLSBkZWxheSkpIGFuZCB0MiBvciBuaWwKCQkJCWxvY2FsIHQgPSB0MSBhbmQgdDIgYW5kIG1hdGgubWluKHQxLHQyKSBvciB0MSBvciB0MgoJCQkJaWYgdCB0aGVuCgkJCQkJUG9zaXRpb24gPSB0PT10MSBhbmQgVmVjdG9yKHAxLngsIDAsIHAxLnkpIG9yIFZlY3RvcihwMi54LCAwLCBwMi55KQoJCQkJCUNhbkhpdCA9IHRydWUKCQkJCWVsc2UKCQkJCQlQb3NpdGlvbiA9IFZlY3RvcihkYXNoLmVuZFBvcy54LCAwLCBkYXNoLmVuZFBvcy56KQoJCQkJCUNhbkhpdCA9ICh1bml0Lm1zICogKGRlbGF5ICsgR2V0RGlzdGFuY2UoZnJvbSwgUG9zaXRpb24pL3NwZWVkIC0gKGRhc2guZW5kVCAtIHNlbGY6R2V0VGltZSgpKSkpIDwgcmFkaXVzCgkJCQllbmQKCQkJZW5kCgkJZW5kCgllbmQKCXJldHVybiBUYXJnZXREYXNoaW5nLCBDYW5IaXQsIFBvc2l0aW9uCmVuZAoKZnVuY3Rpb24gVlByZWRpY3Rpb246R2V0V2F5cG9pbnRzKE5ldHdvcmtJRCwgZnJvbSwgdG8pCglsb2NhbCBSZXN1bHQgPSB7fQoJdG8gPSB0byBhbmQgdG8gb3Igc2VsZjpHZXRUaW1lKCkKCWlmIHNlbGYuVGFyZ2V0c1dheXBvaW50c1tOZXR3b3JrSURdIHRoZW4KCQlmb3IgaSwgd2F5cG9pbnQgaW4gaXBhaXJzKHNlbGYuVGFyZ2V0c1dheXBvaW50c1tOZXR3b3JrSURdKSBkbwoJCQlpZiBmcm9tIDw9IHdheXBvaW50LnRpbWUgIGFuZCB0byA+PSB3YXlwb2ludC50aW1lIHRoZW4KCQkJCXRhYmxlLmluc2VydChSZXN1bHQsIHdheXBvaW50KQoJCQllbmQKCQllbmQKCWVuZAoJcmV0dXJuIFJlc3VsdCwgI1Jlc3VsdAplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkNvdW50V2F5cG9pbnRzKE5ldHdvcmtJRCwgZnJvbSwgdG8pCglsb2NhbCBSLCBOID0gc2VsZjpHZXRXYXlwb2ludHMoTmV0d29ya0lELCBmcm9tLCB0bykKCXJldHVybiBOCmVuZAoKZnVuY3Rpb24gVlByZWRpY3Rpb246R2V0V2F5cG9pbnRzTGVuZ3RoKFdheXBvaW50cykKCWxvY2FsIHJlc3VsdCA9IDAKCWZvciBpID0gMSwgI1dheXBvaW50cyAtMSBkbwoJCXJlc3VsdCA9IHJlc3VsdCArIEdldERpc3RhbmNlKFdheXBvaW50c1tpXSwgV2F5cG9pbnRzW2kgKyAxXSkKCWVuZAoJcmV0dXJuIHJlc3VsdAplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkN1dFdheXBvaW50cyhXYXlwb2ludHMsIGRpc3RhbmNlKQoJbG9jYWwgcmVzdWx0ID0ge30KCWxvY2FsIHJlbWFpbmluZyA9IGRpc3RhbmNlCglpZiBkaXN0YW5jZSA+IDAgdGhlbgoJCWZvciBpID0gMSwgI1dheXBvaW50cyAtMSBkbwoJCQlsb2NhbCBBLCBCID0gV2F5cG9pbnRzW2ldLCBXYXlwb2ludHNbaSArIDFdCgkJCWxvY2FsIGRpc3QgPSBHZXREaXN0YW5jZShBLCBCKQoJCQlpZiBkaXN0ID49IHJlbWFpbmluZyB0aGVuCgkJCQlyZXN1bHRbMV0gPSBWZWN0b3IoQSkgKyByZW1haW5pbmcgKiAoVmVjdG9yKEIpIC0gVmVjdG9yKEEpKTpub3JtYWxpemVkKCkKCgkJCQlmb3IgaiA9IGkgKyAxLCAjV2F5cG9pbnRzIGRvCgkJCQkJcmVzdWx0W2ogLSBpICsgMV0gPSBXYXlwb2ludHNbal0KCQkJCWVuZAoJCQkJcmVtYWluaW5nID0gMAoJCQkJYnJlYWsKCQkJZWxzZQoJCQkJcmVtYWluaW5nID0gcmVtYWluaW5nIC0gZGlzdAoJCQllbmQKCQllbmQKCWVsc2UKCQlsb2NhbCBBLCBCID0gV2F5cG9pbnRzWzFdLCBXYXlwb2ludHNbMl0KCQlyZXN1bHQgPSBXYXlwb2ludHMKCQlyZXN1bHRbMV0gPSBWZWN0b3IoQSkgLSBkaXN0YW5jZSAqIChWZWN0b3IoQikgLSBWZWN0b3IoQSkpOm5vcm1hbGl6ZWQoKQoJZW5kCgoJcmV0dXJuIHJlc3VsdAplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkdldEN1cnJlbnRXYXlQb2ludHMob2JqZWN0KQoJbG9jYWwgcmVzdWx0ID0ge30KCglpZiBub3QgVklQX1VTRVIgdGhlbgoJCWlmIG9iamVjdC5oYXNNb3ZlUGF0aCB0aGVuCgkJCXRhYmxlLmluc2VydChyZXN1bHQsIFZlY3RvcihvYmplY3QudmlzaW9uUG9zLngsIG9iamVjdC52aXNpb25Qb3MueikpCgkJCWZvciBpID0gb2JqZWN0LnBhdGhJbmRleCwgb2JqZWN0LnBhdGhDb3VudCBkbwoJCQkJcGF0aCA9IG9iamVjdDpHZXRQYXRoKGkpCgkJCQl0YWJsZS5pbnNlcnQocmVzdWx0LCBWZWN0b3IocGF0aC54LCBwYXRoLnopKQoJCQllbmQKCQllbHNlCgkJCXRhYmxlLmluc2VydChyZXN1bHQsIG9iamVjdC52aXNpb25Qb3MgYW5kIFZlY3RvcihvYmplY3QudmlzaW9uUG9zLngsIG9iamVjdC52aXNpb25Qb3Mueikgb3IgVmVjdG9yKG9iamVjdC54LCBvYmplY3QueikpCgkJZW5kCgkJcmV0dXJuIHJlc3VsdAoJZWxzZQoJCWxvY2FsIHdheVBvaW50cywgbGluZVNlZ21lbnQsIGRpc3RhbmNlU3FyLCBmUG9pbnQgPSBXYXlQb2ludE1hbmFnZXI6R2V0UmF3V2F5UG9pbnRzKG9iamVjdCksIDAsIG1hdGguaHVnZSwgbmlsCgkJaWYgbm90IHdheVBvaW50cyBhbmQgbm90IG9iamVjdC52aXNpb25Qb3MgdGhlbgoJCQlyZXR1cm4geyB7IHggPSBvYmplY3QueCwgeSA9IG9iamVjdC56IH0gfQoJCWVsc2VpZiBub3Qgd2F5UG9pbnRzIGFuZCBvYmplY3QudmlzaW9uUG9zIHRoZW4KCQkJcmV0dXJuIHsgeyB4ID0gb2JqZWN0LnZpc2lvblBvcy54LCB5ID0gb2JqZWN0LnZpc2lvblBvcy56IH0gfQoJCWVuZAoJCWZvciBpID0gMSwgI3dheVBvaW50cyAtIDEgZG8KCQkJbG9jYWwgcDEsIHRtcDEsIHRtcDIgPSBWZWN0b3JQb2ludFByb2plY3Rpb25PbkxpbmVTZWdtZW50KHdheVBvaW50c1tpXSwgd2F5UG9pbnRzW2kgKyAxXSwgVmVjdG9yKG9iamVjdC52aXNpb25Qb3MpKQoJCQlsb2NhbCBkaXN0YW5jZVNlZ21lbnRTcXIgPSBHZXREaXN0YW5jZVNxcihwMSwgb2JqZWN0LnZpc2lvblBvcykKCQkJaWYgZGlzdGFuY2VTZWdtZW50U3FyIDw9IGRpc3RhbmNlU3FyIHRoZW4KCQkJCWZQb2ludCA9IHAxCgkJCQlsaW5lU2VnbWVudCA9IGkKCQkJCWRpc3RhbmNlU3FyID0gZGlzdGFuY2VTZWdtZW50U3FyCgkJCWVsc2UKCQkJCWJyZWFrIC0tbm90IG5lY2Vzc2FyeSwgYnV0IG1ha2VzIGl0IGZhc3RlcgoJCQllbmQKCQllbmQKCQlsb2NhbCByZXN1bHQgPSB7IGZQb2ludCBvciB7IHggPSBvYmplY3QudmlzaW9uUG9zLngsIHkgPSBvYmplY3QudmlzaW9uUG9zLnogfSB9CgkJZm9yIGkgPSBsaW5lU2VnbWVudCArIDEsICN3YXlQb2ludHMgZG8KCQkJcmVzdWx0WyNyZXN1bHQgKyAxXSA9IHdheVBvaW50c1tpXQoJCWVuZAoJCWlmICNyZXN1bHQgPT0gMiBhbmQgR2V0RGlzdGFuY2VTcXIocmVzdWx0WzFdLCByZXN1bHRbMl0pIDwgNDAwIHRoZW4gcmVzdWx0WzJdID0gbmlsIGVuZAoJCXJldHVybiByZXN1bHQKCWVuZAoKZW5kCgoKCi0tW1tDYWxjdWxhdGUgdGhlIGhlcm8gcG9zaXRpb24gYmFzZWQgb24gdGhlIGxhc3Qgd2F5cG9pbnRzXV0KZnVuY3Rpb24gVlByZWRpY3Rpb246Q2FsY3VsYXRlVGFyZ2V0UG9zaXRpb24odW5pdCwgZGVsYXksIHJhZGl1cywgc3BlZWQsIGZyb20sIHNwZWxsdHlwZSkKCWxvY2FsIFdheXBvaW50cyA9IHt9Cglsb2NhbCBQb3NpdGlvbiwgQ2FzdFBvc2l0aW9uID0gVmVjdG9yKHVuaXQudmlzaW9uUG9zKSwgVmVjdG9yKHVuaXQudmlzaW9uUG9zKQoJbG9jYWwgdAoKCVdheXBvaW50cyA9IHNlbGY6R2V0Q3VycmVudFdheVBvaW50cyh1bml0KQoJbG9jYWwgV2F5cG9pbnRzbGVuZ3RoID0gc2VsZjpHZXRXYXlwb2ludHNMZW5ndGgoV2F5cG9pbnRzKQoKCWlmICNXYXlwb2ludHMgPT0gMSB0aGVuCgkJUG9zaXRpb24sIENhc3RQb3NpdGlvbiA9IFZlY3RvcihXYXlwb2ludHNbMV0ueCwgMCwgV2F5cG9pbnRzWzFdLnkpLCBWZWN0b3IoV2F5cG9pbnRzWzFdLngsIDAsIFdheXBvaW50c1sxXS55KQoJCXJldHVybiBQb3NpdGlvbiwgQ2FzdFBvc2l0aW9uCgllbHNlaWYgKFdheXBvaW50c2xlbmd0aCAtIGRlbGF5ICogdW5pdC5tcyArIHJhZGl1cykgPj0gMCB0aGVuCgkJbG9jYWwgdEEgPSAwCgkJV2F5cG9pbnRzID0gc2VsZjpDdXRXYXlwb2ludHMoV2F5cG9pbnRzLCBkZWxheSAqIHVuaXQubXMgLSByYWRpdXMpCgoJCWlmIHNwZWVkIH49IG1hdGguaHVnZSB0aGVuCgkJCWZvciBpID0gMSwgI1dheXBvaW50cyAtIDEgZG8KCQkJCWxvY2FsIEEsIEIgPSBXYXlwb2ludHNbaV0sIFdheXBvaW50c1tpKzFdCgkJCQlpZiBpID09ICNXYXlwb2ludHMgLSAxIHRoZW4KCQkJCQlCID0gVmVjdG9yKEIpICsgcmFkaXVzICogVmVjdG9yKEIgLSBBKTpub3JtYWxpemVkKCkKCQkJCWVuZAoJCQkJbG9jYWwgdDEsIHAxLCB0MiwgcDIsIEQgPSBWZWN0b3JNb3ZlbWVudENvbGxpc2lvbihBLCBCLCB1bml0Lm1zLCBWZWN0b3IoZnJvbS54LCBmcm9tLnopLCBzcGVlZCkKCQkJCWxvY2FsIHRCID0gdEEgKyBEIC8gdW5pdC5tcwoJCQkJdDEsIHQyID0gKHQxIGFuZCB0QSA8PSB0MSBhbmQgdDEgPD0gKHRCIC0gdEEpKSBhbmQgdDEgb3IgbmlsLCAodDIgYW5kIHRBIDw9IHQyIGFuZCB0MiA8PSAodEIgLSB0QSkpIGFuZCB0MiBvciBuaWwKCQkJCXQgPSB0MSBhbmQgdDIgYW5kIG1hdGgubWluKHQxLCB0Mikgb3IgdDEgb3IgdDIKCQkJCWlmIHQgdGhlbgoJCQkJCUNhc3RQb3NpdGlvbiA9IHQ9PXQxIGFuZCBWZWN0b3IocDEueCwgMCwgcDEueSkgb3IgVmVjdG9yKHAyLngsIDAsIHAyLnkpCgkJCQkJYnJlYWsKCQkJCWVuZAoJCQkJdEEgPSB0QgoJCQllbmQKCQllbHNlCgkJCXQgPSAwCgkJCUNhc3RQb3NpdGlvbiA9IFZlY3RvcihXYXlwb2ludHNbMV0ueCwgMCwgV2F5cG9pbnRzWzFdLnkpCgkJZW5kCgoJCWlmIHQgdGhlbgoJCQlpZiAoc2VsZjpHZXRXYXlwb2ludHNMZW5ndGgoV2F5cG9pbnRzKSAtIHQgKiB1bml0Lm1zIC0gcmFkaXVzKSA+PSAwIHRoZW4KCQkJCVdheXBvaW50cyA9IHNlbGY6Q3V0V2F5cG9pbnRzKFdheXBvaW50cywgcmFkaXVzICsgdCAqIHVuaXQubXMpCgkJCQlQb3NpdGlvbiA9IFZlY3RvcihXYXlwb2ludHNbMV0ueCwgMCwgV2F5cG9pbnRzWzFdLnkpCgkJCWVsc2UKCQkJCVBvc2l0aW9uID0gQ2FzdFBvc2l0aW9uCgkJCWVuZAoJCWVsc2VpZiB1bml0LnR5cGUgfj0gbXlIZXJvLnR5cGUgdGhlbgoJCQlDYXN0UG9zaXRpb24gPSBWZWN0b3IoV2F5cG9pbnRzWyNXYXlwb2ludHNdLngsIDAsIFdheXBvaW50c1sjV2F5cG9pbnRzXS55KQoJCQlQb3NpdGlvbiA9IENhc3RQb3NpdGlvbgoJCWVuZAoKCWVsc2VpZiB1bml0LnR5cGUgfj0gbXlIZXJvLnR5cGUgdGhlbgoJCUNhc3RQb3NpdGlvbiA9IFZlY3RvcihXYXlwb2ludHNbI1dheXBvaW50c10ueCwgMCwgV2F5cG9pbnRzWyNXYXlwb2ludHNdLnkpCgkJUG9zaXRpb24gPSBDYXN0UG9zaXRpb24KCWVuZAoKCWlmIHQgYW5kIHNlbGY6aXNTbG93ZWQodW5pdCwgMCwgbWF0aC5odWdlLCBmcm9tKSBhbmQgbm90IHNlbGY6aXNTbG93ZWQodW5pdCwgdCwgbWF0aC5odWdlLCBmcm9tKSBhbmQgUG9zaXRpb24gdGhlbgoJCUNhc3RQb3NpdGlvbiA9IFBvc2l0aW9uCgllbmQKCglyZXR1cm4gUG9zaXRpb24sIENhc3RQb3NpdGlvbgplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOk1heEFuZ2xlKHVuaXQsIGN1cnJlbnR3YXlwb2ludCwgZnJvbSkKCWxvY2FsIFdQdGFibGUsIG4gPSBzZWxmOkdldFdheXBvaW50cyh1bml0Lm5ldHdvcmtJRCwgZnJvbSkKCWxvY2FsIE1heCA9IDAKCWxvY2FsIENWID0gKFZlY3RvcihjdXJyZW50d2F5cG9pbnQueCwgMCwgY3VycmVudHdheXBvaW50LnkpIC0gVmVjdG9yKHVuaXQpKQoJCWZvciBpLCB3YXlwb2ludCBpbiBpcGFpcnMoV1B0YWJsZSkgZG8KCQkJCWxvY2FsIGFuZ2xlID0gVmVjdG9yKDAsIDAsIDApOmFuZ2xlQmV0d2VlbihDViwgVmVjdG9yKHdheXBvaW50LndheXBvaW50LngsIDAsIHdheXBvaW50LndheXBvaW50LnkpIC0gVmVjdG9yKHdheXBvaW50LnVuaXRwb3MueCwgMCwgd2F5cG9pbnQudW5pdHBvcy55KSkKCQkJCWlmIGFuZ2xlID4gTWF4IHRoZW4KCQkJCQlNYXggPSBhbmdsZQoJCQkJZW5kCgkJZW5kCglyZXR1cm4gTWF4CmVuZAoKZnVuY3Rpb24gVlByZWRpY3Rpb246V2F5UG9pbnRBbmFseXNpcyh1bml0LCBkZWxheSwgcmFkaXVzLCByYW5nZSwgc3BlZWQsIGZyb20sIHNwZWxsdHlwZSkKCWxvY2FsIFBvc2l0aW9uLCBDYXN0UG9zaXRpb24sIEhpdENoYW5jZQoJbG9jYWwgU2F2ZWRXYXlQb2ludHMgPSBzZWxmLlRhcmdldHNXYXlwb2ludHNbdW5pdC5uZXR3b3JrSURdIGFuZCBzZWxmLlRhcmdldHNXYXlwb2ludHNbdW5pdC5uZXR3b3JrSURdIG9yIHt9Cglsb2NhbCBDdXJyZW50V2F5UG9pbnRzID0gc2VsZjpHZXRDdXJyZW50V2F5UG9pbnRzKHVuaXQpCglsb2NhbCBWaXNpYmxlU2luY2UgPSBzZWxmLlRhcmdldHNWaXNpYmxlW3VuaXQubmV0d29ya0lEXSBhbmQgc2VsZi5UYXJnZXRzVmlzaWJsZVt1bml0Lm5ldHdvcmtJRF0gb3Igc2VsZjpHZXRUaW1lKCkKCglIaXRDaGFuY2UgPSAxCglQb3NpdGlvbiwgQ2FzdFBvc2l0aW9uID0gc2VsZjpDYWxjdWxhdGVUYXJnZXRQb3NpdGlvbih1bml0LCBkZWxheSwgcmFkaXVzLCBzcGVlZCwgZnJvbSwgc3BlbGx0eXBlKQoKCWlmIHNlbGY6Q291bnRXYXlwb2ludHModW5pdC5uZXR3b3JrSUQsIHNlbGY6R2V0VGltZSgpIC0gMC4xKSA+PSAxIG9yIHNlbGY6Q291bnRXYXlwb2ludHModW5pdC5uZXR3b3JrSUQsIHNlbGY6R2V0VGltZSgpIC0gMSkgPT0gMSB0aGVuCgkJSGl0Q2hhbmNlID0gMgoJZW5kCgoJbG9jYWwgTiA9IChfRy5WUHJlZGljdGlvbk1lbnUuTW9kZSA9PSBfU0xPVykgYW5kIDMgb3IgMgoJbG9jYWwgdDEgPSAoX0cuVlByZWRpY3Rpb25NZW51Lk1vZGUgPT0gX1NMT1cpIGFuZCAxIG9yIDAuNQoJaWYgc2VsZjpDb3VudFdheXBvaW50cyh1bml0Lm5ldHdvcmtJRCwgc2VsZjpHZXRUaW1lKCkgLSAwLjc1KSA+PSBOIHRoZW4KCQlsb2NhbCBhbmdsZSA9IHNlbGY6TWF4QW5nbGUodW5pdCwgQ3VycmVudFdheVBvaW50c1sjQ3VycmVudFdheVBvaW50c10sIHNlbGY6R2V0VGltZSgpIC0gdDEpCgkJaWYgYW5nbGUgPiA5MCB0aGVuCgkJCUhpdENoYW5jZSA9IDEKCQllbHNlaWYgYW5nbGUgPCAzMCBhbmQgc2VsZjpDb3VudFdheXBvaW50cyh1bml0Lm5ldHdvcmtJRCwgc2VsZjpHZXRUaW1lKCkgLSAwLjEpID49IDEgdGhlbgoJCQlIaXRDaGFuY2UgPSAyCgkJZW5kCgllbmQKCglOID0gKF9HLlZQcmVkaWN0aW9uTWVudS5Nb2RlID09IF9TTE9XKSBhbmQgMiBvciAxCglpZiBzZWxmOkNvdW50V2F5cG9pbnRzKHVuaXQubmV0d29ya0lELCBzZWxmOkdldFRpbWUoKSAtIE4pID09IDAgdGhlbgoJCUhpdENoYW5jZSA9IDIKCWVuZAoKCWlmIF9HLlZQcmVkaWN0aW9uTWVudS5Nb2RlID09IF9GQVNUIHRoZW4KCQlIaXRDaGFuY2UgPSAyCgllbmQKCglpZiAjQ3VycmVudFdheVBvaW50cyA8PSAxIGFuZCBzZWxmOkdldFRpbWUoKSAtIFZpc2libGVTaW5jZSA+IDEgdGhlbgoJCUhpdENoYW5jZSA9IDIKCWVuZAoKCWlmIHNlbGY6aXNTbG93ZWQodW5pdCwgZGVsYXksIHNwZWVkLCBmcm9tKSB0aGVuCgkJSGl0Q2hhbmNlID0gMgoJZW5kCgoJaWYgUG9zaXRpb24gYW5kIENhc3RQb3NpdGlvbiBhbmQgKChyYWRpdXMgLyB1bml0Lm1zID49IGRlbGF5ICsgR2V0RGlzdGFuY2UoZnJvbSwgQ2FzdFBvc2l0aW9uKS9zcGVlZCkgb3IgKHJhZGl1cyAvIHVuaXQubXMgPj0gZGVsYXkgKyBHZXREaXN0YW5jZShmcm9tLCBQb3NpdGlvbikvc3BlZWQpKSB0aGVuCgkJSGl0Q2hhbmNlID0gMwoJZW5kCgkJLS1bW0FuZ2xlIHRvbyB3aWRlXV0KCWlmIFZlY3Rvcihmcm9tKTphbmdsZUJldHdlZW4oVmVjdG9yKHVuaXQudmlzaW9uUG9zKSwgVmVjdG9yKENhc3RQb3NpdGlvbikpID4gNjAgdGhlbgoJCUhpdENoYW5jZSA9IDEKCWVuZAoKCWlmIG5vdCBQb3NpdGlvbiBvciBub3QgQ2FzdFBvc2l0aW9uIHRoZW4KCQlIaXRDaGFuY2UgPSAwCgkJQ2FzdFBvc2l0aW9uID0gVmVjdG9yKEN1cnJlbnRXYXlQb2ludHNbI0N1cnJlbnRXYXlQb2ludHNdLngsIDAsIEN1cnJlbnRXYXlQb2ludHNbI0N1cnJlbnRXYXlQb2ludHNdLnkpCgkJUG9zaXRpb24gPSBDYXN0UG9zaXRpb24KCWVuZAoKCWlmIEdldERpc3RhbmNlKG15SGVyby52aXNpb25Qb3MsIHVuaXQudmlzaW9uUG9zKSA8IDI1MCB0aGVuCgkJSGl0Q2hhbmNlID0gMgoJCVBvc2l0aW9uLCBDYXN0UG9zaXRpb24gPSBzZWxmOkNhbGN1bGF0ZVRhcmdldFBvc2l0aW9uKHVuaXQsIGRlbGF5KjAuNSwgcmFkaXVzLCBzcGVlZCoyLCBmcm9tLCBzcGVsbHR5cGUpCgkJUG9zaXRpb24gPSBDYXN0UG9zaXRpb24KCWVuZAoKCWlmICNTYXZlZFdheVBvaW50cyA9PSAwIGFuZCAoc2VsZjpHZXRUaW1lKCkgLSBWaXNpYmxlU2luY2UpID4gMyB0aGVuCgkJSGl0Q2hhbmNlID0gMgoJZW5kCgoJaWYgc2VsZi5Eb250U2hvb3RVbnRpbE5ld1dheXBvaW50c1t1bml0Lm5ldHdvcmtJRF0gdGhlbgoJCUhpdENoYW5jZSA9IDAKCQlDYXN0UG9zaXRpb24gPSBWZWN0b3IodW5pdC52aXNpb25Qb3MueCwgMCwgdW5pdC52aXNpb25Qb3MueikKCQlQb3NpdGlvbiA9IENhc3RQb3NpdGlvbgoJZW5kCgoJcmV0dXJuIENhc3RQb3NpdGlvbiwgSGl0Q2hhbmNlLCBQb3NpdGlvbgplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkdldEJlc3RDYXN0UG9zaXRpb24odW5pdCwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tLCBjb2xsaXNpb24sIHNwZWxsdHlwZSkKCWFzc2VydCh1bml0LCAiVlByZWRpY3Rpb246IFRhcmdldCBjYW4ndCBiZSBuaWwiKQoKCXJhbmdlID0gcmFuZ2UgYW5kIHJhbmdlIC0gNCBvciBtYXRoLmh1Z2UKCXJhZGl1cyA9IHJhZGl1cyA9PSAwIGFuZCAxIG9yIChyYWRpdXMgKyBzZWxmOkdldEhpdEJveCh1bml0KSkgLSA0CglzcGVlZCA9IHNwZWVkIGFuZCBzcGVlZCBvciBtYXRoLmh1Z2UKCWZyb20gPSBmcm9tIGFuZCBmcm9tIG9yIFZlY3RvcihteUhlcm8udmlzaW9uUG9zKQoJaWYgZnJvbS5uZXR3b3JrSUQgYW5kIGZyb20ubmV0d29ya0lEID09IG15SGVyby5uZXR3b3JrSUQgdGhlbgoJCWZyb20gPSBWZWN0b3IobXlIZXJvLnZpc2lvblBvcykKCWVuZAoJbG9jYWwgSXNGcm9tTXlIZXJvID0gR2V0RGlzdGFuY2VTcXIoZnJvbSwgbXlIZXJvLnZpc2lvblBvcykgPCA1MCo1MCBhbmQgdHJ1ZSBvciBmYWxzZQoKCWRlbGF5ID0gZGVsYXkgKyAoMC4wNyArIEdldExhdGVuY3koKSAvIDIwMDApCgoJbG9jYWwgUG9zaXRpb24sIENhc3RQb3NpdGlvbiwgSGl0Q2hhbmNlID0gVmVjdG9yKHVuaXQudmlzaW9uUG9zKSwgVmVjdG9yKHVuaXQudmlzaW9uUG9zKSwgMAoJbG9jYWwgVGFyZ2V0RGFzaGluZywgQ2FuSGl0RGFzaGluZywgRGFzaFBvc2l0aW9uID0gc2VsZjpJc0Rhc2hpbmcodW5pdCwgZGVsYXksIHJhZGl1cywgc3BlZWQsIGZyb20pCglsb2NhbCBUYXJnZXRJbW1vYmlsZSwgSW1tb2JpbGVQb3MsIEltbW9iaWxlQ2FzdFBvc2l0aW9uID0gc2VsZjpJc0ltbW9iaWxlKHVuaXQsIGRlbGF5LCByYWRpdXMsIHNwZWVkLCBmcm9tLCBzcGVsbHR5cGUpCglsb2NhbCBWaXNpYmxlU2luY2UgPSBzZWxmLlRhcmdldHNWaXNpYmxlW3VuaXQubmV0d29ya0lEXSBhbmQgc2VsZi5UYXJnZXRzVmlzaWJsZVt1bml0Lm5ldHdvcmtJRF0gb3Igc2VsZjpHZXRUaW1lKCkKCglpZiB1bml0LnR5cGUgfj0gbXlIZXJvLnR5cGUgdGhlbgoJCVBvc2l0aW9uLCBDYXN0UG9zaXRpb24gPSBzZWxmOkNhbGN1bGF0ZVRhcmdldFBvc2l0aW9uKHVuaXQsIGRlbGF5LCByYWRpdXMsIHNwZWVkLCBmcm9tLCBzcGVsbHR5cGUpCgkJSGl0Q2hhbmNlID0gMgoJZWxzZQoJCWlmIHNlbGYuRG9udFNob290W3VuaXQubmV0d29ya0lEXSBhbmQgc2VsZi5Eb250U2hvb3RbdW5pdC5uZXR3b3JrSURdID4gc2VsZjpHZXRUaW1lKCkgdGhlbgoJCQlQb3NpdGlvbiwgQ2FzdFBvc2l0aW9uID0gVmVjdG9yKHVuaXQudmlzaW9uUG9zLngsIHVuaXQudmlzaW9uUG9zLnksIHVuaXQudmlzaW9uUG9zLnopLCAgVmVjdG9yKHVuaXQudmlzaW9uUG9zLngsIHVuaXQudmlzaW9uUG9zLnksIHVuaXQudmlzaW9uUG9zLnopCgkJCUhpdENoYW5jZSA9IDAKCQllbHNlaWYgVGFyZ2V0RGFzaGluZyB0aGVuCgkJCWlmIENhbkhpdERhc2hpbmcgdGhlbgoJCQkJSGl0Q2hhbmNlID0gNQoJCQllbHNlCgkJCQlIaXRDaGFuY2UgPSAwCgkJCWVuZAoJCQlQb3NpdGlvbiwgQ2FzdFBvc2l0aW9uID0gRGFzaFBvc2l0aW9uLCBEYXNoUG9zaXRpb24KCQllbHNlaWYgc2VsZi5Eb250U2hvb3QyW3VuaXQubmV0d29ya0lEXSBhbmQgc2VsZi5Eb250U2hvb3QyW3VuaXQubmV0d29ya0lEXSA+IHNlbGY6R2V0VGltZSgpIHRoZW4KCQkJUG9zaXRpb24sIENhc3RQb3NpdGlvbiA9IFZlY3Rvcih1bml0LnZpc2lvblBvcy54LCB1bml0LnZpc2lvblBvcy55LCB1bml0LnZpc2lvblBvcy56KSwgIFZlY3Rvcih1bml0LnZpc2lvblBvcy54LCB1bml0LnZpc2lvblBvcy55LCB1bml0LnZpc2lvblBvcy56KQoJCQlIaXRDaGFuY2UgPSA3CgkJZWxzZWlmIFRhcmdldEltbW9iaWxlIHRoZW4KCQkJUG9zaXRpb24sIENhc3RQb3NpdGlvbiA9IEltbW9iaWxlUG9zLCBJbW1vYmlsZUNhc3RQb3NpdGlvbgoJCQlIaXRDaGFuY2UgPSA0CgkJZWxzZWlmIG5vdCBzZWxmLkRvbnRVc2VXYXlQb2ludHMgdGhlbgoJCQlDYXN0UG9zaXRpb24sIEhpdENoYW5jZSwgUG9zaXRpb24gPSBzZWxmOldheVBvaW50QW5hbHlzaXModW5pdCwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tLCBzcGVsbHR5cGUpCgkJZW5kCgllbmQKCgktLVtbT3V0IG9mIHJhbmdlXV0KCWlmIElzRnJvbU15SGVybyB0aGVuCgkJaWYgKHNwZWxsdHlwZSA9PSAibGluZSIgYW5kIEdldERpc3RhbmNlU3FyKGZyb20sIFBvc2l0aW9uKSA+PSByYW5nZSAqIHJhbmdlKSB0aGVuCgkJCUhpdENoYW5jZSA9IDAKCQllbmQKCQlpZiAoc3BlbGx0eXBlID09ICJjaXJjdWxhciIgYW5kIChHZXREaXN0YW5jZVNxcihmcm9tLCBQb3NpdGlvbikgPj0gKHJhbmdlICsgcmFkaXVzKV4yKSkgdGhlbgoJCQlIaXRDaGFuY2UgPSAwCgkJZW5kCgoJCWlmIHNlbGYuU2hvdEF0TWF4UmFuZ2UgYW5kIEhpdENoYW5jZSB+PSAwIGFuZCBzcGVsbHR5cGUgPT0gImNpcmN1bGFyIiBhbmQgKEdldERpc3RhbmNlU3FyKGZyb20sIENhc3RQb3NpdGlvbikgPiByYW5nZSBeIDIpIHRoZW4KCQkJaWYgR2V0RGlzdGFuY2VTcXIoZnJvbSwgUG9zaXRpb24pIDw9IChyYW5nZSArIHJhZGl1cyAvIDEuNCkgXiAyIHRoZW4KCQkJCWlmIEdldERpc3RhbmNlU3FyKGZyb20sIFBvc2l0aW9uKSA8PSByYW5nZSAqIHJhbmdlIHRoZW4KCQkJCQlDYXN0UG9zaXRpb24gPSBQb3NpdGlvbgoJCQkJZWxzZQoJCQkJCUNhc3RQb3NpdGlvbiA9IFZlY3Rvcihmcm9tKSArIHJhbmdlICogKFZlY3RvcihQb3NpdGlvbikgLSBWZWN0b3IoZnJvbSkpOm5vcm1hbGl6ZWQoKQoJCQkJZW5kCgkJCWVuZAoJCWVsc2VpZiAoR2V0RGlzdGFuY2VTcXIoZnJvbSwgQ2FzdFBvc2l0aW9uKSA+IHJhbmdlIF4gMikgdGhlbgoJCQlIaXRDaGFuY2UgPSAwCgkJZW5kCgllbmQKCglyYWRpdXMgPSByYWRpdXMgLSBzZWxmOkdldEhpdEJveCh1bml0KSArIDQKCglpZiBjb2xsaXNpb24gYW5kIEhpdENoYW5jZSA+IDAgdGhlbgoJCXNlbGYuRW5lbXlNaW5pb25zLnJhbmdlID0gcmFuZ2UgKyA1MDAgKiAoZGVsYXkgKyByYW5nZS9zcGVlZCkKCQlzZWxmLkp1bmdsZU1pbmlvbnMucmFuZ2UgPSBzZWxmLkVuZW15TWluaW9ucy5yYW5nZQoJCXNlbGYuT3RoZXJNaW5pb25zLnJhbmdlID0gc2VsZi5FbmVteU1pbmlvbnMucmFuZ2UKCQlzZWxmLkVuZW15TWluaW9uczp1cGRhdGUoKQoJCXNlbGYuSnVuZ2xlTWluaW9uczp1cGRhdGUoKQoJCXNlbGYuT3RoZXJNaW5pb25zOnVwZGF0ZSgpCgoJCWlmIGNvbGxpc2lvbiBhbmQgX0cuVlByZWRpY3Rpb25NZW51LkNvbGxpc2lvbi5Vbml0UG9zIGFuZCBzZWxmOkNoZWNrTWluaW9uQ29sbGlzaW9uKHVuaXQsIHVuaXQsIGRlbGF5LCByYWRpdXMsIHJhbmdlLCBzcGVlZCwgZnJvbSkgdGhlbgoJCQlIaXRDaGFuY2UgPSAtMQoJCWVsc2VpZiBfRy5WUHJlZGljdGlvbk1lbnUuQ29sbGlzaW9uLlByZWRpY3RQb3MgYW5kIHNlbGY6Q2hlY2tNaW5pb25Db2xsaXNpb24odW5pdCwgUG9zaXRpb24sIGRlbGF5LCByYWRpdXMsIHJhbmdlLCBzcGVlZCwgZnJvbSkgdGhlbgoJCQlIaXRDaGFuY2UgPSAtMQoJCWVsc2VpZiBfRy5WUHJlZGljdGlvbk1lbnUuQ29sbGlzaW9uLkNhc3RQb3MgYW5kIHNlbGY6Q2hlY2tNaW5pb25Db2xsaXNpb24odW5pdCwgQ2FzdFBvc2l0aW9uLCBkZWxheSwgcmFkaXVzLCByYW5nZSwgc3BlZWQsIGZyb20pIHRoZW4KCQkJSGl0Q2hhbmNlID0gLTEKCQllbmQKCWVuZAoJcmV0dXJuIENhc3RQb3NpdGlvbiwgSGl0Q2hhbmNlLCBQb3NpdGlvbgplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi0tQ29sbGlzaW9uCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpHZXRQcmVkaWN0ZWRIZWFsdGgodW5pdCwgdGltZSwgZGVsYXkpCglsb2NhbCBJbmNEYW1hZ2UgPSAwCglsb2NhbCBpID0gMQoJbG9jYWwgTWF4RGFtYWdlID0gMAoJbG9jYWwgY291bnQgPSAwCglkZWxheSA9IGRlbGF5IGFuZCBkZWxheSBvciAwLjA3Cgl3aGlsZSBpIDw9ICNzZWxmLkFjdGl2ZUF0dGFja3MgZG8KCQlpZiBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uQXR0YWNrZXIgYW5kIG5vdCBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uQXR0YWNrZXIuZGVhZCBhbmQgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLlRhcmdldCBhbmQgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLlRhcmdldC5uZXR3b3JrSUQgPT0gdW5pdC5uZXR3b3JrSUQgdGhlbgoJCQlsb2NhbCBoaXR0aW1lID0gc2VsZi5BY3RpdmVBdHRhY2tzW2ldLnN0YXJ0dGltZSArIHNlbGYuQWN0aXZlQXR0YWNrc1tpXS53aW5kVXBUaW1lICsgKEdldERpc3RhbmNlKHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5wb3MsIHVuaXQudmlzaW9uUG9zKSkgLyBzZWxmLkFjdGl2ZUF0dGFja3NbaV0ucHJvamVjdGlsZXNwZWVkICsgZGVsYXkKCQkJaWYgc2VsZjpHZXRUaW1lKCkgPCBoaXR0aW1lIC0gZGVsYXkgYW5kIGhpdHRpbWUgPCBzZWxmOkdldFRpbWUoKSArIHRpbWUgIHRoZW4KCQkJCUluY0RhbWFnZSA9IEluY0RhbWFnZSArIHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5kYW1hZ2UKCQkJCWNvdW50ID0gY291bnQgKyAxCgkJCQlpZiBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uZGFtYWdlID4gTWF4RGFtYWdlIHRoZW4KCQkJCQlNYXhEYW1hZ2UgPSBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uZGFtYWdlCgkJCQllbmQKCQkJZW5kCgkJZW5kCgkJaSA9IGkgKyAxCgllbmQKCglyZXR1cm4gdW5pdC5oZWFsdGggLSBJbmNEYW1hZ2UsIE1heERhbWFnZSwgY291bnQKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpHZXRQcmVkaWN0ZWRIZWFsdGgyKHVuaXQsIHQpCglsb2NhbCBkYW1hZ2UgPSAwCglsb2NhbCBpID0gMQoKCXdoaWxlIGkgPD0gI3NlbGYuQWN0aXZlQXR0YWNrcyBkbwoJCWxvY2FsIG4gPSAwCgkJaWYgKHNlbGY6R2V0VGltZSgpIC0gMC4xKSA8PSBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uc3RhcnR0aW1lICsgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLmFuaW1hdGlvblRpbWUgYW5kIHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5UYXJnZXQgYW5kIHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5UYXJnZXQudmFsaWQgYW5kIHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5UYXJnZXQubmV0d29ya0lEID09IHVuaXQubmV0d29ya0lEIGFuZCBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uQXR0YWNrZXIgYW5kIHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5BdHRhY2tlci52YWxpZCBhbmQgbm90IHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5BdHRhY2tlci5kZWFkIHRoZW4KCQkJbG9jYWwgRnJvbVQgPSBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uc3RhcnR0aW1lCgkJCWxvY2FsIFRvVCA9IHQgKyBzZWxmOkdldFRpbWUoKQoKCQkJd2hpbGUgRnJvbVQgPCBUb1QgZG8KCQkJCWlmIEZyb21UID49IHNlbGY6R2V0VGltZSgpIGFuZCAoRnJvbVQgKyAoc2VsZi5BY3RpdmVBdHRhY2tzW2ldLndpbmRVcFRpbWUgKyBHZXREaXN0YW5jZSh1bml0LnZpc2lvblBvcywgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLnBvcykgLyBzZWxmLkFjdGl2ZUF0dGFja3NbaV0ucHJvamVjdGlsZXNwZWVkKSkgPCBUb1QgdGhlbgoJCQkJCW4gPSBuICsgMQoJCQkJZW5kCgkJCQlGcm9tVCA9IEZyb21UICsgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLmFuaW1hdGlvblRpbWUKCQkJZW5kCgkJZW5kCgkJZGFtYWdlID0gZGFtYWdlICsgbiAqIHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5kYW1hZ2UKCQlpID0gaSArIDEKCWVuZAoKCXJldHVybiB1bml0LmhlYWx0aCAtIGRhbWFnZQplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkNvbGxpc2lvblByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkKCWlmIHVuaXQgYW5kIHVuaXQudmFsaWQgYW5kIHNwZWxsLnRhcmdldCBhbmQgdW5pdC50eXBlIH49IG15SGVyby50eXBlIGFuZCBzcGVsbC50YXJnZXQudHlwZSA9PSAnb2JqX0FJX01pbmlvbicgYW5kIHVuaXQudGVhbSA9PSBteUhlcm8udGVhbSBhbmQgc3BlbGwgYW5kIHNwZWxsLm5hbWUgYW5kIChzcGVsbC5uYW1lOmxvd2VyKCk6ZmluZCgiYXR0YWNrIikgb3IgKHNwZWxsLm5hbWUgPT0gImZyb3N0YXJyb3ciKSkgYW5kIHNwZWxsLndpbmRVcFRpbWUgYW5kIHNwZWxsLnRhcmdldCB0aGVuCgkJaWYgR2V0RGlzdGFuY2VTcXIodW5pdCkgPCA0MDAwMDAwIHRoZW4KCgkJCWxvY2FsIHRpbWUgPSBzZWxmOkdldFRpbWUoKSArIHNwZWxsLndpbmRVcFRpbWUgKyBHZXREaXN0YW5jZShzcGVsbC50YXJnZXQsIHVuaXQpIC8gc2VsZjpHZXRQcm9qZWN0aWxlU3BlZWQodW5pdCkgLSBHZXRMYXRlbmN5KCkvMjAwMAoJCQlsb2NhbCBpID0gMQoJCQl3aGlsZSBpIDw9ICNzZWxmLkFjdGl2ZUF0dGFja3MgZG8KCQkJCWlmIChzZWxmLkFjdGl2ZUF0dGFja3NbaV0uQXR0YWNrZXIgYW5kIHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5BdHRhY2tlci52YWxpZCBhbmQgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLkF0dGFja2VyLm5ldHdvcmtJRCA9PSB1bml0Lm5ldHdvcmtJRCkgb3IgKChzZWxmLkFjdGl2ZUF0dGFja3NbaV0uaGl0dGltZSArIDMpIDwgc2VsZjpHZXRUaW1lKCkpIHRoZW4KCQkJCQl0YWJsZS5yZW1vdmUoc2VsZi5BY3RpdmVBdHRhY2tzLCBpKQoJCQkJZWxzZQoJCQkJCWkgPSBpICsgMQoJCQkJZW5kCgkJCWVuZAoKCQkJdGFibGUuaW5zZXJ0KHNlbGYuQWN0aXZlQXR0YWNrcywge0F0dGFja2VyID0gdW5pdCwgcG9zID0gVmVjdG9yKHVuaXQudmlzaW9uUG9zKSwgVGFyZ2V0ID0gc3BlbGwudGFyZ2V0LCBhbmltYXRpb25UaW1lID0gc3BlbGwuYW5pbWF0aW9uVGltZSwgZGFtYWdlID0gc2VsZjpDYWxjRGFtYWdlT2ZBdHRhY2sodW5pdCwgc3BlbGwudGFyZ2V0LCBzcGVsbCwgMCksIGhpdHRpbWU9dGltZSwgc3RhcnR0aW1lID0gc2VsZjpHZXRUaW1lKCkgLSBHZXRMYXRlbmN5KCkvMjAwMCwgd2luZFVwVGltZSA9IHNwZWxsLndpbmRVcFRpbWUsIHByb2plY3RpbGVzcGVlZCA9IHNlbGY6R2V0UHJvamVjdGlsZVNwZWVkKHVuaXQpfSkKCQllbmQKCWVuZAplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkNoZWNrQ29sKHVuaXQsIG1pbmlvbiwgUG9zaXRpb24sIGRlbGF5LCByYWRpdXMsIHJhbmdlLCBzcGVlZCwgZnJvbSwgZHJhdykKCWlmIHVuaXQubmV0d29ya0lEID09IG1pbmlvbi5uZXR3b3JrSUQgdGhlbgoJCXJldHVybiBmYWxzZQoJZW5kCgktLVtbQ2hlY2sgZmlyc3QgaWYgdGhlIG1pbmlvbiBpcyBnb2luZyB0byBiZSBkZWFkIHdoZW4gc2tpbGxzaG90cyByZWFjaGVzIGhpcyBwb3NpdGlvbl1dCglpZiBtaW5pb24udHlwZSB+PSBteUhlcm8udHlwZSBhbmQgX0cuVlByZWRpY3Rpb25NZW51LkNvbGxpc2lvbi5DSGVhbHRoIGFuZCBzZWxmOkdldFByZWRpY3RlZEhlYWx0aChtaW5pb24sICBkZWxheSAgKyBHZXREaXN0YW5jZShmcm9tLCBtaW5pb24udmlzaW9uUG9zKSAvIHNwZWVkIC0gR2V0TGF0ZW5jeSgpLzEwMDApIDwgMCB0aGVuCgkJcmV0dXJuIGZhbHNlCgllbmQKCglsb2NhbCB3YXlwb2ludHMgPSBzZWxmOkdldEN1cnJlbnRXYXlQb2ludHMobWluaW9uKQoJbG9jYWwgTVBvcywgQ2FzdFBvc2l0aW9uID0gI3dheXBvaW50cyA9PSAxIGFuZCBWZWN0b3IobWluaW9uLnZpc2lvblBvcykgb3Igc2VsZjpDYWxjdWxhdGVUYXJnZXRQb3NpdGlvbihtaW5pb24sIGRlbGF5LCByYWRpdXMsIHNwZWVkLCBmcm9tLCAibGluZSIpCglpZiBHZXREaXN0YW5jZVNxcihmcm9tLCBNUG9zKSA8PSAocmFuZ2UpXjIgYW5kIEdldERpc3RhbmNlU3FyKGZyb20sIG1pbmlvbikgPD0gKHJhbmdlICsgMTAwKV4yIHRoZW4KCQlsb2NhbCBidWZmZXIgPSAoI3dheXBvaW50cyA+IDEpIGFuZCBfRy5WUHJlZGljdGlvbk1lbnUuQ29sbGlzaW9uLkJ1ZmZlciBvciA4CgoJCWlmIG1pbmlvbi50eXBlID09IG15SGVyby50eXBlIHRoZW4KCQkJYnVmZmVyID0gYnVmZmVyICsgc2VsZjpHZXRIaXRCb3gobWluaW9uKQoJCWVuZAoKCQlpZiBkcmF3IHRoZW4KCQkJRHJhd0NpcmNsZTNEKG1pbmlvbi52aXNpb25Qb3MueCwgbXlIZXJvLnksIG1pbmlvbi52aXNpb25Qb3Mueiwgc2VsZjpHZXRIaXRCb3gobWluaW9uKSArIGJ1ZmZlciwgMSwgQVJHQigyNTUsIDI1NSwgMjU1LCAyNTUpKQoJCQlEcmF3Q2lyY2xlM0QoTVBvcy54LCBteUhlcm8ueSwgTVBvcy56LCBzZWxmOkdldEhpdEJveChtaW5pb24pICsgYnVmZmVyLCAxLCBBUkdCKDI1NSwgMjU1LCAyNTUsIDI1NSkpCgkJCXNlbGY6RExpbmUoTVBvcywgbWluaW9uLnZpc2lvblBvcywgQ29sb3IpCgkJZW5kCgoJCWlmICN3YXlwb2ludHMgPiAxIHRoZW4KCQkJbG9jYWwgcHJvajEsIHBvaW50TGluZSwgaXNPblNlZ21lbnQgPSBWZWN0b3JQb2ludFByb2plY3Rpb25PbkxpbmVTZWdtZW50KGZyb20sIFBvc2l0aW9uLCBWZWN0b3IoTVBvcykpCgkJCWlmIGlzT25TZWdtZW50IGFuZCAoR2V0RGlzdGFuY2VTcXIoTVBvcywgcHJvajEpIDw9IChzZWxmOkdldEhpdEJveChtaW5pb24pICsgcmFkaXVzICsgYnVmZmVyKSBeIDIpIHRoZW4KCQkJCXJldHVybiB0cnVlCgkJCWVuZAoJCWVuZAoKCQlsb2NhbCBwcm9qMiwgcG9pbnRMaW5lLCBpc09uU2VnbWVudCA9IFZlY3RvclBvaW50UHJvamVjdGlvbk9uTGluZVNlZ21lbnQoZnJvbSwgUG9zaXRpb24sIFZlY3RvcihtaW5pb24udmlzaW9uUG9zKSkKCQlpZiBpc09uU2VnbWVudCBhbmQgKEdldERpc3RhbmNlU3FyKG1pbmlvbi52aXNpb25Qb3MsIHByb2oyKSA8PSAoc2VsZjpHZXRIaXRCb3gobWluaW9uKSArIHJhZGl1cyArIGJ1ZmZlcikgXiAyKSB0aGVuCgkJCXJldHVybiB0cnVlCgkJZW5kCgllbmQKCXJldHVybiBmYWxzZQplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkNoZWNrTWluaW9uQ29sbGlzaW9uKHVuaXQsIFBvc2l0aW9uLCBkZWxheSwgcmFkaXVzLCByYW5nZSwgc3BlZWQsIGZyb20sIGRyYXcsIHVwZGF0ZW1hbmFnZXJzKQoJUG9zaXRpb24gPSBWZWN0b3IoUG9zaXRpb24pCglmcm9tID0gZnJvbSBhbmQgVmVjdG9yKGZyb20pIG9yIG15SGVyby52aXNpb25Qb3MKCglpZiB1cGRhdGVtYW5hZ2VycyB0aGVuCgkJc2VsZi5FbmVteU1pbmlvbnMucmFuZ2UgPSByYW5nZSArIDUwMCAqIChkZWxheSArIHJhbmdlIC8gc3BlZWQpCgkJc2VsZi5KdW5nbGVNaW5pb25zLnJhbmdlID0gc2VsZi5FbmVteU1pbmlvbnMucmFuZ2UKCQlzZWxmLk90aGVyTWluaW9ucy5yYW5nZSA9IHNlbGYuRW5lbXlNaW5pb25zLnJhbmdlCgkJc2VsZi5FbmVteU1pbmlvbnM6dXBkYXRlKCkKCQlzZWxmLkp1bmdsZU1pbmlvbnM6dXBkYXRlKCkKCQlzZWxmLk90aGVyTWluaW9uczp1cGRhdGUoKQoJZW5kCgoJbG9jYWwgcmVzdWx0ID0gZmFsc2UKCWlmIF9HLlZQcmVkaWN0aW9uTWVudS5Db2xsaXNpb24uTWluaW9ucyB0aGVuCgkJZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5FbmVteU1pbmlvbnMub2JqZWN0cykgZG8KCQkJaWYgc2VsZjpDaGVja0NvbCh1bml0LCBtaW5pb24sIFBvc2l0aW9uLCBkZWxheSwgcmFkaXVzLCByYW5nZSwgc3BlZWQsIGZyb20sIGRyYXcpIHRoZW4KCQkJCWlmIG5vdCBkcmF3IHRoZW4KCQkJCQlyZXR1cm4gdHJ1ZQoJCQkJZWxzZQoJCQkJCXJlc3VsdCA9IHRydWUKCQkJCWVuZAoJCQllbmQKCQllbmQKCWVuZAoKCWlmIF9HLlZQcmVkaWN0aW9uTWVudS5Db2xsaXNpb24uTW9icyB0aGVuCgkJZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5KdW5nbGVNaW5pb25zLm9iamVjdHMpIGRvCgkJCWlmIHNlbGY6Q2hlY2tDb2wodW5pdCwgbWluaW9uLCBQb3NpdGlvbiwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tLCBkcmF3KSB0aGVuCgkJCQlpZiBub3QgZHJhdyB0aGVuCgkJCQkJcmV0dXJuIHRydWUKCQkJCWVsc2UKCQkJCQlyZXN1bHQgPSB0cnVlCgkJCQllbmQKCQkJZW5kCgkJZW5kCgllbmQKCglpZiBfRy5WUHJlZGljdGlvbk1lbnUuQ29sbGlzaW9uLk90aGVycyB0aGVuCgkJZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5PdGhlck1pbmlvbnMub2JqZWN0cykgZG8KCQkJaWYgbWluaW9uLnRlYW0gfj0gbXlIZXJvLnRlYW0gYW5kIHNlbGY6Q2hlY2tDb2wodW5pdCwgbWluaW9uLCBQb3NpdGlvbiwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tLCBkcmF3KSB0aGVuCgkJCQlpZiBub3QgZHJhdyB0aGVuCgkJCQkJcmV0dXJuIHRydWUKCQkJCWVsc2UKCQkJCQlyZXN1bHQgPSB0cnVlCgkJCQllbmQKCQkJZW5kCgkJZW5kCgllbmQKCglpZiBzZWxmLkNoYW1waW9uQ29sbGlzaW9uIHRoZW4KCQlmb3IgaSwgZW5lbXkgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvCgkJCWlmIHNlbGY6Q2hlY2tDb2wodW5pdCwgZW5lbXksIFBvc2l0aW9uLCBkZWxheSwgcmFkaXVzLCByYW5nZSwgc3BlZWQsIGZyb20sIGRyYXcpIHRoZW4KCQkJCWlmIG5vdCBkcmF3IHRoZW4KCQkJCQlyZXR1cm4gdHJ1ZQoJCQkJZWxzZQoJCQkJCXJlc3VsdCA9IHRydWUKCQkJCWVuZAoJCQllbmQKCQllbmQKCWVuZAoKCWlmIGRyYXcgdGhlbgoJCWxvY2FsIERpcmVjdGlvbiA9IFZlY3RvcihQb3NpdGlvbiAtIGZyb20pOnBlcnBlbmRpY3VsYXIoKTpub3JtYWxpemVkKCkKCQlsb2NhbCBDb2xvciA9IHJlc3VsdCBhbmQgQVJHQigyNTUsIDI1NSwgMCwgMCkgb3IgQVJHQigyNTUsIDAsIDI1NSwgMCkKCQlsb2NhbCBQMXIgPSBWZWN0b3IoZnJvbSkgKyByYWRpdXMgKiBWZWN0b3IoRGlyZWN0aW9uKQoJCWxvY2FsIFAxbCA9IFZlY3Rvcihmcm9tKSAtIHJhZGl1cyAqIFZlY3RvcihEaXJlY3Rpb24pCgkJbG9jYWwgUDJyID0gVmVjdG9yKGZyb20pICsgcmFkaXVzICogRGlyZWN0aW9uIC0gVmVjdG9yKERpcmVjdGlvbik6cGVycGVuZGljdWxhcigpICogR2V0RGlzdGFuY2UoZnJvbSwgUG9zaXRpb24pCgkJbG9jYWwgUDJsID0gVmVjdG9yKGZyb20pIC0gcmFkaXVzICogRGlyZWN0aW9uIC0gVmVjdG9yKERpcmVjdGlvbik6cGVycGVuZGljdWxhcigpICogR2V0RGlzdGFuY2UoZnJvbSwgUG9zaXRpb24pCgoJCXNlbGY6RExpbmUoUDFyLCBQMWwsIENvbG9yKQoJCXNlbGY6RExpbmUoUDFyLCBQMnIsIENvbG9yKQoJCXNlbGY6RExpbmUoUDFsLCBQMmwsIENvbG9yKQoJCXNlbGY6RExpbmUoUDJyLCBQMmwsIENvbG9yKQoJCWlmIG5vdCByZXN1bHQgYW5kIElzS2V5RG93bihzdHJpbmcuYnl0ZSgiVCIpKSB0aGVuCgkJCUNhc3RTcGVsbChfUSwgUG9zaXRpb24ueCwgUG9zaXRpb24ueikKCQllbmQKCWVuZAoKCXJldHVybiBmYWxzZQplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkdldENpcmN1bGFyQ2FzdFBvc2l0aW9uKHVuaXQsIGRlbGF5LCByYWRpdXMsIHJhbmdlLCBzcGVlZCwgZnJvbSwgY29sbGlzaW9uKQoJcmV0dXJuIHNlbGY6R2V0QmVzdENhc3RQb3NpdGlvbih1bml0LCBkZWxheSwgcmFkaXVzLCByYW5nZSwgc3BlZWQsIGZyb20sIGNvbGxpc2lvbiwgImNpcmN1bGFyIikKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpHZXRMaW5lQ2FzdFBvc2l0aW9uKHVuaXQsIGRlbGF5LCByYWRpdXMsIHJhbmdlLCBzcGVlZCwgZnJvbSwgY29sbGlzaW9uKQoJcmV0dXJuIHNlbGY6R2V0QmVzdENhc3RQb3NpdGlvbih1bml0LCBkZWxheSwgcmFkaXVzLCByYW5nZSwgc3BlZWQsIGZyb20sIGNvbGxpc2lvbiwgImxpbmUiKQplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkdldFByZWRpY3RlZFBvcyh1bml0LCBkZWxheSwgc3BlZWQsIGZyb20sIGNvbGxpc2lvbikKCXJldHVybiBzZWxmOkdldEJlc3RDYXN0UG9zaXRpb24odW5pdCwgZGVsYXksIDEsIG1hdGguaHVnZSwgc3BlZWQsIGZyb20sIGNvbGxpc2lvbiwgImNpcmN1bGFyIikKZW5kCgotLVRPRE86IFJlY29kZSB0aGlzIHN0dWZmIGFuZCBtYWtlIGl0IG1vcmUgcmVhZGFibGUgOkQKZnVuY3Rpb24gVlByZWRpY3Rpb246R2V0Q2lyY3VsYXJBT0VDYXN0UG9zaXRpb24odW5pdCwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tLCBjb2xsaXNpb24pCglsb2NhbCBDYXN0UG9zaXRpb24sIEhpdENoYW5jZSwgUG9zaXRpb24gPSBzZWxmOkdldEJlc3RDYXN0UG9zaXRpb24odW5pdCwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tLCBjb2xsaXNpb24sICJjaXJjdWxhciIpCglsb2NhbCBwb2ludHMgPSB7fQoJbG9jYWwgbWFpbkNhc3RQb3NpdGlvbiwgbWFpbkhpdENoYW5jZSwgbWFpblBvc2l0aW9uID0gQ2FzdFBvc2l0aW9uLCBIaXRDaGFuY2UsIFBvc2l0aW9uCgoJdGFibGUuaW5zZXJ0KHBvaW50cywgUG9zaXRpb24pCgoJZm9yIGksIHRhcmdldCBpbiBpcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8KCQlpZiB0YXJnZXQubmV0d29ya0lEIH49IHVuaXQubmV0d29ya0lEIGFuZCBWYWxpZFRhcmdldCh0YXJnZXQsIHJhbmdlICogMS41KSB0aGVuCgkJCUNhc3RQb3NpdGlvbiwgSGl0Q2hhbmNlLCBQb3NpdGlvbiA9IHNlbGY6R2V0QmVzdENhc3RQb3NpdGlvbih0YXJnZXQsIGRlbGF5LCByYWRpdXMsIHJhbmdlLCBzcGVlZCwgZnJvbSwgY29sbGlzaW9uLCAiY2lyY3VsYXIiKQoJCQlpZiBHZXREaXN0YW5jZShmcm9tLCBQb3NpdGlvbikgPCAocmFuZ2UgKyByYWRpdXMpIGFuZCAoSGl0Y2hhbmNlIH49IC0xIG9yIG5vdCBjb2xsaXNpb24pIHRoZW4KCQkJCXRhYmxlLmluc2VydChwb2ludHMsIFBvc2l0aW9uKQoJCQllbmQKCQllbmQKCWVuZAoKCXdoaWxlICNwb2ludHMgPiAxIGRvCgkJbG9jYWwgTWVjID0gTUVDKHBvaW50cykKCQlsb2NhbCBDaXJjbGUgPSBNZWM6Q29tcHV0ZSgpCgoJCWlmIENpcmNsZS5yYWRpdXMgPD0gcmFkaXVzICsgc2VsZjpHZXRIaXRCb3godW5pdCkgLSA4IHRoZW4KCQkJcmV0dXJuIENpcmNsZS5jZW50ZXIsIG1haW5IaXRDaGFuY2UsICNwb2ludHMKCQllbmQKCgkJbG9jYWwgbWF4ZGlzdCA9IC0xCgkJbG9jYWwgbWF4ZGlzdGluZGV4ID0gMAoKCQlmb3IgaT0yLCAjcG9pbnRzIGRvCgkJCWxvY2FsIGQgPSBHZXREaXN0YW5jZVNxcihwb2ludHNbaV0sIHBvaW50c1sxXSkKCQkJaWYgZCA+IG1heGRpc3Qgb3IgbWF4ZGlzdCA9PSAtMSB0aGVuCgkJCQltYXhkaXN0aW5kZXggPSBpCgkJCQltYXhkaXN0ID0gZAoJCQllbmQKCQllbmQKCgkJdGFibGUucmVtb3ZlKHBvaW50cywgbWF4ZGlzdGluZGV4KQoJZW5kCgoJcmV0dXJuIG1haW5DYXN0UG9zaXRpb24sIG1haW5IaXRDaGFuY2UsICNwb2ludHMsIG1haW5Qb3NpdGlvbgplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkdldExpbmVBT0VDYXN0UG9zaXRpb24odW5pdCwgZGVsYXksIHJhZGl1cywgcmFuZ2UsIHNwZWVkLCBmcm9tKQoJbG9jYWwgQ2FzdFBvc2l0aW9uLCBIaXRDaGFuY2UsIFBvc2l0aW9uID0gc2VsZjpHZXRCZXN0Q2FzdFBvc2l0aW9uKHVuaXQsIGRlbGF5LCByYWRpdXMsIHJhbmdlLCBzcGVlZCwgZnJvbSwgZmFsc2UsICJsaW5lIikKCWxvY2FsIHBvaW50cyA9IHt9Cglsb2NhbCBQb3NpdGlvbnMgPSB7fQoJbG9jYWwgbWFpbkNhc3RQb3NpdGlvbiwgbWFpbkhpdENoYW5jZSA9IENhc3RQb3NpdGlvbiwgSGl0Q2hhbmNlCgoJdGFibGUuaW5zZXJ0KFBvc2l0aW9ucywge3VuaXQgPSB1bml0LCBIaXRDaGFuY2UgPSBIaXRDaGFuY2UsIFBvc2l0aW9uID0gUG9zaXRpb24sIENhc3RQb3NpdGlvbiA9IENhc3RQb3NpdGlvbn0pCgl0YWJsZS5pbnNlcnQocG9pbnRzLCBQb3NpdGlvbikKCglyYW5nZSA9IHJhbmdlIGFuZCByYW5nZSAtIDQgb3IgMjAwMDAKCXJhZGl1cyA9IHJhZGl1cyA9PSAwIGFuZCAxIG9yIChyYWRpdXMgKyBzZWxmOkdldEhpdEJveCh1bml0KSkgLSA0Cglmcm9tID0gZnJvbSBhbmQgVmVjdG9yKGZyb20pIG9yIFZlY3RvcihteUhlcm8udmlzaW9uUG9zKQoKCWxvY2FsIGZ1bmN0aW9uIENpcmNsZUNpcmNsZUludGVyc2VjdGlvbihDMSwgQzIsIFIxLCBSMikKCQlsb2NhbCBEID0gR2V0RGlzdGFuY2UoQzEsIEMyKQoJCWxvY2FsIEEgPSAoUjEgKiBSMSAtIFIyICogUjIgKyBEICogRCApIC8gKDIgKiBEKQoJCWxvY2FsIEggPSBtYXRoLnNxcnQoUjEgKiBSMSAtIEEgKiBBKTsKCQlsb2NhbCBEaXJlY3Rpb24gPSAoVmVjdG9yKEMyKSAtIFZlY3RvcihDMSkpOm5vcm1hbGl6ZWQoKQoJCWxvY2FsIFBBID0gVmVjdG9yKEMxKSArIEEgKiBEaXJlY3Rpb24KCgkJbG9jYWwgUzEgPSBQQSArIEggKiBEaXJlY3Rpb246cGVycGVuZGljdWxhcigpCgkJbG9jYWwgUzIgPSBQQSAtIEggKiBEaXJlY3Rpb246cGVycGVuZGljdWxhcigpCgoJCXJldHVybiBTMSwgUzIKCWVuZAoKCWxvY2FsIGZ1bmN0aW9uIEdldFBvc2libGVQb2ludHMoZnJvbSwgcG9zLCB3aWR0aCwgcmFuZ2UpCgkJbG9jYWwgbWlkZGxlcG9pbnQgPSAoZnJvbSArIHBvcykvMgoJCWxvY2FsIFAxLCBQMiA9IENpcmNsZUNpcmNsZUludGVyc2VjdGlvbihmcm9tLCBtaWRkbGVwb2ludCwgd2lkdGgsIEdldERpc3RhbmNlKG1pZGRsZXBvaW50LCBmcm9tKSkKCgkJbG9jYWwgVjEgPSAoUDEgLSBmcm9tKQoJCWxvY2FsIFYyID0gKFAyIC0gZnJvbSkKCgkJcmV0dXJuIGZyb20gKyByYW5nZSAqIChwb3MgLSBWMSAtIGZyb20pOm5vcm1hbGl6ZWQoKSwgZnJvbSArIHJhbmdlICogKHBvcyAtIFYyIC0gZnJvbSk6bm9ybWFsaXplZCgpCgllbmQKCglsb2NhbCBmdW5jdGlvbiBDb3VudEhpdHMoUDEsIFAyLCB3aWR0aCwgcG9pbnRzKQoJCWxvY2FsIGhpdHMgPSAwCgkJbG9jYWwgaGl0dCA9IHt9CgkJd2lkdGggPSB3aWR0aCArIDIKCQlmb3IgaSwgcG9pbnQgaW4gaXBhaXJzKHBvaW50cykgZG8KCQkJbG9jYWwgcG9pbnRTZWdtZW50LCBwb2ludExpbmUsIGlzT25TZWdtZW50ID0gVmVjdG9yUG9pbnRQcm9qZWN0aW9uT25MaW5lU2VnbWVudChQMSwgUDIsIHBvaW50KQoJCQlpZiBpc09uU2VnbWVudCBhbmQgR2V0RGlzdGFuY2VTcXIocG9pbnRTZWdtZW50LCBwb2ludCkgPD0gd2lkdGggKiB3aWR0aCB0aGVuCgkJCQloaXRzID0gaGl0cyArIDEKCQkJCXRhYmxlLmluc2VydChoaXR0LCBwb2ludCkKCQkJZWxzZWlmIGkgPT0gMSB0aGVuCgkJCQlyZXR1cm4gLTEKCQkJZW5kCgkJZW5kCgkJcmV0dXJuIGhpdHMsIGhpdHQKCWVuZAoKCWZvciBpLCB0YXJnZXQgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvCgkJaWYgdGFyZ2V0Lm5ldHdvcmtJRCB+PSB1bml0Lm5ldHdvcmtJRCBhbmQgVmFsaWRUYXJnZXQodGFyZ2V0LCByYW5nZSAqIDEuNSkgdGhlbgoJCQlDYXN0UG9zaXRpb24sIEhpdENoYW5jZSwgUG9zaXRpb24gPSBzZWxmOkdldEJlc3RDYXN0UG9zaXRpb24odGFyZ2V0LCBkZWxheSwgcmFkaXVzLCByYW5nZSwgc3BlZWQsIGZyb20sIGZhbHNlLCAibGluZSIpCgkJCWlmIEdldERpc3RhbmNlKGZyb20sIFBvc2l0aW9uKSA8IChyYW5nZSArIHJhZGl1cykgdGhlbgoJCQkJdGFibGUuaW5zZXJ0KHBvaW50cywgUG9zaXRpb24pCgkJCQl0YWJsZS5pbnNlcnQoUG9zaXRpb25zLCB7dW5pdCA9IHRhcmdldCwgSGl0Q2hhbmNlID0gSGl0Q2hhbmNlLCBQb3NpdGlvbiA9IFBvc2l0aW9uLCBDYXN0UG9zaXRpb24gPSBDYXN0UG9zaXRpb259KQoJCQllbmQKCQllbmQKCWVuZAoKCWxvY2FsIE1heEhpdCA9IDEKCWxvY2FsIE1heEhpdFBvcwoKCWlmICNwb2ludHMgPiAxIHRoZW4KCQlmb3IgaSwgY2FuZGlkYXRlIGluIGlwYWlycyhwb2ludHMpIGRvCgkJCWxvY2FsIEMxLCBDMiA9IEdldFBvc2libGVQb2ludHMoZnJvbSwgcG9pbnRzW2ldLCByYWRpdXMgLSAyMCwgcmFuZ2UpCgkJCWxvY2FsIGhpdHMsIE1Qb2ludHMxID0gQ291bnRIaXRzKGZyb20sIEMxLCByYWRpdXMsIHBvaW50cykKCQkJbG9jYWwgaGl0czIsIE1Qb2ludHMyID0gQ291bnRIaXRzKGZyb20sIEMyLCByYWRpdXMsIHBvaW50cykKCQkJaWYgaGl0cyA+PSBNYXhIaXQgdGhlbgoJCQkJTWF4SGl0UG9zID0gQzEKCQkJCU1heEhpdCA9IGhpdHMKCQkJCU1heEhpdFBvaW50cyA9IE1Qb2ludHMxCgkJCWVuZAoJCQlpZiBoaXRzMiA+PSBNYXhIaXQgdGhlbgoJCQkJTWF4SGl0UG9zID0gQzIKCQkJCU1heEhpdCA9IGhpdHMyCgkJCQlNYXhIaXRQb2ludHMgPSBNUG9pbnRzMgoJCQllbmQKCQllbmQKCWVuZAoKCWlmIE1heEhpdCA+IDEgdGhlbgoJCS0tY2VudGVyIHRoZSBsaW5lCgkJbG9jYWwgbWF4ZGlzdCA9IC0xCgkJbG9jYWwgcDEKCQlsb2NhbCBwMgoJCWZvciBpLCBoaXRwIGluIGlwYWlycyhNYXhIaXRQb2ludHMpIGRvCgkJCWZvciBvLCBoaXRwMiBpbiBpcGFpcnMoTWF4SGl0UG9pbnRzKSBkbwoJCQkJbG9jYWwgU3RhcnRQLCBFbmRQID0gVmVjdG9yKGZyb20pLCAoVmVjdG9yKGhpdHApICsgVmVjdG9yKGhpdHAyKSkgLyAyCgkJCQlsb2NhbCBwb2ludFNlZ21lbnQsIHBvaW50TGluZSwgaXNPblNlZ21lbnQgPSBWZWN0b3JQb2ludFByb2plY3Rpb25PbkxpbmVTZWdtZW50KFN0YXJ0UCwgRW5kUCwgaGl0cCkKCQkJCWxvY2FsIHBvaW50U2VnbWVudDIsIHBvaW50TGluZTIsIGlzT25TZWdtZW50MiA9IFZlY3RvclBvaW50UHJvamVjdGlvbk9uTGluZVNlZ21lbnQoU3RhcnRQLCBFbmRQLCBoaXRwMikKCgkJCQlsb2NhbCBkaXN0ID0gR2V0RGlzdGFuY2VTcXIoaGl0cCwgcG9pbnRMaW5lKSArIEdldERpc3RhbmNlU3FyKGhpdHAyLCBwb2ludExpbmUyKQoJCQkJaWYgZGlzdCA+PSBtYXhkaXN0IHRoZW4KCQkJCQltYXhkaXN0ID0gZGlzdAoJCQkJCXAxID0gaGl0cAoJCQkJCXAyID0gaGl0cDIKCQkJCWVuZAoJCQllbmQKCQllbmQKCgkJaWYgc2VsZi5SZXR1cm5IaXRUYWJsZSB0aGVuCgkJCWZvciBpID0gI1Bvc2l0aW9ucywgMSwgLTEgZG8KCQkJCWxvY2FsIHBvaW50U2VnbWVudCwgcG9pbnRMaW5lLCBpc09uU2VnbWVudCA9IFZlY3RvclBvaW50UHJvamVjdGlvbk9uTGluZVNlZ21lbnQoVmVjdG9yKGZyb20pLCAocDEgKyBwMikgLyAyLCBQb3NpdGlvbnNbaV0uUG9zaXRpb24pCgkJCQlpZiAobm90IGlzT25TZWdtZW50KSBvciAoR2V0RGlzdGFuY2VTcXIocG9pbnRMaW5lLCBQb3NpdGlvbnNbaV0uUG9zaXRpb24pID4gKHJhZGl1cyArIDUpXjIpIHRoZW4KCQkJCQl0YWJsZS5yZW1vdmUoUG9zaXRpb25zLCBpKQoJCQkJZW5kCgkJCWVuZAoJCWVuZAoKCQlyZXR1cm4gKHAxICsgcDIpIC8gMiwgbWFpbkhpdENoYW5jZSwgTWF4SGl0LCBQb3NpdGlvbnMKCWVsc2UKCQlyZXR1cm4gbWFpbkNhc3RQb3NpdGlvbiwgbWFpbkhpdENoYW5jZSwgMSwgUG9zaXRpb25zCgllbmQKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpHZXRDb25lQU9FQ2FzdFBvc2l0aW9uKHVuaXQsIGRlbGF5LCBhbmdsZSwgcmFuZ2UsIHNwZWVkLCBmcm9tKQoJcmFuZ2UgPSByYW5nZSBhbmQgcmFuZ2UgLSA0IG9yIDIwMDAwCglyYWRpdXMgPSAxCglmcm9tID0gZnJvbSBhbmQgVmVjdG9yKGZyb20pIG9yIFZlY3RvcihteUhlcm8udmlzaW9uUG9zKQoJYW5nbGUgPSAoYW5nbGUgPCBtYXRoLnBpICogMikgYW5kIGFuZ2xlIG9yIChhbmdsZSAqIG1hdGgucGkgLyAxODApCgoJbG9jYWwgQ2FzdFBvc2l0aW9uLCBIaXRDaGFuY2UsIFBvc2l0aW9uID0gc2VsZjpHZXRCZXN0Q2FzdFBvc2l0aW9uKHVuaXQsIGRlbGF5LCByYWRpdXMsIHJhbmdlLCBzcGVlZCwgZnJvbSwgZmFsc2UsICJsaW5lIikKCWxvY2FsIHBvaW50cyA9IHt9Cglsb2NhbCBtYWluQ2FzdFBvc2l0aW9uLCBtYWluSGl0Q2hhbmNlID0gQ2FzdFBvc2l0aW9uLCBIaXRDaGFuY2UKCgl0YWJsZS5pbnNlcnQocG9pbnRzLCBWZWN0b3IoUG9zaXRpb24pIC0gVmVjdG9yKGZyb20pKQoKCWxvY2FsIGZ1bmN0aW9uIENvdW50VmVjdG9yc0JldHdlZW4oVjEsIFYyLCBwb2ludHMpCgkJbG9jYWwgcmVzdWx0ID0gMAoJCWxvY2FsIGhpdHBvaW50cyA9IHt9CgkJZm9yIGksIHRlc3QgaW4gaXBhaXJzKHBvaW50cykgZG8KCQkJbG9jYWwgTlZlY3RvciA9IFZlY3RvcihWMSk6Y3Jvc3NQKHRlc3QpCgkJCWxvY2FsIE5WZWN0b3IyID0gVmVjdG9yKHRlc3QpOmNyb3NzUChWMikKCQkJaWYgTlZlY3Rvci55ID49IDAgYW5kIE5WZWN0b3IyLnkgPj0gMCB0aGVuCgkJCQlyZXN1bHQgPSByZXN1bHQgKyAxCgkJCQl0YWJsZS5pbnNlcnQoaGl0cG9pbnRzLCB0ZXN0KQoJCQllbHNlaWYgaSA9PSAxIHRoZW4KCQkJCXJldHVybiAtMSAtLWRvZXNudCBoaXQgdGhlIG1haW4gdGFyZ2V0CgkJCWVuZAoJCWVuZAoJCXJldHVybiByZXN1bHQsIGhpdHBvaW50cwoJZW5kCgoJbG9jYWwgZnVuY3Rpb24gQ2hlY2tIaXQocG9zaXRpb24sIGFuZ2xlLCBwb2ludHMpCgkJbG9jYWwgZGlyZWN0aW9uID0gVmVjdG9yKHBvc2l0aW9uKTpub3JtYWxpemVkKCkKCQlsb2NhbCB2MSA9IFZlY3Rvcihwb3NpdGlvbik6cm90YXRlZCgwLCAtYW5nbGUgLyAyLCAwKQoJCWxvY2FsIHYyID0gVmVjdG9yKHBvc2l0aW9uKTpyb3RhdGVkKDAsIGFuZ2xlIC8gMiwgMCkKCQlyZXR1cm4gQ291bnRWZWN0b3JzQmV0d2Vlbih2MSwgdjIsIHBvaW50cykKCWVuZAoKCWZvciBpLCB0YXJnZXQgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvCgkJaWYgdGFyZ2V0Lm5ldHdvcmtJRCB+PSB1bml0Lm5ldHdvcmtJRCBhbmQgVmFsaWRUYXJnZXQodGFyZ2V0LCByYW5nZSAqIDEuNSkgdGhlbgoJCQlDYXN0UG9zaXRpb24sIEhpdENoYW5jZSwgUG9zaXRpb24gPSBzZWxmOkdldEJlc3RDYXN0UG9zaXRpb24odGFyZ2V0LCBkZWxheSwgcmFkaXVzLCByYW5nZSwgc3BlZWQsIGZyb20sIGZhbHNlLCAibGluZSIpCgkJCWlmIEdldERpc3RhbmNlU3FyKGZyb20sIFBvc2l0aW9uKSA8IHJhbmdlICogcmFuZ2UgdGhlbgoJCQkJdGFibGUuaW5zZXJ0KHBvaW50cywgVmVjdG9yKFBvc2l0aW9uKSAtIFZlY3Rvcihmcm9tKSkKCQkJZW5kCgkJZW5kCgllbmQKCglsb2NhbCBNYXhIaXRQb3MKCWxvY2FsIE1heEhpdCA9IDEKCWxvY2FsIE1heEhpdFBvaW50cyA9IHt9CgoJaWYgI3BvaW50cyA+IDEgdGhlbgoJCWZvciBpLCBwb2ludCBpbiBpcGFpcnMocG9pbnRzKSBkbwoJCQlsb2NhbCBwb3MxID0gVmVjdG9yKHBvaW50KTpyb3RhdGVkKDAsIGFuZ2xlIC8gMiwgMCkKCQkJbG9jYWwgcG9zMiA9IFZlY3Rvcihwb2ludCk6cm90YXRlZCgwLCAtIGFuZ2xlIC8gMiwgMCkKCgkJCWxvY2FsIGhpdHMsIHBvaW50czEgPSBDaGVja0hpdChwb3MxLCBhbmdsZSwgcG9pbnRzKQoJCQlsb2NhbCBoaXRzMiwgcG9pbnRzMiA9IENoZWNrSGl0KHBvczIsIGFuZ2xlLCBwb2ludHMpCgoJCQlpZiBoaXRzID49IE1heEhpdCB0aGVuCgkJCQlNYXhIaXRQb3MgPSBDMQoJCQkJTWF4SGl0ID0gaGl0cwoJCQkJTWF4SGl0UG9pbnRzID0gcG9pbnRzMQoJCQllbmQKCQkJaWYgaGl0czIgPj0gTWF4SGl0IHRoZW4KCQkJCU1heEhpdFBvcyA9IEMyCgkJCQlNYXhIaXQgPSBoaXRzMgoJCQkJTWF4SGl0UG9pbnRzID0gcG9pbnRzMgoJCQllbmQKCQllbmQKCWVuZAoKCWlmIE1heEhpdCA+IDEgdGhlbgoJCS0tQ2VudGVyIHRoZSBjb25lCgkJbG9jYWwgbWF4YW5nbGUgPSAtMQoJCWxvY2FsIHAxCgkJbG9jYWwgcDIKCQlmb3IgaSwgaGl0cCBpbiBpcGFpcnMoTWF4SGl0UG9pbnRzKSBkbwoJCQlmb3IgbywgaGl0cDIgaW4gaXBhaXJzKE1heEhpdFBvaW50cykgZG8KCQkJCWxvY2FsIGNhbmdsZSA9IFZlY3RvcigpOmFuZ2xlQmV0d2VlbihoaXRwMiwgaGl0cCkKCQkJCWlmIGNhbmdsZSA+IG1heGFuZ2xlIHRoZW4KCQkJCQltYXhhbmdsZSA9IGNhbmdsZQoJCQkJCXAxID0gaGl0cAoJCQkJCXAyID0gaGl0cDIKCQkJCWVuZAoJCQllbmQKCQllbmQKCgoJCXJldHVybiBWZWN0b3IoZnJvbSkgKyByYW5nZSAqICgoKHAxICsgcDIpIC8gMikpOm5vcm1hbGl6ZWQoKSwgbWFpbkhpdENoYW5jZSwgTWF4SGl0CgllbHNlCgkJcmV0dXJuIG1haW5DYXN0UG9zaXRpb24sIG1haW5IaXRDaGFuY2UsIDEKCWVuZAplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOk9uVGljaygpCgktLVtbRGVsZXRlIHRoZSBvbGQgc2F2ZWQgV2F5cG9pbnRzXV0KCWlmIHNlbGYubGFzdGljayA9PSBuaWwgb3Igc2VsZjpHZXRUaW1lKCkgLSBzZWxmLmxhc3RpY2sgPiAwLjIgdGhlbgoJCXNlbGYubGFzdGljayA9IHNlbGY6R2V0VGltZSgpCgkJZm9yIE5JRCwgVGFyZ2V0V2F5cG9pbnRzIGluIHBhaXJzKHNlbGYuVGFyZ2V0c1dheXBvaW50cykgZG8KCQkJbG9jYWwgaSA9IDEKCQkJd2hpbGUgaSA8PSAjc2VsZi5UYXJnZXRzV2F5cG9pbnRzW05JRF0gZG8KCQkJCWlmIHNlbGYuVGFyZ2V0c1dheXBvaW50c1tOSURdW2ldWyJ0aW1lIl0gKyBzZWxmLldheXBvaW50c1RpbWUgPCBzZWxmOkdldFRpbWUoKSB0aGVuCgkJCQkJdGFibGUucmVtb3ZlKHNlbGYuVGFyZ2V0c1dheXBvaW50c1tOSURdLCBpKQoJCQkJZWxzZQoJCQkJCWkgPSBpICsgMQoJCQkJZW5kCgkJCWVuZAoJCWVuZAoKCQlmb3IgaSwgdW5pdCBpbiBpcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8KCQkJZm9yIGogPSAxLCB1bml0LmJ1ZmZDb3VudCBkbwoJCQkJbG9jYWwgYnVmZiA9IHVuaXQ6Z2V0QnVmZihqKQoJCQkJaWYgYnVmZi52YWxpZCBhbmQgYnVmZi5uYW1lID09ICJTdHVuIiB0aGVuCgkJCQkJaWYgc2VsZi5UYXJnZXRzSW1tb2JpbGVbdW5pdC5uZXR3b3JrSURdIGFuZCBzZWxmLlRhcmdldHNJbW1vYmlsZVt1bml0Lm5ldHdvcmtJRF0gPCBzZWxmOkdldFRpbWUoKSB0aGVuCgkJCQkJCXNlbGYuVGFyZ2V0c0ltbW9iaWxlW3VuaXQubmV0d29ya0lEXSA9IHNlbGY6R2V0VGltZSgpICsgKGJ1ZmYuZW5kVC1idWZmLnN0YXJ0VCkKCQkJCQllbmQKCQkJCWVuZAoJCQllbmQKCQllbmQKCWVuZAplbmQKCi0tW1tEcmF3aW5nIGZ1bmN0aW9ucyBmb3IgZGVidWc6IF1dCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkRyYXdTYXZlZFdheXBvaW50cyhvYmplY3QsIHRpbWUpCglsb2NhbCBXYXlwb2ludHMgPSBzZWxmOkdldFdheXBvaW50cyhvYmplY3QubmV0d29ya0lELCBzZWxmOkdldFRpbWUoKSAtIHRpbWUpCglmb3IgaSwgd2F5cG9pbnQgaW4gaXBhaXJzKFdheXBvaW50cykgZG8KCQlEcmF3Q2lyY2xlM0Qod2F5cG9pbnQud2F5cG9pbnQueCwgbXlIZXJvLnksIHdheXBvaW50LndheXBvaW50LnksIDEwMCwgMiwgQVJHQigyNTUsIDI1NSwgMjU1LCAyNTUpKQoJCURyYXdUZXh0M0QodG9zdHJpbmcoaSksIHdheXBvaW50LndheXBvaW50LngsIG15SGVyby55LCB3YXlwb2ludC53YXlwb2ludC55LCAxMywgQVJHQigyNTUsIDI1NSwgMjU1LCAyNTUpLCB0cnVlKQoJCURyYXdDaXJjbGUzRCh3YXlwb2ludC51bml0cG9zLngsIG15SGVyby55LCB3YXlwb2ludC51bml0cG9zLnksIDEwMCwgMiwgQVJHQigyNTUsIDI1NSwgMCwgMCkpCgllbmQKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpEcmF3SGl0Qm94KG9iamVjdCkKCURyYXdDaXJjbGUzRChvYmplY3QueCwgb2JqZWN0LnksIG9iamVjdC56LCBzZWxmOkdldEhpdEJveChvYmplY3QpLCAxLCBBUkdCKDI1NSwgMjU1LCAyNTUsIDI1NSkpCglpZiBvYmplY3QudmlzaW9uUG9zIHRoZW4KCQlEcmF3Q2lyY2xlM0Qob2JqZWN0LnZpc2lvblBvcy54LCBvYmplY3QudmlzaW9uUG9zLnksIG9iamVjdC52aXNpb25Qb3Mueiwgc2VsZjpHZXRIaXRCb3gob2JqZWN0KSwgMSwgQVJHQigyNTUsIDAsIDI1NSwgMCkpCgllbmQKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpETGluZShGcm9tLCBUbywgQ29sb3IpCglEcmF3TGluZTNEKEZyb20ueCwgRnJvbS55LCBGcm9tLnosIFRvLngsIFRvLnksIFRvLnosIDEsIENvbG9yKQplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOk9uRHJhdygpCglpZiBzZWxmLnNob3dkZXZtb2RlIGFuZCBfRy5WUHJlZGljdGlvbk1lbnUuRGV2ZWxvcGVycy5EZWJ1ZyB0aGVuCgkJTGFzdEdldFRhcmdldCA9IExhc3RHZXRUYXJnZXQgb3IgbXlIZXJvCgkJbG9jYWwgdGFyZ2V0ID0gR2V0VGFyZ2V0KCkgb3IgTGFzdEdldFRhcmdldAoJCUxhc3RHZXRUYXJnZXQgPSB0YXJnZXQKCQlmb3IgaSwgZW5lbXkgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvCgkJCXNlbGY6RHJhd0hpdEJveChlbmVteSkKCQllbmQKCQlpZiBfRy5WUHJlZGljdGlvbk1lbnUuRGV2ZWxvcGVycy5TQyB0aGVuCgkJCXNlbGYuRW5lbXlNaW5pb25zOnVwZGF0ZSgpCgkJCXNlbGYuSnVuZ2xlTWluaW9uczp1cGRhdGUoKQoJCQlzZWxmLk90aGVyTWluaW9uczp1cGRhdGUoKQoJCQlzZWxmOkNoZWNrTWluaW9uQ29sbGlzaW9uKFZlY3RvcihteUhlcm8udmlzaW9uUG9zKSArIDEwNTAgKiAoVmVjdG9yKG1vdXNlUG9zKSAtIFZlY3RvcihteUhlcm8udmlzaW9uUG9zKSk6bm9ybWFsaXplZCgpLCAwLjI1LCA3MCwgMTA1MCwgMTgwMCwgbXlIZXJvLnZpc2lvblBvcywgdHJ1ZSkKCQllbmQKCQlpZiB0YXJnZXQgdGhlbgoJCQlzZWxmOkRyYXdIaXRCb3godGFyZ2V0KQoJCQlsb2NhbCBDYXN0UG9zaXRpb24sICBIaXRDaGFuY2UsICBQb3NpdGlvbiA9IHNlbGY6R2V0Q2lyY3VsYXJDYXN0UG9zaXRpb24odGFyZ2V0LCAwLjYsIDcwLCA5MDAsIG1hdGguaHVnZSkKCQkJaWYgSGl0Q2hhbmNlID49IC0xIHRoZW4KCQkJCURyYXdUZXh0M0QodG9zdHJpbmcoSGl0Q2hhbmNlKSwgQ2FzdFBvc2l0aW9uLngsIG15SGVyby55LCBDYXN0UG9zaXRpb24ueiwgNDAsIEFSR0IoMjU1LCAyNTUsIDI1NSwgMjU1KSwgdHJ1ZSkKCQkJCURyYXdDaXJjbGUzRChQb3NpdGlvbi54LCBteUhlcm8ueSwgUG9zaXRpb24ueiwgNzAgKyBzZWxmOkdldEhpdEJveCh0YXJnZXQpLCAxLCBBUkdCKDI1NSwgMCwgMjU1LCAwKSkKCQkJCURyYXdDaXJjbGUzRChDYXN0UG9zaXRpb24ueCwgbXlIZXJvLnksIENhc3RQb3NpdGlvbi56LCA3MCArIHNlbGY6R2V0SGl0Qm94KHRhcmdldCksIDEsIEFSR0IoMjU1LCAyNTUsIDAsIDApKQoJCQllbmQKCQkJbG9jYWwgd2F5cG9pbnQgPSBzZWxmOkdldEN1cnJlbnRXYXlQb2ludHModGFyZ2V0KQoJCQlmb3IgaSAgPSAxLCAjd2F5cG9pbnQtMSBkbwoJCQkJc2VsZjpETGluZShWZWN0b3Iod2F5cG9pbnRbaV0ueCwgbXlIZXJvLnksIHdheXBvaW50W2ldLnkpLCBWZWN0b3Iod2F5cG9pbnRbaSsxXS54LCBteUhlcm8ueSwgd2F5cG9pbnRbaSsxXS55KSwgQVJHQigyNTUsMjU1LDI1NSwyNTUpKQoJCQllbmQKCQllbmQKCWVuZAplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkdldEhpdEJveChvYmplY3QpCglpZiBzZWxmLm5vaGl0Ym94bW9kZSBhbmQgb2JqZWN0LnR5cGUgYW5kIG9iamVjdC50eXBlID09IG15SGVyby50eXBlIHRoZW4KCQlyZXR1cm4gMAoJZW5kCglyZXR1cm4gKHNlbGYuaGl0Ym94ZXNbb2JqZWN0LmNoYXJOYW1lXSB+PSBuaWwgYW5kIHNlbGYuaGl0Ym94ZXNbb2JqZWN0LmNoYXJOYW1lXSB+PSAwKSBhbmQgc2VsZi5oaXRib3hlc1tvYmplY3QuY2hhck5hbWVdICBvciA2NQplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkdldFByb2plY3RpbGVTcGVlZCh1bml0KQoJcmV0dXJuIHNlbGYucHJvamVjdGlsZXNwZWVkc1t1bml0LmNoYXJOYW1lXSBhbmQgc2VsZi5wcm9qZWN0aWxlc3BlZWRzW3VuaXQuY2hhck5hbWVdIG9yIG1hdGguaHVnZQplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOkNhbGNEYW1hZ2VPZkF0dGFjayhzb3VyY2UsIHRhcmdldCwgc3BlbGwsIGFkZGl0aW9uYWxEYW1hZ2UpCgktLSByZWFkIGluaXRpYWwgYXJtb3IgYW5kIGRhbWFnZSB2YWx1ZXMKCWxvY2FsIGFybW9yUGVuUGVyY2VudCA9IHNvdXJjZS5hcm1vclBlblBlcmNlbnQKCWxvY2FsIGFybW9yUGVuID0gc291cmNlLmFybW9yUGVuCglsb2NhbCB0b3RhbERhbWFnZSA9IHNvdXJjZS50b3RhbERhbWFnZSArIChhZGRpdGlvbmFsRGFtYWdlIG9yIDApCglsb2NhbCBkYW1hZ2VNdWx0aXBsaWVyID0gc3BlbGwubmFtZTpmaW5kKCJDcml0QXR0YWNrIikgYW5kIDIgb3IgMQoKCS0tIG1pbmlvbnMgZ2l2ZSB3cm9uZyB2YWx1ZXMgZm9yIGFybW9yUGVuIGFuZCBhcm1vclBlblBlcmNlbnQKCWlmIHNvdXJjZS50eXBlID09ICJvYmpfQUlfTWluaW9uIiB0aGVuCgkJYXJtb3JQZW5QZXJjZW50ID0gMQoJZWxzZWlmIHNvdXJjZS50eXBlID09ICJvYmpfQUlfVHVycmV0IiB0aGVuCgkJYXJtb3JQZW5QZXJjZW50ID0gMC43CgllbmQKCgktLSB0dXJyZXRzIGlnbm9yZSBhcm1vciBwZW5ldHJhdGlvbiBhbmQgY3JpdGljYWwgYXR0YWNrcwoJaWYgdGFyZ2V0LnR5cGUgPT0gIm9ial9BSV9UdXJyZXQiIHRoZW4KCQlhcm1vclBlblBlcmNlbnQgPSAxCgkJYXJtb3JQZW4gPSAwCgkJZGFtYWdlTXVsdGlwbGllciA9IDEKCWVuZAoKCS0tIGNhbGN1bGF0ZSBpbml0aWFsIGRhbWFnZSBtdWx0aXBsaWVyIGZvciBuZWdhdGl2ZSBhbmQgcG9zaXRpdmUgYXJtb3IKCglsb2NhbCB0YXJnZXRBcm1vciA9ICh0YXJnZXQuYXJtb3IgKiBhcm1vclBlblBlcmNlbnQpIC0gYXJtb3JQZW4KCWlmIHRhcmdldEFybW9yIDwgMCB0aGVuIC0tIG1pbmlvbnMgY2FuJ3QgZ28gYmVsb3cgMCBhcm1vci4KCQktLWRhbWFnZU11bHRpcGxpZXIgPSAoMiAtIDEwMCAvICgxMDAgLSB0YXJnZXRBcm1vcikpICogZGFtYWdlTXVsdGlwbGllcgoJCWRhbWFnZU11bHRpcGxpZXIgPSAxICogZGFtYWdlTXVsdGlwbGllcgoJZWxzZQoJCWRhbWFnZU11bHRpcGxpZXIgPSAxMDAgLyAoMTAwICsgdGFyZ2V0QXJtb3IpICogZGFtYWdlTXVsdGlwbGllcgoJZW5kCgoJLS0gdXNlIGFiaWxpdHkgcG93ZXIgb3IgYWQgYmFzZWQgZGFtYWdlIG9uIHR1cnJldHMKCWlmIHNvdXJjZS50eXBlID09ICJvYmpfQUlfSGVybyIgYW5kIHRhcmdldC50eXBlID09ICJvYmpfQUlfVHVycmV0IiB0aGVuCgkJdG90YWxEYW1hZ2UgPSBtYXRoLm1heChzb3VyY2UudG90YWxEYW1hZ2UsIHNvdXJjZS5kYW1hZ2UgKyAwLjQgKiBzb3VyY2UuYXApCgllbmQKCgktLSBtaW5pb25zIGRlYWwgbGVzcyBkYW1hZ2UgdG8gZW5lbXkgaGVyb3MKCWlmIHNvdXJjZS50eXBlID09ICJvYmpfQUlfTWluaW9uIiBhbmQgdGFyZ2V0LnR5cGUgPT0gIm9ial9BSV9IZXJvIiBhbmQgc291cmNlLnRlYW0gfj0gVEVBTV9ORVVUUkFMIHRoZW4KCQlkYW1hZ2VNdWx0aXBsaWVyID0gMC42MCAqIGRhbWFnZU11bHRpcGxpZXIKCWVuZAoKCS0tIGhlcm9zIGRlYWwgbGVzcyBkYW1hZ2UgdG8gdHVycmV0cwoJaWYgc291cmNlLnR5cGUgPT0gIm9ial9BSV9IZXJvIiBhbmQgdGFyZ2V0LnR5cGUgPT0gIm9ial9BSV9UdXJyZXQiIHRoZW4KCQlkYW1hZ2VNdWx0aXBsaWVyID0gMC45NSAqIGRhbWFnZU11bHRpcGxpZXIKCWVuZAoKCS0tIG1pbmlvbnMgZGVhbCBsZXNzIGRhbWFnZSB0byB0dXJyZXRzCglpZiBzb3VyY2UudHlwZSA9PSAib2JqX0FJX01pbmlvbiIgYW5kIHRhcmdldC50eXBlID09ICJvYmpfQUlfVHVycmV0IiB0aGVuCgkJZGFtYWdlTXVsdGlwbGllciA9IDAuNDc1ICogZGFtYWdlTXVsdGlwbGllcgoJZW5kCgoJLS0gc2llZ2UgbWluaW9ucyBhbmQgc3VwZXJtaW5pb25zIHRha2UgbGVzcyBkYW1hZ2UgZnJvbSB0dXJyZXRzCglpZiBzb3VyY2UudHlwZSA9PSAib2JqX0FJX1R1cnJldCIgYW5kICh0YXJnZXQuY2hhck5hbWUgPT0gIlJlZF9NaW5pb25fTWVjaENhbm5vbiIgb3IgdGFyZ2V0LmNoYXJOYW1lID09ICJCbHVlX01pbmlvbl9NZWNoQ2Fubm9uIikgdGhlbgoJCWRhbWFnZU11bHRpcGxpZXIgPSAwLjggKiBkYW1hZ2VNdWx0aXBsaWVyCgllbmQKCgktLSBjYXN0ZXIgbWluaW9ucyBhbmQgYmFzaWMgbWluaW9ucyB0YWtlIG1vcmUgZGFtYWdlIGZyb20gdHVycmV0cwoJaWYgc291cmNlLnR5cGUgPT0gIm9ial9BSV9UdXJyZXQiIGFuZCAodGFyZ2V0LmNoYXJOYW1lID09ICJSZWRfTWluaW9uX1dpemFyZCIgb3IgdGFyZ2V0LmNoYXJOYW1lID09ICJCbHVlX01pbmlvbl9XaXphcmQiIG9yIHRhcmdldC5jaGFyTmFtZSA9PSAiUmVkX01pbmlvbl9CYXNpYyIgb3IgdGFyZ2V0LmNoYXJOYW1lID09ICJCbHVlX01pbmlvbl9CYXNpYyIpIHRoZW4KCQlkYW1hZ2VNdWx0aXBsaWVyID0gKDEgLyAwLjg3NSkgKiBkYW1hZ2VNdWx0aXBsaWVyCgllbmQKCgktLSB0dXJyZXRzIGRlYWwgbW9yZSBkYW1hZ2UgdG8gYWxsIHVuaXRzIGJ5IGRlZmF1bHQKCWlmIHNvdXJjZS50eXBlID09ICJvYmpfQUlfVHVycmV0IiB0aGVuCgkJZGFtYWdlTXVsdGlwbGllciA9IDEuMDUgKiBkYW1hZ2VNdWx0aXBsaWVyCgllbmQKCgktLSBjYWxjdWxhdGUgZGFtYWdlIGRlYWx0CglyZXR1cm4gZGFtYWdlTXVsdGlwbGllciAqIHRvdGFsRGFtYWdlCmVuZAotLX0K"
				NewVPredictionFile = io.open(LIB_PATH.."/VPrediction.lua", "w+")
				NewVPredictionFile:write(StringDecrypt(NewVPredictionString))
				NewVPredictionFile:close()
				_PrintScriptMsg("Incorrect Version of VPrediction detected.")
				_PrintScriptMsg("Updated VPrediction to Version ".. 2.51)
				require "VPrediction"
				UpdateDone_VPrediction = true
			else
				_PrintScriptMsg("VPrediction loaded, Version: ".. 2.51)
				require "VPrediction"
				UpdateDone_VPrediction = true
			end
		end
	end
end

function _CheckUpdate_SOW()
	if not UpdateDone_SOW then
		--~ Get Local Version
		if LocalVersion_SOW == nil then
			if FileExist(LIB_PATH.."/SOW.lua") then
				LocalVersionFile = io.open(LIB_PATH.."/SOW.lua", "r")
				LocalVersionString = LocalVersionFile:read("*a")
				LocalVersionPos, Dummy = string.find(LocalVersionString, "local version =")
				if string.find(LocalVersionString, "local AUTOUPDATE = true") then
					LocalVersion_SOW = 1.000
				else
					LocalVersion_SOW = tonumber(string.sub(LocalVersionString, LocalVersionPos+17, LocalVersionPos+21))
				end
			else
				LocalVersion_SOW = 1.000
			end
		end

	--~ Check for Updates and Download
		if LocalVersion_SOW ~= nil then
			if LocalVersion_SOW ~= 1.127 then
				NewSOWString = "bG9jYWwgdmVyc2lvbiA9ICIxLjEyNyIKbG9jYWwgQVVUT1VQREFURSA9IGZhbHNlCmxvY2FsIFVQREFURV9IT1NUID0gInJhdy5naXRodWIuY29tIgpsb2NhbCBVUERBVEVfUEFUSCA9ICIvaG9uZGE3L0JvTC9tYXN0ZXIvQ29tbW9uL1NPVy5sdWEiLi4iP3JhbmQ9Ii4ubWF0aC5yYW5kb20oMSwxMDAwMCkKbG9jYWwgVVBEQVRFX0ZJTEVfUEFUSCA9IExJQl9QQVRILi4iU09XLmx1YSIKbG9jYWwgVVBEQVRFX1VSTCA9ICJodHRwczovLyIuLlVQREFURV9IT1NULi5VUERBVEVfUEFUSAoKZnVuY3Rpb24gX0F1dG91cGRhdGVyTXNnKG1zZykgcHJpbnQoIjxmb250IGNvbG9yPVwiIzY2OTlmZlwiPjxiPlNPVzo8L2I+PC9mb250PiA8Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4iLi5tc2cuLiIuPC9mb250PiIpIGVuZAppZiBBVVRPVVBEQVRFIHRoZW4KCWxvY2FsIFNlcnZlckRhdGEgPSBHZXRXZWJSZXN1bHQoVVBEQVRFX0hPU1QsICIvaG9uZGE3L0JvTC9tYXN0ZXIvVmVyc2lvbkZpbGVzL1NPVy52ZXJzaW9uIikKCWlmIFNlcnZlckRhdGEgdGhlbgoJCVNlcnZlclZlcnNpb24gPSB0eXBlKHRvbnVtYmVyKFNlcnZlckRhdGEpKSA9PSAibnVtYmVyIiBhbmQgdG9udW1iZXIoU2VydmVyRGF0YSkgb3IgbmlsCgkJaWYgU2VydmVyVmVyc2lvbiB0aGVuCgkJCWlmIHRvbnVtYmVyKHZlcnNpb24pIDwgU2VydmVyVmVyc2lvbiB0aGVuCgkJCQlfQXV0b3VwZGF0ZXJNc2coIk5ldyB2ZXJzaW9uIGF2YWlsYWJsZSIuLlNlcnZlclZlcnNpb24pCgkJCQlfQXV0b3VwZGF0ZXJNc2coIlVwZGF0aW5nLCBwbGVhc2UgZG9uJ3QgcHJlc3MgRjkiKQoJCQkJRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBEb3dubG9hZEZpbGUoVVBEQVRFX1VSTCwgVVBEQVRFX0ZJTEVfUEFUSCwgZnVuY3Rpb24gKCkgX0F1dG91cGRhdGVyTXNnKCJTdWNjZXNzZnVsbHkgdXBkYXRlZC4gKCIuLnZlcnNpb24uLiIgPT4gIi4uU2VydmVyVmVyc2lvbi4uIiksIHByZXNzIEY5IHR3aWNlIHRvIGxvYWQgdGhlIHVwZGF0ZWQgdmVyc2lvbi4iKSBlbmQpIGVuZCwgMykKCQkJZWxzZQoJCQkJX0F1dG91cGRhdGVyTXNnKCJZb3UgaGF2ZSBnb3QgdGhlIGxhdGVzdCB2ZXJzaW9uICgiLi5TZXJ2ZXJWZXJzaW9uLi4iKSIpCgkJCWVuZAoJCWVuZAoJZWxzZQoJCV9BdXRvdXBkYXRlck1zZygiRXJyb3IgZG93bmxvYWRpbmcgdmVyc2lvbiBpbmZvIikKCWVuZAplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKY2xhc3MgIlNPVyIKZnVuY3Rpb24gU09XOl9faW5pdChWUCkKCV9HLlNPV0xvYWRlZCA9IHRydWUKCglzZWxmLlByb2plY3RpbGVTcGVlZCA9IG15SGVyby5yYW5nZSA+IDMwMCBhbmQgVlA6R2V0UHJvamVjdGlsZVNwZWVkKG15SGVybykgb3IgbWF0aC5odWdlCglzZWxmLkJhc2VXaW5kdXBUaW1lID0gMwoJc2VsZi5CYXNlQW5pbWF0aW9uVGltZSA9IDAuNjUKCXNlbGYuRGF0YVVwZGF0ZWQgPSBmYWxzZQoKCXNlbGYuVlAgPSBWUAoKCS0tQ2FsbGJhY2tzCglzZWxmLkFmdGVyQXR0YWNrQ2FsbGJhY2tzID0ge30KCXNlbGYuT25BdHRhY2tDYWxsYmFja3MgPSB7fQoJc2VsZi5CZWZvcmVBdHRhY2tDYWxsYmFja3MgPSB7fQoKCXNlbGYuQXR0YWNrVGFibGUgPQoJCXsKCQkJWyJBc2hlcyBRIl0gPSAiZnJvc3RhcnJvdyIsCgkJfQoKCXNlbGYuTm9BdHRhY2tUYWJsZSA9CgkJewoJCQlbIlNoeXZhbmExIl0gPSAic2h5dmFuYWRvdWJsZWF0dGFja2RyYWdvbiIsCgkJCVsiU2h5dmFuYTIiXSA9ICJTaHl2YW5hRG91YmxlQXR0YWNrIiwKCQkJWyJXdWtvbmciXSA9ICJNb25rZXlLaW5nRG91YmxlQXR0YWNrIiwKCQl9CgoJc2VsZi5BdHRhY2tSZXNldFRhYmxlID0KCQl7CgkJCVsidmF5bmUiXSA9IF9RLAoJCQlbImRhcml1cyJdID0gX1csCgkJCVsiZmlvcmEiXSA9IF9FLAoJCQlbImdhbmdwbGFuayJdID0gX1EsCgkJCVsiamF4Il0gPSBfVywKCQkJWyJsZW9uYSJdID0gX1EsCgkJCVsibW9yZGVrYWlzZXIiXSA9IF9RLAoJCQlbIm5hc3VzIl0gPSBfUSwKCQkJWyJuYXV0aWx1cyJdID0gX1csCgkJCVsibmlkYWxlZSJdID0gX1EsCgkJCVsicG9wcHkiXSA9IF9RLAoJCQlbInJlbmVrdG9uIl0gPSBfVywKCQkJWyJyZW5nYXIiXSA9IF9RLAoJCQlbInNoeXZhbmEiXSA9IF9RLAoJCQlbInNpdmlyIl0gPSBfVywKCQkJWyJ0YWxvbiJdID0gX1EsCgkJCVsidHJ1bmRsZSJdID0gX1EsCgkJCVsidmkiXSA9IF9FLAoJCQlbInZvbGliZWFyIl0gPSBfUSwKCQkJWyJ4aW56aGFvIl0gPSBfUSwKCQkJWyJtb25rZXlraW5nIl0gPSBfUSwKCQkJWyJ5b3JpY2siXSA9IF9RLAoJCQlbImNhc3Npb3BlaWEiXSA9IF9FLAoJCQlbImdhcmVuIl0gPSBfUSwKCQkJWyJraGF6aXgiXSA9IF9RLAoJCX0KCglzZWxmLkxhc3RBdHRhY2sgPSAwCglzZWxmLkVuZW15TWluaW9ucyA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0VORU1ZLCAyMDAwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9BU0MpCglzZWxmLkp1bmdsZU1pbmlvbnMgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9KVU5HTEUsIDIwMDAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykKCXNlbGYuT3RoZXJNaW5pb25zID0gbWluaW9uTWFuYWdlcihNSU5JT05fT1RIRVIsIDIwMDAsIG15SGVybywgTUlOSU9OX1NPUlRfSEVBTFRIX0FTQykKCglHZXRTYXZlKCJTT1ciKS5GYXJtRGVsYXkgPSBHZXRTYXZlKCJTT1ciKS5GYXJtRGVsYXkgYW5kIEdldFNhdmUoIlNPVyIpLkZhcm1EZWxheSBvciAwCglHZXRTYXZlKCJTT1ciKS5FeHRyYVdpbmRVcFRpbWUgPSBHZXRTYXZlKCJTT1ciKS5FeHRyYVdpbmRVcFRpbWUgYW5kIEdldFNhdmUoIlNPVyIpLkV4dHJhV2luZFVwVGltZSBvciA1MAoJR2V0U2F2ZSgiU09XIikuTW9kZTMgPSBHZXRTYXZlKCJTT1ciKS5Nb2RlMyBhbmQgR2V0U2F2ZSgiU09XIikuTW9kZTMgb3Igc3RyaW5nLmJ5dGUoIlgiKQoJR2V0U2F2ZSgiU09XIikuTW9kZTIgPSBHZXRTYXZlKCJTT1ciKS5Nb2RlMiBhbmQgR2V0U2F2ZSgiU09XIikuTW9kZTIgb3Igc3RyaW5nLmJ5dGUoIlYiKQoJR2V0U2F2ZSgiU09XIikuTW9kZTEgPSBHZXRTYXZlKCJTT1ciKS5Nb2RlMSBhbmQgR2V0U2F2ZSgiU09XIikuTW9kZTEgb3Igc3RyaW5nLmJ5dGUoIkMiKQoJR2V0U2F2ZSgiU09XIikuTW9kZTAgPSBHZXRTYXZlKCJTT1ciKS5Nb2RlMCBhbmQgR2V0U2F2ZSgiU09XIikuTW9kZTAgb3IgMzIKCglzZWxmLkF0dGFja3MgPSB0cnVlCglzZWxmLk1vdmUgPSB0cnVlCglzZWxmLm1vZGUgPSAtMQoJc2VsZi5jaGVja2NhbmNlbCA9IDAKCglBZGRQcm9jZXNzU3BlbGxDYWxsYmFjayhmdW5jdGlvbih1bml0LCBzcGVsbCkgc2VsZjpPblByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQplbmQKCmZ1bmN0aW9uIFNPVzpMb2FkVG9NZW51KG0sIFNUUykKCWlmIG5vdCBtIHRoZW4KCQlzZWxmLk1lbnUgPSBzY3JpcHRDb25maWcoIlNpbXBsZSBPcmJXYWxrZXIiLCAiU09XIikKCWVsc2UKCQlzZWxmLk1lbnUgPSBtCgllbmQKCglpZiBTVFMgdGhlbgoJCXNlbGYuU1RTID0gU1RTCgkJc2VsZi5TVFMuVlAgPSBzZWxmLlZQCgllbmQKCglzZWxmLk1lbnU6YWRkUGFyYW0oIkVuYWJsZWQiLCAiRW5hYmxlZCIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKCXNlbGYuTWVudTphZGRQYXJhbSgiRmFybURlbGF5IiwgIkZhcm0gRGVsYXkiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIC0xNTAsIDAsIDE1MCkKCXNlbGYuTWVudTphZGRQYXJhbSgiRXh0cmFXaW5kVXBUaW1lIiwgIkV4dHJhIFdpbmRVcCBUaW1lIiwgU0NSSVBUX1BBUkFNX1NMSUNFLCAtMTUwLCAgMCwgMTUwKQoKCXNlbGYuTWVudS5GYXJtRGVsYXkgPSBHZXRTYXZlKCJTT1ciKS5GYXJtRGVsYXkKCXNlbGYuTWVudS5FeHRyYVdpbmRVcFRpbWUgPSBHZXRTYXZlKCJTT1ciKS5FeHRyYVdpbmRVcFRpbWUKCglzZWxmLk1lbnU6YWRkUGFyYW0oIkF0dGFjayIsICAiQXR0YWNrIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDIsIHsgIk9ubHkgRmFybWluZyIsICJGYXJtaW5nICsgQ2FycnkgbW9kZSJ9KQoJc2VsZi5NZW51OmFkZFBhcmFtKCJNb2RlIiwgICJPcmJ3YWxraW5nIG1vZGUiLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgeyAiVG8gbW91c2UiLCAiVG8gdGFyZ2V0In0pCgoJc2VsZi5NZW51OmFkZFBhcmFtKCJIb3RrZXlzIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikKCglzZWxmLk1lbnU6YWRkUGFyYW0oIk1vZGUzIiwgIkxhc3QgaGl0ISIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWCIpKQoJc2VsZi5Nb2RlM1BhcmFtSUQgPSAjc2VsZi5NZW51Ll9wYXJhbQoJc2VsZi5NZW51OmFkZFBhcmFtKCJNb2RlMSIsICJNaXhlZCBNb2RlISIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiQyIpKQoJc2VsZi5Nb2RlMVBhcmFtSUQgPSAjc2VsZi5NZW51Ll9wYXJhbQoJc2VsZi5NZW51OmFkZFBhcmFtKCJNb2RlMiIsICJMYW5lY2xlYXIhIiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJWIikpCglzZWxmLk1vZGUyUGFyYW1JRCA9ICNzZWxmLk1lbnUuX3BhcmFtCglzZWxmLk1lbnU6YWRkUGFyYW0oIk1vZGUwIiwgIkNhcnJ5IG1lISIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCAzMikKCXNlbGYuTW9kZTBQYXJhbUlEID0gI3NlbGYuTWVudS5fcGFyYW0KCglzZWxmLk1lbnUuX3BhcmFtW3NlbGYuTW9kZTNQYXJhbUlEXS5rZXkgPSBHZXRTYXZlKCJTT1ciKS5Nb2RlMwoJc2VsZi5NZW51Ll9wYXJhbVtzZWxmLk1vZGUyUGFyYW1JRF0ua2V5ID0gR2V0U2F2ZSgiU09XIikuTW9kZTIKCXNlbGYuTWVudS5fcGFyYW1bc2VsZi5Nb2RlMVBhcmFtSURdLmtleSA9IEdldFNhdmUoIlNPVyIpLk1vZGUxCglzZWxmLk1lbnUuX3BhcmFtW3NlbGYuTW9kZTBQYXJhbUlEXS5rZXkgPSBHZXRTYXZlKCJTT1ciKS5Nb2RlMAoKCUFkZFRpY2tDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6T25UaWNrKCkgZW5kKQoJQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpDaGVja0NvbmZpZygpIGVuZCkKZW5kCgpmdW5jdGlvbiBTT1c6Q2hlY2tDb25maWcoKQoJR2V0U2F2ZSgiU09XIikuRmFybURlbGF5ID0gc2VsZi5NZW51LkZhcm1EZWxheQoJR2V0U2F2ZSgiU09XIikuRXh0cmFXaW5kVXBUaW1lID0gc2VsZi5NZW51LkV4dHJhV2luZFVwVGltZQoKCUdldFNhdmUoIlNPVyIpLk1vZGUzID0gc2VsZi5NZW51Ll9wYXJhbVtzZWxmLk1vZGUzUGFyYW1JRF0ua2V5CglHZXRTYXZlKCJTT1ciKS5Nb2RlMiA9IHNlbGYuTWVudS5fcGFyYW1bc2VsZi5Nb2RlMlBhcmFtSURdLmtleQoJR2V0U2F2ZSgiU09XIikuTW9kZTEgPSBzZWxmLk1lbnUuX3BhcmFtW3NlbGYuTW9kZTFQYXJhbUlEXS5rZXkKCUdldFNhdmUoIlNPVyIpLk1vZGUwID0gc2VsZi5NZW51Ll9wYXJhbVtzZWxmLk1vZGUwUGFyYW1JRF0ua2V5CmVuZAoKZnVuY3Rpb24gU09XOkRpc2FibGVBdHRhY2tzKCkKCXNlbGYuQXR0YWNrcyA9IGZhbHNlCmVuZAoKZnVuY3Rpb24gU09XOkVuYWJsZUF0dGFja3MoKQoJc2VsZi5BdHRhY2tzID0gdHJ1ZQplbmQKCmZ1bmN0aW9uIFNPVzpGb3JjZVRhcmdldCh0YXJnZXQpCglzZWxmLmZvcmNldGFyZ2V0ID0gdGFyZ2V0CmVuZAoKZnVuY3Rpb24gU09XOkdldFRpbWUoKQoJcmV0dXJuIG9zLmNsb2NrKCkKZW5kCgpmdW5jdGlvbiBTT1c6TXlSYW5nZSh0YXJnZXQpCglsb2NhbCBteVJhbmdlID0gbXlIZXJvLnJhbmdlICsgc2VsZi5WUDpHZXRIaXRCb3gobXlIZXJvKQoJaWYgdGFyZ2V0IGFuZCBWYWxpZFRhcmdldCh0YXJnZXQpIHRoZW4KCQlteVJhbmdlID0gbXlSYW5nZSArIHNlbGYuVlA6R2V0SGl0Qm94KHRhcmdldCkKCWVuZAoJcmV0dXJuIG15UmFuZ2UgLSAyMAplbmQKCmZ1bmN0aW9uIFNPVzpJblJhbmdlKHRhcmdldCkKCWxvY2FsIE15UmFuZ2UgPSBzZWxmOk15UmFuZ2UodGFyZ2V0KQoJaWYgdGFyZ2V0IGFuZCBHZXREaXN0YW5jZVNxcih0YXJnZXQudmlzaW9uUG9zLCBteUhlcm8udmlzaW9uUG9zKSA8PSBNeVJhbmdlICogTXlSYW5nZSB0aGVuCgkJcmV0dXJuIHRydWUKCWVuZAplbmQKCmZ1bmN0aW9uIFNPVzpWYWxpZFRhcmdldCh0YXJnZXQpCglpZiB0YXJnZXQgYW5kIHRhcmdldC50eXBlIGFuZCAodGFyZ2V0LnR5cGUgPT0gIm9ial9CYXJyYWNrc0RhbXBlbmVyIiBvciB0YXJnZXQudHlwZSA9PSAib2JqX0hRIikgIHRoZW4KCQlyZXR1cm4gZmFsc2UKCWVuZAoJcmV0dXJuIFZhbGlkVGFyZ2V0KHRhcmdldCkgYW5kIHNlbGY6SW5SYW5nZSh0YXJnZXQpCmVuZAoKZnVuY3Rpb24gU09XOkF0dGFjayh0YXJnZXQpCglzZWxmLkxhc3RBdHRhY2sgPSBzZWxmOkdldFRpbWUoKSArIHNlbGY6TGF0ZW5jeSgpCglteUhlcm86QXR0YWNrKHRhcmdldCkKZW5kCgpmdW5jdGlvbiBTT1c6V2luZFVwVGltZShleGFjdCkKCXJldHVybiAoMSAvIChteUhlcm8uYXR0YWNrU3BlZWQgKiBzZWxmLkJhc2VXaW5kdXBUaW1lKSkgKyAoZXhhY3QgYW5kIDAgb3IgR2V0U2F2ZSgiU09XIikuRXh0cmFXaW5kVXBUaW1lIC8gMTAwMCkKZW5kCgpmdW5jdGlvbiBTT1c6QW5pbWF0aW9uVGltZSgpCglyZXR1cm4gKDEgLyAobXlIZXJvLmF0dGFja1NwZWVkICogc2VsZi5CYXNlQW5pbWF0aW9uVGltZSkpCmVuZAoKZnVuY3Rpb24gU09XOkxhdGVuY3koKQoJcmV0dXJuIEdldExhdGVuY3koKSAvIDIwMDAKZW5kCgpmdW5jdGlvbiBTT1c6Q2FuQXR0YWNrKCkKCWlmIHNlbGYuTGFzdEF0dGFjayA8PSBzZWxmOkdldFRpbWUoKSB0aGVuCgkJcmV0dXJuIChzZWxmOkdldFRpbWUoKSArIHNlbGY6TGF0ZW5jeSgpICA+IHNlbGYuTGFzdEF0dGFjayArIHNlbGY6QW5pbWF0aW9uVGltZSgpKQoJZW5kCglyZXR1cm4gZmFsc2UKZW5kCgpmdW5jdGlvbiBTT1c6Q2FuTW92ZSgpCglpZiBzZWxmLkxhc3RBdHRhY2sgPD0gc2VsZjpHZXRUaW1lKCkgdGhlbgoJCXJldHVybiAoKHNlbGY6R2V0VGltZSgpICsgc2VsZjpMYXRlbmN5KCkgPiBzZWxmLkxhc3RBdHRhY2sgKyBzZWxmOldpbmRVcFRpbWUoKSkgb3Igc2VsZi5QYXJ0aWNsZUNyZWF0ZWQpIGFuZCBub3QgX0cuZXZhZGUKCWVuZAplbmQKCmZ1bmN0aW9uIFNPVzpCZWZvcmVBdHRhY2sodGFyZ2V0KQoJbG9jYWwgcmVzdWx0ID0gZmFsc2UKCWZvciBpLCBjYiBpbiBpcGFpcnMoc2VsZi5CZWZvcmVBdHRhY2tDYWxsYmFja3MpIGRvCgkJbG9jYWwgcmkgPSBjYih0YXJnZXQsIHNlbGYubW9kZSkKCQlpZiByaSB0aGVuCgkJCXJlc3VsdCA9IHRydWUKCQllbmQKCWVuZAoJcmV0dXJuIHJlc3VsdAplbmQKCmZ1bmN0aW9uIFNPVzpSZWdpc3RlckJlZm9yZUF0dGFja0NhbGxiYWNrKGYpCgl0YWJsZS5pbnNlcnQoc2VsZi5CZWZvcmVBdHRhY2tDYWxsYmFja3MsIGYpCmVuZAoKZnVuY3Rpb24gU09XOk9uQXR0YWNrKHRhcmdldCkKCWZvciBpLCBjYiBpbiBpcGFpcnMoc2VsZi5PbkF0dGFja0NhbGxiYWNrcykgZG8KCQljYih0YXJnZXQsIHNlbGYubW9kZSkKCWVuZAplbmQKCmZ1bmN0aW9uIFNPVzpSZWdpc3Rlck9uQXR0YWNrQ2FsbGJhY2soZikKCXRhYmxlLmluc2VydChzZWxmLk9uQXR0YWNrQ2FsbGJhY2tzLCBmKQplbmQKCmZ1bmN0aW9uIFNPVzpBZnRlckF0dGFjayh0YXJnZXQpCglmb3IgaSwgY2IgaW4gaXBhaXJzKHNlbGYuQWZ0ZXJBdHRhY2tDYWxsYmFja3MpIGRvCgkJY2IodGFyZ2V0LCBzZWxmLm1vZGUpCgllbmQKZW5kCgpmdW5jdGlvbiBTT1c6UmVnaXN0ZXJBZnRlckF0dGFja0NhbGxiYWNrKGYpCgl0YWJsZS5pbnNlcnQoc2VsZi5BZnRlckF0dGFja0NhbGxiYWNrcywgZikKZW5kCgpmdW5jdGlvbiBTT1c6TW92ZVRvKHgsIHkpCglteUhlcm86TW92ZVRvKHgsIHkpCmVuZApmdW5jdGlvbiBTT1c6T3JiV2Fsayh0YXJnZXQsIHBvaW50KQoJcG9pbnQgPSBwb2ludCBvciBzZWxmLmZvcmNlb3Jid2Fsa3BvcwoJaWYgc2VsZi5BdHRhY2tzIGFuZCBzZWxmOkNhbkF0dGFjaygpIGFuZCBzZWxmOlZhbGlkVGFyZ2V0KHRhcmdldCkgYW5kIG5vdCBzZWxmOkJlZm9yZUF0dGFjayh0YXJnZXQpIHRoZW4KCQlzZWxmOkF0dGFjayh0YXJnZXQpCgllbHNlaWYgc2VsZjpDYW5Nb3ZlKCkgYW5kIHNlbGYuTW92ZSB0aGVuCgkJaWYgbm90IHBvaW50IHRoZW4KCQkJbG9jYWwgT0JUYXJnZXQgPSBHZXRUYXJnZXQoKQoJCQlpZiBzZWxmLk1lbnUuTW9kZSA9PSAxIG9yIG5vdCBPQlRhcmdldCB0aGVuCgkJCQlsb2NhbCBNdiA9IFZlY3RvcihteUhlcm8pICsgNDAwICogKFZlY3Rvcihtb3VzZVBvcykgLSBWZWN0b3IobXlIZXJvKSk6bm9ybWFsaXplZCgpCgkJCQlzZWxmOk1vdmVUbyhNdi54LCBNdi56KQoJCQllbHNlaWYgR2V0RGlzdGFuY2VTcXIoT0JUYXJnZXQpID4gNTAqNTAgdGhlbgoJCQkJbG9jYWwgcG9pbnQgPSBzZWxmLlZQOkdldFByZWRpY3RlZFBvcyhPQlRhcmdldCwgMCwgMipteUhlcm8ubXMsIG15SGVybywgZmFsc2UpCgkJCQlzZWxmOk1vdmVUbyhwb2ludC54LCBwb2ludC56KQoJCQllbmQKCQllbHNlCgkJCXNlbGY6TW92ZVRvKHBvaW50LngsIHBvaW50LnopCgkJZW5kCgllbmQKZW5kCgpmdW5jdGlvbiBTT1c6SXNBdHRhY2soU3BlbGxOYW1lKQoJcmV0dXJuIChTcGVsbE5hbWU6bG93ZXIoKTpmaW5kKCJhdHRhY2siKSBvciB0YWJsZS5jb250YWlucyhzZWxmLkF0dGFja1RhYmxlLCBTcGVsbE5hbWU6bG93ZXIoKSkpIGFuZCBub3QgdGFibGUuY29udGFpbnMoc2VsZi5Ob0F0dGFja1RhYmxlLCBTcGVsbE5hbWU6bG93ZXIoKSkKZW5kCgpmdW5jdGlvbiBTT1c6SXNBQVJlc2V0KFNwZWxsTmFtZSkKCWxvY2FsIFNwZWxsSUQKCWlmIFNwZWxsTmFtZTpsb3dlcigpID09IG15SGVybzpHZXRTcGVsbERhdGEoX1EpLm5hbWU6bG93ZXIoKSB0aGVuCgkJU3BlbGxJRCA9IF9RCgllbHNlaWYgU3BlbGxOYW1lOmxvd2VyKCkgPT0gbXlIZXJvOkdldFNwZWxsRGF0YShfVykubmFtZTpsb3dlcigpIHRoZW4KCQlTcGVsbElEID0gX1cKCWVsc2VpZiBTcGVsbE5hbWU6bG93ZXIoKSA9PSBteUhlcm86R2V0U3BlbGxEYXRhKF9FKS5uYW1lOmxvd2VyKCkgdGhlbgoJCVNwZWxsSUQgPSBfRQoJZWxzZWlmIFNwZWxsTmFtZTpsb3dlcigpID09IG15SGVybzpHZXRTcGVsbERhdGEoX1IpLm5hbWU6bG93ZXIoKSB0aGVuCgkJU3BlbGxJRCA9IF9SCgllbmQKCglpZiBTcGVsbElEIHRoZW4KCQlyZXR1cm4gc2VsZi5BdHRhY2tSZXNldFRhYmxlW215SGVyby5jaGFyTmFtZTpsb3dlcigpXSA9PSBTcGVsbElECgllbmQKCXJldHVybiBmYWxzZQplbmQKCmZ1bmN0aW9uIFNPVzpPblByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkKCWlmIHVuaXQuaXNNZSBhbmQgc2VsZjpJc0F0dGFjayhzcGVsbC5uYW1lKSB0aGVuCgkJaWYgc2VsZi5kZWJ1Z2RwcyB0aGVuCgkJCURQUyA9IERQUyBhbmQgRFBTIG9yIDAKCQkJcHJpbnQoIkRQUzogIi4uKDEwMDAvKHNlbGY6R2V0VGltZSgpLSBEUFMpKS4uIiAiLi4oMTAwMC8oc2VsZjpBbmltYXRpb25UaW1lKCkpKSkKCQkJRFBTID0gc2VsZjpHZXRUaW1lKCkKCQllbmQKCQlpZiBub3Qgc2VsZi5EYXRhVXBkYXRlZCBhbmQgbm90IHNwZWxsLm5hbWU6bG93ZXIoKTpmaW5kKCJjYXJkIikgdGhlbgoJCQlzZWxmLkJhc2VBbmltYXRpb25UaW1lID0gMSAvIChzcGVsbC5hbmltYXRpb25UaW1lICogbXlIZXJvLmF0dGFja1NwZWVkKQoJCQlzZWxmLkJhc2VXaW5kdXBUaW1lID0gMSAvIChzcGVsbC53aW5kVXBUaW1lICogbXlIZXJvLmF0dGFja1NwZWVkKQoJCQlpZiBzZWxmLmRlYnVnIHRoZW4KCQkJCXByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj5CYXNpYyBBdHRhY2tzIGRhdGEgdXBkYXRlZDogPC9mb250PiIpCgkJCQlwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+QmFzZVdpbmR1cFRpbWU6ICIuLnNlbGYuQmFzZVdpbmR1cFRpbWUuLiI8L2ZvbnQ+IikKCQkJCXByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj5CYXNlQW5pbWF0aW9uVGltZTogIi4uc2VsZi5CYXNlQW5pbWF0aW9uVGltZS4uIjwvZm9udD4iKQoJCQkJcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPlByb2plY3RpbGVTcGVlZDogIi4uc2VsZi5Qcm9qZWN0aWxlU3BlZWQuLiI8L2ZvbnQ+IikKCQkJZW5kCgkJCXNlbGYuRGF0YVVwZGF0ZWQgPSB0cnVlCgkJZW5kCgkJc2VsZi5MYXN0QXR0YWNrID0gc2VsZjpHZXRUaW1lKCkgLSBzZWxmOkxhdGVuY3koKQoJCXNlbGYuY2hlY2tpbmcgPSB0cnVlCgkJc2VsZi5MYXN0QXR0YWNrQ2FuY2VsbGVkID0gZmFsc2UKCQlzZWxmOk9uQXR0YWNrKHNwZWxsLnRhcmdldCkKCQlzZWxmLmNoZWNrY2FuY2VsID0gc2VsZjpHZXRUaW1lKCkKCQlEZWxheUFjdGlvbihmdW5jdGlvbih0KSBzZWxmOkFmdGVyQXR0YWNrKHQpIGVuZCwgc2VsZjpXaW5kVXBUaW1lKCkgLSBzZWxmOkxhdGVuY3koKSwge3NwZWxsLnRhcmdldH0pCgoJZWxzZWlmIHVuaXQuaXNNZSBhbmQgc2VsZjpJc0FBUmVzZXQoc3BlbGwubmFtZSkgdGhlbgoJCURlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgc2VsZjpyZXNldEFBKCkgZW5kLCAwLjI1KQoJZW5kCmVuZAoKZnVuY3Rpb24gU09XOnJlc2V0QUEoKQoJc2VsZi5MYXN0QXR0YWNrID0gMAplbmQKLS1UT0RPOiBDaGFuZ2UgdGhpcy4KZnVuY3Rpb24gU09XOkJvbnVzRGFtYWdlKG1pbmlvbikKCWxvY2FsIEFEID0gbXlIZXJvOkNhbGNEYW1hZ2UobWluaW9uLCBteUhlcm8udG90YWxEYW1hZ2UpCglsb2NhbCBCT05VUyA9IDAKCWlmIG15SGVyby5jaGFyTmFtZSA9PSAnVmF5bmUnIHRoZW4KCQlpZiBteUhlcm86R2V0U3BlbGxEYXRhKF9RKS5sZXZlbCA+IDAgYW5kIG15SGVybzpDYW5Vc2VTcGVsbChfUSkgPT0gU1VQUkVTU0VEIHRoZW4KCQkJQk9OVVMgPSBCT05VUyArIG15SGVybzpDYWxjRGFtYWdlKG1pbmlvbiwgKCgwLjA1ICogbXlIZXJvOkdldFNwZWxsRGF0YShfUSkubGV2ZWwpICsgMC4yNSApICogbXlIZXJvLnRvdGFsRGFtYWdlKQoJCWVuZAoJCWlmIG5vdCBWYXluZUNCQWRkZWQgdGhlbgoJCQlWYXluZUNCQWRkZWQgPSB0cnVlCgkJCWZ1bmN0aW9uIFZheW5lUGFydGljbGUob2JqKQoJCQkJaWYgR2V0RGlzdGFuY2Uob2JqKSA8IDEwMDAgYW5kIG9iai5uYW1lOmxvd2VyKCk6ZmluZCgidmF5bmVfd19yaW5nMi50cm95IikgdGhlbgoJCQkJCVZheW5lV1BhcnRpY2xlID0gb2JqCgkJCQllbmQKCQkJZW5kCgkJCUFkZENyZWF0ZU9iakNhbGxiYWNrKFZheW5lUGFydGljbGUpCgkJZW5kCgkJaWYgVmF5bmVXUGFydGljbGUgYW5kIFZheW5lV1BhcnRpY2xlLnZhbGlkIGFuZCBHZXREaXN0YW5jZShWYXluZVdQYXJ0aWNsZSwgbWluaW9uKSA8IDEwIHRoZW4KCQkJQk9OVVMgPSBCT05VUyArIDEwICsgMTAgKiBteUhlcm86R2V0U3BlbGxEYXRhKF9XKS5sZXZlbCArICgwLjAzICsgKDAuMDEgKiBteUhlcm86R2V0U3BlbGxEYXRhKF9XKS5sZXZlbCkpICogbWluaW9uLm1heEhlYWx0aAoJCWVuZAoJZWxzZWlmIG15SGVyby5jaGFyTmFtZSA9PSAnVGVlbW8nIGFuZCBteUhlcm86R2V0U3BlbGxEYXRhKF9FKS5sZXZlbCA+IDAgdGhlbgoJCUJPTlVTID0gQk9OVVMgKyBteUhlcm86Q2FsY01hZ2ljRGFtYWdlKG1pbmlvbiwgKG15SGVybzpHZXRTcGVsbERhdGEoX0UpLmxldmVsICogMTApICsgKG15SGVyby5hcCAqIDAuMykgKQoJZWxzZWlmIG15SGVyby5jaGFyTmFtZSA9PSAnQ29ya2knIHRoZW4KCQlCT05VUyA9IEJPTlVTICsgbXlIZXJvLnRvdGFsRGFtYWdlLzEwCgllbHNlaWYgbXlIZXJvLmNoYXJOYW1lID09ICdNaXNzRm9ydHVuZScgYW5kIG15SGVybzpHZXRTcGVsbERhdGEoX1cpLmxldmVsID4gMCB0aGVuCgkJQk9OVVMgPSBCT05VUyArIG15SGVybzpDYWxjTWFnaWNEYW1hZ2UobWluaW9uLCAoNCArIDIgKiBteUhlcm86R2V0U3BlbGxEYXRhKF9XKS5sZXZlbCkgKyAobXlIZXJvLmFwLzIwKSkKCWVsc2VpZiBteUhlcm8uY2hhck5hbWUgPT0gJ1ZhcnVzJyBhbmQgbXlIZXJvOkdldFNwZWxsRGF0YShfVykubGV2ZWwgPiAwIHRoZW4KCQlCT05VUyA9IEJPTlVTICsgKDYgKyAobXlIZXJvOkdldFNwZWxsRGF0YShfVykubGV2ZWwgKiA0KSArIChteUhlcm8uYXAgKiAwLjI1KSkKCWVsc2VpZiBteUhlcm8uY2hhck5hbWUgPT0gJ0NhaXRseW4nIHRoZW4KCQkJaWYgbm90IENhbGxiYWNrQ2FpdGx5bkFkZGVkIHRoZW4KCQkJCWZ1bmN0aW9uIENhaXRseW5QYXJ0aWNsZShvYmopCgkJCQkJaWYgR2V0RGlzdGFuY2Uob2JqKSA8IDEwMCBhbmQgb2JqLm5hbWU6bG93ZXIoKTpmaW5kKCJjYWl0bHluX2hlYWRzaG90X3JkeSIpIHRoZW4KCQkJCQkJCUhlYWRTaG90UGFydGljbGUgPSBvYmoKCQkJCQllbmQKCQkJCWVuZAoJCQkJQWRkQ3JlYXRlT2JqQ2FsbGJhY2soQ2FpdGx5blBhcnRpY2xlKQoJCQkJQ2FsbGJhY2tDYWl0bHluQWRkZWQgPSB0cnVlCgkJCWVuZAoJCQlpZiBIZWFkU2hvdFBhcnRpY2xlIGFuZCBIZWFkU2hvdFBhcnRpY2xlLnZhbGlkIHRoZW4KCQkJCUJPTlVTID0gQk9OVVMgKyBBRCAqIDEuNQoJCQllbmQKCWVsc2VpZiBteUhlcm8uY2hhck5hbWUgPT0gJ09yaWFubmEnIHRoZW4KCQlCT05VUyA9IEJPTlVTICsgbXlIZXJvOkNhbGNNYWdpY0RhbWFnZShtaW5pb24sIDEwICsgOCAqICgobXlIZXJvLmxldmVsIC0gMSkgJSAzKSkKCWVsc2VpZiBteUhlcm8uY2hhck5hbWUgPT0gJ1R3aXN0ZWRGYXRlJyB0aGVuCgkJCWlmIG5vdCBURkNhbGxiYWNrQWRkZWQgdGhlbgoJCQkJZnVuY3Rpb24gVEZQYXJ0aWNsZShvYmopCgkJCQkJaWYgR2V0RGlzdGFuY2Uob2JqKSA8IDEwMCBhbmQgb2JqLm5hbWU6bG93ZXIoKTpmaW5kKCJjYXJkbWFzdGVyX3N0YWNrcmVhZHkudHJveSIpIHRoZW4KCQkJCQkJVEZFUGFydGljbGUgPSBvYmoKCQkJCQllbHNlaWYgR2V0RGlzdGFuY2Uob2JqKSA8IDEwMCBhbmQgb2JqLm5hbWU6bG93ZXIoKTpmaW5kKCJjYXJkX2JsdWUudHJveSIpIHRoZW4KCQkJCQkJVEZXUGFydGljbGUgPSBvYmoKCQkJCQllbmQKCQkJCWVuZAoJCQkJQWRkQ3JlYXRlT2JqQ2FsbGJhY2soVEZQYXJ0aWNsZSkKCQkJCVRGQ2FsbGJhY2tBZGRlZCA9IHRydWUKCQkJZW5kCgkJCWlmIFRGRVBhcnRpY2xlIGFuZCBURkVQYXJ0aWNsZS52YWxpZCB0aGVuCgkJCQlCT05VUyA9IEJPTlVTICsgbXlIZXJvOkNhbGNNYWdpY0RhbWFnZShtaW5pb24sIG15SGVybzpHZXRTcGVsbERhdGEoX0UpLmxldmVsICogMTUgKyA0MCArIDAuNSAqIG15SGVyby5hcCkKCQkJZW5kCgkJCWlmIFRGV1BhcnRpY2xlIGFuZCBURldQYXJ0aWNsZS52YWxpZCB0aGVuCgkJCQlCT05VUyA9IEJPTlVTICsgbWF0aC5tYXgobXlIZXJvOkNhbGNNYWdpY0RhbWFnZShtaW5pb24sIG15SGVybzpHZXRTcGVsbERhdGEoX1cpLmxldmVsICogMjAgKyAyMCArIDAuNSAqIG15SGVyby5hcCkgLSA0MCwgMCkKCQkJZW5kCgllbHNlaWYgbXlIZXJvLmNoYXJOYW1lID09ICdEcmF2ZW4nIHRoZW4KCQkJaWYgbm90IENhbGxiYWNrRHJhdmVuQWRkZWQgdGhlbgoJCQkJZnVuY3Rpb24gRHJhdmVuUGFydGljbGUob2JqKQoJCQkJCWlmIEdldERpc3RhbmNlKG9iaikgPCAxMDAgYW5kIG9iai5uYW1lOmxvd2VyKCk6ZmluZCgiZHJhdmVuX3FfYnVmIikgdGhlbgoJCQkJCQkJRHJhdmVuUGFydGljbGVvID0gb2JqCgkJCQkJZW5kCgkJCQllbmQKCQkJCUFkZENyZWF0ZU9iakNhbGxiYWNrKERyYXZlblBhcnRpY2xlKQoJCQkJQ2FsbGJhY2tEcmF2ZW5BZGRlZCA9IHRydWUKCQkJZW5kCgkJCWlmIERyYXZlblBhcnRpY2xlbyBhbmQgRHJhdmVuUGFydGljbGVvLnZhbGlkIHRoZW4KCQkJCUJPTlVTID0gQk9OVVMgKyBBRCAqICgwLjMgKyAoMC4xMCAqIG15SGVybzpHZXRTcGVsbERhdGEoX1EpLmxldmVsKSkKCQkJZW5kCgllbHNlaWYgbXlIZXJvLmNoYXJOYW1lID09ICdOYXN1cycgYW5kIFZJUF9VU0VSIHRoZW4KCQlpZiBteUhlcm86R2V0U3BlbGxEYXRhKF9RKS5sZXZlbCA+IDAgYW5kIG15SGVybzpDYW5Vc2VTcGVsbChfUSkgPT0gU1VQUkVTU0VEIHRoZW4KCQkJbG9jYWwgUWRhbWFnZSA9IHszMCwgNTAsIDcwLCA5MCwgMTEwfQoJCQlOYXN1c1FTdGFja3MgPSBOYXN1c1FTdGFja3Mgb3IgMAoJCQlCT05VUyA9IEJPTlVTICsgbXlIZXJvOkNhbGNEYW1hZ2UobWluaW9uLCAxMCArIDIwICogKG15SGVybzpHZXRTcGVsbERhdGEoX1EpLmxldmVsKSArIE5hc3VzUVN0YWNrcykKCQkJaWYgbm90IFJlY3ZQYWNrZXROYXN1c0FkZGVkIHRoZW4KCQkJCWZ1bmN0aW9uIE5hc3VzT25SZWN2UGFja2V0KHApCgkJCQkJaWYgcC5oZWFkZXIgPT0gMHhGRSBhbmQgcC5zaXplID09IDB4QyB0aGVuCgkJCQkJCXAucG9zID0gMQoJCQkJCQlwTmV0d29ya0lEID0gcDpEZWNvZGVGKCkKCQkJCQkJdW5rMDEgPSBwOkRlY29kZTIoKQoJCQkJIAkJdW5rMDIgPSBwOkRlY29kZTEoKQoJCQkJCQlzdGFjayA9IHA6RGVjb2RlNCgpCgkJCQkJCWlmIHBOZXR3b3JrSUQgPT0gbXlIZXJvLm5ldHdvcmtJRCB0aGVuCgkJCQkJCQlOYXN1c1FTdGFja3MgPSBzdGFjawoJCQkJCQllbmQKCQkJCQllbmQKCQkJCWVuZAoJCQkJUmVjdlBhY2tldE5hc3VzQWRkZWQgPSB0cnVlCgkJCQlBZGRSZWN2UGFja2V0Q2FsbGJhY2soTmFzdXNPblJlY3ZQYWNrZXQpCgkJCWVuZAoJCWVuZAoJZWxzZWlmIG15SGVyby5jaGFyTmFtZSA9PSAiWmlnZ3MiIHRoZW4KCQlpZiBub3QgQ2FsbGJhY2taaWdnc0FkZGVkIHRoZW4KCQkJZnVuY3Rpb24gWmlnZ3NQYXJ0aWNsZShvYmopCgkJCQlpZiBHZXREaXN0YW5jZShvYmopIDwgMTAwIGFuZCBvYmoubmFtZTpsb3dlcigpOmZpbmQoInppZ2dzcGFzc2l2ZSIpIHRoZW4KCQkJCQkJWmlnZ3NQYXJ0aWNsZU9iaiA9IG9iagoJCQkJZW5kCgkJCWVuZAoJCQlBZGRDcmVhdGVPYmpDYWxsYmFjayhaaWdnc1BhcnRpY2xlKQoJCQlDYWxsYmFja1ppZ2dzQWRkZWQgPSB0cnVlCgkJZW5kCgkJaWYgWmlnZ3NQYXJ0aWNsZU9iaiBhbmQgWmlnZ3NQYXJ0aWNsZU9iai52YWxpZCB0aGVuCgkJCWxvY2FsIGJhc2UgPSB7MjAsIDI0LCAyOCwgMzIsIDM2LCA0MCwgNDgsIDU2LCA2NCwgNzIsIDgwLCA4OCwgMTAwLCAxMTIsIDEyNCwgMTM2LCAxNDgsIDE2MH0KCQkJQk9OVVMgPSBCT05VUyArIG15SGVybzpDYWxjTWFnaWNEYW1hZ2UobWluaW9uLCBiYXNlW215SGVyby5sZXZlbF0gKyAoMC4yNSArIDAuMDUgKiAobXlIZXJvLmxldmVsICUgNykpICogbXlIZXJvLmFwKQoJCWVuZAoJZW5kCgoJcmV0dXJuIEJPTlVTCmVuZAoKZnVuY3Rpb24gU09XOktpbGxhYmxlTWluaW9uKCkKCWxvY2FsIHJlc3VsdAoJZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5FbmVteU1pbmlvbnMub2JqZWN0cykgZG8KCQlsb2NhbCB0aW1lID0gc2VsZjpXaW5kVXBUaW1lKHRydWUpICsgR2V0RGlzdGFuY2UobWluaW9uLnZpc2lvblBvcywgbXlIZXJvLnZpc2lvblBvcykgLyBzZWxmLlByb2plY3RpbGVTcGVlZCAtIDAuMDcKCQlsb2NhbCBQcmVkaWN0ZWRIZWFsdGggPSBzZWxmLlZQOkdldFByZWRpY3RlZEhlYWx0aChtaW5pb24sIHRpbWUsIEdldFNhdmUoIlNPVyIpLkZhcm1EZWxheSAvIDEwMDApCgkJaWYgc2VsZjpWYWxpZFRhcmdldChtaW5pb24pIGFuZCBQcmVkaWN0ZWRIZWFsdGggPCBzZWxmLlZQOkNhbGNEYW1hZ2VPZkF0dGFjayhteUhlcm8sIG1pbmlvbiwge25hbWUgPSAiQmFzaWMifSwgMCkgKyBzZWxmOkJvbnVzRGFtYWdlKG1pbmlvbikgYW5kIFByZWRpY3RlZEhlYWx0aCA+IC00MCB0aGVuCgkJCXJlc3VsdCA9IG1pbmlvbgoJCQlicmVhawoJCWVuZAoJZW5kCglyZXR1cm4gcmVzdWx0CmVuZAoKZnVuY3Rpb24gU09XOlNob3VsZFdhaXQoKQoJZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5FbmVteU1pbmlvbnMub2JqZWN0cykgZG8KCQlsb2NhbCB0aW1lID0gc2VsZjpBbmltYXRpb25UaW1lKCkgKyBHZXREaXN0YW5jZShtaW5pb24udmlzaW9uUG9zLCBteUhlcm8udmlzaW9uUG9zKSAvIHNlbGYuUHJvamVjdGlsZVNwZWVkIC0gMC4wNwoJCWlmIHNlbGY6VmFsaWRUYXJnZXQobWluaW9uKSBhbmQgc2VsZi5WUDpHZXRQcmVkaWN0ZWRIZWFsdGgyKG1pbmlvbiwgdGltZSAqIDIpIDwgKHNlbGYuVlA6Q2FsY0RhbWFnZU9mQXR0YWNrKG15SGVybywgbWluaW9uLCB7bmFtZSA9ICJCYXNpYyJ9LCAwKSArIHNlbGY6Qm9udXNEYW1hZ2UobWluaW9uKSkgdGhlbgoJCQlyZXR1cm4gdHJ1ZQoJCWVuZAoJZW5kCmVuZAoKZnVuY3Rpb24gU09XOlZhbGlkU3R1ZmYoKQoJbG9jYWwgcmVzdWx0ID0gc2VsZjpHZXRUYXJnZXQoKQoKCWlmIHJlc3VsdCB0aGVuCgkJcmV0dXJuIHJlc3VsdAoJZW5kCgoJZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5FbmVteU1pbmlvbnMub2JqZWN0cykgZG8KCQlsb2NhbCB0aW1lID0gc2VsZjpBbmltYXRpb25UaW1lKCkgKyBHZXREaXN0YW5jZShtaW5pb24udmlzaW9uUG9zLCBteUhlcm8udmlzaW9uUG9zKSAvIHNlbGYuUHJvamVjdGlsZVNwZWVkIC0gMC4wNwoJCWxvY2FsIHBkYW1hZ2UyID0gbWluaW9uLmhlYWx0aCAtIHNlbGYuVlA6R2V0UHJlZGljdGVkSGVhbHRoKG1pbmlvbiwgdGltZSwgR2V0U2F2ZSgiU09XIikuRmFybURlbGF5IC8gMTAwMCkKCQlsb2NhbCBwZGFtYWdlID0gc2VsZi5WUDpHZXRQcmVkaWN0ZWRIZWFsdGgyKG1pbmlvbiwgdGltZSAqIDIpCgkJaWYgc2VsZjpWYWxpZFRhcmdldChtaW5pb24pIGFuZCAoKHBkYW1hZ2UpID4gMipzZWxmLlZQOkNhbGNEYW1hZ2VPZkF0dGFjayhteUhlcm8sIG1pbmlvbiwge25hbWUgPSAiQmFzaWMifSwgMCkgKyBzZWxmOkJvbnVzRGFtYWdlKG1pbmlvbikgb3IgcGRhbWFnZTIgPT0gMCkgdGhlbgoJCQlyZXR1cm4gbWluaW9uCgkJZW5kCgllbmQKCglmb3IgaSwgbWluaW9uIGluIGlwYWlycyhzZWxmLkp1bmdsZU1pbmlvbnMub2JqZWN0cykgZG8KCQlpZiBzZWxmOlZhbGlkVGFyZ2V0KG1pbmlvbikgdGhlbgoJCQlyZXR1cm4gbWluaW9uCgkJZW5kCgllbmQKCglmb3IgaSwgbWluaW9uIGluIGlwYWlycyhzZWxmLk90aGVyTWluaW9ucy5vYmplY3RzKSBkbwoJCWlmIHNlbGY6VmFsaWRUYXJnZXQobWluaW9uKSB0aGVuCgkJCXJldHVybiBtaW5pb24KCQllbmQKCWVuZAplbmQKCmZ1bmN0aW9uIFNPVzpHZXRUYXJnZXQoT25seUNoYW1waW9ucykKCWxvY2FsIHJlc3VsdAoJbG9jYWwgaGVhbHRoUmF0aW8KCglpZiBzZWxmOlZhbGlkVGFyZ2V0KHNlbGYuZm9yY2V0YXJnZXQpIHRoZW4KCQlyZXR1cm4gc2VsZi5mb3JjZXRhcmdldAoJZWxzZWlmIHNlbGYuZm9yY2V0YXJnZXQgfj0gbmlsIHRoZW4KCQlyZXR1cm4gbmlsCgllbmQKCglpZiAobm90IHNlbGYuU1RTIG9yIG5vdCBPbmx5Q2hhbXBpb25zKSBhbmQgc2VsZjpWYWxpZFRhcmdldChHZXRUYXJnZXQoKSkgYW5kIChHZXRUYXJnZXQoKS50eXBlID09IG15SGVyby50eXBlIG9yIChub3QgT25seUNoYW1waW9ucykpIHRoZW4KCQlyZXR1cm4gR2V0VGFyZ2V0KCkKCWVuZAoKCWlmIHNlbGYuU1RTIHRoZW4KCQlsb2NhbCBvbGRoaXRib3htb2RlID0gc2VsZi5TVFMuaGl0Ym94bW9kZQoJCXNlbGYuU1RTLmhpdGJveG1vZGUgPSB0cnVlCgoJCXJlc3VsdCA9IHNlbGYuU1RTOkdldFRhcmdldChteUhlcm8ucmFuZ2UpCgoJCXNlbGYuU1RTLmhpdGJveG1vZGUgPSBvbGRoaXRib3htb2RlCgkJcmV0dXJuIHJlc3VsdAoJZW5kCgoJZm9yIGksIGNoYW1waW9uIGluIGlwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbwoJCWxvY2FsIGhyID0gY2hhbXBpb24uaGVhbHRoIC8gbXlIZXJvOkNhbGNEYW1hZ2UoY2hhbXBpb24sIDIwMCkKCQlpZiBzZWxmOlZhbGlkVGFyZ2V0KGNoYW1waW9uKSBhbmQgKChoZWFsdGhSYXRpbyA9PSBuaWwpIG9yIGhyIDwgaGVhbHRoUmF0aW8pIHRoZW4KCQkJcmVzdWx0ID0gY2hhbXBpb24KCQkJaGVhbHRoUmF0aW8gPSBocgoJCWVuZAoJZW5kCgoJcmV0dXJuIHJlc3VsdAplbmQKCmZ1bmN0aW9uIFNPVzpGYXJtKG1vZGUsIHBvaW50KQoJaWYgbW9kZSA9PSAxIHRoZW4KCQlzZWxmLkVuZW15TWluaW9uczp1cGRhdGUoKQoJCWxvY2FsIHRhcmdldCA9IHNlbGY6S2lsbGFibGVNaW5pb24oKSBvciBzZWxmOkdldFRhcmdldCgpCgkJc2VsZjpPcmJXYWxrKHRhcmdldCwgcG9pbnQpCgkJc2VsZi5tb2RlID0gMQoJZWxzZWlmIG1vZGUgPT0gMiB0aGVuCgkJc2VsZi5FbmVteU1pbmlvbnM6dXBkYXRlKCkKCQlzZWxmLk90aGVyTWluaW9uczp1cGRhdGUoKQoJCXNlbGYuSnVuZ2xlTWluaW9uczp1cGRhdGUoKQoKCQlsb2NhbCB0YXJnZXQgPSBzZWxmOktpbGxhYmxlTWluaW9uKCkKCQlpZiB0YXJnZXQgdGhlbgoJCQlzZWxmOk9yYldhbGsodGFyZ2V0LCBwb2ludCkKCQllbHNlaWYgbm90IHNlbGY6U2hvdWxkV2FpdCgpIHRoZW4KCgkJCWlmIHNlbGY6VmFsaWRUYXJnZXQoc2VsZi5sYXN0dGFyZ2V0KSB0aGVuCgkJCQl0YXJnZXQgPSBzZWxmLmxhc3R0YXJnZXQKCQkJZWxzZQoJCQkJdGFyZ2V0ID0gc2VsZjpWYWxpZFN0dWZmKCkKCQkJZW5kCgkJCXNlbGYubGFzdHRhcmdldCA9IHRhcmdldAoKCQkJc2VsZjpPcmJXYWxrKHRhcmdldCwgcG9pbnQpCgkJZWxzZQoJCQlzZWxmOk9yYldhbGsobmlsLCBwb2ludCkKCQllbmQKCQlzZWxmLm1vZGUgPSAyCgllbHNlaWYgbW9kZSA9PSAzIHRoZW4KCQlzZWxmLkVuZW15TWluaW9uczp1cGRhdGUoKQoJCWxvY2FsIHRhcmdldCA9IHNlbGY6S2lsbGFibGVNaW5pb24oKQoJCXNlbGY6T3JiV2Fsayh0YXJnZXQsIHBvaW50KQoJCXNlbGYubW9kZSA9IDMKCWVuZAplbmQKCmZ1bmN0aW9uIFNPVzpPblRpY2soKQoJaWYgbm90IHNlbGYuTWVudS5FbmFibGVkIHRoZW4gcmV0dXJuIGVuZAoJaWYgc2VsZi5NZW51Lk1vZGUwIHRoZW4KCQlsb2NhbCB0YXJnZXQgPSBzZWxmOkdldFRhcmdldCh0cnVlKQoJCWlmIHNlbGYuTWVudS5BdHRhY2sgPT0gMiB0aGVuCgkJCXNlbGY6T3JiV2Fsayh0YXJnZXQpCgkJZWxzZQoJCQlzZWxmOk9yYldhbGsoKQoJCWVuZAoJCXNlbGYubW9kZSA9IDAKCWVsc2VpZiBzZWxmLk1lbnUuTW9kZTEgdGhlbgoJCXNlbGY6RmFybSgxKQoJZWxzZWlmIHNlbGYuTWVudS5Nb2RlMiB0aGVuCgkJc2VsZjpGYXJtKDIpCgllbHNlaWYgc2VsZi5NZW51Lk1vZGUzIHRoZW4KCQlzZWxmOkZhcm0oMykKCWVsc2UKCQlzZWxmLm1vZGUgPSAtMQoJZW5kCmVuZAoKZnVuY3Rpb24gU09XOkRyYXdBQVJhbmdlKHdpZHRoLCBjb2xvcikKCWxvY2FsIHAgPSBXb3JsZFRvU2NyZWVuKEQzRFhWRUNUT1IzKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnopKQoJaWYgT25TY3JlZW4ocC54LCBwLnkpIHRoZW4KCQlEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgc2VsZjpNeVJhbmdlKCkgKyAyNSwgd2lkdGggb3IgMSwgY29sb3Igb3IgQVJHQigyNTUsIDI1NSwgMCwgMCkpCgllbmQKZW5kCg=="
				NewSOWFile = io.open(LIB_PATH.."/SOW.lua", "w+")
				NewSOWFile:write(StringDecrypt(NewSOWString))
				NewSOWFile:close()
				_PrintScriptMsg("Incorrect Version of SOW detected.")
				_PrintScriptMsg("Updated SOW to Version ".. 1.127)
				require "SOW"
				UpdateDone_SOW = true
			else
				_PrintScriptMsg("SOW loaded, Version: ".. 1.127)
				require "SOW"
				UpdateDone_SOW = true
			end
		end
	end
end

function StringDecrypt(data)
	local b='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
    data = string.gsub(data, '[^'..b..'=]', '')
    return (data:gsub('.', function(x)
        if (x == '=') then return '' end
        local r,f='',(b:find(x)-1)
        for i=6,1,-1 do r=r..(f%2^i-f%2^(i-1)>0 and '1' or '0') end
        return r;
    end):gsub('%d%d%d?%d?%d?%d?%d?%d?', function(x)
        if (#x ~= 8) then return '' end
        local c=0
        for i=1,8 do c=c+(x:sub(i,i)=='1' and 2^(8-i) or 0) end
        return string.char(c)
    end))
end

function _GetUpdate()
	if not AlreadyChecked then
		if not OnLoadDone then
			if Beta then SCRIPT_NAME = "ShadowVayneBeta" else SCRIPT_NAME = "ShadowVayne" end
				OwnScriptFile = io.open(SCRIPT_PATH..(GetCurrentEnv().FILE_NAME), "r")
				LocalVersion = string.sub(OwnScriptFile:read("*a"), 51, 54)
				FileClose = OwnScriptFile:close()
				_PrintScriptMsg("Loaded Version: "..(LocalVersion))
			OnLoadDone = true
			SHADOWVAYNE_SCRIPT_URL = "http://raw.github.com/Superx321/BoL/master/ShadowVayne.lua?rand="..tostring(math.random(1,10000))
			SHADOWVAYNE_PATH = SCRIPT_PATH..(GetCurrentEnv().FILE_NAME)
			ServerWebResult = GetWebResult("raw.github.com", "/Superx321/BoL/master/"..SCRIPT_NAME..".lua?rand="..tostring(math.random(1,10000)))
			if ServerWebResult ~= nil then
				ServerVersion = string.sub(ServerWebResult, 51, 54)
			else
				ServerVersion = nil
			end
		end
		if VayneMenu.autoup.autoupcheck then
			if tonumber(ServerVersion) ~= nil and tonumber(LocalVersion) ~= nil then
				if tonumber(LocalVersion) < tonumber(ServerVersion) then
					if VayneMenu.autoup.autoupdown then
						_PrintScriptMsg("New Version ("..(ServerVersion)..") available, downloading...")
						DownloadFile(SHADOWVAYNE_SCRIPT_URL, SHADOWVAYNE_PATH, function () _PrintScriptMsg("Updated to Version "..(ServerVersion)..". Please reload with F9") end)
					else
						_PrintScriptMsg("New Version is available. Turn on AutoUpdate or download manually")
					end
				else
					_PrintScriptMsg("No Updates available")
				end
				AlreadyChecked = true
			else
				_PrintScriptMsg("Error downloading Version Info.")
				AlreadyChecked = true
			end
		end
	end
end

function _UseBotRK()
	local BladeSlot = GetInventorySlotItem(3153)
	if LastAttackedEnemy ~= nil and GetDistance(LastAttackedEnemy) < 450 and not LastAttackedEnemy.dead and LastAttackedEnemy.visible and BladeSlot ~= nil and myHero:CanUseSpell(BladeSlot) == 0 then
		if (VayneMenu.botrksettings.botrkautocarry and ShadowVayneAutoCarry) or
		 (VayneMenu.botrksettings.botrkmixedmode and ShadowVayneMixedMode) or
		 (VayneMenu.botrksettings.botrklaneclear and ShadowVayneLaneClear) or
		 (VayneMenu.botrksettings.botrklasthit and ShadowVayneLastHit) or
		 (VayneMenu.botrksettings.botrkalways) then
			if (math.floor(myHero.health / myHero.maxHealth * 100)) <= VayneMenu.botrksettings.botrkmaxheal then
				if (math.floor(LastAttackedEnemy.health / LastAttackedEnemy.maxHealth * 100)) >= VayneMenu.botrksettings.botrkminheal then
					CastSpell(BladeSlot, LastAttackedEnemy)
				end
			end
		end
	end
end

function _ClickThreshLantern()
	if VIP_USER and VayneMenu.keysetting.threshlantern and LanternObj then
		LanternPacket = CLoLPacket(0x39)
		LanternPacket:EncodeF(myHero.networkID)
		LanternPacket:EncodeF(LanternObj.networkID)
		LanternPacket.dwArg1 = 1
		LanternPacket.dwArg2 = 0
		SendPacket(LanternPacket)
	end
end

function CustomPermaShow(TextVar, ValueVar, VisibleVar, PermaColorVar, OnColorVar, OffColorVar)
	if not _CPS_Added then
		_G.DrawCustomText = _G.DrawText
		_G.DrawText = function(Arg1, Arg2, Arg3, Arg4, Arg5) _DrawText(Arg1, Arg2, Arg3, Arg4, Arg5) end
		_G.DrawCustomLine = _G.DrawLine
		_G.DrawLine = function(Arg1, Arg2, Arg3, Arg4, Arg5, Arg6) _DrawLine(Arg1, Arg2, Arg3, Arg4, Arg5, Arg6) end
		OldPermaShowTable, OldPermaShowCount, IsPermaShowStatusOn, PermaShowTable = {}, 0, {}, {}
		AddDrawCallback(_DrawCustomPermaShow)
		_CPS_Added = true
	end

	local _CPS_Updated = false
	for i=1, #PermaShowTable do
		if PermaShowTable[i]["TextVar"] == TextVar then
			PermaShowTable[i]["ValueVar"], PermaShowTable[i]["VisibleVar"],_CPS_Updated = ValueVar,VisibleVar,true
			PermaShowTable[i]["PermaColorVar"],PermaShowTable[i]["OnColorVar"],PermaShowTable[i]["OffColorVar"] = PermaColorVar, OnColorVar, OffColorVar
		end
	end

	if not _CPS_Updated then
		PermaShowTable[#PermaShowTable+1] = {["TextVar"] = TextVar, ["ValueVar"] = ValueVar, ["VisibleVar"] = VisibleVar, ["PermaColorVar"] = PermaColorVar, ["OnColorVar"] = OnColorVar, ["OffColorVar"] = OffColorVar}
	end
end

function _DrawCustomPermaShow()
	_CPS_Master = GetSave("scriptConfig")["Master"]
	_CPS_Master.py1 = _CPS_Master.py
	_CPS_Master.py2 = _CPS_Master.py
	_CPS_Master.color = { lgrey = 1413167931, grey = 4290427578, green = 1409321728}
	_CPS_Master.fontSize = WINDOW_H and math.round(WINDOW_H / 72) or 10
	_CPS_Master.midSize = _CPS_Master.fontSize / 2
	_CPS_Master.cellSize = _CPS_Master.fontSize + 1
	_CPS_Master.width = WINDOW_W and math.round(WINDOW_W / 6.4) or 160
	_CPS_Master.row = _CPS_Master.width * 0.7

	for i = 1, #PermaShowTable do
		if PermaShowTable[i].ValueVar == true then
			if PermaShowTable[i].OnColorVar == nil then
				if PermaShowTable[i].PermaColorVar == nil then
					ColorVar = _CPS_Master.color.green
				else
					ColorVar = PermaShowTable[i].PermaColorVar
				end
			else
				ColorVar = PermaShowTable[i].OnColorVar
			end
			TextVar = "      ON"
		elseif PermaShowTable[i].ValueVar == false then
			if PermaShowTable[i].OffColorVar == nil then
				if PermaShowTable[i].PermaColorVar == nil then
					ColorVar = _CPS_Master.color.lgrey
				else
					ColorVar = PermaShowTable[i].PermaColorVar
				end
			else
				ColorVar = PermaShowTable[i].OffColorVar
			end
			TextVar = "      OFF"
		else
			if PermaShowTable[i].PermaColorVar == nil then
				ColorVar = _CPS_Master.color.lgrey
			else
				ColorVar = PermaShowTable[i].PermaColorVar
			end
			TextVar = PermaShowTable[i].ValueVar
		end
		if PermaShowTable[i]["VisibleVar"] then
			DrawCustomLine(_CPS_Master.px - 1, _CPS_Master.py1 + _CPS_Master.midSize, _CPS_Master.px + _CPS_Master.row - 1, _CPS_Master.py1 + _CPS_Master.midSize, _CPS_Master.cellSize, _CPS_Master.color.lgrey)
			DrawCustomText(PermaShowTable[i].TextVar, _CPS_Master.fontSize, _CPS_Master.px, _CPS_Master.py1, _CPS_Master.color.grey)
			DrawCustomLine(_CPS_Master.px + _CPS_Master.row, _CPS_Master.py1 + _CPS_Master.midSize, _CPS_Master.px + _CPS_Master.width + 1, _CPS_Master.py1 + _CPS_Master.midSize, _CPS_Master.cellSize, ColorVar)
			DrawCustomText(TextVar, _CPS_Master.fontSize, _CPS_Master.px + _CPS_Master.row + 1, _CPS_Master.py1, _CPS_Master.color.grey)
			_CPS_Master.py1 = _CPS_Master.py1 + _CPS_Master.cellSize
		end
	end
	for i=1,OldPermaShowCount do
		if IsPermaShowStatusOn[_CPS_Master.py2] == true then
			ColorVar = _CPS_Master.color.green
			TextVar = "      ON"
		elseif IsPermaShowStatusOn[_CPS_Master.py2] == false then
			ColorVar = _CPS_Master.color.lgrey
			TextVar = "      OFF"
		else
			ColorVar = _CPS_Master.color.lgrey
			TextVar = IsPermaShowStatusOn[_CPS_Master.py2]
		end
		DrawCustomLine(_CPS_Master.px - 1, _CPS_Master.py1 + _CPS_Master.midSize, _CPS_Master.px + _CPS_Master.row - 1, _CPS_Master.py1 + _CPS_Master.midSize, _CPS_Master.cellSize, _CPS_Master.color.lgrey)
		DrawCustomText(OldPermaShowTable[i].Arg1, _CPS_Master.fontSize, _CPS_Master.px, _CPS_Master.py1, _CPS_Master.color.grey)
		DrawCustomLine(_CPS_Master.px + _CPS_Master.row, _CPS_Master.py1 + _CPS_Master.midSize, _CPS_Master.px + _CPS_Master.width + 1, _CPS_Master.py1 + _CPS_Master.midSize, _CPS_Master.cellSize, (ColorVar))
		DrawCustomText(TextVar, _CPS_Master.fontSize, _CPS_Master.px + _CPS_Master.row + 1, _CPS_Master.py1, _CPS_Master.color.grey)
		_CPS_Master.py1 = _CPS_Master.py1 + _CPS_Master.cellSize
		_CPS_Master.py2 = _CPS_Master.py2 + _CPS_Master.cellSize
	end
end

function scriptConfig:_DrawSubInstance(index)
 	_CPS_Master = GetSave("scriptConfig")["Master"]
	_CPS_Master.py1 = 0
	_CPS_Master.py2 = _CPS_Master.py
	_CPS_Master.color = { lgrey = 1413167931, grey = 4290427578, red = 1422721024, green = 1409321728, ivory = 4294967280 }
	_CPS_Master.fontSize = WINDOW_H and math.round(WINDOW_H / 54) or 14
	_CPS_Master.midSize = _CPS_Master.fontSize / 2
	_CPS_Master.cellSize = _CPS_Master.fontSize + 2
	_CPS_Master.width = WINDOW_W and math.round(WINDOW_W / 4.8) or 213
	_CPS_Master.row = _CPS_Master.width * 0.7
	_CPS_Master.row4 = _CPS_Master.width * 0.9
	_CPS_Master.row3 = _CPS_Master.width * 0.8
	_CPS_Master.row2 = _CPS_Master.width * 0.7
	_CPS_Master.row1 = _CPS_Master.width * 0.6
	if (self._subInstances[index].name == "sidasacvayne_sidasacvaynesub") then
		self._subInstances[index].header = ""
		self._subMenuIndex = 0
	end
	if not ((self._subInstances[index].name == "sidasacvayne_sidasacvaynesub") or (self._subInstances[index].name == "sidasacvayne_sidasacvayneallowed")) then
		local pVar = self._subInstances[index].name
		local selected = self._subMenuIndex == index
		DrawLine(self._x - 2, self._y + _CPS_Master.midSize, self._x + _CPS_Master.width + 2, self._y + _CPS_Master.midSize, _CPS_Master.cellSize, (selected and _CPS_Master.color.red or _CPS_Master.color.lgrey))
		DrawText(self._subInstances[index].header, _CPS_Master.fontSize, self._x, self._y, (selected and _CPS_Master.color.ivory or _CPS_Master.color.grey))
		DrawText("        >>", _CPS_Master.fontSize, self._x + _CPS_Master.row3 + 2, self._y, (selected and _CPS_Master.color.ivory or _CPS_Master.color.grey))
		--_SC._Idraw.y = _SC._Idraw.y + _SC.draw.cellSize
		self._y = self._y + _CPS_Master.cellSize
	end
end

function scriptConfig:_DrawParam(varIndex)
	_CPS_Master = GetSave("scriptConfig")["Master"]
	_CPS_Master.py1 = 0
	_CPS_Master.py2 = _CPS_Master.py
	_CPS_Master.color = { lgrey = 1413167931, grey = 4290427578, green = 1409321728}
	_CPS_Master.fontSize = WINDOW_H and math.round(WINDOW_H / 54) or 14
	_CPS_Master.midSize = _CPS_Master.fontSize / 2
	_CPS_Master.cellSize = _CPS_Master.fontSize + 2
	_CPS_Master.width = WINDOW_W and math.round(WINDOW_W / 4.8) or 213
	_CPS_Master.row = _CPS_Master.width * 0.7
	_CPS_Master.row4 = _CPS_Master.width * 0.9
	_CPS_Master.row3 = _CPS_Master.width * 0.8
	_CPS_Master.row2 = _CPS_Master.width * 0.7
	_CPS_Master.row1 = _CPS_Master.width * 0.6

    local pVar = self._param[varIndex].var
	local pText = self._param[varIndex].text
	if self.name == "sidasacvayne" or self.name == "sidasacvayne_sidasacvaynesub" then
		self._param[varIndex].pType = 5
		self._param[varIndex].text = "ShadowVayne found. Set the Keysettings there!"
	end
	if (self.name == "sidasacsetup_sidasacautocarrysub" and pText == "Auto Carry")
	or (self.name == "sidasacsetup_sidasacmixedmodesub" and pText == "Mixed Mode")
	or (self.name == "sidasacsetup_sidasaclaneclearsub" and pText == "Lane Clear")
	or (self.name == "sidasacsetup_sidasaclasthitsub" and pText == "Last Hit")
	then
		self._param[varIndex].pType = 5
		self._param[varIndex].text = "ShadowVayne found. Set the Keysettings there!"
	end

	if not ((self.name == "SV_SOW" and pVar == "Mode1" and pText == "Mixed Mode!") -- SOW MixedMode
	or (self.name == "SV_SOW" and pVar == "Mode3" and pText == "Last hit!") -- SOW LastHit
	or (self.name == "SV_SOW" and pVar == "Mode2" and pText == "Laneclear!") -- SOW LaneClear
	or (self.name == "SV_SOW" and pVar == "Mode0" and pText == "Carry me!") -- SOW AutoCarry
	or (self.name == "SV_SOW" and pVar == "Hotkeys" and pText == "")
	or (self.name == "sidasacvayne" and pVar ~= "toggleMode")
	or (self.name == "sidasacvayne_sidasacvaynesub")
	)
	then
--~ 		if string.find(pText, "Auto Carry") and self.name == "sidasacsetup_sidasacautocarrysub" then
--~ 			print(pVar)
--~ 		end
		DrawLine(self._x - 2, self._y + _CPS_Master.midSize, self._x + _CPS_Master.row3 - 2, self._y + _CPS_Master.midSize, _CPS_Master.cellSize, _CPS_Master.color.lgrey)
		DrawText(self._param[varIndex].text, _CPS_Master.fontSize, self._x, self._y, _CPS_Master.color.grey)
		if self._param[varIndex].pType == SCRIPT_PARAM_SLICE then
			DrawText(tostring(self[pVar]), _CPS_Master.fontSize, self._x + _CPS_Master.row2, self._y, _CPS_Master.color.grey)
			DrawLine(self._x + _CPS_Master.row3, self._y + _CPS_Master.midSize, self._x + _CPS_Master.width + 2, self._y + _CPS_Master.midSize, _CPS_Master.cellSize, _CPS_Master.color.lgrey)
			-- cursor
			self._param[varIndex].cursor = (self[pVar] - self._param[varIndex].min) / (self._param[varIndex].max - self._param[varIndex].min) * (_CPS_Master.width - _CPS_Master.row3)
			DrawLine(self._x + _CPS_Master.row3 + self._param[varIndex].cursor - 2, self._y + _CPS_Master.midSize, self._x + _CPS_Master.row3 + self._param[varIndex].cursor + 2, self._y + _CPS_Master.midSize, _CPS_Master.cellSize, 4292598640)
		elseif self._param[varIndex].pType == SCRIPT_PARAM_LIST then
			local text = tostring(self._param[varIndex].listTable[self[pVar]])
			local maxWidth = (_CPS_Master.width - _CPS_Master.row3) * 0.8
			local textWidth = GetTextArea(text, _CPS_Master.fontSize).x
			if textWidth > maxWidth then
				text = text:sub(1, math.floor(text:len() * maxWidth / textWidth)) .. ".."
			end
			DrawText(text, _CPS_Master.fontSize, self._x + _CPS_Master.row3, self._y, _CPS_Master.color.grey)
			if self._list then self._listY = self._y + _CPS_Master.cellSize end
		elseif self._param[varIndex].pType == SCRIPT_PARAM_INFO then
			if not (
			(self.name == "sidasacvayne")
			or (self.name == "sidasacsetup_sidasacautocarrysub" and pVar == "Active")
			or (self.name == "sidasacsetup_sidasacmixedmodesub" and pVar == "Active")
			or (self.name == "sidasacsetup_sidasaclaneclearsub" and pVar == "Active")
			or (self.name == "sidasacsetup_sidasaclasthitsub" and pVar == "Active")
			) then
				DrawText(tostring(self[pVar]), _CPS_Master.fontSize, self._x + _CPS_Master.row3 + 2, self._y, _CPS_Master.color.grey)
			end
		elseif self._param[varIndex].pType == SCRIPT_PARAM_COLOR then
			DrawRectangle(self._x + _CPS_Master.row3 + 2, self._y, 80, _CPS_Master.cellSize, ARGB(self[pVar][1], self[pVar][2], self[pVar][3], self[pVar][4]))
		else


			if (self._param[varIndex].pType == SCRIPT_PARAM_ONKEYDOWN or self._param[varIndex].pType == SCRIPT_PARAM_ONKEYTOGGLE) then
				DrawText(self:_txtKey(self._param[varIndex].key), _CPS_Master.fontSize, self._x + _CPS_Master.row2, self._y, _CPS_Master.color.grey)
			end
			DrawLine(self._x + _CPS_Master.row3, self._y + _CPS_Master.midSize, self._x + _CPS_Master.width + 2, self._y + _CPS_Master.midSize, _CPS_Master.cellSize, (self[pVar] and _CPS_Master.color.green or _CPS_Master.color.lgrey))
			DrawText((self[pVar] and "        ON" or "        OFF"), _CPS_Master.fontSize, self._x + _CPS_Master.row3 + 2, self._y, _CPS_Master.color.grey)
			end
		self._y = self._y + _CPS_Master.cellSize
	else
		self._param[varIndex].pType = 5
	end
end

function _DrawText(Arg1, Arg2, Arg3, Arg4, Arg5)
	_CPS_Master = GetSave("scriptConfig")["Master"]
	_CPS_Master.row = (WINDOW_W and math.round(WINDOW_W / 6.4) or 160) * 0.7
	if Arg1 == "Selector" then
		Arg1 = "[SV] TargetSelector Settings"
	end
	if Arg3 == _CPS_Master.px then
		if not (HidePermaShow[Arg1] ~= nil and HidePermaShow[Arg1] == true) then
			if not OldPermaShowTable[Arg1] then
				OldPermaShowTable[Arg1] = true
				OldPermaShowCount = OldPermaShowCount + 1
				OldPermaShowTable[OldPermaShowCount] = {}
				OldPermaShowTable[OldPermaShowCount]["Status"] = true
				OldPermaShowTable[OldPermaShowCount]["Arg1"] = Arg1
				OldPermaShowTable[OldPermaShowCount]["Arg2"] = Arg2
				OldPermaShowTable[OldPermaShowCount]["Arg3"] = Arg3
				OldPermaShowTable[OldPermaShowCount]["Arg4"] = Arg4
				OldPermaShowTable[OldPermaShowCount]["Arg5"] = Arg5
			end
		end
	elseif Arg3 == (_CPS_Master.px + _CPS_Master.row + 1) then
		if Arg1 == "      ON" then
			IsPermaShowStatusOn[Arg4] = true
		elseif Arg1 == "      OFF" then
			IsPermaShowStatusOn[Arg4] = false
		else
			IsPermaShowStatusOn[Arg4] = Arg1
		end
	else
		DrawCustomText(Arg1, Arg2, Arg3, Arg4, Arg5)
	end
end

function _DrawLine(Arg1, Arg2, Arg3, Arg4, Arg5, Arg6)
	_CPS_Master = GetSave("scriptConfig")["Master"]
	_CPS_Master.row = (WINDOW_W and math.round(WINDOW_W / 6.4) or 160) * 0.7
	if not (Arg1 == (_CPS_Master.px - 1) or Arg1 == (_CPS_Master.px + _CPS_Master.row)) then
		DrawCustomLine(Arg1, Arg2, Arg3, Arg4, Arg5, Arg6)
	end
end

function _DownloadLib(FilePath, LibName, VersionString, VersionLine)
	if FileExist(SCRIPT_PATH.."Common/"..LibName..".lua") then NeedDownLoad = false else NeedDownLoad = true end

	if FileExist(SCRIPT_PATH.."Common/"..LibName..".lua") and VersionString ~= nil then
		LibFile = io.open(SCRIPT_PATH.."/Common/"..LibName..".lua", "r")
		if VersionLine ~= nil and VersionLine > 1 then
			for i = 1, VersionLine-1 do DummyLine = LibFile:read() end
		end
		FirstLine = LibFile:read()
		LibFile:close()
		if FirstLine ~= VersionString then NeedDownLoad = true else NeedDownLoad = false end
	end

	if not DownloadStarted and NeedDownLoad == true then
		DownloadStarted = true
		_PrintScriptMsg("Downloading Library ("..LibName.."), please wait until its finished")
		DownloadFile(FilePath.."?rand="..tostring(math.random(1,10000)), SCRIPT_PATH.."Common/"..LibName..".lua",  function() DownloadStarted, HadToDownload = false, true end)
	end

end

function _LoadTables()
	isAGapcloserUnitTarget = {
        ['Akali']       = {true, spell = "AkaliShadowDance", 	spellKey = "R"},
        ['Alistar']     = {true, spell = "Headbutt", 			spellKey = "W"},
        ['Diana']       = {true, spell = "DianaTeleport", 		spellKey = "R"},
        ['Irelia']      = {true, spell = "IreliaGatotsu",		spellKey = "Q"},
        ['Jax']         = {true, spell = "JaxLeapStrike", 		spellKey = "Q"},
        ['Jayce']       = {true, spell = "JayceToTheSkies",		spellKey = "Q"},
        ['Maokai']      = {true, spell = "MaokaiUnstableGrowth",spellKey = "W"},
        ['MonkeyKing']  = {true, spell = "MonkeyKingNimbus",	spellKey = "E"},
        ['Pantheon']    = {true, spell = "Pantheon_LeapBash",	spellKey = "W"},
        ['Poppy']       = {true, spell = "PoppyHeroicCharge",	spellKey = "E"},
		['Quinn']       = {true, spell = "QuinnE",				spellKey = "E"},
        ['XinZhao']     = {true, spell = "XenZhaoSweep",		spellKey = "E"},
        ['LeeSin']	    = {true, spell = "blindmonkqtwo",		spellKey = "Q"}
    }

	isAGapcloserUnitNoTarget = {
		["AatroxQ"]					= {true, champ = "Aatrox", 		range = 1000,  	projSpeed = 1200, spellKey = "Q"},
		["GragasE"]					= {true, champ = "Gragas", 		range = 600,   	projSpeed = 2000, spellKey = "E"},
		["GravesMove"]				= {true, champ = "Graves", 		range = 425,   	projSpeed = 2000, spellKey = "E"},
		["HecarimUlt"]				= {true, champ = "Hecarim", 	range = 1000,   projSpeed = 1200, spellKey = "R"},
		["JarvanIVDragonStrike"]	= {true, champ = "JarvanIV",	range = 770,   	projSpeed = 2000, spellKey = "Q"},
		["JarvanIVCataclysm"]		= {true, champ = "JarvanIV", 	range = 650,   	projSpeed = 2000, spellKey = "R"},
		["KhazixE"]					= {true, champ = "Khazix", 		range = 900,   	projSpeed = 2000, spellKey = "E"},
		["khazixelong"]				= {true, champ = "Khazix", 		range = 900,   	projSpeed = 2000, spellKey = "E"},
		["LeblancSlide"]			= {true, champ = "Leblanc", 	range = 600,   	projSpeed = 2000, spellKey = "W"},
		["LeblancSlideM"]			= {true, champ = "Leblanc", 	range = 600,   	projSpeed = 2000, spellKey = "WMimic"},
		["LeonaZenithBlade"]		= {true, champ = "Leona", 		range = 900,  	projSpeed = 2000, spellKey = "E"},
		["UFSlash"]					= {true, champ = "Malphite", 	range = 1000,  	projSpeed = 1800, spellKey = "R"},
		["RenektonSliceAndDice"]	= {true, champ = "Renekton", 	range = 450,  	projSpeed = 2000, spellKey = "E"},
		["SejuaniArcticAssault"]	= {true, champ = "Sejuani", 	range = 650,  	projSpeed = 2000, spellKey = "Q"},
		["ShenShadowDash"]			= {true, champ = "Shen", 		range = 575,  	projSpeed = 2000, spellKey = "E"},
		["RocketJump"]				= {true, champ = "Tristana", 	range = 900,  	projSpeed = 2000, spellKey = "W"},
		["slashCast"]				= {true, champ = "Tryndamere", 	range = 650,  	projSpeed = 1450, spellKey = "E"}
	}

	isAChampToInterrupt = {
                ["KatarinaR"]					= {true, champ = "Katarina",	spellKey = "R"},
                ["GalioIdolOfDurand"]			= {true, champ = "Galio",		spellKey = "R"},
                ["Crowstorm"]					= {true, champ = "FiddleSticks",spellKey = "R"},
                ["Drain"]						= {true, champ = "FiddleSticks",spellKey = "W"},
                ["AbsoluteZero"]				= {true, champ = "Nunu",		spellKey = "R"},
                ["ShenStandUnited"]				= {true, champ = "Shen",		spellKey = "R"},
                ["UrgotSwap2"]					= {true, champ = "Urgot",		spellKey = "R"},
                ["AlZaharNetherGrasp"]			= {true, champ = "Malzahar",	spellKey = "R"},
                ["FallenOne"]					= {true, champ = "Karthus",		spellKey = "R"},
                ["Pantheon_GrandSkyfall_Jump"]	= {true, champ = "Pantheon",	spellKey = "R"},
                ["VarusQ"]						= {true, champ = "Varus",		spellKey = "Q"},
                ["CaitlynAceintheHole"]			= {true, champ = "Caitlyn",		spellKey = "R"},
                ["MissFortuneBulletTime"]		= {true, champ = "MissFortune",	spellKey = "R"},
                ["InfiniteDuress"]				= {true, champ = "Warwick",		spellKey = "R"}
	}

	AutoLevelSpellTable = {
                ["SpellOrder"]	= {"QWE", "QEW", "WQE", "WEQ", "EQW", "EWQ"},
                ["QWE"]	= {1,2,3,1,1,4,1,2,1,2,4,2,2,3,3,4,3,3},
                ["QEW"]	= {1,3,2,1,1,4,1,3,1,3,4,3,3,2,2,4,2,2},
                ["WQE"]	= {2,1,3,2,2,4,2,1,2,1,4,1,1,3,3,4,3,3},
                ["WEQ"]	= {2,3,1,2,2,4,2,3,2,3,4,3,3,1,1,4,1,1},
                ["EQW"]	= {3,1,2,3,3,4,3,1,3,1,4,1,1,2,2,4,2,2},
                ["EWQ"]	= {3,2,1,3,3,4,3,2,3,2,4,2,2,1,1,4,1,1}
	}

	priorityTable = {

    AP = {
        "Ahri", "Akali", "Anivia", "Annie", "Brand", "Cassiopeia", "Diana", "Evelynn", "FiddleSticks", "Fizz", "Gragas", "Heimerdinger", "Karthus",
        "Kassadin", "Katarina", "Kayle", "Kennen", "Leblanc", "Lissandra", "Lux", "Malzahar", "Mordekaiser", "Morgana", "Nidalee", "Orianna",
        "Rumble", "Ryze", "Sion", "Swain", "Syndra", "Teemo", "TwistedFate", "Veigar", "Viktor", "Vladimir", "Xerath", "Ziggs", "Zyra", "MasterYi", "Velkoz",
    },
    Support = {
        "Blitzcrank", "Janna", "Karma", "Leona", "Lulu", "Nami", "Sona", "Soraka", "Thresh", "Zilean", "Braum",
    },

    Tank = {
        "Amumu", "Chogath", "DrMundo", "Galio", "Hecarim", "Malphite", "Maokai", "Nasus", "Rammus", "Sejuani", "Shen", "Singed", "Skarner", "Volibear",
        "Warwick", "Yorick", "Zac", "Nunu", "Taric", "Alistar",
    },

    AD_Carry = {
        "Ashe", "Caitlyn", "Corki", "Draven", "Ezreal", "Graves", "Jayce", "KogMaw", "MissFortune", "Pantheon", "Quinn", "Shaco", "Sivir",
        "Talon", "Tristana", "Twitch", "Urgot", "Varus", "Vayne", "Zed", "Jinx" , "Lucian",

    },

    Bruiser = {
        "Darius", "Elise", "Fiora", "Gangplank", "Garen", "Irelia", "JarvanIV", "Jax", "Khazix", "LeeSin", "Nautilus", "Nocturne", "Olaf", "Poppy",
        "Renekton", "Rengar", "Riven", "Shyvana", "Trundle", "Tryndamere", "Udyr", "Vi", "MonkeyKing", "XinZhao", "Aatrox",
    },

}

	ChampHitBoxes = {['RecItemsCLASSIC'] = 65, ['TeemoMushroom'] = 50.0, ['TestCubeRender'] = 65, ['Xerath'] = 65, ['Kassadin'] = 65, ['Rengar'] = 65, ['Thresh'] = 55.0, ['RecItemsTUTORIAL'] = 65, ['Ziggs'] = 55.0, ['ZyraPassive'] = 20.0, ['ZyraThornPlant'] = 20.0, ['KogMaw'] = 65, ['HeimerTBlue'] = 35.0, ['EliseSpider'] = 65, ['Skarner'] = 80.0, ['ChaosNexus'] = 65, ['Katarina'] = 65, ['Riven'] = 65, ['SightWard'] = 1, ['HeimerTYellow'] = 35.0, ['Ashe'] = 65, ['VisionWard'] = 1, ['TT_NGolem2'] = 80.0, ['ThreshLantern'] = 65, ['RecItemsCLASSICMap10'] = 65, ['RecItemsODIN'] = 65, ['TT_Spiderboss'] = 200.0, ['RecItemsARAM'] = 65, ['OrderNexus'] = 65, ['Soraka'] = 65, ['Jinx'] = 65, ['TestCubeRenderwCollision'] = 65, ['Red_Minion_Wizard'] = 48.0, ['JarvanIV'] = 65, ['Blue_Minion_Wizard'] = 48.0, ['TT_ChaosTurret2'] = 88.4, ['TT_ChaosTurret3'] = 88.4, ['TT_ChaosTurret1'] = 88.4, ['ChaosTurretGiant'] = 88.4, ['Dragon'] = 100.0, ['LuluSnowman'] = 50.0, ['Worm'] = 100.0, ['ChaosTurretWorm'] = 88.4, ['TT_ChaosInhibitor'] = 65, ['ChaosTurretNormal'] = 88.4, ['AncientGolem'] = 100.0, ['ZyraGraspingPlant'] = 20.0, ['HA_AP_OrderTurret3'] = 88.4, ['HA_AP_OrderTurret2'] = 88.4, ['Tryndamere'] = 65, ['OrderTurretNormal2'] = 88.4, ['Singed'] = 65, ['OrderInhibitor'] = 65, ['Diana'] = 65, ['HA_FB_HealthRelic'] = 65, ['TT_OrderInhibitor'] = 65, ['GreatWraith'] = 80.0, ['Yasuo'] = 65, ['OrderTurretDragon'] = 88.4, ['OrderTurretNormal'] = 88.4, ['LizardElder'] = 65.0, ['HA_AP_ChaosTurret'] = 88.4, ['Ahri'] = 65, ['Lulu'] = 65, ['ChaosInhibitor'] = 65, ['HA_AP_ChaosTurret3'] = 88.4, ['HA_AP_ChaosTurret2'] = 88.4, ['ChaosTurretWorm2'] = 88.4, ['TT_OrderTurret1'] = 88.4, ['TT_OrderTurret2'] = 88.4, ['TT_OrderTurret3'] = 88.4, ['LuluFaerie'] = 65, ['HA_AP_OrderTurret'] = 88.4, ['OrderTurretAngel'] = 88.4, ['YellowTrinketUpgrade'] = 1, ['MasterYi'] = 65, ['Lissandra'] = 65, ['ARAMOrderTurretNexus'] = 88.4, ['Draven'] = 65, ['FiddleSticks'] = 65, ['SmallGolem'] = 80.0, ['ARAMOrderTurretFront'] = 88.4, ['ChaosTurretTutorial'] = 88.4, ['NasusUlt'] = 80.0, ['Maokai'] = 80.0, ['Wraith'] = 50.0, ['Wolf'] = 50.0, ['Sivir'] = 65, ['Corki'] = 65, ['Janna'] = 65, ['Nasus'] = 80.0, ['Golem'] = 80.0, ['ARAMChaosTurretFront'] = 88.4, ['ARAMOrderTurretInhib'] = 88.4, ['LeeSin'] = 65, ['HA_AP_ChaosTurretTutorial'] = 88.4, ['GiantWolf'] = 65.0, ['HA_AP_OrderTurretTutorial'] = 88.4, ['YoungLizard'] = 50.0, ['Jax'] = 65, ['LesserWraith'] = 50.0, ['Blitzcrank'] = 80.0, ['brush_D_SR'] = 65, ['brush_E_SR'] = 65, ['brush_F_SR'] = 65, ['brush_C_SR'] = 65, ['brush_A_SR'] = 65, ['brush_B_SR'] = 65, ['ARAMChaosTurretInhib'] = 88.4, ['Shen'] = 65, ['Nocturne'] = 65, ['Sona'] = 65, ['ARAMChaosTurretNexus'] = 88.4, ['YellowTrinket'] = 1, ['OrderTurretTutorial'] = 88.4, ['Caitlyn'] = 65, ['Trundle'] = 65, ['Malphite'] = 80.0, ['Mordekaiser'] = 80.0, ['ZyraSeed'] = 65, ['Vi'] = 50, ['Tutorial_Red_Minion_Wizard'] = 48.0, ['Renekton'] = 80.0, ['Anivia'] = 65, ['Fizz'] = 65, ['Heimerdinger'] = 55.0, ['Evelynn'] = 65, ['Rumble'] = 80.0, ['Leblanc'] = 65, ['Darius'] = 80.0, ['OlafAxe'] = 50.0, ['Viktor'] = 65, ['XinZhao'] = 65, ['Orianna'] = 65, ['Vladimir'] = 65, ['Nidalee'] = 65, ['Tutorial_Red_Minion_Basic'] = 48.0, ['ZedShadow'] = 65, ['Syndra'] = 65, ['Zac'] = 80.0, ['Olaf'] = 65, ['Veigar'] = 55.0, ['Twitch'] = 65, ['Alistar'] = 80.0, ['Akali'] = 65, ['Urgot'] = 80.0, ['Leona'] = 65, ['Talon'] = 65, ['Karma'] = 65, ['Jayce'] = 65, ['Galio'] = 80.0, ['Shaco'] = 65, ['Taric'] = 65, ['TwistedFate'] = 65, ['Varus'] = 65, ['Garen'] = 65, ['Swain'] = 65, ['Vayne'] = 65, ['Fiora'] = 65, ['Quinn'] = 65, ['Kayle'] = 65, ['Blue_Minion_Basic'] = 48.0, ['Brand'] = 65, ['Teemo'] = 55.0, ['Amumu'] = 55.0, ['Annie'] = 55.0, ['Odin_Blue_Minion_caster'] = 48.0, ['Elise'] = 65, ['Nami'] = 65, ['Poppy'] = 55.0, ['AniviaEgg'] = 65, ['Tristana'] = 55.0, ['Graves'] = 65, ['Morgana'] = 65, ['Gragas'] = 80.0, ['MissFortune'] = 65, ['Warwick'] = 65, ['Cassiopeia'] = 65, ['Tutorial_Blue_Minion_Wizard'] = 48.0, ['DrMundo'] = 80.0, ['Volibear'] = 80.0, ['Irelia'] = 65, ['Odin_Red_Minion_Caster'] = 48.0, ['Lucian'] = 65, ['Yorick'] = 80.0, ['RammusPB'] = 65, ['Red_Minion_Basic'] = 48.0, ['Udyr'] = 65, ['MonkeyKing'] = 65, ['Tutorial_Blue_Minion_Basic'] = 48.0, ['Kennen'] = 55.0, ['Nunu'] = 65, ['Ryze'] = 65, ['Zed'] = 65, ['Nautilus'] = 80.0, ['Gangplank'] = 65, ['shopevo'] = 65, ['Lux'] = 65, ['Sejuani'] = 80.0, ['Ezreal'] = 65, ['OdinNeutralGuardian'] = 65, ['Khazix'] = 65, ['Sion'] = 80.0, ['Aatrox'] = 65, ['Hecarim'] = 80.0, ['Pantheon'] = 65, ['Shyvana'] = 50.0, ['Zyra'] = 65, ['Karthus'] = 65, ['Rammus'] = 65, ['Zilean'] = 65, ['Chogath'] = 80.0, ['Malzahar'] = 65, ['YorickRavenousGhoul'] = 1.0, ['YorickSpectralGhoul'] = 1.0, ['JinxMine'] = 65, ['YorickDecayedGhoul'] = 1.0, ['XerathArcaneBarrageLauncher'] = 65, ['Odin_SOG_Order_Crystal'] = 65, ['TestCube'] = 65, ['ShyvanaDragon'] = 80.0, ['FizzBait'] = 65, ['ShopKeeper'] = 65, ['Blue_Minion_MechMelee'] = 65.0, ['OdinQuestBuff'] = 65, ['TT_Buffplat_L'] = 65, ['TT_Buffplat_R'] = 65, ['KogMawDead'] = 65, ['TempMovableChar'] = 48.0, ['Lizard'] = 50.0, ['GolemOdin'] = 80.0, ['OdinOpeningBarrier'] = 65, ['TT_ChaosTurret4'] = 88.4, ['TT_Flytrap_A'] = 65, ['TT_Chains_Order_Periph'] = 65, ['TT_NWolf'] = 65.0, ['ShopMale'] = 65, ['OdinShieldRelic'] = 65, ['TT_Chains_Xaos_Base'] = 65, ['LuluSquill'] = 50.0, ['TT_Shopkeeper'] = 65, ['redDragon'] = 100.0, ['MonkeyKingClone'] = 65, ['Odin_skeleton'] = 65, ['OdinChaosTurretShrine'] = 88.4, ['Cassiopeia_Death'] = 65, ['OdinCenterRelic'] = 48.0, ['Ezreal_cyber_1'] = 65, ['Ezreal_cyber_3'] = 65, ['Ezreal_cyber_2'] = 65, ['OdinRedSuperminion'] = 55.0, ['TT_Speedshrine_Gears'] = 65, ['JarvanIVWall'] = 65, ['DestroyedNexus'] = 65, ['ARAMOrderNexus'] = 65, ['Red_Minion_MechCannon'] = 65.0, ['OdinBlueSuperminion'] = 55.0, ['SyndraOrbs'] = 65, ['LuluKitty'] = 50.0, ['SwainNoBird'] = 65, ['LuluLadybug'] = 50.0, ['CaitlynTrap'] = 65, ['TT_Shroom_A'] = 65, ['ARAMChaosTurretShrine'] = 88.4, ['Odin_Windmill_Propellers'] = 65, ['DestroyedInhibitor'] = 65, ['TT_NWolf2'] = 50.0, ['OdinMinionGraveyardPortal'] = 1.0, ['SwainBeam'] = 65, ['Summoner_Rider_Order'] = 65.0, ['TT_Relic'] = 65, ['odin_lifts_crystal'] = 65, ['OdinOrderTurretShrine'] = 88.4, ['SpellBook1'] = 65, ['Blue_Minion_MechCannon'] = 65.0, ['TT_ChaosInhibitor_D'] = 65, ['Odin_SoG_Chaos'] = 65, ['TrundleWall'] = 65, ['HA_AP_HealthRelic'] = 65, ['OrderTurretShrine'] = 88.4, ['OriannaBall'] = 48.0, ['ChaosTurretShrine'] = 88.4, ['LuluCupcake'] = 50.0, ['HA_AP_ChaosTurretShrine'] = 88.4, ['TT_Chains_Bot_Lane'] = 65, ['TT_NWraith2'] = 50.0, ['TT_Tree_A'] = 65, ['SummonerBeacon'] = 65, ['Odin_Drill'] = 65, ['TT_NGolem'] = 80.0, ['Shop'] = 65, ['AramSpeedShrine'] = 65, ['DestroyedTower'] = 65, ['OriannaNoBall'] = 65, ['Odin_Minecart'] = 65, ['Summoner_Rider_Chaos'] = 65.0, ['OdinSpeedShrine'] = 65, ['TT_Brazier'] = 65, ['TT_SpeedShrine'] = 65, ['odin_lifts_buckets'] = 65, ['OdinRockSaw'] = 65, ['OdinMinionSpawnPortal'] = 1.0, ['SyndraSphere'] = 48.0, ['TT_Nexus_Gears'] = 65, ['Red_Minion_MechMelee'] = 65.0, ['SwainRaven'] = 65, ['crystal_platform'] = 65, ['MaokaiSproutling'] = 48.0, ['Urf'] = 65, ['TestCubeRender10Vision'] = 65, ['MalzaharVoidling'] = 10.0, ['GhostWard'] = 1, ['MonkeyKingFlying'] = 65, ['LuluPig'] = 50.0, ['AniviaIceBlock'] = 65, ['TT_OrderInhibitor_D'] = 65, ['yonkey'] = 65, ['Odin_SoG_Order'] = 65, ['RammusDBC'] = 65, ['FizzShark'] = 65, ['LuluDragon'] = 50.0, ['OdinTestCubeRender'] = 65, ['OdinCrane'] = 65, ['TT_Tree1'] = 65, ['ARAMOrderTurretShrine'] = 88.4, ['TT_Chains_Order_Base'] = 65, ['Odin_Windmill_Gears'] = 65, ['ARAMChaosNexus'] = 65, ['TT_NWraith'] = 50.0, ['TT_OrderTurret4'] = 88.4, ['Odin_SOG_Chaos_Crystal'] = 65, ['TT_SpiderLayer_Web'] = 65, ['OdinQuestIndicator'] = 1.0, ['JarvanIVStandard'] = 65, ['TT_DummyPusher'] = 65, ['OdinClaw'] = 65, ['EliseSpiderling'] = 1.0, ['QuinnValor'] = 65, ['UdyrTigerUlt'] = 65, ['UdyrTurtleUlt'] = 65, ['UdyrUlt'] = 65, ['UdyrPhoenixUlt'] = 65, ['ShacoBox'] = 10, ['HA_AP_Poro'] = 65, ['AnnieTibbers'] = 80.0, ['UdyrPhoenix'] = 65, ['UdyrTurtle'] = 65, ['UdyrTiger'] = 65, ['HA_AP_OrderShrineTurret'] = 88.4, ['HA_AP_OrderTurretRubble'] = 65, ['HA_AP_Chains_Long'] = 65, ['HA_AP_OrderCloth'] = 65, ['HA_AP_PeriphBridge'] = 65, ['HA_AP_BridgeLaneStatue'] = 65, ['HA_AP_ChaosTurretRubble'] = 88.4, ['HA_AP_BannerMidBridge'] = 65, ['HA_AP_PoroSpawner'] = 50.0, ['HA_AP_Cutaway'] = 65, ['HA_AP_Chains'] = 65, ['HA_AP_ShpSouth'] = 65, ['HA_AP_HeroTower'] = 65, ['HA_AP_ShpNorth'] = 65, ['ChaosInhibitor_D'] = 65, ['ZacRebirthBloblet'] = 65, ['OrderInhibitor_D'] = 65, ['Nidalee_Spear'] = 65, ['Nidalee_Cougar'] = 65, ['TT_Buffplat_Chain'] = 65, ['WriggleLantern'] = 1, ['TwistedLizardElder'] = 65.0, ['RabidWolf'] = 65.0, ['HeimerTGreen'] = 50.0, ['HeimerTRed'] = 50.0, ['ViktorFF'] = 65, ['TwistedGolem'] = 80.0, ['TwistedSmallWolf'] = 50.0, ['TwistedGiantWolf'] = 65.0, ['TwistedTinyWraith'] = 50.0, ['TwistedBlueWraith'] = 50.0, ['TwistedYoungLizard'] = 50.0, ['Red_Minion_Melee'] = 48.0, ['Blue_Minion_Melee'] = 48.0, ['Blue_Minion_Healer'] = 48.0, ['Ghast'] = 60.0, ['blueDragon'] = 100.0, ['Red_Minion_MechRange'] = 65.0, ['Test_CubeSphere'] = 65,}

	ChampInfoTable = {}
	for i, enemy in ipairs(GetEnemyHeroes()) do
		ChampInfoTable[enemy.charName] = {CurrentVector = Vector(0,0,0), CurrentDirection = Vector(0,0,0), CurrentAngle = 0, CurrentHitBox = ChampHitBoxes[enemy.charName]}
	end


end