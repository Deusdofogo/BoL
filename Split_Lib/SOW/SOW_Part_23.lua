oc2VsZi5PdGhlck1pbmlvbnMub2JqZWN0cykgZG8KCQlpZiBzZWxmOlZhbGlkVGFyZ2V0KG1pbmlvbikgdGhlbgoJCQlyZXR1cm4gbWluaW9uCgkJZW5kCgllbmQKZW5kCgpmdW5jdGlvbiBTT1c6R2V0VGFyZ2V0KE9ubHlDaGFtcGlvbnMpCglsb2NhbCByZXN1bHQKCWxvY2FsIGhlYWx0aFJhdGlvCgoJaWYgc2VsZjpWYWxpZFRhcmdldChzZWxmLmZvcmNldGFyZ2V0KSB0aGVuCgkJcmV0dXJuIHNlbGYuZm9yY2V0YXJnZXQKCWVsc2VpZiBzZWxmLmZvcmNldGFyZ2V0IH49IG5pbCB0aGVuCgkJcmV0dXJuIG5pbAoJZW5kCgoJaWYgKG5vdCBzZWxmLlNUUyBvciBub3QgT25seUNoYW1waW9ucykgYW5kIHNlbGY6VmFsaWRUYXJnZXQoR2V0VGFyZ2V0KCkpIGFuZCAoR2V0VGFyZ2V0KCkudHlwZSA9PSBteUhlcm8udHlwZSBvciAobm90IE9ubHlDaGFtcGlvbnMpKSB0aGVuCgkJcmV0dXJuIEdldFRhcmdldCgpCgllbmQKCglpZiBzZWxmLlNUUyB0aGVuCgkJbG9jYWwgb2xkaGl0Ym94bW9kZSA9IHNlbGYuU1RTLmhpdGJveG1vZGUKCQlzZWxmLlNUUy5oaXRib3htb2RlID0gdHJ1ZQoKCQlyZXN1bHQgPSBzZWxmLlNUUzpHZXRUYXJnZXQobXlIZXJvLnJhbmdlKQoKCQlzZWxmLlNUUy5oaXRib3htb2RlID0gb2xkaGl0Ym94bW9kZQoJCXJldHVybiByZXN1bHQKCWVuZAoKCWZvciBpLCBjaGFtcGlvbiBpbiBpcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8KCQlsb2NhbCBociA9IGNoYW1waW9uLmhlYWx0aCAvIG15SGVybzpDYWxjRGFtYWdlKGNoYW1waW9uLCA