0aGVuCgkJaWYgbXlIZXJvOkdldFNwZWxsRGF0YShfUSkubGV2ZWwgPiAwIGFuZCBteUhlcm86Q2FuVXNlU3BlbGwoX1EpID09IFNVUFJFU1NFRCB0aGVuCgkJCUJPTlVTID0gQk9OVVMgKyBteUhlcm86Q2FsY0RhbWFnZShtaW5pb24sICgoMC4wNSAqIG15SGVybzpHZXRTcGVsbERhdGEoX1EpLmxldmVsKSArIDAuMjUgKSAqIG15SGVyby50b3RhbERhbWFnZSkKCQllbmQKCQlpZiBub3QgVmF5bmVDQkFkZGVkIHRoZW4KCQkJVmF5bmVDQkFkZGVkID0gdHJ1ZQoJCQlmdW5jdGlvbiBWYXluZVBhcnRpY2xlKG9iaikKCQkJCWlmIEdldERpc3RhbmNlKG9iaikgPCAxMDAwIGFuZCBvYmoubmFtZTpsb3dlcigpOmZpbmQoInZheW5lX3dfcmluZzIudHJveSIpIHRoZW4KCQkJCQlWYXluZVdQYXJ0aWNsZSA9IG9iagoJCQkJZW5kCgkJCWVuZAoJCQlBZGRDcmVhdGVPYmpDYWxsYmFjayhWYXluZVBhcnRpY2xlKQoJCWVuZAoJCWlmIFZheW5lV1BhcnRpY2xlIGFuZCBWYXluZVdQYXJ0aWNsZS52YWxpZCBhbmQgR2V0RGlzdGFuY2UoVmF5bmVXUGFydGljbGUsIG1pbmlvbikgPCAxMCB0aGVuCgkJCUJPTlVTID0gQk9OVVMgKyAxMCArIDEwICogbXlIZXJvOkdldFNwZWxsRGF0YShfVykubGV2ZWwgKyAoMC4wMyArICgwLjAxICogbXlIZXJvOkdldFNwZWxsRGF0YShfVykubGV2ZWwpKSAqIG1pbmlvbi5tYXhIZWFsdGgKCQllbmQKCWVsc2VpZiBteUhlcm8uY2hhck5hbWUgPT0gJ1RlZW1vJyBhbmQgbXlIZXJvOkdldFNwZWxsRGF0YShfRSkubGV2ZWwgPiAwIHRoZW4