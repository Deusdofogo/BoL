hRGVsYXkgPSBzcGVlZCA9PSBtYXRoLmh1Z2UgYW5kICAwIG9yIChHZXREaXN0YW5jZShmcm9tLCB1bml0KSAvIHNwZWVkKQoJCWlmIChzZWxmLlRhcmdldHNJbW1vYmlsZVt1bml0Lm5ldHdvcmtJRF0gPiAoc2VsZjpHZXRUaW1lKCkgKyBkZWxheSArIEV4dHJhRGVsYXkpIGFuZCBzcGVsbHR5cGUgPT0gImNpcmN1bGFyIikgdGhlbgoJCQlyZXR1cm4gdHJ1ZSwgVmVjdG9yKHVuaXQudmlzaW9uUG9zKSwgVmVjdG9yKHVuaXQudmlzaW9uUG9zKSArIChyYWRpdXMvMykgKiAoVmVjdG9yKGZyb20pIC0gVmVjdG9yKHVuaXQudmlzaW9uUG9zKSk6bm9ybWFsaXplZCgpCgkJZWxzZWlmIChzZWxmLlRhcmdldHNJbW1vYmlsZVt1bml0Lm5ldHdvcmtJRF0gKyAocmFkaXVzIC8gdW5pdC5tcykpID4gKHNlbGY6R2V0VGltZSgpICsgZGVsYXkgKyBFeHRyYURlbGF5KSB0aGVuCgkJCXJldHVybiB0cnVlLCBWZWN0b3IodW5pdC52aXNpb25Qb3MpLCBWZWN0b3IodW5pdC52aXNpb25Qb3MpCgkJZW5kCgllbmQKCXJldHVybiBmYWxzZSwgVmVjdG9yKHVuaXQudmlzaW9uUG9zKSwgVmVjdG9yKHVuaXQudmlzaW9uUG9zKQplbmQKCmZ1bmN0aW9uIFZQcmVkaWN0aW9uOmlzU2xvd2VkKHVuaXQsIGRlbGF5LCBzcGVlZCwgZnJvbSkKCWlmIHNlbGYuVGFyZ2V0c1Nsb3dlZFt1bml0Lm5ldHdvcmtJRF0gdGhlbgoJCWlmIHNlbGYuVGFyZ2V0c1Nsb3dlZFt1bml0Lm5ldHdvcmtJRF0gPiAoc2VsZjpHZXRUaW1lKCkgKyBkZWxheSArIEdldERpc3RhbmNlKHVuaXQsIGZyb20pIC8