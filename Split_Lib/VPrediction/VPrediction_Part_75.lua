lLCBzcGVlZCwgZnJvbSwgY29sbGlzaW9uLCAiY2lyY3VsYXIiKQoJbG9jYWwgcG9pbnRzID0ge30KCWxvY2FsIG1haW5DYXN0UG9zaXRpb24sIG1haW5IaXRDaGFuY2UsIG1haW5Qb3NpdGlvbiA9IENhc3RQb3NpdGlvbiwgSGl0Q2hhbmNlLCBQb3NpdGlvbgoKCXRhYmxlLmluc2VydChwb2ludHMsIFBvc2l0aW9uKQoKCWZvciBpLCB0YXJnZXQgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvCgkJaWYgdGFyZ2V0Lm5ldHdvcmtJRCB+PSB1bml0Lm5ldHdvcmtJRCBhbmQgVmFsaWRUYXJnZXQodGFyZ2V0LCByYW5nZSAqIDEuNSkgdGhlbgoJCQlDYXN0UG9zaXRpb24sIEhpdENoYW5jZSwgUG9zaXRpb24gPSBzZWxmOkdldEJlc3RDYXN0UG9zaXRpb24odGFyZ2V0LCBkZWxheSwgcmFkaXVzLCByYW5nZSwgc3BlZWQsIGZyb20sIGNvbGxpc2lvbiwgImNpcmN1bGFyIikKCQkJaWYgR2V0RGlzdGFuY2UoZnJvbSwgUG9zaXRpb24pIDwgKHJhbmdlICsgcmFkaXVzKSBhbmQgKEhpdGNoYW5jZSB+PSAtMSBvciBub3QgY29sbGlzaW9uKSB0aGVuCgkJCQl0YWJsZS5pbnNlcnQocG9pbnRzLCBQb3NpdGlvbikKCQkJZW5kCgkJZW5kCgllbmQKCgl3aGlsZSAjcG9pbnRzID4gMSBkbwoJCWxvY2FsIE1lYyA9IE1FQyhwb2ludHMpCgkJbG9jYWwgQ2lyY2xlID0gTWVjOkNvbXB1dGUoKQoJCQoJCWlmIENpcmNsZS5yYWRpdXMgPD0gcmFkaXVzICsgc2VsZjpHZXRIaXRCb3godW5pdCkgLSA4IHRoZW4KCQkJcmV0dXJuIENpcmNsZS5jZW50ZXIsIG1haW5IaXRDaGF