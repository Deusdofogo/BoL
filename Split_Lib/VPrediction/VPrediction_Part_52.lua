0aW9uLCBDYXN0UG9zaXRpb24gPSBWZWN0b3IodW5pdC52aXNpb25Qb3MpLCBWZWN0b3IodW5pdC52aXNpb25Qb3MpCglsb2NhbCB0CgoJV2F5cG9pbnRzID0gc2VsZjpHZXRDdXJyZW50V2F5UG9pbnRzKHVuaXQpCglsb2NhbCBXYXlwb2ludHNsZW5ndGggPSBzZWxmOkdldFdheXBvaW50c0xlbmd0aChXYXlwb2ludHMpCgoJaWYgI1dheXBvaW50cyA9PSAxIHRoZW4KCQlQb3NpdGlvbiwgQ2FzdFBvc2l0aW9uID0gVmVjdG9yKFdheXBvaW50c1sxXS54LCAwLCBXYXlwb2ludHNbMV0ueSksIFZlY3RvcihXYXlwb2ludHNbMV0ueCwgMCwgV2F5cG9pbnRzWzFdLnkpCgkJcmV0dXJuIFBvc2l0aW9uLCBDYXN0UG9zaXRpb24KCWVsc2VpZiAoV2F5cG9pbnRzbGVuZ3RoIC0gZGVsYXkgKiB1bml0Lm1zICsgcmFkaXVzKSA+PSAwIHRoZW4KCQlsb2NhbCB0QSA9IDAKCQlXYXlwb2ludHMgPSBzZWxmOkN1dFdheXBvaW50cyhXYXlwb2ludHMsIGRlbGF5ICogdW5pdC5tcyAtIHJhZGl1cykKCgkJaWYgc3BlZWQgfj0gbWF0aC5odWdlIHRoZW4KCQkJZm9yIGkgPSAxLCAjV2F5cG9pbnRzIC0gMSBkbwoJCQkJbG9jYWwgQSwgQiA9IFdheXBvaW50c1tpXSwgV2F5cG9pbnRzW2krMV0KCQkJCWlmIGkgPT0gI1dheXBvaW50cyAtIDEgdGhlbgoJCQkJCUIgPSBWZWN0b3IoQikgKyByYWRpdXMgKiBWZWN0b3IoQiAtIEEpOm5vcm1hbGl6ZWQoKQoJCQkJZW5kCgkJCQlsb2NhbCB0MSwgcDEsIHQyLCBwMiwgRCA9IFZlY3Rvck1vdmVtZW50Q29sbGlzaW9uKEEsIEIsIHVuaXQ