lQXR0YWNrc1tpXS53aW5kVXBUaW1lICsgKEdldERpc3RhbmNlKHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5wb3MsIHVuaXQudmlzaW9uUG9zKSkgLyBzZWxmLkFjdGl2ZUF0dGFja3NbaV0ucHJvamVjdGlsZXNwZWVkICsgZGVsYXkKCQkJaWYgc2VsZjpHZXRUaW1lKCkgPCBoaXR0aW1lIC0gZGVsYXkgYW5kIGhpdHRpbWUgPCBzZWxmOkdldFRpbWUoKSArIHRpbWUgIHRoZW4KCQkJCUluY0RhbWFnZSA9IEluY0RhbWFnZSArIHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5kYW1hZ2UKCQkJCWNvdW50ID0gY291bnQgKyAxCgkJCQlpZiBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uZGFtYWdlID4gTWF4RGFtYWdlIHRoZW4KCQkJCQlNYXhEYW1hZ2UgPSBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uZGFtYWdlCgkJCQllbmQKCQkJZW5kCgkJZW5kCgkJaSA9IGkgKyAxCgllbmQKCglyZXR1cm4gdW5pdC5oZWFsdGggLSBJbmNEYW1hZ2UsIE1heERhbWFnZSwgY291bnQKZW5kCgpmdW5jdGlvbiBWUHJlZGljdGlvbjpHZXRQcmVkaWN0ZWRIZWFsdGgyKHVuaXQsIHQpCglsb2NhbCBkYW1hZ2UgPSAwCglsb2NhbCBpID0gMQoKCXdoaWxlIGkgPD0gI3NlbGYuQWN0aXZlQXR0YWNrcyBkbwoJCWxvY2FsIG4gPSAwCgkJaWYgKHNlbGY6R2V0VGltZSgpIC0gMC4xKSA8PSBzZWxmLkFjdGl2ZUF0dGFja3NbaV0uc3RhcnR0aW1lICsgc2VsZi5BY3RpdmVBdHRhY2tzW2ldLmFuaW1hdGlvblRpbWUgYW5kIHNlbGYuQWN0aXZlQXR0YWNrc1tpXS5UYXJnZXQgYW5kIHNlbGYuQWN0aXZlQXR0YWN