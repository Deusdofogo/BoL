gICAgZW5kCiAgICAgICAgaWYgU2VsZWN0ZWRUYXJnZXQgYW5kIE1pbmltdW1EaXN0YW5jZSA8IDE1MCAqIDE1MCB0aGVuCiAgICAgICAgICAgIHNlbGYuU1RhcmdldCA9IFNlbGVjdGVkVGFyZ2V0CiAgICAgICAgZWxzZQogICAgICAgICAgICBzZWxmLlNUYXJnZXQgPSBuaWwKICAgICAgICBlbmQKICAgIGVuZAplbmQKCmZ1bmN0aW9uIFNpbXBsZVRTOlNlbGVjdGVkVGFyZ2V0KCkKICAgIHJldHVybiBzZWxmLlNUYXJnZXQKZW5kCgpmdW5jdGlvbiBTaW1wbGVUUzpHZXRUYXJnZXQocmFuZ2UsIG4sIGZvcmNlbW9kZSkKICAgIGFzc2VydChyYW5nZSwgIlNpbXBsZVRTOiByYW5nZSBjYW4ndCBiZSBuaWwiKQogICAgcmFuZ2UgPSByYW5nZSAqIHJhbmdlCiAgICBsb2NhbCBQb3NpYmxlVGFyZ2V0cyA9IHt9CiAgICBsb2NhbCBzZWxlY3RlZCA9IHNlbGY6U2VsZWN0ZWRUYXJnZXQoKQoKICAgIGlmIHNlbGYubWVudSB0aGVuCiAgICAgICAgc2VsZi5tb2RlID0gU1RTX0FWQUlMQUJMRV9NT0RFU1tzZWxmLm1lbnUubW9kZV0KICAgICAgICBpZiBzZWxmLm1lbnUuU2VsZWN0ZWQgYW5kIHNlbGVjdGVkIGFuZCBzZWxlY3RlZC50eXBlID09IHBsYXllci50eXBlIGFuZCBzZWxmOklzVmFsaWQoc2VsZWN0ZWQsIHJhbmdlLCB0cnVlKSB0aGVuCiAgICAgICAgICAgIHJldHVybiBzZWxlY3RlZAogICAgICAgIGVuZAogICAgZW5kCgogICAgZm9yIGksIGVuZW15IGluIGlwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbwogICAgICAgIGlmIHNlbGY6SXNWYWxpZChlbmV