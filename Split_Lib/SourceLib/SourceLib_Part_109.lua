wY2xvc2VyOk9uUHJvY2Vzc1NwZWxsKHVuaXQsIHNwZWxsKQoKICAgIGlmIG5vdCBzZWxmLk1lbnUuRW5hYmxlZCB0aGVuIHJldHVybiBlbmQKICAgIGlmIHVuaXQudGVhbSB+PSBteUhlcm8udGVhbSB0aGVuCiAgICAgICAgaWYgX0dBUENMT1NFUl9TUEVMTFNbc3BlbGwubmFtZV0gdGhlbgogICAgICAgICAgICBsb2NhbCBHYXBjbG9zZXIgPSBfR0FQQ0xPU0VSX1NQRUxMU1tzcGVsbC5uYW1lXQogICAgICAgICAgICBpZiAoc2VsZi5NZW51IGFuZCBzZWxmLk1lbnVbc3RyaW5nLmdzdWIoc3BlbGwubmFtZSwgIl8iLCAiIildKSBvciBub3Qgc2VsZi5NZW51IHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGFkZCA9IGZhbHNlCiAgICAgICAgICAgICAgICBpZiBzcGVsbC50YXJnZXQgYW5kIHNwZWxsLnRhcmdldC5pc01lIHRoZW4KICAgICAgICAgICAgICAgICAgICBhZGQgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgc3RhcnRQb3MgPSBWZWN0b3IodW5pdC52aXNpb25Qb3MpCiAgICAgICAgICAgICAgICAgICAgZW5kUG9zID0gbXlIZXJvCiAgICAgICAgICAgICAgICBlbHNlaWYgbm90IHNwZWxsLnRhcmdldCB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZW5kUG9zMSA9IFZlY3Rvcih1bml0LnZpc2lvblBvcykgKyAzMDAgKiAoVmVjdG9yKHNwZWxsLmVuZFBvcykgLSBWZWN0b3IodW5pdC52aXNpb25Qb3MpKTpub3JtYWxpemVkKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBlbmRQb3MyID0gVmVjdG9yKHVuaXQudmlzaW9uUG9zKSA