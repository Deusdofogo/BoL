lbGYudGlja2xpbWl0IHRoZW4KICAgICAgICBzZWxmLmxhc3R0aWNrID0gb3MuY2xvY2soKQogICAgICAgIGZvciBpLCBlbmVteSBpbiBpcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8KICAgICAgICAgICAgaWYgVmFsaWRUYXJnZXQoZW5lbXkpIHRoZW4KICAgICAgICAgICAgICAgIHNlbGYuY2FjaGVkRGFtYWdlW2VuZW15Lmhhc2hdID0gc2VsZjpDYWxjQ29tYm9EYW1hZ2UoZW5lbXksIHNlbGYuY29tYm8pCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgplbmQKCmZ1bmN0aW9uIERhbWFnZUxpYjpPbkRyYXcoKQoKICAgIGlmIG5vdCBzZWxmLm1lbnVbIkRyYXdQcmVkaWN0ZWRIZWFsdGgiXSB0aGVuIHJldHVybiBlbmQKICAgIGZvciBpLCBlbmVteSBpbiBpcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8KICAgICAgICBpZiBWYWxpZFRhcmdldChlbmVteSkgdGhlbgogICAgICAgICAgICBzZWxmOkRyYXdJbmRpY2F0b3IoZW5lbXkpCiAgICAgICAgZW5kCiAgICBlbmQKCmVuZAoKZnVuY3Rpb24gRGFtYWdlTGliOkRyYXdJbmRpY2F0b3IoZW5lbXkpCgogICAgbG9jYWwgZGFtYWdlID0gc2VsZi5jYWNoZWREYW1hZ2VbZW5lbXkuaGFzaF0gb3IgMAogICAgbG9jYWwgU1BvcywgRVBvcyA9IEdldEVuZW15SFBCYXJQb3MoZW5lbXkpCgogICAgLS0gVmFsaWRhdGUgZGF0YQogICAgaWYgbm90IFNQb3MgdGhlbiByZXR1cm4gZW5kCgogICAgbG9jYWwgYmFyd2lkdGggPSBFUG9zLnggLSBTUG9zLngKICAgIGxvY2FsIFBvc2l0aW9uID0gU1B