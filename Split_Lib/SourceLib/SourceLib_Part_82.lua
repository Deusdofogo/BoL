BSUxBQkxFX01PREVTKSBkbwogICAgICAgIHRhYmxlLmluc2VydChtb2RlbGlzdCwgbW9kZS5uYW1lKQogICAgZW5kCgogICAgc2VsZi5tZW51OmFkZFBhcmFtKCJtb2RlIiwgIlRhcmdldHRpbmcgbW9kZTogIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIG1vZGVsaXN0KQogICAgc2VsZi5tZW51WyJtb2RlIl0gPSBzZWxmLm1vZGUuaWQKCiAgICBzZWxmLm1lbnU6YWRkUGFyYW0oIlNlbGVjdGVkIiwgIkZvY3VzIHNlbGVjdGVkIHRhcmdldCIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKCiAgICBTVFNfTUVOVSA9IHNlbGYubWVudQplbmQKCmZ1bmN0aW9uIFNpbXBsZVRTOk9uTXNnKG1zZywga2V5KQogICAgaWYgbXNnID09IFdNX0xCVVRUT05ET1dOIHRoZW4KICAgICAgICBsb2NhbCBNaW5pbXVtRGlzdGFuY2UgPSBtYXRoLmh1Z2UKICAgICAgICBsb2NhbCBTZWxlY3RlZFRhcmdldAogICAgICAgIGZvciBpLCBlbmVteSBpbiBpcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8KICAgICAgICAgICAgaWYgVmFsaWRUYXJnZXQoZW5lbXkpIHRoZW4KICAgICAgICAgICAgICAgIGlmIF9HZXREaXN0YW5jZVNxcihlbmVteSwgbW91c2VQb3MpIDw9IE1pbmltdW1EaXN0YW5jZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgTWluaW11bURpc3RhbmNlID0gX0dldERpc3RhbmNlU3FyKGVuZW15LCBtb3VzZVBvcykKICAgICAgICAgICAgICAgICAgICBTZWxlY3RlZFRhcmdldCA9IGVuZW15CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICA